{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\NewSearch\\\\item\\\\[id]\\\\index.js\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState, useRef } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { Form, Button, Card, Container, Row, Col, Modal, FormControl, Collapse, InputGroup, ButtonGroup } from \"react-bootstrap\";\nimport Link from \"next/link\";\nimport { useAuth } from \"../../../../context/AuthUserContext\";\nimport firebase from \"../../../../context/Firebase\";\nimport LoggedIn from \"../../../LoggedIn\";\nimport { useRouter } from \"next/router\";\nimport { fetchClients } from \"../../../../utils/fetchAssociations\";\nimport ClientTable from \"../../../../utils/ClientTable\";\nimport ClientInfoModal from \"../../ClientInfoModal\";\nimport ParentModal from \"../../AddItem/parentModal\";\nimport dynamic from \"next/dynamic\";\nimport InfoModal from \"../../InfoModal\";\nimport MachineSelectionModal from \"./MachineSelectionModal\";\nimport { addServiceItem } from \"../../../../utils/BluefolderService\";\nimport NewLocal from \"./NewLocal\"; //inflow API\n\nimport InflowAPI from \"../../../../utils/inflowAPI\"; // Import for SSR\n\nimport { adminDb } from \"../../../../context/FirebaseAdmin\"; // === BUILD A MAP ONLY OF THOSE FIELDS THE USER ACTUALLY PICKED ===\n\nfunction buildLocalLocObject(loc) {\n  var _loc$section, _loc$section2;\n\n  const o = {};\n  if (loc.region) o.region = loc.region;\n  if ((_loc$section = loc.section) !== null && _loc$section !== void 0 && _loc$section.letter && (_loc$section2 = loc.section) !== null && _loc$section2 !== void 0 && _loc$section2.number) o.section = loc.section; // pick up the new singular fields, too:\n\n  if (loc.bin !== undefined && loc.bin !== \"\") o.bin = loc.bin;\n  if (loc.pallet !== undefined && loc.pallet !== \"\") o.pallet = loc.pallet;\n  return o;\n} // This will only load the component on the client-side.\n\n\nconst BarcodeScannerComponent = dynamic(() => import(\"react-qr-barcode-scanner\"), {\n  ssr: false,\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"react-qr-barcode-scanner\")],\n    modules: [\"NewSearch\\\\item\\\\[id]\\\\index.js -> \" + \"react-qr-barcode-scanner\"]\n  }\n}); // Simulates a network request delay.\n\nfunction simulateNetworkRequest() {\n  return new Promise(resolve => setTimeout(resolve, 2000));\n} // Custom LoadingButton component.\n\n\nfunction LoadingButton({\n  type,\n  name,\n  route\n}) {\n  const {\n    0: isLoading,\n    1: setLoading\n  } = useState(false);\n  useEffect(() => {\n    if (isLoading) {\n      simulateNetworkRequest().then(() => setLoading(false));\n    }\n  }, [isLoading]);\n\n  const handleClick = () => setLoading(true);\n\n  return __jsx(Link, {\n    href: `/${route}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", {\n    className: `btn btn-${type}`,\n    disabled: isLoading,\n    onClick: !isLoading ? handleClick : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 7\n    }\n  }, isLoading ? \"Loading…\" : name));\n}\n\nexport default function DisplayItem({\n  initialItem,\n  initialMachineData,\n  error\n}) {\n  var _initialItem$price, _initialItem$status, _initialItem$length, _initialItem$width, _initialItem$height, _initialItem$poNumber, _initialItem$tracking, _initialItem$visible, _descriptions$selecte3, _descriptions$selecte4, _newLocalFrom$section, _newLocalFrom$section2, _newLocalCurrent$sect, _newLocalCurrent$sect2;\n\n  const router = useRouter();\n  const {\n    signOut\n  } = useAuth(); // const { id } = router.query;\n\n  const {\n    id: idFromRouter\n  } = router.query;\n  const initialId = (initialItem === null || initialItem === void 0 ? void 0 : initialItem.id) || idFromRouter; // Use a single local var everywhere in this component\n\n  const id = initialId;\n  const {\n    0: items,\n    1: setItems\n  } = useState({\n    name: (initialItem === null || initialItem === void 0 ? void 0 : initialItem.name) || \"\",\n    pn: Array.isArray(initialItem === null || initialItem === void 0 ? void 0 : initialItem.pn) ? initialItem.pn : initialItem !== null && initialItem !== void 0 && initialItem.pn ? [initialItem.pn] : [],\n    sn: Array.isArray(initialItem === null || initialItem === void 0 ? void 0 : initialItem.sn) ? initialItem.sn : initialItem !== null && initialItem !== void 0 && initialItem.sn ? [initialItem.sn] : [],\n    // hydrate these from initialItem so SSR renders fully on deploy\n    price: (_initialItem$price = initialItem === null || initialItem === void 0 ? void 0 : initialItem.price) !== null && _initialItem$price !== void 0 ? _initialItem$price : \"\",\n    status: (_initialItem$status = initialItem === null || initialItem === void 0 ? void 0 : initialItem.status) !== null && _initialItem$status !== void 0 ? _initialItem$status : \"\",\n    length: (_initialItem$length = initialItem === null || initialItem === void 0 ? void 0 : initialItem.length) !== null && _initialItem$length !== void 0 ? _initialItem$length : \"\",\n    width: (_initialItem$width = initialItem === null || initialItem === void 0 ? void 0 : initialItem.width) !== null && _initialItem$width !== void 0 ? _initialItem$width : \"\",\n    height: (_initialItem$height = initialItem === null || initialItem === void 0 ? void 0 : initialItem.height) !== null && _initialItem$height !== void 0 ? _initialItem$height : \"\",\n    poNumber: (_initialItem$poNumber = initialItem === null || initialItem === void 0 ? void 0 : initialItem.poNumber) !== null && _initialItem$poNumber !== void 0 ? _initialItem$poNumber : \"\",\n    trackingNumber: (_initialItem$tracking = initialItem === null || initialItem === void 0 ? void 0 : initialItem.trackingNumber) !== null && _initialItem$tracking !== void 0 ? _initialItem$tracking : \"\",\n    localSN: (initialItem === null || initialItem === void 0 ? void 0 : initialItem.localSN) || \"\",\n    arrival_date: (initialItem === null || initialItem === void 0 ? void 0 : initialItem.arrival_date) || \"\",\n    visible: (_initialItem$visible = initialItem === null || initialItem === void 0 ? void 0 : initialItem.visible) !== null && _initialItem$visible !== void 0 ? _initialItem$visible : true\n  }); // ⬇️ put this INSIDE DisplayItem, after the related useState hooks\n\n  useEffect(() => {\n    if (!initialItem) return;\n    setDescriptions(initialItem.descriptions || []);\n    setWorkOrders(initialItem.workOrders || []);\n    setDOM(initialItem.DOM || \"\");\n    setItems(prev => {\n      var _ref, _initialItem$status2, _ref2, _initialItem$price2, _ref3, _initialItem$length2, _ref4, _initialItem$width2, _ref5, _initialItem$height2, _ref6, _initialItem$poNumber2, _ref7, _initialItem$tracking2;\n\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        // only overwrite if SSR provided a value; otherwise keep what you have\n        status: (_ref = (_initialItem$status2 = initialItem.status) !== null && _initialItem$status2 !== void 0 ? _initialItem$status2 : prev.status) !== null && _ref !== void 0 ? _ref : \"\",\n        price: (_ref2 = (_initialItem$price2 = initialItem.price) !== null && _initialItem$price2 !== void 0 ? _initialItem$price2 : prev.price) !== null && _ref2 !== void 0 ? _ref2 : \"\",\n        length: (_ref3 = (_initialItem$length2 = initialItem.length) !== null && _initialItem$length2 !== void 0 ? _initialItem$length2 : prev.length) !== null && _ref3 !== void 0 ? _ref3 : \"\",\n        width: (_ref4 = (_initialItem$width2 = initialItem.width) !== null && _initialItem$width2 !== void 0 ? _initialItem$width2 : prev.width) !== null && _ref4 !== void 0 ? _ref4 : \"\",\n        height: (_ref5 = (_initialItem$height2 = initialItem.height) !== null && _initialItem$height2 !== void 0 ? _initialItem$height2 : prev.height) !== null && _ref5 !== void 0 ? _ref5 : \"\",\n        poNumber: (_ref6 = (_initialItem$poNumber2 = initialItem.poNumber) !== null && _initialItem$poNumber2 !== void 0 ? _initialItem$poNumber2 : prev.poNumber) !== null && _ref6 !== void 0 ? _ref6 : \"\",\n        trackingNumber: (_ref7 = (_initialItem$tracking2 = initialItem.trackingNumber) !== null && _initialItem$tracking2 !== void 0 ? _initialItem$tracking2 : prev.trackingNumber) !== null && _ref7 !== void 0 ? _ref7 : \"\"\n      });\n    });\n  }, [initialItem]);\n  const {\n    0: newLocalFrom,\n    1: setNewLocalFrom\n  } = useState({\n    region: \"\",\n    section: {\n      letter: \"\",\n      number: \"\"\n    },\n    bin: \"\",\n    pallet: \"\"\n  });\n  const {\n    0: newLocalCurrent,\n    1: setNewLocalCurrent\n  } = useState({\n    region: \"\",\n    section: {\n      letter: \"\",\n      number: \"\"\n    },\n    bin: \"\",\n    pallet: \"\"\n  }); // New states for separate client selections:\n\n  const {\n    0: selectedClientFrom,\n    1: setSelectedClientFrom\n  } = useState(null);\n  const {\n    0: selectedClientCurrent,\n    1: setSelectedClientCurrent\n  } = useState(null);\n  const {\n    0: selectedMachine,\n    1: setSelectedMachine\n  } = useState(null);\n  const {\n    0: selectedCurrentMachine,\n    1: setSelectedCurrentMachine\n  } = useState(null); // whenever you pick a new “From” client or machine, clear the old From-loc:\n  // useEffect(() => {\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientFrom, selectedMachine]);\n  // const didMountFrom = useRef(false);\n  // useEffect(() => {\n  //   if (!didMountFrom.current) {\n  //     // first time through (the data-load phase), don’t clear\n  //     didMountFrom.current = true;\n  //     return;\n  //   }\n  //   // thereafter, when the user picks a new client or machine, clear:\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  //   setLocalLocFrom(\"\");\n  // }, [selectedClientFrom, selectedMachine]);\n  // whenever you pick a new “Current” client or machine, clear the old Current-loc:\n  // useEffect(() => {\n  //   setNewLocalCurrent({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\n  // const [didFetch, setDidFetch] = useState(false);\n  // useEffect(() => {\n  //   if (!didFetch) {\n  //     // we’re in the data-load phase, skip clearing\n  //     setDidFetch(true);\n  //     return;\n  //   }\n  //   // only clear on subsequent user changes:\n  //   setNewLocalCurrent({ region: \"\", section: {}, bin: \"\", pallet: \"\" });\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\n  // These arrays will be populated from Firebase.\n\n  const {\n    0: pnOptions,\n    1: setPnOptions\n  } = useState([]);\n  const {\n    0: snOptions,\n    1: setSnOptions\n  } = useState([]);\n  const {\n    0: descriptions,\n    1: setDescriptions\n  } = useState([{\n    description: \"\",\n    date: \"\"\n  }]);\n  const {\n    0: workOrders,\n    1: setWorkOrders\n  } = useState([{\n    workOrder: \"\",\n    date: \"\"\n  }]);\n  const {\n    0: clients,\n    1: setClients\n  } = useState([]);\n  const {\n    0: photos,\n    1: setPhotos\n  } = useState([]);\n  const {\n    0: show,\n    1: setShow\n  } = useState(false);\n  const {\n    0: showErr,\n    1: setShowErr\n  } = useState(false);\n  const {\n    0: Err,\n    1: setErr\n  } = useState(\"N/A\");\n  const {\n    0: showDescModal,\n    1: setShowDescModal\n  } = useState(false);\n  const {\n    0: showWoModal,\n    1: setShowWoModal\n  } = useState(false);\n  const {\n    0: showClientModal,\n    1: setShowClientModal\n  } = useState(false);\n  const {\n    0: showMachineModal,\n    1: setShowMachineModal\n  } = useState(false);\n  const {\n    0: showParentModal,\n    1: setShowParentModal\n  } = useState(false);\n  const {\n    0: showCameraModal,\n    1: setShowCameraModal\n  } = useState(false);\n  const {\n    0: showSaveModal,\n    1: setShowSaveModal\n  } = useState(false);\n  const {\n    0: showPrintModal,\n    1: setShowPrintModal\n  } = useState(false);\n  const {\n    0: machineSelectionModal,\n    1: setMachineSelectionModal\n  } = useState(false);\n  const {\n    0: selectedDesc,\n    1: setSelectedDesc\n  } = useState(0);\n  const {\n    0: selectedClient,\n    1: setSelectedClient\n  } = useState(null);\n  const {\n    0: selectedParent,\n    1: setSelectedParent\n  } = useState(null);\n  const {\n    0: TheMachine,\n    1: setTheMachine\n  } = useState(null);\n  const {\n    0: machineOptions,\n    1: setMachineOptions\n  } = useState([]);\n  const {\n    0: search,\n    1: setSearch\n  } = useState(\"\");\n  const {\n    0: capturedPhoto,\n    1: setCapturedPhoto\n  } = useState(null);\n  const {\n    0: cameraFacing,\n    1: setCameraFacing\n  } = useState(\"environment\");\n  const {\n    0: addToWebsite,\n    1: setAddToWebsite\n  } = useState(false);\n  const {\n    0: machinePick,\n    1: setMachinePick\n  } = useState(false);\n  const {\n    0: freqItem,\n    1: setFreqItem\n  } = useState(0);\n  const {\n    0: usagePastYear,\n    1: setUsagePastYear\n  } = useState(0);\n  const {\n    0: machineFrequency,\n    1: setMachineFrequency\n  } = useState(0); // State for the extra (dimensions/price/DOM/PO Number) section.\n\n  const {\n    0: showExtra,\n    1: setShowExtra\n  } = useState(false); // State for the local warehouse location inputs.\n\n  const {\n    0: localLocFrom,\n    1: setLocalLocFrom\n  } = useState(\"\");\n  const {\n    0: localLocCurrent,\n    1: setLocalLocCurrent\n  } = useState(\"\"); // New state for DOM (Date of Manufacture)\n\n  const {\n    0: DOM,\n    1: setDOM\n  } = useState(\"\"); // New state for OEM, Modality, and Model.\n\n  const {\n    0: oem,\n    1: setOem\n  } = useState(\"\");\n  const {\n    0: modality,\n    1: setModality\n  } = useState(\"\");\n  const {\n    0: model,\n    1: setModel\n  } = useState(\"\"); // More info modal state.\n\n  const {\n    0: showInfoModal,\n    1: setShowInfoModal\n  } = useState(false);\n  const {\n    0: itemName,\n    1: setItemName\n  } = useState(\"\");\n  const {\n    0: machineFieldsInitialized,\n    1: setMachineFieldsInitialized\n  } = useState(false); // near the top of DisplayItem()\n\n  const {\n    0: showLocalModalFrom,\n    1: setShowLocalModalFrom\n  } = useState(false);\n  const {\n    0: showLocalModalCurrent,\n    1: setShowLocalModalCurrent\n  } = useState(false);\n\n  const openLocalModalFrom = () => setShowLocalModalFrom(true);\n\n  const closeLocalModalFrom = () => setShowLocalModalFrom(false);\n\n  const openLocalModalCurrent = () => setShowLocalModalCurrent(true);\n\n  const closeLocalModalCurrent = () => setShowLocalModalCurrent(false); // at the top of DisplayItem()\n\n\n  const {\n    0: showNewLocalModalFrom,\n    1: setShowNewLocalModalFrom\n  } = useState(false);\n  const {\n    0: showNewLocalModalCurrent,\n    1: setShowNewLocalModalCurrent\n  } = useState(false);\n\n  function formatLoc(loc) {\n    var _loc$section3, _loc$section4;\n\n    if (!loc) return \"\";\n    const parts = [];\n    if (loc.region) parts.push(loc.region);\n    if ((_loc$section3 = loc.section) !== null && _loc$section3 !== void 0 && _loc$section3.letter && (_loc$section4 = loc.section) !== null && _loc$section4 !== void 0 && _loc$section4.number) parts.push(`${loc.section.letter}${loc.section.number}`);\n    if (loc.bin) parts.push(`B${loc.bin}`);\n    if (loc.pallet) parts.push(`P${loc.pallet}`);\n    return parts.join(\"–\");\n  } // when the From-client changes, clear any old local-loc\n  // useEffect(() => {\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientFrom]);\n  // // when the From-machine changes, clear any old local-loc\n  // useEffect(() => {\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedMachine]);\n  // same for Current:\n  // useEffect(() => {\n  //   setNewLocalCurrent({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\n  // const handleSendToInflow = async () => {\n  //   try {\n  //     const name = items.name;\n  //     const description = descriptions[selectedDesc]?.description || \"\";\n  //     // gather every photo URL from Firebase Storage\n  //     const imageUrls = photos.map((p) => p.url);\n  //     await InflowAPI.upsertProduct({ name, description, imageUrls });\n  //     alert(\"Sent to inFlow successfully!\");\n  //   } catch (err) {\n  //     console.error(err);\n  //     alert(\"Error sending to inFlow: \" + err.message);\n  //   }\n  // };\n\n\n  const handleSendToInflow = async () => {\n    try {\n      var _descriptions$selecte;\n\n      const name = (items.name || '').trim();\n\n      if (!name) {\n        alert('Item needs a name before sending to inFlow.');\n        return;\n      } // Regular description (don’t also send a custom “Description” unless you truly have one)\n\n\n      const description = (((_descriptions$selecte = descriptions[selectedDesc]) === null || _descriptions$selecte === void 0 ? void 0 : _descriptions$selecte.description) || '').trim(); // Photos already fetched from storage\n\n      const imageUrls = photos.map(p => p.url).filter(Boolean); // SKU = your item id\n\n      const sku = (id !== null && id !== void 0 ? id : '').toString(); // Basic normalizers\n\n      const toCSV = arr => Array.isArray(arr) ? arr.filter(Boolean).join(', ') : arr || ''; // YYYY-MM-DD for the date field in inFlow\n\n\n      const arrivalISO = items.arrival_date ? new Date(items.arrival_date).toISOString().slice(0, 10) : '';\n      const pnStr = Array.isArray(items.pn) ? items.pn.filter(Boolean).join(', ') : items.pn || '';\n      const snStr = Array.isArray(items.sn) ? items.sn.filter(Boolean).join(', ') : items.sn || ''; // Most recent WO (you already have this)\n\n      const mostRecentWO = workOrders !== null && workOrders !== void 0 && workOrders.length ? workOrders.reduce((latest, cur) => new Date(cur.date) > new Date(latest.date) ? cur : latest, workOrders[0]) : {\n        workOrder: '',\n        date: ''\n      }; // Build the numbered fields (match your inFlow “Field 1..10”)\n\n      const customFields = {\n        custom1: (oem || '').trim(),\n        // OEM   (dropdown)\n        custom2: (modality || '').trim(),\n        // Modality (dropdown)\n        custom3: (model || '').trim(),\n        // Model (dropdown)\n        custom4: (description || '').trim(),\n        // Description (text) - optional duplicate\n        custom5: (mostRecentWO.workOrder || '').trim(),\n        // Work Order (text)\n        custom6: ((selectedClientFrom === null || selectedClientFrom === void 0 ? void 0 : selectedClientFrom.name) || '').trim(),\n        // From (text)\n        custom7: pnStr,\n        // Product Number (text)\n        custom8: snStr,\n        // Serial Number (text)\n        custom9: arrivalISO,\n        // Arrival Date (date)\n        custom10: ((selectedClientCurrent === null || selectedClientCurrent === void 0 ? void 0 : selectedClientCurrent.name) || '').trim() // Current (text)\n\n      };\n      console.log('[inFlow] customFields to send (numbered):', customFields);\n      const created = await InflowAPI.upsertProduct({\n        name,\n        description,\n        sku,\n        imageUrls,\n        customFields\n      });\n      alert(`Sent to inFlow successfully. ID: ${(created === null || created === void 0 ? void 0 : created.productId) || (created === null || created === void 0 ? void 0 : created.id) || '(unknown)'}`);\n    } catch (err) {\n      console.error(err);\n      alert('Error sending to inFlow: ' + err.message);\n    }\n  }; // const [storedMachine, setStoredMachine] = useState(null);\n  // useEffect(() => {\n  //   // once any of these three change, re-merge:\n  //   if (TheMachine || selectedCurrentMachine || selectedMachine) {\n  //     const merged = updateMachineFields(\n  //       TheMachine,\n  //       selectedCurrentMachine,\n  //       selectedMachine\n  //     );\n  //     setOem(merged.oem);\n  //     setModality(merged.modality);\n  //     setModel(merged.model);\n  //   }\n  // }, [TheMachine, selectedCurrentMachine, selectedMachine]);\n  // whenever the “From” client changes:\n\n\n  useEffect(() => {\n    var _selectedClientFrom$n;\n\n    setShowLocalLocFrom((selectedClientFrom === null || selectedClientFrom === void 0 ? void 0 : (_selectedClientFrom$n = selectedClientFrom.name) === null || _selectedClientFrom$n === void 0 ? void 0 : _selectedClientFrom$n.toLowerCase()) === \"socalwarehouse\");\n  }, [selectedClientFrom]); // whenever the “Current” client changes:\n\n  useEffect(() => {\n    var _selectedClientCurren;\n\n    setShowLocalLocCurrent((selectedClientCurrent === null || selectedClientCurrent === void 0 ? void 0 : (_selectedClientCurren = selectedClientCurrent.name) === null || _selectedClientCurren === void 0 ? void 0 : _selectedClientCurren.toLowerCase()) === \"socalwarehouse\");\n  }, [selectedClientCurrent]); // Fetch clients data.\n\n  useEffect(() => {\n    async function fetchClientsData() {\n      try {\n        const clientsData = await fetchClients();\n        console.log(clientsData);\n        setClients(clientsData);\n      } catch (error) {\n        console.error(\"Error fetching clients: \", error);\n      }\n    }\n\n    fetchClientsData();\n  }, []); // Fetch PN and SN options from Firebase.\n\n  useEffect(() => {\n    async function fetchPnSn() {\n      const db = firebase.firestore();\n      const snapshot = await db.collection(\"Test\").get();\n      let pnSet = new Set();\n      let snSet = new Set();\n      snapshot.forEach(doc => {\n        const data = doc.data();\n        if (data.pn) pnSet.add(data.pn);\n        if (data.sn) snSet.add(data.sn);\n      });\n      const pnArray = [...pnSet];\n      const snArray = [...snSet];\n      setPnOptions(pnArray);\n      setSnOptions(snArray);\n    }\n\n    fetchPnSn();\n  }, []);\n  useEffect(() => {\n    if (!initialItem && idFromRouter) {\n      fetchData();\n    }\n  }, [initialItem, idFromRouter]);\n\n  async function resolveClientFromMachine(machineRef, setClient, setMachine, isFrom = true) {\n    const machineDoc = await machineRef.get();\n\n    if (machineDoc.exists) {\n      var _machineData$name;\n\n      const machineData = machineDoc.data();\n      setMachine(_objectSpread({\n        id: machineDoc.id\n      }, machineData)); // Determine if the machine is \"interior socal\"\n      // const isSocalInterior = machineData.name && machineData.name.toLowerCase() === \"interior socal\";\n      // if (isSocalInterior) {\n      //   if (isFrom) {\n      //     setShowLocalLocFrom(true);\n      //   } else {\n      //     setShowLocalLocCurrent(true);\n      //   }\n      // } else {\n      // Optionally clear the flag if it is not \"interior socal\"\n      // if (isFrom) {\n      //   setShowLocalLocFrom(false);\n      // } else {\n      //   setShowLocalLocCurrent(false);\n      // }\n      // }\n      // new: fetch client name and combine both checks\n\n      const clientDoc = machineData.client && typeof machineData.client.get === \"function\" ? await machineData.client.get() : null;\n      const clientName = clientDoc && clientDoc.exists ? clientDoc.data().name : null;\n      const isSocalInterior = ((_machineData$name = machineData.name) === null || _machineData$name === void 0 ? void 0 : _machineData$name.toLowerCase()) === \"interior socal\";\n      const shouldShow = isSocalInterior || clientName === \"SoCalWarehouse\";\n\n      if (isFrom) {\n        setShowLocalLocFrom(shouldShow);\n      } else {\n        setShowLocalLocCurrent(shouldShow);\n      }\n\n      if (machineData.client && typeof machineData.client.get === \"function\") {\n        const clientDoc = await machineData.client.get();\n\n        if (clientDoc.exists) {\n          setClient(_objectSpread({\n            id: clientDoc.id\n          }, clientDoc.data()));\n        }\n      }\n    }\n  }\n\n  const fetchData = async () => {\n    const id = (initialItem === null || initialItem === void 0 ? void 0 : initialItem.id) || idFromRouter; // <- make sure id exists here\n\n    const db = firebase.firestore();\n    const doc = await db.collection(\"Test\").doc(id).get();\n\n    if (doc.exists) {\n      var _machineFromData, _machineFromData$name, _machineCurrentData, _machineCurrentData$n, _selectedClientFrom$n2, _selectedClientCurren2;\n\n      console.log(\"test\");\n      const data = doc.data();\n      const normalizedPN = Array.isArray(data.pn) ? data.pn : [data.pn];\n      const normalizedSN = Array.isArray(data.sn) ? data.sn : [data.sn];\n      setItems(_objectSpread(_objectSpread({}, data), {}, {\n        pn: normalizedPN,\n        sn: normalizedSN\n      }));\n      setDescriptions(data.descriptions || []);\n      setWorkOrders(data.workOrders || []);\n      if (data.localLocFrom) setLocalLocFrom(data.localLocFrom);\n      if (data.localLocCurrent) setLocalLocCurrent(data.localLocCurrent);\n\n      if (data.DOM) {\n        setDOM(data.DOM);\n      } // …after you do setItems, setDescriptions, etc.\n      // load the “newLocal” maps\n\n\n      if (data.newLocalFrom) setNewLocalFrom(data.newLocalFrom);\n      if (data.newLocalCurrent) setNewLocalCurrent(data.newLocalCurrent); // Load PO Number if it exists.\n\n      if (data.poNumber) {\n        setItems(prev => _objectSpread(_objectSpread({}, prev), {}, {\n          poNumber: data.poNumber\n        }));\n      }\n\n      if (data.ClientFrom) {\n        const clientFromDoc = await data.ClientFrom.get();\n\n        if (clientFromDoc.exists) {\n          setSelectedClientFrom(_objectSpread({\n            id: clientFromDoc.id\n          }, clientFromDoc.data()));\n        }\n      }\n\n      if (data.ClientCurrent) {\n        const clientCurrentDoc = await data.ClientCurrent.get();\n\n        if (clientCurrentDoc.exists) {\n          setSelectedClientCurrent(_objectSpread({\n            id: clientCurrentDoc.id\n          }, clientCurrentDoc.data()));\n        }\n      }\n\n      if (!data.ClientFrom && data.Machine && typeof data.Machine.get === \"function\") {\n        console.log(\"Entered resolveClientFromMachine for Machine (old style for From)\");\n        await resolveClientFromMachine(data.Machine, setSelectedClientFrom, setSelectedMachine, true);\n      }\n\n      if (!data.ClientCurrent && data.CurrentMachine && typeof data.CurrentMachine.get === \"function\") {\n        console.log(\"Entered resolveClientFromMachine for CurrentMachine (old style for Current)\");\n        await resolveClientFromMachine(data.CurrentMachine, setSelectedClientCurrent, setSelectedCurrentMachine, false);\n      }\n\n      let machineFromData = null;\n      let machineCurrentData = null;\n\n      if (data.MachineFrom) {\n        const doc = await data.MachineFrom.get();\n        machineFromData = doc.exists ? doc.data() : null;\n        setSelectedMachine(_objectSpread({\n          id: doc.id\n        }, doc.data()));\n      }\n\n      if (data.MachineCurrent) {\n        const doc = await data.MachineCurrent.get();\n        machineCurrentData = doc.exists ? doc.data() : null;\n        setSelectedCurrentMachine(_objectSpread({\n          id: doc.id\n        }, doc.data()));\n      }\n\n      const nameFrom = (_machineFromData = machineFromData) === null || _machineFromData === void 0 ? void 0 : (_machineFromData$name = _machineFromData.name) === null || _machineFromData$name === void 0 ? void 0 : _machineFromData$name.toLowerCase();\n      const nameCurrent = (_machineCurrentData = machineCurrentData) === null || _machineCurrentData === void 0 ? void 0 : (_machineCurrentData$n = _machineCurrentData.name) === null || _machineCurrentData$n === void 0 ? void 0 : _machineCurrentData$n.toLowerCase(); // If the machine’s name is “interior socal”, show that branch:\n      // setShowLocalLocFrom(nameFrom === \"interior socal\");\n      // // Or if your Firestore already has a value for localLocFrom, show it anyway:\n      // if (data.localLocFrom) setShowLocalLocFrom(true);\n      // setShowLocalLocCurrent(nameCurrent === \"interior socal\");\n      // if (data.localLocCurrent) setShowLocalLocCurrent(true);\n      // new: combine machine-name OR client-name check, keep existing-data\n\n      setShowLocalLocFrom(nameFrom === \"interior socal\" || (selectedClientFrom === null || selectedClientFrom === void 0 ? void 0 : (_selectedClientFrom$n2 = selectedClientFrom.name) === null || _selectedClientFrom$n2 === void 0 ? void 0 : _selectedClientFrom$n2.toLowerCase()) === \"socalwarehouse\" || Boolean(data.localLocFrom));\n      setShowLocalLocCurrent(nameCurrent === \"interior socal\" || (selectedClientCurrent === null || selectedClientCurrent === void 0 ? void 0 : (_selectedClientCurren2 = selectedClientCurrent.name) === null || _selectedClientCurren2 === void 0 ? void 0 : _selectedClientCurren2.toLowerCase()) === \"socalwarehouse\" || Boolean(data.localLocCurrent));\n      const theMachineData = data.TheMachine || null;\n      setTheMachine(theMachineData);\n\n      if (theMachineData) {\n        var _theMachineData$oem, _theMachineData$modal, _theMachineData$model;\n\n        // pull both variants, prefer lowercase if it exists\n        const OEM = (_theMachineData$oem = theMachineData.oem) !== null && _theMachineData$oem !== void 0 ? _theMachineData$oem : theMachineData.OEM;\n        const Modality = (_theMachineData$modal = theMachineData.modality) !== null && _theMachineData$modal !== void 0 ? _theMachineData$modal : theMachineData.Modality;\n        const Model = (_theMachineData$model = theMachineData.model) !== null && _theMachineData$model !== void 0 ? _theMachineData$model : theMachineData.Model;\n        setTheMachine(_objectSpread(_objectSpread({}, theMachineData), {}, {\n          OEM,\n          Modality,\n          Model\n        }));\n      } // setStoredMachine(theMachineData);\n      // **right here** merge from the three sources you just fetched:\n\n\n      const merged = updateMachineFields(theMachineData, machineCurrentData, machineFromData);\n      setOem(merged.oem);\n      setModality(merged.modality);\n      setModel(merged.model);\n      console.log(\"SelectedMachine:\", selectedMachine, \"SelectedCurrentMachine:\", selectedCurrentMachine); // Show local loc inputs if applicable\n      // if (\n      //   selectedMachine &&\n      //   selectedMachine.name &&\n      //   selectedMachine.name.toLowerCase() === \"interior socal\"\n      // ) {\n      //   setShowLocalLocFrom(true);\n      // }\n      // if (\n      //   selectedCurrentMachine &&\n      //   selectedCurrentMachine.name &&\n      //   selectedCurrentMachine.name.toLowerCase() === \"interior socal\"\n      // ) {\n      //   setShowLocalLocCurrent(true);\n      // }\n\n      if (data.Parent) {\n        const parentDoc = await data.Parent.get();\n        setSelectedParent(_objectSpread({\n          id: parentDoc.id\n        }, parentDoc.data()));\n      } // Priority auto‑population of machine fields.\n      // const updatedFields = updateMachineFields(storedMachine, selectedCurrentMachine, selectedMachine);\n      // // console.log(\"Updated machine fields:\", updatedFields);\n      // setOem(updatedFields.oem);\n      // setModality(updatedFields.modality);\n      // setModel(updatedFields.model);\n\n\n      await fetchPhotos(id);\n      await checkIfAddedToWebsite(id);\n      await calculateItemFrequencyAndUsage(data.pn);\n    } else {\n      router.push({\n        pathname: \"../AddItem/NewItem\",\n        query: {\n          signal: id\n        }\n      });\n    }\n  }; // Returns the value for a given field from the highest-priority source.\n\n\n  function getPriorityMachineField(field, theMachine, currentMachine, fromMachine) {\n    console.log(\"the machine: \", theMachine, \"field: \", field);\n\n    if (theMachine && theMachine[field] && theMachine[field] !== \"N/A\" && theMachine[field].trim() !== \"\") {\n      return theMachine[field];\n    }\n\n    if (currentMachine && currentMachine[field] && currentMachine[field] !== \"N/A\" && currentMachine[field].trim() !== \"\") {\n      return currentMachine[field];\n    }\n\n    if (fromMachine && fromMachine[field] && fromMachine[field] !== \"N/A\" && fromMachine[field].trim() !== \"\") {\n      return fromMachine[field];\n    }\n\n    return \"\";\n  } // Returns an object with updated OEM, modality, and model fields.\n\n\n  function updateMachineFields(theMachine, currentMachine, fromMachine) {\n    return {\n      oem: getPriorityMachineField(\"OEM\", theMachine, currentMachine, fromMachine),\n      modality: getPriorityMachineField(\"Modality\", theMachine, currentMachine, fromMachine),\n      model: getPriorityMachineField(\"Model\", theMachine, currentMachine, fromMachine)\n    };\n  }\n\n  const calculateItemFrequencyAndUsage = async pn => {\n    const db = firebase.firestore();\n    const currentDate = new Date();\n    const oneYearAgo = new Date();\n    oneYearAgo.setFullYear(currentDate.getFullYear() - 1);\n    const normalizedPN = pn !== undefined ? pn : \"\";\n    const itemsSnapshot = await db.collection(\"Test\").where(\"pn\", \"==\", normalizedPN).get();\n    setFreqItem(itemsSnapshot.size);\n    let usagePastYear = 0;\n    itemsSnapshot.forEach(doc => {\n      const itemData = doc.data();\n      itemData.workOrders.forEach(workOrder => {\n        const workOrderDate = new Date(workOrder.date);\n\n        if (workOrderDate >= oneYearAgo && workOrderDate <= currentDate) {\n          usagePastYear++;\n        }\n      });\n    });\n    setUsagePastYear(usagePastYear);\n  };\n\n  const fetchMachine = async machineId => {\n    const db = firebase.firestore();\n    const doc = await db.collection(\"Machine\").doc(machineId).get();\n\n    if (doc.exists) {\n      const machineData = doc.data();\n      setTheMachine(machineData); // re-merge all three sources with correct priority:\n\n      const merged = updateMachineFields(machineData, selectedCurrentMachine, selectedMachine);\n      setOem(merged.oem);\n      setModality(merged.modality);\n      setModel(merged.model);\n      const machinesSnapshot = await db.collection(\"Machine\").where(\"Model\", \"==\", machineData.Model || machineData.model).get();\n      setMachineFrequency(machinesSnapshot.size);\n    } else {\n      console.error(\"Machine not found\");\n    }\n  };\n\n  const fetchPhotos = async docID => {\n    const storageRef = firebase.storage().ref();\n    const listRef = storageRef.child(`Parts/${docID}`);\n\n    try {\n      const res = await listRef.listAll();\n      const urls = await Promise.all(res.items.map(item => item.getDownloadURL()));\n      console.log(\"Fetched photo URLs:\", urls);\n      setPhotos(urls.map(url => ({\n        url,\n        file: null\n      })));\n    } catch (error) {\n      console.error(\"Error fetching photos: \", error);\n    }\n  };\n\n  const checkIfAddedToWebsite = async docID => {\n    const db = firebase.firestore();\n    const partsDoc = await db.collection(\"Parts\").doc(docID).get();\n\n    if (partsDoc.exists) {\n      setAddToWebsite(true);\n    }\n  };\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true);\n\n  const handleCloseErr = () => setShowErr(false);\n\n  const handleShowErr = () => setShowErr(true);\n\n  const handleCloseSaveModal = () => setShowSaveModal(false);\n\n  const handleClosePrintModal = () => setShowPrintModal(false);\n\n  const handleShowSaveModal = () => setShowSaveModal(true);\n\n  const handleShowPrintModal = () => setShowPrintModal(true);\n\n  const handleMachineSelectionModal = () => setMachineSelectionModal(false);\n\n  const handleCloseDescModal = () => setShowDescModal(false);\n\n  const handleShowDescModal = () => setShowDescModal(true);\n\n  const handleCloseWoModal = () => setShowWoModal(false);\n\n  const handleShowWoModal = () => setShowWoModal(true);\n\n  const handleCloseClientModal = () => setShowClientModal(false);\n\n  const handleShowClientModal = () => setShowClientModal(true);\n\n  const handleCloseMachineModal = () => setShowMachineModal(false);\n\n  const handleShowMachineModal = () => {\n    setShowMachineModal(true);\n    setShowClientModal(false);\n  };\n\n  const handleCloseParentModal = () => setShowParentModal(false);\n\n  const handleShowParentModal = () => setShowParentModal(true); // When a client is selected from the client table.\n\n\n  const handleClientInfo = async clientId => {\n    // Clear any previously selected machine and local loc info for this branch.\n    if (machinePick) {\n      setSelectedMachine(null);\n      setShowLocalLocFrom(false);\n    } else {\n      setSelectedCurrentMachine(null);\n      setShowLocalLocCurrent(false);\n    }\n\n    const db = firebase.firestore();\n    const clientDoc = await db.collection(\"Client\").doc(clientId).get();\n\n    if (clientDoc.exists) {\n      const clientData = _objectSpread({\n        id: clientDoc.id\n      }, clientDoc.data());\n\n      if (machinePick) {\n        setSelectedClientFrom(clientData);\n      } else {\n        setSelectedClientCurrent(clientData);\n      } // after setting selectedClientFrom/Current:\n\n\n      if (clientData.name === \"SoCalWarehouse\") {\n        if (machinePick) setShowLocalLocFrom(true);else setShowLocalLocCurrent(true);\n      } // Fetch machines for this client:\n\n\n      const machinePromises = clientData.machines.map(machineRef => machineRef.get());\n      const machineDocs = await Promise.all(machinePromises);\n      const machines = machineDocs.map(machineDoc => _objectSpread({\n        id: machineDoc.id\n      }, machineDoc.data()));\n      setMachineOptions(machines); // Close the client modal\n\n      handleCloseClientModal();\n    }\n  }; // Reordering function for dropdowns.\n\n\n  const reorderArray = (arr, selectedValue) => {\n    const newArr = arr.filter(val => val !== selectedValue);\n    return [selectedValue, ...newArr];\n  };\n\n  const {\n    0: addingNewPn,\n    1: setAddingNewPn\n  } = useState(false);\n  const {\n    0: newPn,\n    1: setNewPn\n  } = useState(\"\");\n  const {\n    0: addingNewSn,\n    1: setAddingNewSn\n  } = useState(false);\n  const {\n    0: newSn,\n    1: setNewSn\n  } = useState(\"\");\n\n  const handlePnSelect = e => {\n    const selected = e.target.value;\n    setItems(prev => {\n      let updatedPn = Array.isArray(prev.pn) ? [...prev.pn] : [];\n      updatedPn[0] = selected;\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        pn: updatedPn\n      });\n    });\n  };\n\n  const handleSnSelect = e => {\n    const selected = e.target.value;\n    setItems(prev => {\n      let updatedSn = Array.isArray(prev.sn) ? [...prev.sn] : [];\n      updatedSn[0] = selected;\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        sn: updatedSn\n      });\n    });\n  };\n\n  const handleAddNewPn = () => {\n    if (newPn.trim() !== \"\") {\n      setItems(prev => _objectSpread(_objectSpread({}, prev), {}, {\n        pn: [...prev.pn, newPn.trim()]\n      }));\n    }\n\n    setNewPn(\"\");\n    setAddingNewPn(false);\n  };\n\n  const handleAddNewSn = () => {\n    if (newSn.trim() !== \"\") {\n      setItems(prev => _objectSpread(_objectSpread({}, prev), {}, {\n        sn: [...prev.sn, newSn.trim()]\n      }));\n    }\n\n    setNewSn(\"\");\n    setAddingNewSn(false);\n  }; // Generate custom document ID if needed.\n\n\n  const generateCustomID = () => {\n    const randomNum = Math.floor(10000 + Math.random() * 90000);\n    return `AIS${randomNum}`;\n  };\n\n  function shallowClean(obj) {\n    const newObj = {};\n\n    for (const key in obj) {\n      console.log(key, obj[key]);\n\n      if (obj.hasOwnProperty(key)) {\n        newObj[key] = obj[key] === undefined ? \"\" : obj[key];\n      }\n    }\n\n    return newObj;\n  }\n\n  async function toSend() {\n    var _fromDetails$section, _fromDetails$section2, _currentDetails$secti, _currentDetails$secti2;\n\n    const db = firebase.firestore();\n    const currentUser = firebase.auth().currentUser;\n    const userEmail = currentUser ? currentUser.email : \"unknown\"; // Always use the current state values for OEM, modality, and model.\n\n    const machineData = _objectSpread(_objectSpread({}, TheMachine || {}), {}, {\n      oem: oem,\n      modality: modality,\n      model: model\n    });\n\n    const formattedItems = _objectSpread(_objectSpread({}, items), {}, {\n      descriptions,\n      workOrders\n    }); // Remove any unused fields.\n\n\n    formattedItems.status = items.status || \"\";\n    formattedItems.DOM = DOM; // Date of Manufacture\n\n    formattedItems.localLocFrom = localLocFrom || \"\";\n    formattedItems.localLocCurrent = localLocCurrent || \"\";\n    formattedItems.date = items.date || \"\";\n    formattedItems.arrival_date = items.arrival_date || \"\"; // NEW: Arrival Date\n\n    formattedItems.poNumber = items.poNumber || \"\";\n    formattedItems.trackingNumber = items.trackingNumber || \"\";\n    formattedItems.TheMachine = machineData || {};\n    formattedItems.addedToWebsite = addToWebsite; // NEW: Add the user's email under the field \"user\"\n\n    formattedItems.lastEdited = userEmail; // Clean pn and sn arrays to replace undefined values with an empty string.\n\n    formattedItems.pn = (items.pn || []).map(value => value === undefined ? \"\" : value);\n    formattedItems.sn = (items.sn || []).map(value => value === undefined ? \"\" : value);\n    const fromDetails = buildLocalLocObject(newLocalFrom);\n    const currentDetails = buildLocalLocObject(newLocalCurrent);\n    console.log(\"From Details: \" + fromDetails.region + \" \" + ((_fromDetails$section = fromDetails.section) === null || _fromDetails$section === void 0 ? void 0 : _fromDetails$section.letter) + ((_fromDetails$section2 = fromDetails.section) === null || _fromDetails$section2 === void 0 ? void 0 : _fromDetails$section2.number) + \" \" + fromDetails.bin + \" \" + fromDetails.pallet);\n    console.log(\"Current Details: \" + currentDetails.region + \" \" + ((_currentDetails$secti = currentDetails.section) === null || _currentDetails$secti === void 0 ? void 0 : _currentDetails$secti.letter) + ((_currentDetails$secti2 = currentDetails.section) === null || _currentDetails$secti2 === void 0 ? void 0 : _currentDetails$secti2.number) + \" \" + currentDetails.bin + \" \" + currentDetails.pallet);\n\n    if (Object.keys(fromDetails).length) {\n      formattedItems.newLocalFrom = fromDetails;\n      formattedItems.localLocFrom = formatLoc(newLocalFrom) || \"\";\n    } else {\n      // all fields empty — force an empty string and remove any stray map\n      console.log(\"entered empty fromDetails else\");\n      formattedItems.localLocFrom = \"\";\n      formattedItems.newLocalFrom = {};\n    }\n\n    if (Object.keys(currentDetails).length) {\n      formattedItems.newLocalCurrent = currentDetails;\n      formattedItems.localLocCurrent = formatLoc(newLocalCurrent) || \"\";\n    } else {\n      // all fields empty — force an empty string and remove any stray map\n      formattedItems.localLocCurrent = \"\";\n      formattedItems.newLocalCurrent = {};\n    }\n\n    if (selectedMachine && selectedMachine.id) {\n      formattedItems.MachineFrom = db.collection(\"Machine\").doc(selectedMachine.id);\n    }\n\n    if (selectedCurrentMachine && selectedCurrentMachine.id) {\n      formattedItems.MachineCurrent = db.collection(\"Machine\").doc(selectedCurrentMachine.id);\n    }\n\n    if (selectedParent && selectedParent.id) {\n      formattedItems.Parent = db.collection(\"Test\").doc(selectedParent.id);\n    } // NEW: Set separate client references.\n\n\n    if (selectedClientFrom && selectedClientFrom.id) {\n      formattedItems.ClientFrom = db.collection(\"Client\").doc(selectedClientFrom.id);\n    }\n\n    if (selectedClientCurrent && selectedClientCurrent.id) {\n      formattedItems.ClientCurrent = db.collection(\"Client\").doc(selectedClientCurrent.id);\n    } // Only attach the richer “newLocal” map when the user actually filled something in\n\n\n    if (Object.keys(fromDetails).length) {\n      formattedItems.newLocalFrom = fromDetails;\n    }\n\n    if (Object.keys(currentDetails).length) {\n      formattedItems.newLocalCurrent = currentDetails;\n    }\n\n    let docId = id;\n\n    try {\n      if (docId) {\n        // Check if a localSN is provided and if it differs from the current docId.\n        const newDocId = items.localSN && items.localSN.trim() !== \"\" ? items.localSN.trim() : docId;\n\n        if (docId !== newDocId) {\n          // Migrate: Create a new document with the newDocId.\n          await db.collection(\"Test\").doc(newDocId).set(formattedItems);\n\n          if (selectedMachine && selectedMachine.id) {\n            const machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\n            const machineDoc = await machineRef.get();\n\n            if (machineDoc.exists) {\n              await machineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(newDocId))\n              });\n            }\n          }\n\n          if (selectedCurrentMachine && selectedCurrentMachine.id) {\n            const currentMachineRef = db.collection(\"Machine\").doc(selectedCurrentMachine.id);\n            const currentMachineDoc = await currentMachineRef.get();\n\n            if (currentMachineDoc.exists) {\n              await currentMachineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(newDocId))\n              });\n            }\n          } // Delete the old document.\n\n\n          await db.collection(\"Test\").doc(docId).delete(); // Set docId to the new document ID.\n\n          docId = newDocId;\n        } else {\n          // Deep-clean the formattedItems to remove any undefined nested values.\n          const cleanFormattedItems = shallowClean(formattedItems);\n          await db.collection(\"Test\").doc(docId).update(cleanFormattedItems);\n\n          if (selectedMachine && selectedMachine.id) {\n            const machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\n            const machineDoc = await machineRef.get();\n\n            if (machineDoc.exists) {\n              await machineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(docId))\n              });\n            }\n          }\n\n          if (selectedCurrentMachine && selectedCurrentMachine.id) {\n            const currentMachineRef = db.collection(\"Machine\").doc(selectedCurrentMachine.id);\n            const currentMachineDoc = await currentMachineRef.get();\n\n            if (currentMachineDoc.exists) {\n              await currentMachineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(docId))\n              });\n            }\n          }\n        }\n      } else {\n        // For a new item, if localSN is provided, use it; otherwise, generate a custom ID.\n        docId = items.localSN && items.localSN.trim() !== \"\" ? items.localSN.trim() : generateCustomID();\n        await db.collection(\"Test\").doc(docId).set(formattedItems);\n\n        if (selectedMachine && selectedMachine.id) {\n          const machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\n          const machineDoc = await machineRef.get();\n\n          if (machineDoc.exists) {\n            await machineRef.update({\n              associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(docId))\n            });\n          }\n        }\n\n        if (selectedCurrentMachine && selectedCurrentMachine.id) {\n          const currentMachineRef = db.collection(\"Machine\").doc(selectedCurrentMachine.id);\n          const currentMachineDoc = await currentMachineRef.get();\n\n          if (currentMachineDoc.exists) {\n            await currentMachineRef.update({\n              associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(docId))\n            });\n          }\n        }\n      } // Upload any new photos to Firebase Storage.\n\n\n      await uploadPhotos(docId);\n      console.log(\"Item saved and associatedParts updated!\"); // Redirect to the new URL using the new document id.\n\n      router.push(`/NewSearch/item/${docId}`); // Optionally, you can also show a save confirmation modal:\n\n      handleShowSaveModal();\n    } catch (error) {\n      console.error(\"Error saving data:\", error);\n    }\n  } // Additional state for local warehouse location inputs.\n\n\n  const {\n    0: showLocalLocFrom,\n    1: setShowLocalLocFrom\n  } = useState(false);\n  const {\n    0: showLocalLocCurrent,\n    1: setShowLocalLocCurrent\n  } = useState(false); // When a machine is selected from the modal.\n\n  const handleSetSelectedMachine = machine => {\n    var _machine$name;\n\n    // const condition = (name) => name && name.toLowerCase() === \"interior socal\";\n    const isSocalInterior = ((_machine$name = machine.name) === null || _machine$name === void 0 ? void 0 : _machine$name.toLowerCase()) === \"interior socal\";\n\n    if (machinePick) {\n      var _selectedClientFrom$n3;\n\n      setSelectedMachine({\n        id: machine.id,\n        name: machine.name\n      });\n      setShowLocalLocFrom(isSocalInterior || (selectedClientFrom === null || selectedClientFrom === void 0 ? void 0 : (_selectedClientFrom$n3 = selectedClientFrom.name) === null || _selectedClientFrom$n3 === void 0 ? void 0 : _selectedClientFrom$n3.toLowerCase()) === \"socalwarehouse\");\n    } else {\n      var _selectedClientCurren3;\n\n      setSelectedCurrentMachine({\n        id: machine.id,\n        name: machine.name\n      });\n      setShowLocalLocCurrent(isSocalInterior || (selectedClientCurrent === null || selectedClientCurrent === void 0 ? void 0 : (_selectedClientCurren3 = selectedClientCurrent.name) === null || _selectedClientCurren3 === void 0 ? void 0 : _selectedClientCurren3.toLowerCase()) === \"socalwarehouse\");\n    }\n\n    fetchMachine(machine.id); // Close the machine modal (assuming you're using showMachineModal to control it)\n\n    setShowMachineModal(false);\n  };\n\n  const uploadPhotos = async docID => {\n    const storageRef = firebase.storage().ref();\n\n    for (let i = 0; i < photos.length; i++) {\n      if (photos[i].file) {\n        const photoRef = storageRef.child(`Parts/${docID}/${docID}${i === 0 ? \".jpg\" : `.${i + 1}.jpg`}`);\n        const metadata = {\n          contentType: \"image/png\"\n        };\n        await photoRef.put(photos[i].file, metadata);\n        const url = await photoRef.getDownloadURL();\n        photos[i].url = url;\n      }\n    }\n  }; // Function to handle printing the label.\n\n\n  const handlePrint = async () => {\n    if (!items.name) {\n      alert(\"Missing name\");\n      return;\n    }\n\n    let clientName = \"\"; // Attempt to fetch client name from the Machine document reference.\n\n    if (items.Machine && typeof items.Machine.get === \"function\") {\n      try {\n        const machineDoc = await items.Machine.get();\n\n        if (machineDoc.exists) {\n          const machineData = machineDoc.data();\n\n          if (machineData.client && typeof machineData.client.get === \"function\") {\n            const clientDoc = await machineData.client.get();\n\n            if (clientDoc.exists) {\n              clientName = clientDoc.data().name || \"\";\n            }\n          }\n        }\n      } catch (error) {\n        console.error(\"Error fetching machine or client:\", error);\n      }\n    } else {\n      console.warn(\"No Machine reference available in the item\");\n    }\n\n    console.log(clientName, \":\", items.client); // Fallback: if no client name was found, check items.client.\n\n    if (!clientName && items.client) {\n      if (typeof items.client.get === \"function\") {\n        try {\n          const clientDoc = await items.client.get();\n\n          if (clientDoc.exists) {\n            clientName = clientDoc.data().name || \"\";\n          }\n        } catch (error) {\n          console.error(\"Error fetching client from items.client:\", error);\n        }\n      } else {\n        clientName = items.client;\n      }\n    }\n\n    console.log(\"descriptions:\", descriptions[selectedDesc]);\n    const payload = {\n      name: items.name,\n      pn: items.pn,\n      sn: items.sn,\n      wo: workOrders && workOrders.length > 0 ? workOrders[0].workOrder : \"\",\n      client: clientName,\n      status: items.status,\n      local_sn: id,\n      descriptions: [descriptions[selectedDesc] || {\n        description: \"\",\n        date: \"\"\n      }],\n      date: items.dateCreated || \"\",\n      DOM: DOM,\n      oem: oem,\n      modality: modality,\n      model: model,\n      poNumber: items.poNumber,\n      arrival_date: items.arrival_date // NEW: Include arrival_date\n\n    };\n    console.log(\"Payload for printing:\", payload);\n\n    try {\n      const response = await fetch(\"https://9d70-174-76-22-138.ngrok-free.app/print-label\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(payload)\n      });\n      const result = await response.json();\n      console.log(\"Print result:\", result.status);\n\n      if (result.status.includes(\"successfully.\")) {\n        handleShowPrintModal();\n      } else {\n        console.error(\"Error printing label:\", result.error);\n      }\n    } catch (error) {\n      console.error(\"Error printing label:\", error);\n    }\n  };\n\n  async function handleSubmit(event) {\n    event.preventDefault(); // Only check that the Name field is filled out.\n\n    if (!items.name) {\n      handleShow(); // This shows the \"missing field\" modal.\n    } else {\n      toSend();\n    }\n  } // Handlers for input changes.\n\n\n  const handleChange = field => event => {\n    const value = event.target ? event.target.value : event.value;\n    setItems(prevItems => _objectSpread(_objectSpread({}, prevItems), {}, {\n      [field]: value\n    }));\n  };\n\n  const addDescription = () => {\n    setDescriptions([...descriptions, {\n      description: \"\",\n      date: \"\"\n    }]);\n  };\n\n  const removeDescription = index => {\n    setDescriptions(descriptions.filter((_, i) => i !== index));\n  };\n\n  const handleDescriptionChange = (index, field, value) => {\n    const newDescriptions = descriptions.map((desc, i) => i === index ? _objectSpread(_objectSpread({}, desc), {}, {\n      [field]: value\n    }) : desc);\n    setDescriptions(newDescriptions);\n  };\n\n  const addWorkOrder = () => {\n    setWorkOrders([...workOrders, {\n      workOrder: \"\",\n      date: \"\"\n    }]);\n  };\n\n  const removeWorkOrder = index => {\n    setWorkOrders(workOrders.filter((_, i) => i !== index));\n  };\n\n  const handleWorkOrderChange = (index, field, value) => {\n    const newWorkOrders = workOrders.map((wo, i) => i === index ? _objectSpread(_objectSpread({}, wo), {}, {\n      [field]: value\n    }) : wo);\n    setWorkOrders(newWorkOrders);\n  };\n\n  const listDescriptions = () => {\n    setShowDescModal(true);\n  };\n\n  const selectDescription = index => {\n    setSelectedDesc(index);\n    setShowDescModal(false);\n  };\n\n  const handleShowCameraModal = () => {\n    setShowCameraModal(true);\n  };\n\n  const handleCloseCameraModal = () => {\n    setShowCameraModal(false);\n    setCapturedPhoto(null);\n  };\n\n  const handleCapture = (err, result) => {\n    if (result) {\n      setCapturedPhoto(result);\n    }\n  };\n\n  const savePhoto = () => {\n    setPhotos(prevPhotos => [...prevPhotos, {\n      file: capturedPhoto,\n      url: URL.createObjectURL(capturedPhoto)\n    }]);\n    setCapturedPhoto(null);\n    handleCloseCameraModal();\n  };\n\n  const removePhoto = index => {\n    setPhotos(photos.filter((_, i) => i !== index));\n  };\n\n  const mostRecentWorkOrder = workOrders && workOrders.length > 0 ? workOrders.reduce((latest, current) => {\n    const latestDate = new Date(latest.date);\n    const currentDate = new Date(current.date);\n    return currentDate > latestDate ? current : latest;\n  }, workOrders[0]) : {};\n\n  const capturePhoto = () => {\n    const video = document.querySelector(\"video\");\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const context = canvas.getContext(\"2d\");\n    context.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(blob => {\n      setCapturedPhoto(blob);\n    }, \"image/png\");\n  };\n\n  const handleShowInfoModal = async () => {\n    const db = firebase.firestore();\n\n    try {\n      const doc = await db.collection(\"Test\").doc(id).get();\n\n      if (doc.exists) {\n        const data = doc.data();\n        setItemName(data.name || \"N/A\");\n        setShowInfoModal(true);\n      } else {\n        console.error(\"Item not found\");\n      }\n    } catch (error) {\n      console.error(\"Error fetching item info:\", error);\n    }\n  };\n\n  const handleCloseInfoModal = () => setShowInfoModal(false);\n\n  const handlePnChange = (index, value) => {\n    setItems(prev => {\n      const newPn = [...prev.pn];\n      newPn[index] = value;\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        pn: newPn\n      });\n    });\n  };\n\n  const addPn = () => {\n    setItems(prev => _objectSpread(_objectSpread({}, prev), {}, {\n      pn: [...prev.pn, \"\"]\n    }));\n  };\n\n  const handleSnChange = (index, value) => {\n    setItems(prev => {\n      const newSn = [...prev.sn];\n      newSn[index] = value;\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        sn: newSn\n      });\n    });\n  };\n\n  const addSn = () => {\n    setItems(prev => _objectSpread(_objectSpread({}, prev), {}, {\n      sn: [...prev.sn, \"\"]\n    }));\n  };\n\n  const browseInputRef = useRef(null);\n\n  const handleBrowsePhotos = () => {\n    if (browseInputRef.current) {\n      browseInputRef.current.click();\n    }\n  };\n\n  const handleFilesSelected = e => {\n    const files = e.target.files;\n\n    if (files.length) {\n      const newPhotos = [];\n\n      for (let i = 0; i < files.length; i++) {\n        newPhotos.push({\n          file: files[i],\n          url: URL.createObjectURL(files[i])\n        });\n      }\n\n      setPhotos(prevPhotos => [...prevPhotos, ...newPhotos]);\n    }\n\n    e.target.value = \"\";\n  };\n\n  const {\n    0: currentPnIndex,\n    1: setCurrentPnIndex\n  } = useState(0);\n  const {\n    0: showDropdown,\n    1: setShowDropdown\n  } = useState(false);\n  const {\n    0: currentSnIndex,\n    1: setCurrentSnIndex\n  } = useState(0);\n  const {\n    0: showSnDropdown,\n    1: setShowSnDropdown\n  } = useState(false);\n\n  const handleAddNewClient = () => {\n    const randomNum = Math.floor(10000 + Math.random() * 90000);\n    router.push(`../client/AIS${randomNum}/addClient?from=item&itemId=${id || \"\"}`);\n  };\n\n  const handleBluefolderButton = async () => {\n    var _descriptions$selecte2;\n\n    // Check that the work order field is filled out (using workOrders[0].workOrder as current)\n    const currentWorkOrder = workOrders && workOrders.length > 0 ? workOrders[0].workOrder : \"\";\n\n    if (!currentWorkOrder) {\n      alert(\"Please fill out the work order field before adding to BlueFolder.\");\n      return;\n    } // Build the payload to send to your proxy endpoint.\n\n\n    const payload = {\n      name: items.name,\n      pn: items.pn[0] || \"\",\n      sn: items.sn[0] || \"\",\n      status: items.status,\n      description: ((_descriptions$selecte2 = descriptions[selectedDesc]) === null || _descriptions$selecte2 === void 0 ? void 0 : _descriptions$selecte2.description) || \"\",\n      workOrder: currentWorkOrder,\n      localsn: items.localSN || \"\"\n    };\n\n    try {\n      // Replace with your ngrok URL and appropriate endpoint path (e.g., /api/bluefolder)\n      const response = await fetch(\"https://9d70-174-76-22-138.ngrok-free.app/bluefolder\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(payload)\n      });\n      const result = await response.json();\n      alert(\"BlueFolder service item added successfully!\");\n      console.log(\"BlueFolder result:\", result);\n    } catch (error) {\n      console.error(\"BlueFolder error:\", error);\n      alert(\"Error adding data to BlueFolder.\");\n    }\n  }; // // Slack integration handler.\n  // const handleAddToSlack = async (which) => {\n  //   try {\n  //     const pn0 = Array.isArray(items.pn) ? items.pn[0] : items.pn;\n  //     const sn0 = Array.isArray(items.sn) ? items.sn[0] : items.sn;\n  //     const linkUrl = typeof window !== \"undefined\" ? window.location.href : \"\";\n  //     const safeName = (items?.name || id || \"Untitled\").trim();\n  //     const title = `${safeName}${id ? ` (${id})` : \"\"}`;\n  //     console.log(\"[SLACK][handleAddToSlack] which:\", which);\n  //     console.log(\"[SLACK] title:\", title);\n  //     console.log(\"[SLACK] PN:\", items.pn, \"SN:\", items.sn);\n  //     const resp = await fetch(\"/api/slack/add-to-list\", {\n  //       method: \"POST\",\n  //       headers: { \"Content-Type\": \"application/json\" },\n  //       body: JSON.stringify({\n  //         listKey: which,      // \"shipping\" | \"receiving\" | \"tasks\"\n  //         title,\n  //         pn: items.pn,\n  //         sn: items.sn,\n  //         // keeping it minimal by design while we stabilize PN/SN\n  //         linkUrl,\n  //       }),\n  //     });\n  // Slack integration handler (drop-in replacement)\n  // Slack integration handler (drop-in replacement)\n  // Add this to your item page component scope\n  // Assumes you already have: items, workOrders, descriptions, selectedDesc, id (item doc id)\n\n\n  const handleAddToSlack = async (which = \"shipping\") => {\n    try {\n      var _ref8, _items$tracking;\n\n      // Prefer arrays’ first element if pn/sn are arrays in your data\n      const pn0 = Array.isArray(items === null || items === void 0 ? void 0 : items.pn) ? items.pn[0] : items === null || items === void 0 ? void 0 : items.pn;\n      const sn0 = Array.isArray(items === null || items === void 0 ? void 0 : items.sn) ? items.sn[0] : items === null || items === void 0 ? void 0 : items.sn; // Current page URL for quick jump-back from Slack\n\n      const linkUrl = false ? window.location.href : \"\"; // Title: keep your working pattern (Name plus ID when present)\n\n      const safeName = ((items === null || items === void 0 ? void 0 : items.name) || id || \"Untitled\").trim();\n      const title = `${safeName}${id ? ` (${id})` : \"\"}`; // Most recent work order (by date) from your existing state\n\n      const mostRecentWO = workOrders && workOrders.length > 0 ? workOrders.reduce((latest, cur) => new Date((cur === null || cur === void 0 ? void 0 : cur.date) || 0) > new Date((latest === null || latest === void 0 ? void 0 : latest.date) || 0) ? cur : latest, workOrders[0]) : {\n        workOrder: \"\"\n      }; // Description from the currently selected description row\n\n      const descVal = selectedDesc != null && descriptions !== null && descriptions !== void 0 && descriptions[selectedDesc] ? descriptions[selectedDesc].description || \"\" : \"\"; // Shipping date mapping: arrival_date first, fall back to date\n\n      const shippingDate = (items === null || items === void 0 ? void 0 : items.arrival_date) || (items === null || items === void 0 ? void 0 : items.date) || \"\"; // Tracking: support either items.tracking or items.trackingNumber\n\n      const tracking = (_ref8 = (_items$tracking = items === null || items === void 0 ? void 0 : items.tracking) !== null && _items$tracking !== void 0 ? _items$tracking : items === null || items === void 0 ? void 0 : items.trackingNumber) !== null && _ref8 !== void 0 ? _ref8 : \"\"; // Local SN is your item ID\n\n      const localSN = id || \"\"; // Build payload — keep what already works, add the rest\n\n      const body = {\n        listKey: which,\n        // \"shipping\" | \"receiving\" | \"tasks\"\n        title,\n        // working\n        pn: pn0,\n        // working\n        sn: sn0,\n        // working\n        linkUrl,\n        // optional link column if you have one\n        // NEW fields for the remaining columns (server auto-detects columns):\n        shippingDate,\n        // Shipping Date column\n        tracking,\n        // Tracking / WDIM column\n        workOrder: (mostRecentWO === null || mostRecentWO === void 0 ? void 0 : mostRecentWO.workOrder) || \"\",\n        // WO/SO Number column\n        localSN,\n        // Local SN column\n        description: (descVal || \"\").trim() // Description column\n        // Parties logic: leave untouched (your server keeps it as-is if you already send it elsewhere)\n        // photoUrls: [] // optional — only if you want to dump image links as text\n\n      };\n      const resp = await fetch(\"/api/slack/add-to-list\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(body)\n      });\n      const json = await resp.json();\n      console.log(\"[SLACK][handleAddToSlack] response:\", json);\n\n      if (!resp.ok || !(json !== null && json !== void 0 && json.ok)) {\n        console.error(\"Slack add failed\", json);\n        alert(\"Failed to add to Slack List: \" + ((json === null || json === void 0 ? void 0 : json.error) || \"unknown error\"));\n        return;\n      }\n\n      alert(`Added to Slack ${which === \"shipping\" ? \"Shipping\" : which === \"receiving\" ? \"Receiving\" : \"Tasks\"} list.`);\n    } catch (e) {\n      console.error(e);\n      alert(\"Error adding to Slack\");\n    }\n  };\n\n  return __jsx(LoggedIn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1667,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1668,\n      columnNumber: 7\n    }\n  }, __jsx(Modal, {\n    show: show,\n    onHide: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1669,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1670,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1671,\n      columnNumber: 13\n    }\n  }, \"Error\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1673,\n      columnNumber: 11\n    }\n  }, \"Missing field\"), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1674,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1675,\n      columnNumber: 13\n    }\n  }, \"Ok\"))), __jsx(Modal, {\n    show: showErr,\n    onHide: handleCloseErr,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1680,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1681,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1682,\n      columnNumber: 13\n    }\n  }, \"Error\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1684,\n      columnNumber: 11\n    }\n  }, Err), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1685,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleCloseErr,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1686,\n      columnNumber: 13\n    }\n  }, \"Ok\"))), __jsx(Modal, {\n    show: showSaveModal,\n    onHide: handleCloseSaveModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1691,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1692,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1693,\n      columnNumber: 13\n    }\n  }, \"Save Confirmation\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1695,\n      columnNumber: 11\n    }\n  }, \"Data has been saved successfully.\"), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1696,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleCloseSaveModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1697,\n      columnNumber: 13\n    }\n  }, \"Ok\"))), __jsx(Modal, {\n    show: showPrintModal,\n    onHide: handleClosePrintModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1702,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1703,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1704,\n      columnNumber: 13\n    }\n  }, \"Print Confirmation\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1706,\n      columnNumber: 11\n    }\n  }, \"Info has been sent to print.\"), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1707,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleClosePrintModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1708,\n      columnNumber: 13\n    }\n  }, \"Ok\"))), __jsx(Modal, {\n    show: showDescModal,\n    onHide: handleCloseDescModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1714,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1715,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1716,\n      columnNumber: 13\n    }\n  }, \"Descriptions\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1718,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    className: \"mb-3\",\n    onClick: addDescription,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1719,\n      columnNumber: 13\n    }\n  }, \"Add Description\"), descriptions.map((desc, index) => __jsx(Row, {\n    key: index,\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1723,\n      columnNumber: 15\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: () => selectDescription(index),\n    style: {\n      cursor: \"pointer\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1724,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: \"d-flex justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1730,\n      columnNumber: 19\n    }\n  }, __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1731,\n      columnNumber: 21\n    }\n  }, desc.description || \"Description\"), __jsx(\"span\", {\n    style: {\n      borderLeft: \"1px solid #ccc\",\n      paddingLeft: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1732,\n      columnNumber: 21\n    }\n  }, desc.date || \"Date\"))))), __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleCloseDescModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1744,\n      columnNumber: 13\n    }\n  }, \"OK\"))), __jsx(Modal, {\n    show: showWoModal,\n    onHide: handleCloseWoModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1750,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1751,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1752,\n      columnNumber: 13\n    }\n  }, \"Work Orders\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1754,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    className: \"mb-3\",\n    onClick: addWorkOrder,\n    style: {\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1755,\n      columnNumber: 13\n    }\n  }, \"Add Work Order\"), workOrders.map((wo, index) => __jsx(Row, {\n    key: index,\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1764,\n      columnNumber: 15\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1765,\n      columnNumber: 17\n    }\n  }, __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Work Order\",\n    value: wo.workOrder,\n    onChange: e => handleWorkOrderChange(index, \"workOrder\", e.target.value),\n    style: {\n      marginBottom: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1766,\n      columnNumber: 19\n    }\n  })), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1776,\n      columnNumber: 17\n    }\n  }, __jsx(Form.Control, {\n    type: \"date\",\n    placeholder: \"Date\",\n    value: wo.date,\n    onChange: e => handleWorkOrderChange(index, \"date\", e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1777,\n      columnNumber: 19\n    }\n  })), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1786,\n      columnNumber: 17\n    }\n  }, __jsx(Button, {\n    variant: \"danger\",\n    onClick: () => removeWorkOrder(index),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1787,\n      columnNumber: 19\n    }\n  }, \"Remove\")))), __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleCloseWoModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1796,\n      columnNumber: 13\n    }\n  }, \"OK\"))), __jsx(ClientInfoModal, {\n    show: showMachineModal,\n    handleClose: handleCloseMachineModal,\n    selectedClient: selectedClient,\n    machineOptions: machineOptions,\n    setSelectedMachine: handleSetSelectedMachine,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1802,\n      columnNumber: 9\n    }\n  }), __jsx(Modal, {\n    show: showClientModal,\n    onHide: handleCloseClientModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1810,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1811,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1812,\n      columnNumber: 13\n    }\n  }, \"Select Client\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1814,\n      columnNumber: 11\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: search,\n    onChange: e => setSearch(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1815,\n      columnNumber: 13\n    }\n  }), __jsx(ClientTable, {\n    clients: clients.filter(client => (client.name || \"\").toLowerCase().includes(search.toLowerCase())),\n    onSelectClient: handleClientInfo,\n    onInfoClick: handleClientInfo,\n    clearSelection: () => handleClientInfo(null),\n    onAddClient: handleAddNewClient,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1822,\n      columnNumber: 13\n    }\n  }))), __jsx(ParentModal, {\n    show: showParentModal,\n    handleClose: handleCloseParentModal,\n    setSelectedParent: setSelectedParent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1834,\n      columnNumber: 9\n    }\n  }), __jsx(MachineSelectionModal, {\n    show: machineSelectionModal,\n    handleClose: () => setMachineSelectionModal(false),\n    setMachine: setTheMachine,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1840,\n      columnNumber: 9\n    }\n  }), __jsx(Modal, {\n    show: showCameraModal,\n    onHide: handleCloseCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1846,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1847,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1848,\n      columnNumber: 13\n    }\n  }, \"Take a Photo\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1850,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"camera\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1851,\n      columnNumber: 13\n    }\n  }, !capturedPhoto && __jsx(BarcodeScannerComponent, {\n    width: \"100%\",\n    height: 300,\n    onUpdate: handleCapture,\n    facingMode: cameraFacing,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1853,\n      columnNumber: 17\n    }\n  }), capturedPhoto && __jsx(\"div\", {\n    className: \"photo-preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1861,\n      columnNumber: 17\n    }\n  }, __jsx(\"img\", {\n    src: URL.createObjectURL(capturedPhoto),\n    alt: \"captured\",\n    style: {\n      width: \"100%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1862,\n      columnNumber: 19\n    }\n  })))), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1871,\n      columnNumber: 11\n    }\n  }, !capturedPhoto ? __jsx(React.Fragment, null, __jsx(Button, {\n    onClick: capturePhoto,\n    style: {\n      borderRadius: \"50%\",\n      width: \"60px\",\n      height: \"60px\",\n      position: \"absolute\",\n      left: \"50%\",\n      transform: \"translateX(-50%)\",\n      bottom: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1874,\n      columnNumber: 17\n    }\n  }, \"\\uD83D\\uDCF7\"), __jsx(Button, {\n    onClick: () => setCameraFacing(prev => prev === \"environment\" ? \"user\" : \"environment\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1888,\n      columnNumber: 17\n    }\n  }, \"Flip Camera\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1897,\n      columnNumber: 17\n    }\n  }, \"Cancel\")) : __jsx(React.Fragment, null, __jsx(Button, {\n    variant: \"secondary\",\n    onClick: () => setCapturedPhoto(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1903,\n      columnNumber: 17\n    }\n  }, \"Retake\"), __jsx(Button, {\n    variant: \"primary\",\n    onClick: savePhoto,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1909,\n      columnNumber: 17\n    }\n  }, \"OK\")))), __jsx(InfoModal, {\n    show: showInfoModal,\n    handleClose: handleCloseInfoModal,\n    itemName: items.name,\n    dimensions: items.length + \",\" + items.width + \",\" + items.height,\n    price: items.price,\n    freqI: freqItem,\n    freqM: machineFrequency,\n    usage: usagePastYear,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1917,\n      columnNumber: 9\n    }\n  }), __jsx(Container, {\n    className: \"d-flex align-items-center justify-content-center\",\n    style: {\n      minHeight: \"100vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1928,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"w-100\",\n    style: {\n      maxWidth: \"600px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1932,\n      columnNumber: 11\n    }\n  }, __jsx(Card, {\n    className: \"align-items-center justify-content-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1933,\n      columnNumber: 13\n    }\n  }, __jsx(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1934,\n      columnNumber: 15\n    }\n  }, __jsx(\"h2\", {\n    className: \"text-center mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1935,\n      columnNumber: 17\n    }\n  }, \"Item\"), __jsx(Form, {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1936,\n      columnNumber: 17\n    }\n  }, __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1938,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1939,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1940,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1941,\n      columnNumber: 25\n    }\n  }, \"Name\"), __jsx(Form.Control, {\n    type: \"text\",\n    value: items.name,\n    onChange: handleChange(\"name\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1942,\n      columnNumber: 25\n    }\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1949,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"pn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1950,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1951,\n      columnNumber: 25\n    }\n  }, \"Product Number\"), __jsx(\"div\", {\n    style: {\n      position: \"relative\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1952,\n      columnNumber: 25\n    }\n  }, __jsx(InputGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1953,\n      columnNumber: 27\n    }\n  }, __jsx(Form.Control, {\n    type: \"text\",\n    value: items.pn[currentPnIndex] || \"\",\n    onChange: e => handlePnChange(currentPnIndex, e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1954,\n      columnNumber: 29\n    }\n  }), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => setShowDropdown(!showDropdown),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1961,\n      columnNumber: 29\n    }\n  }, \"\\u25BE\"), __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1967,\n      columnNumber: 29\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => setAddingNewPn(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1968,\n      columnNumber: 31\n    }\n  }, \"+\"))), showDropdown && __jsx(\"div\", {\n    style: {\n      position: \"absolute\",\n      top: \"100%\",\n      left: 0,\n      right: 0,\n      backgroundColor: \"white\",\n      border: \"1px solid #ccc\",\n      zIndex: 1000,\n      maxHeight: \"150px\",\n      overflowY: \"auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1977,\n      columnNumber: 29\n    }\n  }, pnOptions.map((pnOption, idx) => __jsx(\"div\", {\n    key: idx,\n    style: {\n      padding: \"8px\",\n      cursor: \"pointer\"\n    },\n    onClick: () => {\n      setCurrentPnIndex(idx);\n      setShowDropdown(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1991,\n      columnNumber: 33\n    }\n  }, pnOption)))), addingNewPn && __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Enter new PN\",\n    value: newPn,\n    onChange: e => setNewPn(e.target.value),\n    onBlur: handleAddNewPn,\n    onKeyDown: e => e.key === \"Enter\" && handleAddNewPn(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2006,\n      columnNumber: 27\n    }\n  })))), __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2021,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2022,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"sn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2023,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2024,\n      columnNumber: 25\n    }\n  }, \"Serial Number\"), __jsx(\"div\", {\n    style: {\n      position: \"relative\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2025,\n      columnNumber: 25\n    }\n  }, __jsx(InputGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2026,\n      columnNumber: 27\n    }\n  }, __jsx(Form.Control, {\n    type: \"text\",\n    value: items.sn[currentSnIndex] || \"\",\n    onChange: e => handleSnChange(currentSnIndex, e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2027,\n      columnNumber: 29\n    }\n  }), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => setShowSnDropdown(!showSnDropdown),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2034,\n      columnNumber: 29\n    }\n  }, \"\\u25BE\"), __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2040,\n      columnNumber: 29\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => setAddingNewSn(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2041,\n      columnNumber: 31\n    }\n  }, \"+\"))), showSnDropdown && __jsx(\"div\", {\n    style: {\n      position: \"absolute\",\n      top: \"100%\",\n      left: 0,\n      right: 0,\n      backgroundColor: \"white\",\n      border: \"1px solid #ccc\",\n      zIndex: 1000,\n      maxHeight: \"150px\",\n      overflowY: \"auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2050,\n      columnNumber: 29\n    }\n  }, snOptions.map((snOption, idx) => __jsx(\"div\", {\n    key: idx,\n    style: {\n      padding: \"8px\",\n      cursor: \"pointer\"\n    },\n    onClick: () => {\n      setCurrentSnIndex(idx);\n      setShowSnDropdown(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2064,\n      columnNumber: 33\n    }\n  }, snOption)))), addingNewSn && __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Enter new SN\",\n    value: newSn,\n    onChange: e => setNewSn(e.target.value),\n    onBlur: handleAddNewSn,\n    onKeyDown: e => e.key === \"Enter\" && handleAddNewSn(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2079,\n      columnNumber: 27\n    }\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2092,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2093,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2094,\n      columnNumber: 25\n    }\n  }, \"Status\"), __jsx(Form.Select, {\n    value: items.status || \"\",\n    onChange: handleChange(\"status\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2095,\n      columnNumber: 25\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2099,\n      columnNumber: 27\n    }\n  }, \"Select status\"), __jsx(\"option\", {\n    value: \"Good\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2100,\n      columnNumber: 27\n    }\n  }, \"Good\"), __jsx(\"option\", {\n    value: \"Bad\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2101,\n      columnNumber: 27\n    }\n  }, \"Bad\"), __jsx(\"option\", {\n    value: \"Unknown\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2102,\n      columnNumber: 27\n    }\n  }, \"Unknown\"))))), __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2108,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2109,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2110,\n      columnNumber: 23\n    }\n  }, \"OEM\"), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"OEM\",\n    value: oem,\n    onChange: e => setOem(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2111,\n      columnNumber: 23\n    }\n  })), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2118,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2119,\n      columnNumber: 23\n    }\n  }, \"Modality\"), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Modality\",\n    value: modality,\n    onChange: e => setModality(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2120,\n      columnNumber: 23\n    }\n  })), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2127,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2128,\n      columnNumber: 23\n    }\n  }, \"Model\"), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Model\",\n    value: model,\n    onChange: e => setModel(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2129,\n      columnNumber: 23\n    }\n  }))), __jsx(\"div\", {\n    style: {\n      marginBottom: \"1rem\",\n      marginTop: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2138,\n      columnNumber: 19\n    }\n  }, __jsx(\"div\", {\n    className: \"d-flex align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2139,\n      columnNumber: 21\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleShowWoModal,\n    className: \"me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2140,\n      columnNumber: 23\n    }\n  }, \"Manage Work Orders\"), workOrders.length > 0 && __jsx(\"div\", {\n    className: \"d-flex flex-column align-items-start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2148,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2149,\n      columnNumber: 27\n    }\n  }, \"Work Order\"), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Most Recent Work Order\",\n    value: mostRecentWorkOrder.workOrder,\n    onChange: e => handleWorkOrderChange(workOrders.indexOf(mostRecentWorkOrder), \"workOrder\", e.target.value),\n    style: {\n      marginBottom: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2150,\n      columnNumber: 27\n    }\n  }), __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2163,\n      columnNumber: 27\n    }\n  }, \"Date\"), __jsx(Form.Control, {\n    type: \"date\",\n    placeholder: \"Work Order Date\",\n    value: mostRecentWorkOrder.date,\n    onChange: e => handleWorkOrderChange(workOrders.indexOf(mostRecentWorkOrder), \"date\", e.target.value),\n    style: {\n      marginBottom: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2164,\n      columnNumber: 27\n    }\n  }))), __jsx(\"div\", {\n    style: {\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2180,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"desc\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2181,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: listDescriptions,\n    className: \"mb-2 me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2182,\n      columnNumber: 25\n    }\n  }, \"List Descriptions\"), __jsx(Form.Control, {\n    as: \"textarea\",\n    rows: 3,\n    placeholder: \"Enter description\",\n    value: ((_descriptions$selecte3 = descriptions[selectedDesc]) === null || _descriptions$selecte3 === void 0 ? void 0 : _descriptions$selecte3.description) || \"\",\n    onChange: e => handleDescriptionChange(selectedDesc, \"description\", e.target.value),\n    style: {\n      marginBottom: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2189,\n      columnNumber: 25\n    }\n  }), __jsx(Form.Control, {\n    type: \"date\",\n    value: ((_descriptions$selecte4 = descriptions[selectedDesc]) === null || _descriptions$selecte4 === void 0 ? void 0 : _descriptions$selecte4.date) || \"\",\n    onChange: e => handleDescriptionChange(selectedDesc, \"date\", e.target.value),\n    style: {\n      marginTop: \"0.5rem\",\n      marginBottom: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2203,\n      columnNumber: 25\n    }\n  })))), __jsx(\"div\", {\n    style: {\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2222,\n      columnNumber: 19\n    }\n  }, __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2223,\n      columnNumber: 21\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2224,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => {\n      setMachinePick(true);\n      handleShowClientModal();\n    },\n    className: \"me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2225,\n      columnNumber: 25\n    }\n  }, \"Select From\"), selectedClientFrom && __jsx(\"div\", {\n    style: {\n      border: \"1px solid #ccc\",\n      padding: \"0.75rem\",\n      borderRadius: \"4px\",\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2236,\n      columnNumber: 27\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2244,\n      columnNumber: 29\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2245,\n      columnNumber: 31\n    }\n  }, \"Selected Client (From):\"), \" \", selectedClientFrom.name), __jsx(\"div\", {\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2248,\n      columnNumber: 29\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => setShowMachineModal(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2249,\n      columnNumber: 31\n    }\n  }, \"Select Machine for \", selectedClientFrom.name), selectedMachine && __jsx(React.Fragment, null, __jsx(\"p\", {\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2257,\n      columnNumber: 35\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2258,\n      columnNumber: 37\n    }\n  }, \"Selected Machine (From):\"), \" \", selectedMachine.name), showLocalLocFrom && __jsx(React.Fragment, null, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => setShowNewLocalModalFrom(true),\n    className: \"w-100 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2263,\n      columnNumber: 39\n    }\n  }, [newLocalFrom.region, ((_newLocalFrom$section = newLocalFrom.section) === null || _newLocalFrom$section === void 0 ? void 0 : _newLocalFrom$section.letter) + ((_newLocalFrom$section2 = newLocalFrom.section) === null || _newLocalFrom$section2 === void 0 ? void 0 : _newLocalFrom$section2.number), newLocalFrom.bin && `B${newLocalFrom.bin}`, newLocalFrom.pallet && `P${newLocalFrom.pallet}`].filter(Boolean).join(\"-\")), __jsx(Modal, {\n    show: showNewLocalModalFrom,\n    onHide: () => setShowNewLocalModalFrom(false),\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2285,\n      columnNumber: 39\n    }\n  }, __jsx(Modal.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2292,\n      columnNumber: 41\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2293,\n      columnNumber: 43\n    }\n  }, \"Edit Local Loc (From)\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2297,\n      columnNumber: 41\n    }\n  }, __jsx(NewLocal, {\n    selectedClient: selectedClientFrom,\n    showLocalLoc: showNewLocalModalFrom,\n    value: newLocalFrom,\n    onChange: setNewLocalFrom,\n    onSave: p => {\n      setNewLocalFrom(p);\n      setShowNewLocalModalFrom(false);\n    },\n    onCancel: () => setShowNewLocalModalFrom(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2298,\n      columnNumber: 43\n    }\n  })))))))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2329,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => {\n      setMachinePick(false);\n      handleShowClientModal();\n    },\n    className: \"me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2330,\n      columnNumber: 25\n    }\n  }, \"Select Current\"), selectedClientCurrent && __jsx(\"div\", {\n    style: {\n      border: \"1px solid #ccc\",\n      padding: \"0.75rem\",\n      borderRadius: \"4px\",\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2341,\n      columnNumber: 27\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2349,\n      columnNumber: 29\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2350,\n      columnNumber: 31\n    }\n  }, \"Selected Client (Current):\"), \" \", selectedClientCurrent.name), __jsx(\"div\", {\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2353,\n      columnNumber: 29\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => setShowMachineModal(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2354,\n      columnNumber: 31\n    }\n  }, \"Select Machine for \", selectedClientCurrent.name), selectedCurrentMachine && __jsx(React.Fragment, null, __jsx(\"p\", {\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2362,\n      columnNumber: 35\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2363,\n      columnNumber: 37\n    }\n  }, \"Selected Machine (Current):\"), \" \", selectedCurrentMachine.name), showLocalLocCurrent && __jsx(React.Fragment, null, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: () => setShowNewLocalModalCurrent(true),\n    className: \"w-100 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2368,\n      columnNumber: 39\n    }\n  }, [newLocalCurrent.region, ((_newLocalCurrent$sect = newLocalCurrent.section) === null || _newLocalCurrent$sect === void 0 ? void 0 : _newLocalCurrent$sect.letter) + ((_newLocalCurrent$sect2 = newLocalCurrent.section) === null || _newLocalCurrent$sect2 === void 0 ? void 0 : _newLocalCurrent$sect2.number), newLocalCurrent.bin && `B${newLocalCurrent.bin}`, newLocalCurrent.pallet && `P${newLocalCurrent.pallet}`].filter(Boolean).join(\"-\")), __jsx(Modal, {\n    show: showNewLocalModalCurrent,\n    onHide: () => setShowNewLocalModalCurrent(false),\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2387,\n      columnNumber: 39\n    }\n  }, __jsx(Modal.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2394,\n      columnNumber: 41\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2395,\n      columnNumber: 43\n    }\n  }, \"Edit Local Loc (Current)\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2399,\n      columnNumber: 41\n    }\n  }, __jsx(NewLocal, {\n    selectedClient: selectedClientCurrent,\n    showLocalLoc: showNewLocalModalCurrent,\n    value: newLocalCurrent,\n    onChange: setNewLocalCurrent,\n    onSave: p => {\n      setNewLocalCurrent(p);\n      setShowNewLocalModalCurrent(false);\n    },\n    onCancel: () => setShowNewLocalModalCurrent(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2400,\n      columnNumber: 43\n    }\n  })))))))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2437,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleShowParentModal,\n    className: \"me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2438,\n      columnNumber: 25\n    }\n  }, \"Select Parent\"), selectedParent && __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Selected Parent\",\n    value: selectedParent.name,\n    readOnly: true,\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2446,\n      columnNumber: 27\n    }\n  })))), __jsx(\"div\", {\n    style: {\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2458,\n      columnNumber: 19\n    }\n  }, __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2459,\n      columnNumber: 21\n    }\n  }, __jsx(Col, {\n    xs: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2460,\n      columnNumber: 23\n    }\n  }, __jsx(ButtonGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2461,\n      columnNumber: 25\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleShowCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2462,\n      columnNumber: 27\n    }\n  }, \"Take Photo\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleBrowsePhotos,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2468,\n      columnNumber: 27\n    }\n  }, \"Browse\"))), __jsx(Col, {\n    xs: 6,\n    className: \"d-flex align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2476,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"success\",\n    onClick: handleSendToInflow,\n    style: {\n      marginLeft: \"auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2477,\n      columnNumber: 25\n    }\n  }, \"Send to inFlow\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleBluefolderButton,\n    style: {\n      marginLeft: \"0.5rem\",\n      marginRight: \".5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2484,\n      columnNumber: 25\n    }\n  }, \"BlueFolder\"), __jsx(Button, {\n    variant: addToWebsite ? \"primary\" : \"outline-primary\",\n    onClick: () => setAddToWebsite(prev => !prev),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2493,\n      columnNumber: 25\n    }\n  }, addToWebsite ? \"✓ Add to Website\" : \"Add to Website\"), __jsx(Form.Check, {\n    type: \"checkbox\",\n    id: \"hide-checkbox\",\n    label: \"Hide\" // box is checked when we want visible = false\n    ,\n    checked: !items.visible,\n    onChange: e => {\n      // grab checked immediately\n      const isHidden = e.currentTarget.checked;\n      setItems(prev => _objectSpread(_objectSpread({}, prev), {}, {\n        visible: !isHidden\n      }));\n    },\n    className: \"ms-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2500,\n      columnNumber: 25\n    }\n  }))), __jsx(\"input\", {\n    type: \"file\",\n    accept: \"image/*\",\n    multiple: true,\n    ref: browseInputRef,\n    style: {\n      display: \"none\"\n    },\n    onChange: handleFilesSelected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2518,\n      columnNumber: 21\n    }\n  })), photos && photos.length > 0 && __jsx(\"div\", {\n    className: \"photo-gallery\",\n    style: {\n      display: \"flex\",\n      flexWrap: \"wrap\",\n      gap: \"10px\",\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2529,\n      columnNumber: 21\n    }\n  }, photos.map((photo, index) => __jsx(\"div\", {\n    key: index,\n    style: {\n      position: \"relative\",\n      width: \"100px\",\n      height: \"100px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2539,\n      columnNumber: 25\n    }\n  }, __jsx(\"img\", {\n    src: photo.url,\n    alt: `Photo ${index + 1}`,\n    style: {\n      width: \"100%\",\n      height: \"100%\",\n      objectFit: \"cover\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2547,\n      columnNumber: 27\n    }\n  }), photo.file && __jsx(Button, {\n    variant: \"danger\",\n    size: \"sm\",\n    style: {\n      position: \"absolute\",\n      top: 0,\n      right: 0,\n      padding: \"0 5px\"\n    },\n    onClick: () => removePhoto(index),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2557,\n      columnNumber: 29\n    }\n  }, \"x\")))), __jsx(\"div\", {\n    className: \"mt-3 d-flex flex-wrap align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2576,\n      columnNumber: 19\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    type: \"submit\",\n    style: {\n      marginRight: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2577,\n      columnNumber: 21\n    }\n  }, \"Save\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleShowInfoModal,\n    style: {\n      marginRight: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2584,\n      columnNumber: 21\n    }\n  }, \"More Info\"), __jsx(LoadingButton, {\n    type: \"primary\",\n    name: \"Back\",\n    route: \"NewSearch/mainSearch\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2591,\n      columnNumber: 21\n    }\n  }), __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      marginLeft: \".5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2596,\n      columnNumber: 21\n    }\n  }, __jsx(\"span\", {\n    style: {\n      fontSize: 12,\n      lineHeight: \"12px\",\n      textAlign: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2597,\n      columnNumber: 23\n    }\n  }, \"Slack\"), __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      border: \"1px solid #ced4da\",\n      borderRadius: 6,\n      overflow: \"hidden\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2598,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-primary\",\n    onClick: () => handleAddToSlack(\"receiving\"),\n    style: {\n      border: \"none\",\n      borderRight: \"1px solid #ced4da\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2599,\n      columnNumber: 25\n    }\n  }, \"Receiving\"), __jsx(Button, {\n    variant: \"outline-primary\",\n    onClick: () => handleAddToSlack(\"shipping\"),\n    style: {\n      border: \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2606,\n      columnNumber: 25\n    }\n  }, \"Shipping\"), __jsx(Button, {\n    variant: \"outline-primary\",\n    onClick: () => handleAddToSlack(\"tasks\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2613,\n      columnNumber: 25\n    }\n  }, \"Tasks\"))), __jsx(Button, {\n    variant: \"info\",\n    onClick: handlePrint,\n    style: {\n      marginLeft: \"auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2622,\n      columnNumber: 21\n    }\n  }, \"Print Label\")), __jsx(\"div\", {\n    style: {\n      textAlign: \"center\",\n      margin: \"1rem 0\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2630,\n      columnNumber: 19\n    }\n  }, __jsx(Button, {\n    variant: \"link\",\n    style: {\n      textDecoration: \"none\",\n      color: \"black\",\n      fontSize: \"24px\"\n    },\n    onClick: () => setShowExtra(!showExtra),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2631,\n      columnNumber: 21\n    }\n  }, \"\\u25BC\")), __jsx(Collapse, {\n    in: showExtra,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2643,\n      columnNumber: 19\n    }\n  }, __jsx(\"div\", {\n    id: \"extra-collapse\",\n    className: \"mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2644,\n      columnNumber: 21\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2645,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Group, {\n    as: Col,\n    controlId: \"dimensions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2646,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2647,\n      columnNumber: 27\n    }\n  }, \"Dimensions\"), __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      alignItems: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2648,\n      columnNumber: 27\n    }\n  }, __jsx(Form.Control, {\n    placeholder: \"Length\",\n    type: \"text\",\n    value: items.length,\n    onChange: handleChange(\"length\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2651,\n      columnNumber: 29\n    }\n  }), __jsx(\"span\", {\n    style: {\n      padding: \"0 5px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2657,\n      columnNumber: 29\n    }\n  }, \"x\"), __jsx(Form.Control, {\n    placeholder: \"Width\",\n    type: \"text\",\n    value: items.width,\n    onChange: handleChange(\"width\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2658,\n      columnNumber: 29\n    }\n  }), __jsx(\"span\", {\n    style: {\n      padding: \"0 5px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2664,\n      columnNumber: 29\n    }\n  }, \"x\"), __jsx(Form.Control, {\n    placeholder: \"Height\",\n    type: \"text\",\n    value: items.height,\n    onChange: handleChange(\"height\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2665,\n      columnNumber: 29\n    }\n  }))), __jsx(Form.Group, {\n    as: Col,\n    controlId: \"trackingNumber\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2673,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2674,\n      columnNumber: 27\n    }\n  }, \"Tracking Number\"), __jsx(Form.Control, {\n    placeholder: \"Tracking Number\",\n    type: \"text\",\n    value: items.trackingNumber,\n    onChange: handleChange(\"trackingNumber\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2675,\n      columnNumber: 27\n    }\n  }))), __jsx(Row, {\n    className: \"mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2684,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Group, {\n    as: Col,\n    controlId: \"Price\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2685,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2686,\n      columnNumber: 27\n    }\n  }, \"Price\"), __jsx(Form.Control, {\n    placeholder: \"Price\",\n    type: \"text\",\n    value: items.price,\n    onChange: handleChange(\"price\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2687,\n      columnNumber: 27\n    }\n  })), __jsx(Form.Group, {\n    as: Col,\n    controlId: \"DOM\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2694,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2695,\n      columnNumber: 27\n    }\n  }, \"DOM\"), __jsx(Form.Control, {\n    placeholder: \"Date of Manufacture\",\n    type: \"date\",\n    value: DOM,\n    onChange: e => setDOM(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2696,\n      columnNumber: 27\n    }\n  })), __jsx(Form.Group, {\n    as: Col,\n    controlId: \"poNumber\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2703,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2704,\n      columnNumber: 27\n    }\n  }, \"PO Number\"), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"PO Number\",\n    value: items.poNumber || \"\",\n    onChange: handleChange(\"poNumber\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2705,\n      columnNumber: 27\n    }\n  }))), __jsx(Row, {\n    className: \"mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2713,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Group, {\n    as: Col,\n    controlId: \"localSN\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2714,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2715,\n      columnNumber: 27\n    }\n  }, \"Local SN\"), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Enter Local SN\",\n    value: items.localSN || \"\",\n    onChange: handleChange(\"localSN\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2716,\n      columnNumber: 27\n    }\n  })), __jsx(Form.Group, {\n    as: Col,\n    controlId: \"arrivalDate\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2723,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2724,\n      columnNumber: 27\n    }\n  }, \"Arrival Date\"), __jsx(Form.Control, {\n    placeholder: \"Enter Arrival Date\",\n    type: \"date\",\n    value: items.arrival_date,\n    onChange: e => {\n      const value = e.target.value;\n      setItems(prev => _objectSpread(_objectSpread({}, prev), {}, {\n        arrival_date: value\n      }));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2725,\n      columnNumber: 27\n    }\n  }))))))))))), __jsx(Modal, {\n    show: showCameraModal,\n    onHide: handleCloseCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2748,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2749,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2750,\n      columnNumber: 11\n    }\n  }, \"Take a Photo\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2752,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"camera\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2753,\n      columnNumber: 11\n    }\n  }, !capturedPhoto ? __jsx(BarcodeScannerComponent, {\n    width: \"100%\",\n    height: 300,\n    onUpdate: handleCapture,\n    facingMode: cameraFacing,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2755,\n      columnNumber: 15\n    }\n  }) : __jsx(\"div\", {\n    className: \"photo-preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2762,\n      columnNumber: 15\n    }\n  }, __jsx(\"img\", {\n    src: URL.createObjectURL(capturedPhoto),\n    alt: \"captured\",\n    style: {\n      width: \"100%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2763,\n      columnNumber: 17\n    }\n  })))), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2772,\n      columnNumber: 9\n    }\n  }, !capturedPhoto ? __jsx(React.Fragment, null, __jsx(Button, {\n    onClick: capturePhoto,\n    style: {\n      borderRadius: \"50%\",\n      width: \"60px\",\n      height: \"60px\",\n      position: \"absolute\",\n      left: \"50%\",\n      transform: \"translateX(-50%)\",\n      bottom: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2775,\n      columnNumber: 15\n    }\n  }, \"\\uD83D\\uDCF7\"), __jsx(Button, {\n    onClick: () => setCameraFacing(prev => prev === \"environment\" ? \"user\" : \"environment\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2789,\n      columnNumber: 15\n    }\n  }, \"Flip Camera\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2798,\n      columnNumber: 15\n    }\n  }, \"Cancel\")) : __jsx(React.Fragment, null, __jsx(Button, {\n    variant: \"secondary\",\n    onClick: () => setCapturedPhoto(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2804,\n      columnNumber: 15\n    }\n  }, \"Retake\"), __jsx(Button, {\n    variant: \"primary\",\n    onClick: savePhoto,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2810,\n      columnNumber: 15\n    }\n  }, \"OK\")))));\n} // Server-side rendering function\n\nexport async function getServerSideProps(context) {\n  const {\n    id\n  } = context.params;\n\n  try {\n    const itemDoc = await adminDb.collection(\"Test\").doc(id).get();\n    if (!itemDoc.exists) return {\n      notFound: true\n    };\n    const itemData = itemDoc.data(); // normalize to arrays for consistent client-side handling\n\n    const pnArray = Array.isArray(itemData.pn) ? itemData.pn : itemData.pn ? [itemData.pn] : [];\n    const snArray = Array.isArray(itemData.sn) ? itemData.sn : itemData.sn ? [itemData.sn] : []; // fetch machineData (optional; you already had this)\n\n    let machineData = {};\n\n    if (itemData.Machine && itemData.Machine.path) {\n      try {\n        const machineDoc = await adminDb.doc(itemData.Machine.path).get();\n\n        if (machineDoc.exists) {\n          machineData = machineDoc.data();\n\n          if (machineData.client && machineData.client.path) {\n            const clientDoc = await adminDb.doc(machineData.client.path).get();\n            if (clientDoc.exists) machineData.Client = clientDoc.data().name;\n          }\n        }\n      } catch (e) {\n        console.error(\"Error fetching machine data:\", e);\n      }\n    }\n\n    const serializedItem = {\n      id,\n      name: itemData.name || \"\",\n      pn: pnArray,\n      sn: snArray,\n      price: itemData.price || \"\",\n      status: itemData.status || \"\",\n      length: itemData.length || \"\",\n      width: itemData.width || \"\",\n      height: itemData.height || \"\",\n      poNumber: itemData.poNumber || \"\",\n      trackingNumber: itemData.trackingNumber || \"\",\n      localSN: itemData.localSN || \"\",\n      arrival_date: itemData.arrival_date || \"\",\n      visible: itemData.visible !== undefined ? itemData.visible : true,\n      // add the pieces the UI reads directly\n      descriptions: itemData.descriptions || [],\n      workOrders: itemData.workOrders || [],\n      DOM: itemData.DOM || \"\"\n    };\n    return {\n      props: {\n        initialItem: serializedItem,\n        initialMachineData: machineData\n      }\n    };\n  } catch (error) {\n    console.error(\"Error in getServerSideProps:\", error);\n    return {\n      props: {\n        error: \"Failed to load item data\"\n      }\n    };\n  }\n}","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/NewSearch/item/[id]/index.js"],"names":["React","useEffect","useState","useRef","Form","Button","Card","Container","Row","Col","Modal","FormControl","Collapse","InputGroup","ButtonGroup","Link","useAuth","firebase","LoggedIn","useRouter","fetchClients","ClientTable","ClientInfoModal","ParentModal","dynamic","InfoModal","MachineSelectionModal","addServiceItem","NewLocal","InflowAPI","adminDb","buildLocalLocObject","loc","o","region","section","letter","number","bin","undefined","pallet","BarcodeScannerComponent","ssr","simulateNetworkRequest","Promise","resolve","setTimeout","LoadingButton","type","name","route","isLoading","setLoading","then","handleClick","DisplayItem","initialItem","initialMachineData","error","router","signOut","id","idFromRouter","query","initialId","items","setItems","pn","Array","isArray","sn","price","status","length","width","height","poNumber","trackingNumber","localSN","arrival_date","visible","setDescriptions","descriptions","setWorkOrders","workOrders","setDOM","DOM","prev","newLocalFrom","setNewLocalFrom","newLocalCurrent","setNewLocalCurrent","selectedClientFrom","setSelectedClientFrom","selectedClientCurrent","setSelectedClientCurrent","selectedMachine","setSelectedMachine","selectedCurrentMachine","setSelectedCurrentMachine","pnOptions","setPnOptions","snOptions","setSnOptions","description","date","workOrder","clients","setClients","photos","setPhotos","show","setShow","showErr","setShowErr","Err","setErr","showDescModal","setShowDescModal","showWoModal","setShowWoModal","showClientModal","setShowClientModal","showMachineModal","setShowMachineModal","showParentModal","setShowParentModal","showCameraModal","setShowCameraModal","showSaveModal","setShowSaveModal","showPrintModal","setShowPrintModal","machineSelectionModal","setMachineSelectionModal","selectedDesc","setSelectedDesc","selectedClient","setSelectedClient","selectedParent","setSelectedParent","TheMachine","setTheMachine","machineOptions","setMachineOptions","search","setSearch","capturedPhoto","setCapturedPhoto","cameraFacing","setCameraFacing","addToWebsite","setAddToWebsite","machinePick","setMachinePick","freqItem","setFreqItem","usagePastYear","setUsagePastYear","machineFrequency","setMachineFrequency","showExtra","setShowExtra","localLocFrom","setLocalLocFrom","localLocCurrent","setLocalLocCurrent","oem","setOem","modality","setModality","model","setModel","showInfoModal","setShowInfoModal","itemName","setItemName","machineFieldsInitialized","setMachineFieldsInitialized","showLocalModalFrom","setShowLocalModalFrom","showLocalModalCurrent","setShowLocalModalCurrent","openLocalModalFrom","closeLocalModalFrom","openLocalModalCurrent","closeLocalModalCurrent","showNewLocalModalFrom","setShowNewLocalModalFrom","showNewLocalModalCurrent","setShowNewLocalModalCurrent","formatLoc","parts","push","join","handleSendToInflow","trim","alert","imageUrls","map","p","url","filter","Boolean","sku","toString","toCSV","arr","arrivalISO","Date","toISOString","slice","pnStr","snStr","mostRecentWO","reduce","latest","cur","customFields","custom1","custom2","custom3","custom4","custom5","custom6","custom7","custom8","custom9","custom10","console","log","created","upsertProduct","productId","err","message","setShowLocalLocFrom","toLowerCase","setShowLocalLocCurrent","fetchClientsData","clientsData","fetchPnSn","db","firestore","snapshot","collection","get","pnSet","Set","snSet","forEach","doc","data","add","pnArray","snArray","fetchData","resolveClientFromMachine","machineRef","setClient","setMachine","isFrom","machineDoc","exists","machineData","clientDoc","client","clientName","isSocalInterior","shouldShow","normalizedPN","normalizedSN","ClientFrom","clientFromDoc","ClientCurrent","clientCurrentDoc","Machine","CurrentMachine","machineFromData","machineCurrentData","MachineFrom","MachineCurrent","nameFrom","nameCurrent","theMachineData","OEM","Modality","Model","merged","updateMachineFields","Parent","parentDoc","fetchPhotos","checkIfAddedToWebsite","calculateItemFrequencyAndUsage","pathname","signal","getPriorityMachineField","field","theMachine","currentMachine","fromMachine","currentDate","oneYearAgo","setFullYear","getFullYear","itemsSnapshot","where","size","itemData","workOrderDate","fetchMachine","machineId","machinesSnapshot","docID","storageRef","storage","ref","listRef","child","res","listAll","urls","all","item","getDownloadURL","file","partsDoc","handleClose","handleShow","handleCloseErr","handleShowErr","handleCloseSaveModal","handleClosePrintModal","handleShowSaveModal","handleShowPrintModal","handleMachineSelectionModal","handleCloseDescModal","handleShowDescModal","handleCloseWoModal","handleShowWoModal","handleCloseClientModal","handleShowClientModal","handleCloseMachineModal","handleShowMachineModal","handleCloseParentModal","handleShowParentModal","handleClientInfo","clientId","clientData","machinePromises","machines","machineDocs","reorderArray","selectedValue","newArr","val","addingNewPn","setAddingNewPn","newPn","setNewPn","addingNewSn","setAddingNewSn","newSn","setNewSn","handlePnSelect","e","selected","target","value","updatedPn","handleSnSelect","updatedSn","handleAddNewPn","handleAddNewSn","generateCustomID","randomNum","Math","floor","random","shallowClean","obj","newObj","key","hasOwnProperty","toSend","currentUser","auth","userEmail","email","formattedItems","addedToWebsite","lastEdited","fromDetails","currentDetails","Object","keys","docId","newDocId","set","update","associatedParts","FieldValue","arrayUnion","currentMachineRef","currentMachineDoc","delete","cleanFormattedItems","uploadPhotos","showLocalLocFrom","showLocalLocCurrent","handleSetSelectedMachine","machine","i","photoRef","metadata","contentType","put","handlePrint","warn","payload","wo","local_sn","dateCreated","response","fetch","method","headers","body","JSON","stringify","result","json","includes","handleSubmit","event","preventDefault","handleChange","prevItems","addDescription","removeDescription","index","_","handleDescriptionChange","newDescriptions","desc","addWorkOrder","removeWorkOrder","handleWorkOrderChange","newWorkOrders","listDescriptions","selectDescription","handleShowCameraModal","handleCloseCameraModal","handleCapture","savePhoto","prevPhotos","URL","createObjectURL","removePhoto","mostRecentWorkOrder","current","latestDate","capturePhoto","video","document","querySelector","canvas","createElement","videoWidth","videoHeight","context","getContext","drawImage","toBlob","blob","handleShowInfoModal","handleCloseInfoModal","handlePnChange","addPn","handleSnChange","addSn","browseInputRef","handleBrowsePhotos","click","handleFilesSelected","files","newPhotos","currentPnIndex","setCurrentPnIndex","showDropdown","setShowDropdown","currentSnIndex","setCurrentSnIndex","showSnDropdown","setShowSnDropdown","handleAddNewClient","handleBluefolderButton","currentWorkOrder","localsn","handleAddToSlack","which","pn0","sn0","linkUrl","window","location","href","safeName","title","descVal","shippingDate","tracking","listKey","resp","ok","cursor","borderLeft","paddingLeft","marginBottom","borderRadius","position","left","transform","bottom","minHeight","maxWidth","top","right","backgroundColor","border","zIndex","maxHeight","overflowY","pnOption","idx","padding","snOption","marginTop","indexOf","marginLeft","marginRight","isHidden","currentTarget","checked","display","flexWrap","gap","photo","objectFit","flexDirection","fontSize","lineHeight","textAlign","overflow","borderRight","margin","textDecoration","color","alignItems","getServerSideProps","params","itemDoc","notFound","path","Client","serializedItem","props"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport {\n  Form,\n  Button,\n  Card,\n  Container,\n  Row,\n  Col,\n  Modal,\n  FormControl,\n  Collapse,\n  InputGroup,\n  ButtonGroup,\n} from \"react-bootstrap\";\n\nimport Link from \"next/link\";\nimport { useAuth } from \"../../../../context/AuthUserContext\";\nimport firebase from \"../../../../context/Firebase\";\nimport LoggedIn from \"../../../LoggedIn\";\nimport { useRouter } from \"next/router\";\nimport { fetchClients } from \"../../../../utils/fetchAssociations\";\nimport ClientTable from \"../../../../utils/ClientTable\";\nimport ClientInfoModal from \"../../ClientInfoModal\";\nimport ParentModal from \"../../AddItem/parentModal\";\nimport dynamic from \"next/dynamic\";\nimport InfoModal from \"../../InfoModal\";\nimport MachineSelectionModal from \"./MachineSelectionModal\";\nimport { addServiceItem } from \"../../../../utils/BluefolderService\";\n\nimport NewLocal from \"./NewLocal\";\n\n//inflow API\nimport InflowAPI from \"../../../../utils/inflowAPI\";\n\n// Import for SSR\nimport { adminDb } from \"../../../../context/FirebaseAdmin\";\n\n// === BUILD A MAP ONLY OF THOSE FIELDS THE USER ACTUALLY PICKED ===\nfunction buildLocalLocObject(loc) {\n  const o = {};\n  if (loc.region) o.region = loc.region;\n  if (loc.section?.letter && loc.section?.number) o.section = loc.section;\n  // pick up the new singular fields, too:\n  if (loc.bin !== undefined && loc.bin !== \"\") o.bin = loc.bin;\n  if (loc.pallet !== undefined && loc.pallet !== \"\") o.pallet = loc.pallet;\n  return o;\n}\n\n// This will only load the component on the client-side.\nconst BarcodeScannerComponent = dynamic(\n  () => import(\"react-qr-barcode-scanner\"),\n  { ssr: false }\n);\n\n// Simulates a network request delay.\nfunction simulateNetworkRequest() {\n  return new Promise((resolve) => setTimeout(resolve, 2000));\n}\n\n// Custom LoadingButton component.\nfunction LoadingButton({ type, name, route }) {\n  const [isLoading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (isLoading) {\n      simulateNetworkRequest().then(() => setLoading(false));\n    }\n  }, [isLoading]);\n\n  const handleClick = () => setLoading(true);\n\n  return (\n    <Link href={`/${route}`}>\n      <a\n        className={`btn btn-${type}`}\n        disabled={isLoading}\n        onClick={!isLoading ? handleClick : null}\n      >\n        {isLoading ? \"Loading…\" : name}\n      </a>\n    </Link>\n  );\n}\n\n\nexport default function DisplayItem({ initialItem, initialMachineData, error }) {\n  const router = useRouter();\n  const { signOut } = useAuth();\n  // const { id } = router.query;\n  const { id: idFromRouter } = router.query;\n  const initialId = initialItem?.id || idFromRouter;\n  // Use a single local var everywhere in this component\n  const id = initialId;\n\n  const [items, setItems] = useState({\n    name: initialItem?.name || \"\",\n    pn: Array.isArray(initialItem?.pn)\n      ? initialItem.pn\n      : (initialItem?.pn ? [initialItem.pn] : []),\n    sn: Array.isArray(initialItem?.sn)\n      ? initialItem.sn\n      : (initialItem?.sn ? [initialItem.sn] : []),\n\n    // hydrate these from initialItem so SSR renders fully on deploy\n    price: initialItem?.price ?? \"\",\n    status: initialItem?.status ?? \"\",\n    length: initialItem?.length ?? \"\",\n    width: initialItem?.width ?? \"\",\n    height: initialItem?.height ?? \"\",\n    poNumber: initialItem?.poNumber ?? \"\",\n    trackingNumber: initialItem?.trackingNumber ?? \"\",\n    localSN: initialItem?.localSN || \"\",\n    arrival_date: initialItem?.arrival_date || \"\",\n    visible: initialItem?.visible ?? true,\n  });\n  // ⬇️ put this INSIDE DisplayItem, after the related useState hooks\n  useEffect(() => {\n    if (!initialItem) return;\n\n    setDescriptions(initialItem.descriptions || []);\n    setWorkOrders(initialItem.workOrders || []);\n    setDOM(initialItem.DOM || \"\");\n\n    setItems(prev => ({\n      ...prev,\n      // only overwrite if SSR provided a value; otherwise keep what you have\n      status: initialItem.status ?? prev.status ?? \"\",\n      price: initialItem.price ?? prev.price ?? \"\",\n      length: initialItem.length ?? prev.length ?? \"\",\n      width: initialItem.width ?? prev.width ?? \"\",\n      height: initialItem.height ?? prev.height ?? \"\",\n      poNumber: initialItem.poNumber ?? prev.poNumber ?? \"\",\n      trackingNumber: initialItem.trackingNumber ?? prev.trackingNumber ?? \"\",\n    }));\n  }, [initialItem]);\n\n\n\n  const [newLocalFrom, setNewLocalFrom] = useState({\n    region: \"\",\n    section: { letter: \"\", number: \"\" },\n    bin: \"\",\n    pallet: \"\",\n  });\n  const [newLocalCurrent, setNewLocalCurrent] = useState({\n    region: \"\",\n    section: { letter: \"\", number: \"\" },\n    bin: \"\",\n    pallet: \"\",\n  });\n\n  // New states for separate client selections:\n  const [selectedClientFrom, setSelectedClientFrom] = useState(null);\n  const [selectedClientCurrent, setSelectedClientCurrent] = useState(null);\n\n  const [selectedMachine, setSelectedMachine] = useState(null);\n  const [selectedCurrentMachine, setSelectedCurrentMachine] = useState(null);\n\n  // whenever you pick a new “From” client or machine, clear the old From-loc:\n  // useEffect(() => {\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientFrom, selectedMachine]);\n  // const didMountFrom = useRef(false);\n\n  // useEffect(() => {\n  //   if (!didMountFrom.current) {\n  //     // first time through (the data-load phase), don’t clear\n  //     didMountFrom.current = true;\n  //     return;\n  //   }\n  //   // thereafter, when the user picks a new client or machine, clear:\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  //   setLocalLocFrom(\"\");\n  // }, [selectedClientFrom, selectedMachine]);\n\n  // whenever you pick a new “Current” client or machine, clear the old Current-loc:\n  // useEffect(() => {\n  //   setNewLocalCurrent({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\n  // const [didFetch, setDidFetch] = useState(false);\n\n  // useEffect(() => {\n  //   if (!didFetch) {\n  //     // we’re in the data-load phase, skip clearing\n  //     setDidFetch(true);\n  //     return;\n  //   }\n  //   // only clear on subsequent user changes:\n  //   setNewLocalCurrent({ region: \"\", section: {}, bin: \"\", pallet: \"\" });\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\n\n  // These arrays will be populated from Firebase.\n  const [pnOptions, setPnOptions] = useState([]);\n  const [snOptions, setSnOptions] = useState([]);\n\n  const [descriptions, setDescriptions] = useState([\n    { description: \"\", date: \"\" },\n  ]);\n  const [workOrders, setWorkOrders] = useState([{ workOrder: \"\", date: \"\" }]);\n  const [clients, setClients] = useState([]);\n  const [photos, setPhotos] = useState([]);\n  const [show, setShow] = useState(false);\n  const [showErr, setShowErr] = useState(false);\n  const [Err, setErr] = useState(\"N/A\");\n  const [showDescModal, setShowDescModal] = useState(false);\n  const [showWoModal, setShowWoModal] = useState(false);\n  const [showClientModal, setShowClientModal] = useState(false);\n  const [showMachineModal, setShowMachineModal] = useState(false);\n  const [showParentModal, setShowParentModal] = useState(false);\n  const [showCameraModal, setShowCameraModal] = useState(false);\n  const [showSaveModal, setShowSaveModal] = useState(false);\n  const [showPrintModal, setShowPrintModal] = useState(false);\n  const [machineSelectionModal, setMachineSelectionModal] = useState(false);\n  const [selectedDesc, setSelectedDesc] = useState(0);\n  const [selectedClient, setSelectedClient] = useState(null);\n\n  const [selectedParent, setSelectedParent] = useState(null);\n  const [TheMachine, setTheMachine] = useState(null);\n  const [machineOptions, setMachineOptions] = useState([]);\n  const [search, setSearch] = useState(\"\");\n  const [capturedPhoto, setCapturedPhoto] = useState(null);\n  const [cameraFacing, setCameraFacing] = useState(\"environment\");\n  const [addToWebsite, setAddToWebsite] = useState(false);\n  const [machinePick, setMachinePick] = useState(false);\n  const [freqItem, setFreqItem] = useState(0);\n  const [usagePastYear, setUsagePastYear] = useState(0);\n  const [machineFrequency, setMachineFrequency] = useState(0);\n  // State for the extra (dimensions/price/DOM/PO Number) section.\n  const [showExtra, setShowExtra] = useState(false);\n  // State for the local warehouse location inputs.\n  const [localLocFrom, setLocalLocFrom] = useState(\"\");\n  const [localLocCurrent, setLocalLocCurrent] = useState(\"\");\n\n  // New state for DOM (Date of Manufacture)\n  const [DOM, setDOM] = useState(\"\");\n  // New state for OEM, Modality, and Model.\n  const [oem, setOem] = useState(\"\");\n  const [modality, setModality] = useState(\"\");\n  const [model, setModel] = useState(\"\");\n\n  // More info modal state.\n  const [showInfoModal, setShowInfoModal] = useState(false);\n  const [itemName, setItemName] = useState(\"\");\n\n  const [machineFieldsInitialized, setMachineFieldsInitialized] =\n    useState(false);\n\n  // near the top of DisplayItem()\n  const [showLocalModalFrom, setShowLocalModalFrom] = useState(false);\n  const [showLocalModalCurrent, setShowLocalModalCurrent] = useState(false);\n\n  const openLocalModalFrom = () => setShowLocalModalFrom(true);\n  const closeLocalModalFrom = () => setShowLocalModalFrom(false);\n  const openLocalModalCurrent = () => setShowLocalModalCurrent(true);\n  const closeLocalModalCurrent = () => setShowLocalModalCurrent(false);\n\n  // at the top of DisplayItem()\n  const [showNewLocalModalFrom, setShowNewLocalModalFrom] = useState(false);\n  const [showNewLocalModalCurrent, setShowNewLocalModalCurrent] =\n    useState(false);\n\n  function formatLoc(loc) {\n    if (!loc) return \"\";\n    const parts = [];\n    if (loc.region) parts.push(loc.region);\n    if (loc.section?.letter && loc.section?.number)\n      parts.push(`${loc.section.letter}${loc.section.number}`);\n    if (loc.bin) parts.push(`B${loc.bin}`);\n    if (loc.pallet) parts.push(`P${loc.pallet}`);\n    return parts.join(\"–\");\n  }\n\n  // when the From-client changes, clear any old local-loc\n  // useEffect(() => {\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientFrom]);\n\n  // // when the From-machine changes, clear any old local-loc\n  // useEffect(() => {\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedMachine]);\n\n  // same for Current:\n  // useEffect(() => {\n  //   setNewLocalCurrent({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\n\n  // const handleSendToInflow = async () => {\n  //   try {\n  //     const name = items.name;\n  //     const description = descriptions[selectedDesc]?.description || \"\";\n  //     // gather every photo URL from Firebase Storage\n  //     const imageUrls = photos.map((p) => p.url);\n  //     await InflowAPI.upsertProduct({ name, description, imageUrls });\n  //     alert(\"Sent to inFlow successfully!\");\n  //   } catch (err) {\n  //     console.error(err);\n  //     alert(\"Error sending to inFlow: \" + err.message);\n  //   }\n  // };\n\nconst handleSendToInflow = async () => {\n  try {\n    const name = (items.name || '').trim();\n    if (!name) {\n      alert('Item needs a name before sending to inFlow.');\n      return;\n    }\n\n    // Regular description (don’t also send a custom “Description” unless you truly have one)\n    const description = (descriptions[selectedDesc]?.description || '').trim();\n\n    // Photos already fetched from storage\n    const imageUrls = photos.map(p => p.url).filter(Boolean);\n\n    // SKU = your item id\n    const sku = (id ?? '').toString();\n\n   \n\n    // Basic normalizers\n    const toCSV = arr => (Array.isArray(arr) ? arr.filter(Boolean).join(', ') : (arr || ''));\n\n    // YYYY-MM-DD for the date field in inFlow\n    const arrivalISO = items.arrival_date\n      ? new Date(items.arrival_date).toISOString().slice(0, 10)\n      : '';\n\n    const pnStr = Array.isArray(items.pn) ? items.pn.filter(Boolean).join(', ') : (items.pn || '');\n    const snStr = Array.isArray(items.sn) ? items.sn.filter(Boolean).join(', ') : (items.sn || '');\n\n    // Most recent WO (you already have this)\n    const mostRecentWO =\n      workOrders?.length\n        ? workOrders.reduce((latest, cur) => (new Date(cur.date) > new Date(latest.date) ? cur : latest), workOrders[0])\n        : { workOrder: '', date: '' };\n\n    // Build the numbered fields (match your inFlow “Field 1..10”)\n    const customFields = {\n      custom1: (oem || '').trim(),                      // OEM   (dropdown)\n      custom2: (modality || '').trim(),                 // Modality (dropdown)\n      custom3: (model || '').trim(),                    // Model (dropdown)\n      custom4: (description || '').trim(),              // Description (text) - optional duplicate\n      custom5: (mostRecentWO.workOrder || '').trim(),   // Work Order (text)\n      custom6: (selectedClientFrom?.name || '').trim(), // From (text)\n      custom7: pnStr,                                   // Product Number (text)\n      custom8: snStr,                                   // Serial Number (text)\n      custom9: arrivalISO,                              // Arrival Date (date)\n      custom10: (selectedClientCurrent?.name || '').trim(), // Current (text)\n    };\n\n    console.log('[inFlow] customFields to send (numbered):', customFields);\n\n\n    const created = await InflowAPI.upsertProduct({\n      name,\n      description,\n      sku,\n      imageUrls,\n      customFields,\n    });\n\n    alert(`Sent to inFlow successfully. ID: ${created?.productId || created?.id || '(unknown)'}`);\n  } catch (err) {\n    console.error(err);\n    alert('Error sending to inFlow: ' + err.message);\n  }\n};\n\n\n  // const [storedMachine, setStoredMachine] = useState(null);\n\n  // useEffect(() => {\n  //   // once any of these three change, re-merge:\n  //   if (TheMachine || selectedCurrentMachine || selectedMachine) {\n  //     const merged = updateMachineFields(\n  //       TheMachine,\n  //       selectedCurrentMachine,\n  //       selectedMachine\n  //     );\n  //     setOem(merged.oem);\n  //     setModality(merged.modality);\n  //     setModel(merged.model);\n  //   }\n  // }, [TheMachine, selectedCurrentMachine, selectedMachine]);\n\n  // whenever the “From” client changes:\n  useEffect(() => {\n    setShowLocalLocFrom(\n      selectedClientFrom?.name?.toLowerCase() === \"socalwarehouse\"\n    );\n  }, [selectedClientFrom]);\n\n  // whenever the “Current” client changes:\n  useEffect(() => {\n    setShowLocalLocCurrent(\n      selectedClientCurrent?.name?.toLowerCase() === \"socalwarehouse\"\n    );\n  }, [selectedClientCurrent]);\n\n  // Fetch clients data.\n  useEffect(() => {\n    async function fetchClientsData() {\n      try {\n        const clientsData = await fetchClients();\n        console.log(clientsData);\n        setClients(clientsData);\n      } catch (error) {\n        console.error(\"Error fetching clients: \", error);\n      }\n    }\n    fetchClientsData();\n  }, []);\n\n  // Fetch PN and SN options from Firebase.\n  useEffect(() => {\n    async function fetchPnSn() {\n      const db = firebase.firestore();\n      const snapshot = await db.collection(\"Test\").get();\n      let pnSet = new Set();\n      let snSet = new Set();\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        if (data.pn) pnSet.add(data.pn);\n        if (data.sn) snSet.add(data.sn);\n      });\n      const pnArray = [...pnSet];\n      const snArray = [...snSet];\n      setPnOptions(pnArray);\n      setSnOptions(snArray);\n    }\n    fetchPnSn();\n  }, []);\n\n  useEffect(() => {\n    if (!initialItem && idFromRouter) {\n      fetchData();\n    }\n  }, [initialItem, idFromRouter]);\n\n  async function resolveClientFromMachine(\n    machineRef,\n    setClient,\n    setMachine,\n    isFrom = true\n  ) {\n    const machineDoc = await machineRef.get();\n    if (machineDoc.exists) {\n      const machineData = machineDoc.data();\n      setMachine({ id: machineDoc.id, ...machineData });\n\n      // Determine if the machine is \"interior socal\"\n      // const isSocalInterior = machineData.name && machineData.name.toLowerCase() === \"interior socal\";\n      // if (isSocalInterior) {\n      //   if (isFrom) {\n      //     setShowLocalLocFrom(true);\n      //   } else {\n      //     setShowLocalLocCurrent(true);\n      //   }\n      // } else {\n      // Optionally clear the flag if it is not \"interior socal\"\n      // if (isFrom) {\n      //   setShowLocalLocFrom(false);\n      // } else {\n      //   setShowLocalLocCurrent(false);\n      // }\n      // }\n      // new: fetch client name and combine both checks\n      const clientDoc =\n        machineData.client && typeof machineData.client.get === \"function\"\n          ? await machineData.client.get()\n          : null;\n      const clientName =\n        clientDoc && clientDoc.exists ? clientDoc.data().name : null;\n      const isSocalInterior =\n        machineData.name?.toLowerCase() === \"interior socal\";\n      const shouldShow = isSocalInterior || clientName === \"SoCalWarehouse\";\n\n      if (isFrom) {\n        setShowLocalLocFrom(shouldShow);\n      } else {\n        setShowLocalLocCurrent(shouldShow);\n      }\n\n      if (machineData.client && typeof machineData.client.get === \"function\") {\n        const clientDoc = await machineData.client.get();\n        if (clientDoc.exists) {\n          setClient({ id: clientDoc.id, ...clientDoc.data() });\n        }\n      }\n    }\n  }\n\n  const fetchData = async () => {\n    const id = initialItem?.id || idFromRouter; // <- make sure id exists here\n    const db = firebase.firestore();\n    const doc = await db.collection(\"Test\").doc(id).get();\n    if (doc.exists) {\n      console.log(\"test\");\n      const data = doc.data();\n      const normalizedPN = Array.isArray(data.pn) ? data.pn : [data.pn];\n      const normalizedSN = Array.isArray(data.sn) ? data.sn : [data.sn];\n      setItems({\n        ...data,\n        pn: normalizedPN,\n        sn: normalizedSN,\n      });\n      setDescriptions(data.descriptions || []);\n      setWorkOrders(data.workOrders || []);\n      if (data.localLocFrom) setLocalLocFrom(data.localLocFrom);\n      if (data.localLocCurrent) setLocalLocCurrent(data.localLocCurrent);\n      if (data.DOM) {\n        setDOM(data.DOM);\n      }\n\n      // …after you do setItems, setDescriptions, etc.\n\n      // load the “newLocal” maps\n      if (data.newLocalFrom) setNewLocalFrom(data.newLocalFrom);\n      if (data.newLocalCurrent) setNewLocalCurrent(data.newLocalCurrent);\n\n      // Load PO Number if it exists.\n      if (data.poNumber) {\n        setItems((prev) => ({ ...prev, poNumber: data.poNumber }));\n      }\n\n      if (data.ClientFrom) {\n        const clientFromDoc = await data.ClientFrom.get();\n        if (clientFromDoc.exists) {\n          setSelectedClientFrom({\n            id: clientFromDoc.id,\n            ...clientFromDoc.data(),\n          });\n        }\n      }\n      if (data.ClientCurrent) {\n        const clientCurrentDoc = await data.ClientCurrent.get();\n        if (clientCurrentDoc.exists) {\n          setSelectedClientCurrent({\n            id: clientCurrentDoc.id,\n            ...clientCurrentDoc.data(),\n          });\n        }\n      }\n\n      if (\n        !data.ClientFrom &&\n        data.Machine &&\n        typeof data.Machine.get === \"function\"\n      ) {\n        console.log(\n          \"Entered resolveClientFromMachine for Machine (old style for From)\"\n        );\n        await resolveClientFromMachine(\n          data.Machine,\n          setSelectedClientFrom,\n          setSelectedMachine,\n          true\n        );\n      }\n      if (\n        !data.ClientCurrent &&\n        data.CurrentMachine &&\n        typeof data.CurrentMachine.get === \"function\"\n      ) {\n        console.log(\n          \"Entered resolveClientFromMachine for CurrentMachine (old style for Current)\"\n        );\n        await resolveClientFromMachine(\n          data.CurrentMachine,\n          setSelectedClientCurrent,\n          setSelectedCurrentMachine,\n          false\n        );\n      }\n\n      let machineFromData = null;\n      let machineCurrentData = null;\n\n      if (data.MachineFrom) {\n        const doc = await data.MachineFrom.get();\n        machineFromData = doc.exists ? doc.data() : null;\n        setSelectedMachine({ id: doc.id, ...doc.data() });\n      }\n      if (data.MachineCurrent) {\n        const doc = await data.MachineCurrent.get();\n        machineCurrentData = doc.exists ? doc.data() : null;\n        setSelectedCurrentMachine({ id: doc.id, ...doc.data() });\n      }\n      const nameFrom = machineFromData?.name?.toLowerCase();\n      const nameCurrent = machineCurrentData?.name?.toLowerCase();\n\n      // If the machine’s name is “interior socal”, show that branch:\n      // setShowLocalLocFrom(nameFrom === \"interior socal\");\n      // // Or if your Firestore already has a value for localLocFrom, show it anyway:\n      // if (data.localLocFrom) setShowLocalLocFrom(true);\n\n      // setShowLocalLocCurrent(nameCurrent === \"interior socal\");\n      // if (data.localLocCurrent) setShowLocalLocCurrent(true);\n      // new: combine machine-name OR client-name check, keep existing-data\n      setShowLocalLocFrom(\n        nameFrom === \"interior socal\" ||\n          selectedClientFrom?.name?.toLowerCase() === \"socalwarehouse\" ||\n          Boolean(data.localLocFrom)\n      );\n      setShowLocalLocCurrent(\n        nameCurrent === \"interior socal\" ||\n          selectedClientCurrent?.name?.toLowerCase() === \"socalwarehouse\" ||\n          Boolean(data.localLocCurrent)\n      );\n\n      const theMachineData = data.TheMachine || null;\n\n      setTheMachine(theMachineData);\n      if (theMachineData) {\n        // pull both variants, prefer lowercase if it exists\n        const OEM = theMachineData.oem ?? theMachineData.OEM;\n        const Modality = theMachineData.modality ?? theMachineData.Modality;\n        const Model = theMachineData.model ?? theMachineData.Model;\n        setTheMachine({ ...theMachineData, OEM, Modality, Model });\n      }\n      // setStoredMachine(theMachineData);\n\n      // **right here** merge from the three sources you just fetched:\n      const merged = updateMachineFields(\n        theMachineData,\n        machineCurrentData,\n        machineFromData\n      );\n      setOem(merged.oem);\n      setModality(merged.modality);\n      setModel(merged.model);\n\n      console.log(\n        \"SelectedMachine:\",\n        selectedMachine,\n        \"SelectedCurrentMachine:\",\n        selectedCurrentMachine\n      );\n      // Show local loc inputs if applicable\n      // if (\n      //   selectedMachine &&\n      //   selectedMachine.name &&\n      //   selectedMachine.name.toLowerCase() === \"interior socal\"\n      // ) {\n      //   setShowLocalLocFrom(true);\n      // }\n      // if (\n      //   selectedCurrentMachine &&\n      //   selectedCurrentMachine.name &&\n      //   selectedCurrentMachine.name.toLowerCase() === \"interior socal\"\n      // ) {\n      //   setShowLocalLocCurrent(true);\n      // }\n\n      if (data.Parent) {\n        const parentDoc = await data.Parent.get();\n        setSelectedParent({ id: parentDoc.id, ...parentDoc.data() });\n      }\n\n      // Priority auto‑population of machine fields.\n      // const updatedFields = updateMachineFields(storedMachine, selectedCurrentMachine, selectedMachine);\n      // // console.log(\"Updated machine fields:\", updatedFields);\n      // setOem(updatedFields.oem);\n      // setModality(updatedFields.modality);\n      // setModel(updatedFields.model);\n\n      await fetchPhotos(id);\n      await checkIfAddedToWebsite(id);\n      await calculateItemFrequencyAndUsage(data.pn);\n    } else {\n      router.push({\n        pathname: \"../AddItem/NewItem\",\n        query: { signal: id },\n      });\n    }\n  };\n\n  // Returns the value for a given field from the highest-priority source.\n  function getPriorityMachineField(\n    field,\n    theMachine,\n    currentMachine,\n    fromMachine\n  ) {\n    console.log(\"the machine: \", theMachine, \"field: \", field);\n    if (\n      theMachine &&\n      theMachine[field] &&\n      theMachine[field] !== \"N/A\" &&\n      theMachine[field].trim() !== \"\"\n    ) {\n      return theMachine[field];\n    }\n    if (\n      currentMachine &&\n      currentMachine[field] &&\n      currentMachine[field] !== \"N/A\" &&\n      currentMachine[field].trim() !== \"\"\n    ) {\n      return currentMachine[field];\n    }\n    if (\n      fromMachine &&\n      fromMachine[field] &&\n      fromMachine[field] !== \"N/A\" &&\n      fromMachine[field].trim() !== \"\"\n    ) {\n      return fromMachine[field];\n    }\n    return \"\";\n  }\n\n  // Returns an object with updated OEM, modality, and model fields.\n  function updateMachineFields(theMachine, currentMachine, fromMachine) {\n    return {\n      oem: getPriorityMachineField(\n        \"OEM\",\n        theMachine,\n        currentMachine,\n        fromMachine\n      ),\n      modality: getPriorityMachineField(\n        \"Modality\",\n        theMachine,\n        currentMachine,\n        fromMachine\n      ),\n      model: getPriorityMachineField(\n        \"Model\",\n        theMachine,\n        currentMachine,\n        fromMachine\n      ),\n    };\n  }\n\n  const calculateItemFrequencyAndUsage = async (pn) => {\n    const db = firebase.firestore();\n    const currentDate = new Date();\n    const oneYearAgo = new Date();\n    oneYearAgo.setFullYear(currentDate.getFullYear() - 1);\n\n    const normalizedPN = pn !== undefined ? pn : \"\";\n    const itemsSnapshot = await db\n      .collection(\"Test\")\n      .where(\"pn\", \"==\", normalizedPN)\n      .get();\n\n    setFreqItem(itemsSnapshot.size);\n\n    let usagePastYear = 0;\n    itemsSnapshot.forEach((doc) => {\n      const itemData = doc.data();\n      itemData.workOrders.forEach((workOrder) => {\n        const workOrderDate = new Date(workOrder.date);\n        if (workOrderDate >= oneYearAgo && workOrderDate <= currentDate) {\n          usagePastYear++;\n        }\n      });\n    });\n    setUsagePastYear(usagePastYear);\n  };\n\n  const fetchMachine = async (machineId) => {\n    const db = firebase.firestore();\n    const doc = await db.collection(\"Machine\").doc(machineId).get();\n    if (doc.exists) {\n      const machineData = doc.data();\n      setTheMachine(machineData);\n      // re-merge all three sources with correct priority:\n      const merged = updateMachineFields(\n        machineData,\n        selectedCurrentMachine,\n        selectedMachine\n      );\n      setOem(merged.oem);\n      setModality(merged.modality);\n      setModel(merged.model);\n      const machinesSnapshot = await db\n        .collection(\"Machine\")\n        .where(\"Model\", \"==\", machineData.Model || machineData.model)\n        .get();\n      setMachineFrequency(machinesSnapshot.size);\n    } else {\n      console.error(\"Machine not found\");\n    }\n  };\n\n  const fetchPhotos = async (docID) => {\n    const storageRef = firebase.storage().ref();\n    const listRef = storageRef.child(`Parts/${docID}`);\n    try {\n      const res = await listRef.listAll();\n      const urls = await Promise.all(\n        res.items.map((item) => item.getDownloadURL())\n      );\n      console.log(\"Fetched photo URLs:\", urls);\n      setPhotos(urls.map((url) => ({ url, file: null })));\n    } catch (error) {\n      console.error(\"Error fetching photos: \", error);\n    }\n  };\n\n  const checkIfAddedToWebsite = async (docID) => {\n    const db = firebase.firestore();\n    const partsDoc = await db.collection(\"Parts\").doc(docID).get();\n    if (partsDoc.exists) {\n      setAddToWebsite(true);\n    }\n  };\n\n  const handleClose = () => setShow(false);\n  const handleShow = () => setShow(true);\n  const handleCloseErr = () => setShowErr(false);\n  const handleShowErr = () => setShowErr(true);\n  const handleCloseSaveModal = () => setShowSaveModal(false);\n  const handleClosePrintModal = () => setShowPrintModal(false);\n  const handleShowSaveModal = () => setShowSaveModal(true);\n  const handleShowPrintModal = () => setShowPrintModal(true);\n  const handleMachineSelectionModal = () => setMachineSelectionModal(false);\n  const handleCloseDescModal = () => setShowDescModal(false);\n  const handleShowDescModal = () => setShowDescModal(true);\n  const handleCloseWoModal = () => setShowWoModal(false);\n  const handleShowWoModal = () => setShowWoModal(true);\n  const handleCloseClientModal = () => setShowClientModal(false);\n  const handleShowClientModal = () => setShowClientModal(true);\n  const handleCloseMachineModal = () => setShowMachineModal(false);\n  const handleShowMachineModal = () => {\n    setShowMachineModal(true);\n    setShowClientModal(false);\n  };\n  const handleCloseParentModal = () => setShowParentModal(false);\n  const handleShowParentModal = () => setShowParentModal(true);\n\n  // When a client is selected from the client table.\n  const handleClientInfo = async (clientId) => {\n    // Clear any previously selected machine and local loc info for this branch.\n    if (machinePick) {\n      setSelectedMachine(null);\n      setShowLocalLocFrom(false);\n    } else {\n      setSelectedCurrentMachine(null);\n      setShowLocalLocCurrent(false);\n    }\n\n    const db = firebase.firestore();\n    const clientDoc = await db.collection(\"Client\").doc(clientId).get();\n    if (clientDoc.exists) {\n      const clientData = { id: clientDoc.id, ...clientDoc.data() };\n      if (machinePick) {\n        setSelectedClientFrom(clientData);\n      } else {\n        setSelectedClientCurrent(clientData);\n      }\n      // after setting selectedClientFrom/Current:\n      if (clientData.name === \"SoCalWarehouse\") {\n        if (machinePick) setShowLocalLocFrom(true);\n        else setShowLocalLocCurrent(true);\n      }\n      // Fetch machines for this client:\n      const machinePromises = clientData.machines.map((machineRef) =>\n        machineRef.get()\n      );\n      const machineDocs = await Promise.all(machinePromises);\n      const machines = machineDocs.map((machineDoc) => ({\n        id: machineDoc.id,\n        ...machineDoc.data(),\n      }));\n      setMachineOptions(machines);\n      // Close the client modal\n      handleCloseClientModal();\n    }\n  };\n\n  // Reordering function for dropdowns.\n  const reorderArray = (arr, selectedValue) => {\n    const newArr = arr.filter((val) => val !== selectedValue);\n    return [selectedValue, ...newArr];\n  };\n\n  const [addingNewPn, setAddingNewPn] = useState(false);\n  const [newPn, setNewPn] = useState(\"\");\n  const [addingNewSn, setAddingNewSn] = useState(false);\n  const [newSn, setNewSn] = useState(\"\");\n\n  const handlePnSelect = (e) => {\n    const selected = e.target.value;\n    setItems((prev) => {\n      let updatedPn = Array.isArray(prev.pn) ? [...prev.pn] : [];\n      updatedPn[0] = selected;\n      return { ...prev, pn: updatedPn };\n    });\n  };\n\n  const handleSnSelect = (e) => {\n    const selected = e.target.value;\n    setItems((prev) => {\n      let updatedSn = Array.isArray(prev.sn) ? [...prev.sn] : [];\n      updatedSn[0] = selected;\n      return { ...prev, sn: updatedSn };\n    });\n  };\n\n  const handleAddNewPn = () => {\n    if (newPn.trim() !== \"\") {\n      setItems((prev) => ({\n        ...prev,\n        pn: [...prev.pn, newPn.trim()],\n      }));\n    }\n    setNewPn(\"\");\n    setAddingNewPn(false);\n  };\n\n  const handleAddNewSn = () => {\n    if (newSn.trim() !== \"\") {\n      setItems((prev) => ({\n        ...prev,\n        sn: [...prev.sn, newSn.trim()],\n      }));\n    }\n    setNewSn(\"\");\n    setAddingNewSn(false);\n  };\n\n  // Generate custom document ID if needed.\n  const generateCustomID = () => {\n    const randomNum = Math.floor(10000 + Math.random() * 90000);\n    return `AIS${randomNum}`;\n  };\n\n  function shallowClean(obj) {\n    const newObj = {};\n    for (const key in obj) {\n      console.log(key, obj[key]);\n      if (obj.hasOwnProperty(key)) {\n        newObj[key] = obj[key] === undefined ? \"\" : obj[key];\n      }\n    }\n    return newObj;\n  }\n\n  async function toSend() {\n    const db = firebase.firestore();\n    const currentUser = firebase.auth().currentUser;\n    const userEmail = currentUser ? currentUser.email : \"unknown\";\n\n    // Always use the current state values for OEM, modality, and model.\n    const machineData = {\n      ...(TheMachine || {}),\n      oem: oem,\n      modality: modality,\n      model: model,\n    };\n\n    const formattedItems = { ...items, descriptions, workOrders };\n    // Remove any unused fields.\n    formattedItems.status = items.status || \"\";\n    formattedItems.DOM = DOM; // Date of Manufacture\n    formattedItems.localLocFrom = localLocFrom || \"\";\n    formattedItems.localLocCurrent = localLocCurrent || \"\";\n    formattedItems.date = items.date || \"\";\n    formattedItems.arrival_date = items.arrival_date || \"\"; // NEW: Arrival Date\n    formattedItems.poNumber = items.poNumber || \"\";\n    formattedItems.trackingNumber = items.trackingNumber || \"\";\n    formattedItems.TheMachine = machineData || {};\n    formattedItems.addedToWebsite = addToWebsite;\n\n    // NEW: Add the user's email under the field \"user\"\n    formattedItems.lastEdited = userEmail;\n\n    // Clean pn and sn arrays to replace undefined values with an empty string.\n    formattedItems.pn = (items.pn || []).map((value) =>\n      value === undefined ? \"\" : value\n    );\n    formattedItems.sn = (items.sn || []).map((value) =>\n      value === undefined ? \"\" : value\n    );\n\n    const fromDetails = buildLocalLocObject(newLocalFrom);\n    const currentDetails = buildLocalLocObject(newLocalCurrent);\n\n    console.log(\n      \"From Details: \" +\n        fromDetails.region +\n        \" \" +\n        fromDetails.section?.letter +\n        fromDetails.section?.number +\n        \" \" +\n        fromDetails.bin +\n        \" \" +\n        fromDetails.pallet\n    );\n    console.log(\n      \"Current Details: \" +\n        currentDetails.region +\n        \" \" +\n        currentDetails.section?.letter +\n        currentDetails.section?.number +\n        \" \" +\n        currentDetails.bin +\n        \" \" +\n        currentDetails.pallet\n    );\n\n    if (Object.keys(fromDetails).length) {\n      formattedItems.newLocalFrom = fromDetails;\n      formattedItems.localLocFrom = formatLoc(newLocalFrom) || \"\";\n    } else {\n      // all fields empty — force an empty string and remove any stray map\n      console.log(\"entered empty fromDetails else\");\n      formattedItems.localLocFrom = \"\";\n      formattedItems.newLocalFrom = {};\n    }\n\n    if (Object.keys(currentDetails).length) {\n      formattedItems.newLocalCurrent = currentDetails;\n      formattedItems.localLocCurrent = formatLoc(newLocalCurrent) || \"\";\n    } else {\n      // all fields empty — force an empty string and remove any stray map\n      formattedItems.localLocCurrent = \"\";\n      formattedItems.newLocalCurrent = {};\n    }\n\n    if (selectedMachine && selectedMachine.id) {\n      formattedItems.MachineFrom = db\n        .collection(\"Machine\")\n        .doc(selectedMachine.id);\n    }\n\n    if (selectedCurrentMachine && selectedCurrentMachine.id) {\n      formattedItems.MachineCurrent = db\n        .collection(\"Machine\")\n        .doc(selectedCurrentMachine.id);\n    }\n\n    if (selectedParent && selectedParent.id) {\n      formattedItems.Parent = db.collection(\"Test\").doc(selectedParent.id);\n    }\n\n    // NEW: Set separate client references.\n    if (selectedClientFrom && selectedClientFrom.id) {\n      formattedItems.ClientFrom = db\n        .collection(\"Client\")\n        .doc(selectedClientFrom.id);\n    }\n    if (selectedClientCurrent && selectedClientCurrent.id) {\n      formattedItems.ClientCurrent = db\n        .collection(\"Client\")\n        .doc(selectedClientCurrent.id);\n    }\n\n    // Only attach the richer “newLocal” map when the user actually filled something in\n    if (Object.keys(fromDetails).length) {\n      formattedItems.newLocalFrom = fromDetails;\n    }\n    if (Object.keys(currentDetails).length) {\n      formattedItems.newLocalCurrent = currentDetails;\n    }\n\n    let docId = id;\n    try {\n      if (docId) {\n        // Check if a localSN is provided and if it differs from the current docId.\n        const newDocId =\n          items.localSN && items.localSN.trim() !== \"\"\n            ? items.localSN.trim()\n            : docId;\n        if (docId !== newDocId) {\n          // Migrate: Create a new document with the newDocId.\n          await db.collection(\"Test\").doc(newDocId).set(formattedItems);\n\n          if (selectedMachine && selectedMachine.id) {\n            const machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\n            const machineDoc = await machineRef.get();\n            if (machineDoc.exists) {\n              await machineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(\n                  db.collection(\"Test\").doc(newDocId)\n                ),\n              });\n            }\n          }\n\n          if (selectedCurrentMachine && selectedCurrentMachine.id) {\n            const currentMachineRef = db\n              .collection(\"Machine\")\n              .doc(selectedCurrentMachine.id);\n            const currentMachineDoc = await currentMachineRef.get();\n            if (currentMachineDoc.exists) {\n              await currentMachineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(\n                  db.collection(\"Test\").doc(newDocId)\n                ),\n              });\n            }\n          }\n          // Delete the old document.\n          await db.collection(\"Test\").doc(docId).delete();\n          // Set docId to the new document ID.\n          docId = newDocId;\n        } else {\n          // Deep-clean the formattedItems to remove any undefined nested values.\n          const cleanFormattedItems = shallowClean(formattedItems);\n          await db.collection(\"Test\").doc(docId).update(cleanFormattedItems);\n\n          if (selectedMachine && selectedMachine.id) {\n            const machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\n            const machineDoc = await machineRef.get();\n            if (machineDoc.exists) {\n              await machineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(\n                  db.collection(\"Test\").doc(docId)\n                ),\n              });\n            }\n          }\n\n          if (selectedCurrentMachine && selectedCurrentMachine.id) {\n            const currentMachineRef = db\n              .collection(\"Machine\")\n              .doc(selectedCurrentMachine.id);\n            const currentMachineDoc = await currentMachineRef.get();\n            if (currentMachineDoc.exists) {\n              await currentMachineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(\n                  db.collection(\"Test\").doc(docId)\n                ),\n              });\n            }\n          }\n        }\n      } else {\n        // For a new item, if localSN is provided, use it; otherwise, generate a custom ID.\n        docId =\n          items.localSN && items.localSN.trim() !== \"\"\n            ? items.localSN.trim()\n            : generateCustomID();\n        await db.collection(\"Test\").doc(docId).set(formattedItems);\n\n        if (selectedMachine && selectedMachine.id) {\n          const machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\n          const machineDoc = await machineRef.get();\n          if (machineDoc.exists) {\n            await machineRef.update({\n              associatedParts: firebase.firestore.FieldValue.arrayUnion(\n                db.collection(\"Test\").doc(docId)\n              ),\n            });\n          }\n        }\n\n        if (selectedCurrentMachine && selectedCurrentMachine.id) {\n          const currentMachineRef = db\n            .collection(\"Machine\")\n            .doc(selectedCurrentMachine.id);\n          const currentMachineDoc = await currentMachineRef.get();\n          if (currentMachineDoc.exists) {\n            await currentMachineRef.update({\n              associatedParts: firebase.firestore.FieldValue.arrayUnion(\n                db.collection(\"Test\").doc(docId)\n              ),\n            });\n          }\n        }\n      }\n      // Upload any new photos to Firebase Storage.\n      await uploadPhotos(docId);\n      console.log(\"Item saved and associatedParts updated!\");\n\n      // Redirect to the new URL using the new document id.\n      router.push(`/NewSearch/item/${docId}`);\n\n      // Optionally, you can also show a save confirmation modal:\n      handleShowSaveModal();\n    } catch (error) {\n      console.error(\"Error saving data:\", error);\n    }\n  }\n\n  // Additional state for local warehouse location inputs.\n  const [showLocalLocFrom, setShowLocalLocFrom] = useState(false);\n  const [showLocalLocCurrent, setShowLocalLocCurrent] = useState(false);\n\n  // When a machine is selected from the modal.\n  const handleSetSelectedMachine = (machine) => {\n    // const condition = (name) => name && name.toLowerCase() === \"interior socal\";\n    const isSocalInterior = machine.name?.toLowerCase() === \"interior socal\";\n\n    if (machinePick) {\n      setSelectedMachine({ id: machine.id, name: machine.name });\n      setShowLocalLocFrom(\n        isSocalInterior ||\n          selectedClientFrom?.name?.toLowerCase() === \"socalwarehouse\"\n      );\n    } else {\n      setSelectedCurrentMachine({ id: machine.id, name: machine.name });\n      setShowLocalLocCurrent(\n        isSocalInterior ||\n          selectedClientCurrent?.name?.toLowerCase() === \"socalwarehouse\"\n      );\n    }\n    fetchMachine(machine.id);\n    // Close the machine modal (assuming you're using showMachineModal to control it)\n    setShowMachineModal(false);\n  };\n\n  const uploadPhotos = async (docID) => {\n    const storageRef = firebase.storage().ref();\n    for (let i = 0; i < photos.length; i++) {\n      if (photos[i].file) {\n        const photoRef = storageRef.child(\n          `Parts/${docID}/${docID}${i === 0 ? \".jpg\" : `.${i + 1}.jpg`}`\n        );\n        const metadata = {\n          contentType: \"image/png\",\n        };\n        await photoRef.put(photos[i].file, metadata);\n        const url = await photoRef.getDownloadURL();\n        photos[i].url = url;\n      }\n    }\n  };\n\n  // Function to handle printing the label.\n  const handlePrint = async () => {\n    if (!items.name) {\n      alert(\"Missing name\");\n      return;\n    }\n\n    let clientName = \"\";\n\n    // Attempt to fetch client name from the Machine document reference.\n    if (items.Machine && typeof items.Machine.get === \"function\") {\n      try {\n        const machineDoc = await items.Machine.get();\n        if (machineDoc.exists) {\n          const machineData = machineDoc.data();\n          if (\n            machineData.client &&\n            typeof machineData.client.get === \"function\"\n          ) {\n            const clientDoc = await machineData.client.get();\n            if (clientDoc.exists) {\n              clientName = clientDoc.data().name || \"\";\n            }\n          }\n        }\n      } catch (error) {\n        console.error(\"Error fetching machine or client:\", error);\n      }\n    } else {\n      console.warn(\"No Machine reference available in the item\");\n    }\n    console.log(clientName, \":\", items.client);\n    // Fallback: if no client name was found, check items.client.\n    if (!clientName && items.client) {\n      if (typeof items.client.get === \"function\") {\n        try {\n          const clientDoc = await items.client.get();\n          if (clientDoc.exists) {\n            clientName = clientDoc.data().name || \"\";\n          }\n        } catch (error) {\n          console.error(\"Error fetching client from items.client:\", error);\n        }\n      } else {\n        clientName = items.client;\n      }\n    }\n    console.log(\"descriptions:\", descriptions[selectedDesc]);\n    const payload = {\n      name: items.name,\n      pn: items.pn,\n      sn: items.sn,\n      wo: workOrders && workOrders.length > 0 ? workOrders[0].workOrder : \"\",\n      client: clientName,\n      status: items.status,\n      local_sn: id,\n      descriptions: [\n        descriptions[selectedDesc] || { description: \"\", date: \"\" },\n      ],\n      date: items.dateCreated || \"\",\n      DOM: DOM,\n      oem: oem,\n      modality: modality,\n      model: model,\n      poNumber: items.poNumber,\n      arrival_date: items.arrival_date, // NEW: Include arrival_date\n    };\n\n    console.log(\"Payload for printing:\", payload);\n    try {\n      const response = await fetch(\n        \"https://9d70-174-76-22-138.ngrok-free.app/print-label\",\n        {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(payload),\n        }\n      );\n      const result = await response.json();\n      console.log(\"Print result:\", result.status);\n\n      if (result.status.includes(\"successfully.\")) {\n        handleShowPrintModal();\n      } else {\n        console.error(\"Error printing label:\", result.error);\n      }\n    } catch (error) {\n      console.error(\"Error printing label:\", error);\n    }\n  };\n\n  async function handleSubmit(event) {\n    event.preventDefault();\n    // Only check that the Name field is filled out.\n    if (!items.name) {\n      handleShow(); // This shows the \"missing field\" modal.\n    } else {\n      toSend();\n    }\n  }\n\n  // Handlers for input changes.\n  const handleChange = (field) => (event) => {\n    const value = event.target ? event.target.value : event.value;\n    setItems((prevItems) => ({ ...prevItems, [field]: value }));\n  };\n\n  const addDescription = () => {\n    setDescriptions([...descriptions, { description: \"\", date: \"\" }]);\n  };\n\n  const removeDescription = (index) => {\n    setDescriptions(descriptions.filter((_, i) => i !== index));\n  };\n\n  const handleDescriptionChange = (index, field, value) => {\n    const newDescriptions = descriptions.map((desc, i) =>\n      i === index ? { ...desc, [field]: value } : desc\n    );\n    setDescriptions(newDescriptions);\n  };\n\n  const addWorkOrder = () => {\n    setWorkOrders([...workOrders, { workOrder: \"\", date: \"\" }]);\n  };\n\n  const removeWorkOrder = (index) => {\n    setWorkOrders(workOrders.filter((_, i) => i !== index));\n  };\n\n  const handleWorkOrderChange = (index, field, value) => {\n    const newWorkOrders = workOrders.map((wo, i) =>\n      i === index ? { ...wo, [field]: value } : wo\n    );\n    setWorkOrders(newWorkOrders);\n  };\n\n  const listDescriptions = () => {\n    setShowDescModal(true);\n  };\n\n  const selectDescription = (index) => {\n    setSelectedDesc(index);\n    setShowDescModal(false);\n  };\n\n  const handleShowCameraModal = () => {\n    setShowCameraModal(true);\n  };\n\n  const handleCloseCameraModal = () => {\n    setShowCameraModal(false);\n    setCapturedPhoto(null);\n  };\n\n  const handleCapture = (err, result) => {\n    if (result) {\n      setCapturedPhoto(result);\n    }\n  };\n\n  const savePhoto = () => {\n    setPhotos((prevPhotos) => [\n      ...prevPhotos,\n      { file: capturedPhoto, url: URL.createObjectURL(capturedPhoto) },\n    ]);\n    setCapturedPhoto(null);\n    handleCloseCameraModal();\n  };\n\n  const removePhoto = (index) => {\n    setPhotos(photos.filter((_, i) => i !== index));\n  };\n\n  const mostRecentWorkOrder =\n    workOrders && workOrders.length > 0\n      ? workOrders.reduce((latest, current) => {\n          const latestDate = new Date(latest.date);\n          const currentDate = new Date(current.date);\n          return currentDate > latestDate ? current : latest;\n        }, workOrders[0])\n      : {};\n\n  const capturePhoto = () => {\n    const video = document.querySelector(\"video\");\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    const context = canvas.getContext(\"2d\");\n    context.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob((blob) => {\n      setCapturedPhoto(blob);\n    }, \"image/png\");\n  };\n\n  const handleShowInfoModal = async () => {\n    const db = firebase.firestore();\n    try {\n      const doc = await db.collection(\"Test\").doc(id).get();\n      if (doc.exists) {\n        const data = doc.data();\n        setItemName(data.name || \"N/A\");\n        setShowInfoModal(true);\n      } else {\n        console.error(\"Item not found\");\n      }\n    } catch (error) {\n      console.error(\"Error fetching item info:\", error);\n    }\n  };\n\n  const handleCloseInfoModal = () => setShowInfoModal(false);\n\n  const handlePnChange = (index, value) => {\n    setItems((prev) => {\n      const newPn = [...prev.pn];\n      newPn[index] = value;\n      return { ...prev, pn: newPn };\n    });\n  };\n\n  const addPn = () => {\n    setItems((prev) => ({\n      ...prev,\n      pn: [...prev.pn, \"\"],\n    }));\n  };\n\n  const handleSnChange = (index, value) => {\n    setItems((prev) => {\n      const newSn = [...prev.sn];\n      newSn[index] = value;\n      return { ...prev, sn: newSn };\n    });\n  };\n\n  const addSn = () => {\n    setItems((prev) => ({\n      ...prev,\n      sn: [...prev.sn, \"\"],\n    }));\n  };\n\n  const browseInputRef = useRef(null);\n\n  const handleBrowsePhotos = () => {\n    if (browseInputRef.current) {\n      browseInputRef.current.click();\n    }\n  };\n\n  const handleFilesSelected = (e) => {\n    const files = e.target.files;\n    if (files.length) {\n      const newPhotos = [];\n      for (let i = 0; i < files.length; i++) {\n        newPhotos.push({\n          file: files[i],\n          url: URL.createObjectURL(files[i]),\n        });\n      }\n      setPhotos((prevPhotos) => [...prevPhotos, ...newPhotos]);\n    }\n    e.target.value = \"\";\n  };\n\n  const [currentPnIndex, setCurrentPnIndex] = useState(0);\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [currentSnIndex, setCurrentSnIndex] = useState(0);\n  const [showSnDropdown, setShowSnDropdown] = useState(false);\n\n  const handleAddNewClient = () => {\n    const randomNum = Math.floor(10000 + Math.random() * 90000);\n    router.push(\n      `../client/AIS${randomNum}/addClient?from=item&itemId=${id || \"\"}`\n    );\n  };\n\n  const handleBluefolderButton = async () => {\n    // Check that the work order field is filled out (using workOrders[0].workOrder as current)\n    const currentWorkOrder =\n      workOrders && workOrders.length > 0 ? workOrders[0].workOrder : \"\";\n    if (!currentWorkOrder) {\n      alert(\n        \"Please fill out the work order field before adding to BlueFolder.\"\n      );\n      return;\n    }\n\n    // Build the payload to send to your proxy endpoint.\n    const payload = {\n      name: items.name,\n      pn: items.pn[0] || \"\",\n      sn: items.sn[0] || \"\",\n      status: items.status,\n      description: descriptions[selectedDesc]?.description || \"\",\n      workOrder: currentWorkOrder,\n      localsn: items.localSN || \"\",\n    };\n\n    try {\n      // Replace with your ngrok URL and appropriate endpoint path (e.g., /api/bluefolder)\n      const response = await fetch(\n        \"https://9d70-174-76-22-138.ngrok-free.app/bluefolder\",\n        {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(payload),\n        }\n      );\n      const result = await response.json();\n      alert(\"BlueFolder service item added successfully!\");\n      console.log(\"BlueFolder result:\", result);\n    } catch (error) {\n      console.error(\"BlueFolder error:\", error);\n      alert(\"Error adding data to BlueFolder.\");\n    }\n  };\n\n// // Slack integration handler.\n// const handleAddToSlack = async (which) => {\n//   try {\n//     const pn0 = Array.isArray(items.pn) ? items.pn[0] : items.pn;\n//     const sn0 = Array.isArray(items.sn) ? items.sn[0] : items.sn;\n\n//     const linkUrl = typeof window !== \"undefined\" ? window.location.href : \"\";\n//     const safeName = (items?.name || id || \"Untitled\").trim();\n//     const title = `${safeName}${id ? ` (${id})` : \"\"}`;\n\n//     console.log(\"[SLACK][handleAddToSlack] which:\", which);\n//     console.log(\"[SLACK] title:\", title);\n//     console.log(\"[SLACK] PN:\", items.pn, \"SN:\", items.sn);\n\n//     const resp = await fetch(\"/api/slack/add-to-list\", {\n//       method: \"POST\",\n//       headers: { \"Content-Type\": \"application/json\" },\n//       body: JSON.stringify({\n//         listKey: which,      // \"shipping\" | \"receiving\" | \"tasks\"\n//         title,\n//         pn: items.pn,\n//         sn: items.sn,\n//         // keeping it minimal by design while we stabilize PN/SN\n//         linkUrl,\n//       }),\n//     });\n// Slack integration handler (drop-in replacement)\n// Slack integration handler (drop-in replacement)\n\n\n// Add this to your item page component scope\n// Assumes you already have: items, workOrders, descriptions, selectedDesc, id (item doc id)\nconst handleAddToSlack = async (which = \"shipping\") => {\n  try {\n    // Prefer arrays’ first element if pn/sn are arrays in your data\n    const pn0 = Array.isArray(items?.pn) ? items.pn[0] : items?.pn;\n    const sn0 = Array.isArray(items?.sn) ? items.sn[0] : items?.sn;\n\n    // Current page URL for quick jump-back from Slack\n    const linkUrl =\n      typeof window !== \"undefined\" ? window.location.href : \"\";\n\n    // Title: keep your working pattern (Name plus ID when present)\n    const safeName = (items?.name || id || \"Untitled\").trim();\n    const title = `${safeName}${id ? ` (${id})` : \"\"}`;\n\n    // Most recent work order (by date) from your existing state\n    const mostRecentWO =\n      (workOrders && workOrders.length > 0)\n        ? workOrders.reduce(\n            (latest, cur) =>\n              new Date(cur?.date || 0) > new Date(latest?.date || 0)\n                ? cur\n                : latest,\n            workOrders[0]\n          )\n        : { workOrder: \"\" };\n\n    // Description from the currently selected description row\n    const descVal = (selectedDesc != null && descriptions?.[selectedDesc])\n      ? (descriptions[selectedDesc].description || \"\")\n      : \"\";\n\n    // Shipping date mapping: arrival_date first, fall back to date\n    const shippingDate = items?.arrival_date || items?.date || \"\";\n\n    // Tracking: support either items.tracking or items.trackingNumber\n    const tracking = items?.tracking ?? items?.trackingNumber ?? \"\";\n\n    // Local SN is your item ID\n    const localSN = id || \"\";\n\n    // Build payload — keep what already works, add the rest\n    const body = {\n      listKey: which,          // \"shipping\" | \"receiving\" | \"tasks\"\n      title,                   // working\n      pn: pn0,                 // working\n      sn: sn0,                 // working\n      linkUrl,                 // optional link column if you have one\n\n      // NEW fields for the remaining columns (server auto-detects columns):\n      shippingDate,            // Shipping Date column\n      tracking,                // Tracking / WDIM column\n      workOrder: mostRecentWO?.workOrder || \"\",  // WO/SO Number column\n      localSN,                 // Local SN column\n      description: (descVal || \"\").trim(),       // Description column\n\n      // Parties logic: leave untouched (your server keeps it as-is if you already send it elsewhere)\n      // photoUrls: [] // optional — only if you want to dump image links as text\n    };\n\n    const resp = await fetch(\"/api/slack/add-to-list\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(body),\n    });\n\n    const json = await resp.json();\n    console.log(\"[SLACK][handleAddToSlack] response:\", json);\n\n    if (!resp.ok || !json?.ok) {\n      console.error(\"Slack add failed\", json);\n      alert(\"Failed to add to Slack List: \" + (json?.error || \"unknown error\"));\n      return;\n    }\n\n    alert(\n      `Added to Slack ${which === \"shipping\"\n        ? \"Shipping\"\n        : which === \"receiving\"\n        ? \"Receiving\"\n        : \"Tasks\"} list.`\n    );\n  } catch (e) {\n    console.error(e);\n    alert(\"Error adding to Slack\");\n  }\n};\n\n\n  return (\n    <LoggedIn>\n      <div>\n        <Modal show={show} onHide={handleClose}>\n          <Modal.Header closeButton>\n            <Modal.Title>Error</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>Missing field</Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"primary\" onClick={handleClose}>\n              Ok\n            </Button>\n          </Modal.Footer>\n        </Modal>\n        <Modal show={showErr} onHide={handleCloseErr}>\n          <Modal.Header closeButton>\n            <Modal.Title>Error</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>{Err}</Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"primary\" onClick={handleCloseErr}>\n              Ok\n            </Button>\n          </Modal.Footer>\n        </Modal>\n        <Modal show={showSaveModal} onHide={handleCloseSaveModal}>\n          <Modal.Header closeButton>\n            <Modal.Title>Save Confirmation</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>Data has been saved successfully.</Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"primary\" onClick={handleCloseSaveModal}>\n              Ok\n            </Button>\n          </Modal.Footer>\n        </Modal>\n        <Modal show={showPrintModal} onHide={handleClosePrintModal}>\n          <Modal.Header closeButton>\n            <Modal.Title>Print Confirmation</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>Info has been sent to print.</Modal.Body>\n          <Modal.Footer>\n            <Button variant=\"primary\" onClick={handleClosePrintModal}>\n              Ok\n            </Button>\n          </Modal.Footer>\n        </Modal>\n\n        <Modal show={showDescModal} onHide={handleCloseDescModal}>\n          <Modal.Header closeButton>\n            <Modal.Title>Descriptions</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <Button variant=\"primary\" className=\"mb-3\" onClick={addDescription}>\n              Add Description\n            </Button>\n            {descriptions.map((desc, index) => (\n              <Row key={index} className=\"mb-3\">\n                <Button\n                  variant=\"outline-secondary\"\n                  className=\"w-100\"\n                  onClick={() => selectDescription(index)}\n                  style={{ cursor: \"pointer\" }}\n                >\n                  <div className=\"d-flex justify-content-between\">\n                    <span>{desc.description || \"Description\"}</span>\n                    <span\n                      style={{\n                        borderLeft: \"1px solid #ccc\",\n                        paddingLeft: \"10px\",\n                      }}\n                    >\n                      {desc.date || \"Date\"}\n                    </span>\n                  </div>\n                </Button>\n              </Row>\n            ))}\n            <Button variant=\"primary\" onClick={handleCloseDescModal}>\n              OK\n            </Button>\n          </Modal.Body>\n        </Modal>\n\n        <Modal show={showWoModal} onHide={handleCloseWoModal}>\n          <Modal.Header closeButton>\n            <Modal.Title>Work Orders</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <Button\n              variant=\"primary\"\n              className=\"mb-3\"\n              onClick={addWorkOrder}\n              style={{ marginBottom: \"1rem\" }}\n            >\n              Add Work Order\n            </Button>\n            {workOrders.map((wo, index) => (\n              <Row key={index} className=\"mb-3\">\n                <Col>\n                  <Form.Control\n                    type=\"text\"\n                    placeholder=\"Work Order\"\n                    value={wo.workOrder}\n                    onChange={(e) =>\n                      handleWorkOrderChange(index, \"workOrder\", e.target.value)\n                    }\n                    style={{ marginBottom: \"0.5rem\" }}\n                  />\n                </Col>\n                <Col>\n                  <Form.Control\n                    type=\"date\"\n                    placeholder=\"Date\"\n                    value={wo.date}\n                    onChange={(e) =>\n                      handleWorkOrderChange(index, \"date\", e.target.value)\n                    }\n                  />\n                </Col>\n                <Col>\n                  <Button\n                    variant=\"danger\"\n                    onClick={() => removeWorkOrder(index)}\n                  >\n                    Remove\n                  </Button>\n                </Col>\n              </Row>\n            ))}\n            <Button variant=\"primary\" onClick={handleCloseWoModal}>\n              OK\n            </Button>\n          </Modal.Body>\n        </Modal>\n\n        <ClientInfoModal\n          show={showMachineModal}\n          handleClose={handleCloseMachineModal}\n          selectedClient={selectedClient}\n          machineOptions={machineOptions}\n          setSelectedMachine={handleSetSelectedMachine}\n        />\n\n        <Modal show={showClientModal} onHide={handleCloseClientModal}>\n          <Modal.Header closeButton>\n            <Modal.Title>Select Client</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <FormControl\n              type=\"text\"\n              placeholder=\"Search by name\"\n              className=\"mb-3\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n            />\n            <ClientTable\n              clients={clients.filter((client) =>\n                (client.name || \"\").toLowerCase().includes(search.toLowerCase())\n              )}\n              onSelectClient={handleClientInfo}\n              onInfoClick={handleClientInfo}\n              clearSelection={() => handleClientInfo(null)}\n              onAddClient={handleAddNewClient}\n            />\n          </Modal.Body>\n        </Modal>\n\n        <ParentModal\n          show={showParentModal}\n          handleClose={handleCloseParentModal}\n          setSelectedParent={setSelectedParent}\n        />\n\n        <MachineSelectionModal\n          show={machineSelectionModal}\n          handleClose={() => setMachineSelectionModal(false)}\n          setMachine={setTheMachine}\n        />\n\n        <Modal show={showCameraModal} onHide={handleCloseCameraModal}>\n          <Modal.Header closeButton>\n            <Modal.Title>Take a Photo</Modal.Title>\n          </Modal.Header>\n          <Modal.Body>\n            <div className=\"camera\">\n              {!capturedPhoto && (\n                <BarcodeScannerComponent\n                  width=\"100%\"\n                  height={300}\n                  onUpdate={handleCapture}\n                  facingMode={cameraFacing}\n                />\n              )}\n              {capturedPhoto && (\n                <div className=\"photo-preview\">\n                  <img\n                    src={URL.createObjectURL(capturedPhoto)}\n                    alt=\"captured\"\n                    style={{ width: \"100%\" }}\n                  />\n                </div>\n              )}\n            </div>\n          </Modal.Body>\n          <Modal.Footer>\n            {!capturedPhoto ? (\n              <>\n                <Button\n                  onClick={capturePhoto}\n                  style={{\n                    borderRadius: \"50%\",\n                    width: \"60px\",\n                    height: \"60px\",\n                    position: \"absolute\",\n                    left: \"50%\",\n                    transform: \"translateX(-50%)\",\n                    bottom: \"10px\",\n                  }}\n                >\n                  📷\n                </Button>\n                <Button\n                  onClick={() =>\n                    setCameraFacing((prev) =>\n                      prev === \"environment\" ? \"user\" : \"environment\"\n                    )\n                  }\n                >\n                  Flip Camera\n                </Button>\n                <Button variant=\"secondary\" onClick={handleCloseCameraModal}>\n                  Cancel\n                </Button>\n              </>\n            ) : (\n              <>\n                <Button\n                  variant=\"secondary\"\n                  onClick={() => setCapturedPhoto(null)}\n                >\n                  Retake\n                </Button>\n                <Button variant=\"primary\" onClick={savePhoto}>\n                  OK\n                </Button>\n              </>\n            )}\n          </Modal.Footer>\n        </Modal>\n\n        <InfoModal\n          show={showInfoModal}\n          handleClose={handleCloseInfoModal}\n          itemName={items.name}\n          dimensions={items.length + \",\" + items.width + \",\" + items.height}\n          price={items.price}\n          freqI={freqItem}\n          freqM={machineFrequency}\n          usage={usagePastYear}\n        />\n\n        <Container\n          className=\"d-flex align-items-center justify-content-center\"\n          style={{ minHeight: \"100vh\" }}\n        >\n          <div className=\"w-100\" style={{ maxWidth: \"600px\" }}>\n            <Card className=\"align-items-center justify-content-center\">\n              <Card.Body>\n                <h2 className=\"text-center mb-4\">Item</h2>\n                <Form onSubmit={handleSubmit}>\n                  {/* Row for Name and PN */}\n                  <Row className=\"mb-3\">\n                    <Col>\n                      <Form.Group controlId=\"name\">\n                        <Form.Label>Name</Form.Label>\n                        <Form.Control\n                          type=\"text\"\n                          value={items.name}\n                          onChange={handleChange(\"name\")}\n                        />\n                      </Form.Group>\n                    </Col>\n                    <Col>\n                      <Form.Group controlId=\"pn\">\n                        <Form.Label>Product Number</Form.Label>\n                        <div style={{ position: \"relative\" }}>\n                          <InputGroup>\n                            <Form.Control\n                              type=\"text\"\n                              value={items.pn[currentPnIndex] || \"\"}\n                              onChange={(e) =>\n                                handlePnChange(currentPnIndex, e.target.value)\n                              }\n                            />\n                            <Button\n                              variant=\"outline-secondary\"\n                              onClick={() => setShowDropdown(!showDropdown)}\n                            >\n                              &#9662;\n                            </Button>\n                            <InputGroup.Text>\n                              <Button\n                                variant=\"outline-secondary\"\n                                onClick={() => setAddingNewPn(true)}\n                              >\n                                +\n                              </Button>\n                            </InputGroup.Text>\n                          </InputGroup>\n                          {showDropdown && (\n                            <div\n                              style={{\n                                position: \"absolute\",\n                                top: \"100%\",\n                                left: 0,\n                                right: 0,\n                                backgroundColor: \"white\",\n                                border: \"1px solid #ccc\",\n                                zIndex: 1000,\n                                maxHeight: \"150px\",\n                                overflowY: \"auto\",\n                              }}\n                            >\n                              {pnOptions.map((pnOption, idx) => (\n                                <div\n                                  key={idx}\n                                  style={{ padding: \"8px\", cursor: \"pointer\" }}\n                                  onClick={() => {\n                                    setCurrentPnIndex(idx);\n                                    setShowDropdown(false);\n                                  }}\n                                >\n                                  {pnOption}\n                                </div>\n                              ))}\n                            </div>\n                          )}\n                        </div>\n                        {addingNewPn && (\n                          <Form.Control\n                            type=\"text\"\n                            placeholder=\"Enter new PN\"\n                            value={newPn}\n                            onChange={(e) => setNewPn(e.target.value)}\n                            onBlur={handleAddNewPn}\n                            onKeyDown={(e) =>\n                              e.key === \"Enter\" && handleAddNewPn()\n                            }\n                          />\n                        )}\n                      </Form.Group>\n                    </Col>\n                  </Row>\n                  {/* Row for SN and Status */}\n                  <Row className=\"mb-3\">\n                    <Col>\n                      <Form.Group controlId=\"sn\">\n                        <Form.Label>Serial Number</Form.Label>\n                        <div style={{ position: \"relative\" }}>\n                          <InputGroup>\n                            <Form.Control\n                              type=\"text\"\n                              value={items.sn[currentSnIndex] || \"\"}\n                              onChange={(e) =>\n                                handleSnChange(currentSnIndex, e.target.value)\n                              }\n                            />\n                            <Button\n                              variant=\"outline-secondary\"\n                              onClick={() => setShowSnDropdown(!showSnDropdown)}\n                            >\n                              &#9662;\n                            </Button>\n                            <InputGroup.Text>\n                              <Button\n                                variant=\"outline-secondary\"\n                                onClick={() => setAddingNewSn(true)}\n                              >\n                                +\n                              </Button>\n                            </InputGroup.Text>\n                          </InputGroup>\n                          {showSnDropdown && (\n                            <div\n                              style={{\n                                position: \"absolute\",\n                                top: \"100%\",\n                                left: 0,\n                                right: 0,\n                                backgroundColor: \"white\",\n                                border: \"1px solid #ccc\",\n                                zIndex: 1000,\n                                maxHeight: \"150px\",\n                                overflowY: \"auto\",\n                              }}\n                            >\n                              {snOptions.map((snOption, idx) => (\n                                <div\n                                  key={idx}\n                                  style={{ padding: \"8px\", cursor: \"pointer\" }}\n                                  onClick={() => {\n                                    setCurrentSnIndex(idx);\n                                    setShowSnDropdown(false);\n                                  }}\n                                >\n                                  {snOption}\n                                </div>\n                              ))}\n                            </div>\n                          )}\n                        </div>\n                        {addingNewSn && (\n                          <Form.Control\n                            type=\"text\"\n                            placeholder=\"Enter new SN\"\n                            value={newSn}\n                            onChange={(e) => setNewSn(e.target.value)}\n                            onBlur={handleAddNewSn}\n                            onKeyDown={(e) =>\n                              e.key === \"Enter\" && handleAddNewSn()\n                            }\n                          />\n                        )}\n                      </Form.Group>\n                    </Col>\n                    <Col>\n                      <Form.Group controlId=\"status\">\n                        <Form.Label>Status</Form.Label>\n                        <Form.Select\n                          value={items.status || \"\"}\n                          onChange={handleChange(\"status\")}\n                        >\n                          <option value=\"\">Select status</option>\n                          <option value=\"Good\">Good</option>\n                          <option value=\"Bad\">Bad</option>\n                          <option value=\"Unknown\">Unknown</option>\n                        </Form.Select>\n                      </Form.Group>\n                    </Col>\n                  </Row>\n                  {/* Row for OEM, Modality, Model */}\n                  <Row className=\"mb-3\">\n                    <Col>\n                      <Form.Label>OEM</Form.Label>\n                      <Form.Control\n                        type=\"text\"\n                        placeholder=\"OEM\"\n                        value={oem}\n                        onChange={(e) => setOem(e.target.value)}\n                      />\n                    </Col>\n                    <Col>\n                      <Form.Label>Modality</Form.Label>\n                      <Form.Control\n                        type=\"text\"\n                        placeholder=\"Modality\"\n                        value={modality}\n                        onChange={(e) => setModality(e.target.value)}\n                      />\n                    </Col>\n                    <Col>\n                      <Form.Label>Model</Form.Label>\n                      <Form.Control\n                        type=\"text\"\n                        placeholder=\"Model\"\n                        value={model}\n                        onChange={(e) => setModel(e.target.value)}\n                      />\n                    </Col>\n                  </Row>\n                  {/* Work Orders and Inline Description Section */}\n                  <div style={{ marginBottom: \"1rem\", marginTop: \"1rem\" }}>\n                    <div className=\"d-flex align-items-center\">\n                      <Button\n                        variant=\"outline-secondary\"\n                        onClick={handleShowWoModal}\n                        className=\"me-2\"\n                      >\n                        Manage Work Orders\n                      </Button>\n                      {workOrders.length > 0 && (\n                        <div className=\"d-flex flex-column align-items-start\">\n                          <Form.Label>Work Order</Form.Label>\n                          <Form.Control\n                            type=\"text\"\n                            placeholder=\"Most Recent Work Order\"\n                            value={mostRecentWorkOrder.workOrder}\n                            onChange={(e) =>\n                              handleWorkOrderChange(\n                                workOrders.indexOf(mostRecentWorkOrder),\n                                \"workOrder\",\n                                e.target.value\n                              )\n                            }\n                            style={{ marginBottom: \"0.5rem\" }}\n                          />\n                          <Form.Label>Date</Form.Label>\n                          <Form.Control\n                            type=\"date\"\n                            placeholder=\"Work Order Date\"\n                            value={mostRecentWorkOrder.date}\n                            onChange={(e) =>\n                              handleWorkOrderChange(\n                                workOrders.indexOf(mostRecentWorkOrder),\n                                \"date\",\n                                e.target.value\n                              )\n                            }\n                            style={{ marginBottom: \"0.5rem\" }}\n                          />\n                        </div>\n                      )}\n                    </div>\n                    <div style={{ marginBottom: \"1rem\" }}>\n                      <Form.Group controlId=\"desc\">\n                        <Button\n                          variant=\"outline-secondary\"\n                          onClick={listDescriptions}\n                          className=\"mb-2 me-2\"\n                        >\n                          List Descriptions\n                        </Button>\n                        <Form.Control\n                          as=\"textarea\"\n                          rows={3}\n                          placeholder=\"Enter description\"\n                          value={descriptions[selectedDesc]?.description || \"\"}\n                          onChange={(e) =>\n                            handleDescriptionChange(\n                              selectedDesc,\n                              \"description\",\n                              e.target.value\n                            )\n                          }\n                          style={{ marginBottom: \"0.5rem\" }}\n                        />\n                        <Form.Control\n                          type=\"date\"\n                          value={descriptions[selectedDesc]?.date || \"\"}\n                          onChange={(e) =>\n                            handleDescriptionChange(\n                              selectedDesc,\n                              \"date\",\n                              e.target.value\n                            )\n                          }\n                          style={{\n                            marginTop: \"0.5rem\",\n                            marginBottom: \"0.5rem\",\n                          }}\n                        />\n                      </Form.Group>\n                    </div>\n                  </div>\n                  {/* Machine Selection Row */}\n                  <div style={{ marginBottom: \"1rem\" }}>\n                    <Row className=\"mb-3\">\n                      <Col>\n                        <Button\n                          variant=\"outline-secondary\"\n                          onClick={() => {\n                            setMachinePick(true);\n                            handleShowClientModal();\n                          }}\n                          className=\"me-2\"\n                        >\n                          Select From\n                        </Button>\n                        {selectedClientFrom && (\n                          <div\n                            style={{\n                              border: \"1px solid #ccc\",\n                              padding: \"0.75rem\",\n                              borderRadius: \"4px\",\n                              marginBottom: \"1rem\",\n                            }}\n                          >\n                            <p>\n                              <strong>Selected Client (From):</strong>{\" \"}\n                              {selectedClientFrom.name}\n                            </p>\n                            <div style={{ marginTop: \"0.5rem\" }}>\n                              <Button\n                                variant=\"outline-secondary\"\n                                onClick={() => setShowMachineModal(true)}\n                              >\n                                Select Machine for {selectedClientFrom.name}\n                              </Button>\n                              {selectedMachine && (\n                                <>\n                                  <p style={{ marginTop: \"0.5rem\" }}>\n                                    <strong>Selected Machine (From):</strong>{\" \"}\n                                    {selectedMachine.name}\n                                  </p>\n                                  {showLocalLocFrom && (\n                                    <>\n                                      <Button\n                                        variant=\"outline-secondary\"\n                                        onClick={() =>\n                                          setShowNewLocalModalFrom(true)\n                                        }\n                                        className=\"w-100 mb-2\"\n                                      >\n                                        {/* build a little helper inline: region-section-bin-pallet */}\n                                        {[\n                                          newLocalFrom.region,\n                                          newLocalFrom.section?.letter +\n                                            newLocalFrom.section?.number,\n                                          newLocalFrom.bin &&\n                                            `B${newLocalFrom.bin}`,\n                                          newLocalFrom.pallet &&\n                                            `P${newLocalFrom.pallet}`,\n                                        ]\n                                          .filter(Boolean)\n                                          .join(\"-\")}\n                                        {/* e.g. “E-A7-B3-P2” */}\n                                      </Button>\n\n                                      <Modal\n                                        show={showNewLocalModalFrom}\n                                        onHide={() =>\n                                          setShowNewLocalModalFrom(false)\n                                        }\n                                        centered\n                                      >\n                                        <Modal.Header>\n                                          <Modal.Title>\n                                            Edit Local Loc (From)\n                                          </Modal.Title>\n                                        </Modal.Header>\n                                        <Modal.Body>\n                                          <NewLocal\n                                            selectedClient={selectedClientFrom}\n                                            showLocalLoc={showNewLocalModalFrom}\n                                            value={newLocalFrom}\n                                            onChange={setNewLocalFrom}\n                                            onSave={(p) => {\n                                              setNewLocalFrom(p);\n                                              setShowNewLocalModalFrom(false);\n                                            }}\n                                            onCancel={() =>\n                                              setShowNewLocalModalFrom(false)\n                                            }\n                                          />\n                                        </Modal.Body>\n                                        {/* <Modal.Footer>\n                                          <Button\n                                            variant=\"secondary\"\n                                            onClick={() => setShowNewLocalModalFrom(false)}\n                                          >\n                                            Close\n                                          </Button>\n                                        </Modal.Footer> */}\n                                      </Modal>\n                                    </>\n                                  )}\n                                </>\n                              )}\n                            </div>\n                          </div>\n                        )}\n                      </Col>\n                      <Col>\n                        <Button\n                          variant=\"outline-secondary\"\n                          onClick={() => {\n                            setMachinePick(false);\n                            handleShowClientModal();\n                          }}\n                          className=\"me-2\"\n                        >\n                          Select Current\n                        </Button>\n                        {selectedClientCurrent && (\n                          <div\n                            style={{\n                              border: \"1px solid #ccc\",\n                              padding: \"0.75rem\",\n                              borderRadius: \"4px\",\n                              marginBottom: \"1rem\",\n                            }}\n                          >\n                            <p>\n                              <strong>Selected Client (Current):</strong>{\" \"}\n                              {selectedClientCurrent.name}\n                            </p>\n                            <div style={{ marginTop: \"0.5rem\" }}>\n                              <Button\n                                variant=\"outline-secondary\"\n                                onClick={() => setShowMachineModal(true)}\n                              >\n                                Select Machine for {selectedClientCurrent.name}\n                              </Button>\n                              {selectedCurrentMachine && (\n                                <>\n                                  <p style={{ marginTop: \"0.5rem\" }}>\n                                    <strong>Selected Machine (Current):</strong>{\" \"}\n                                    {selectedCurrentMachine.name}\n                                  </p>\n                                  {showLocalLocCurrent && (\n                                    <>\n                                      <Button\n                                        variant=\"outline-secondary\"\n                                        onClick={() =>\n                                          setShowNewLocalModalCurrent(true)\n                                        }\n                                        className=\"w-100 mb-2\"\n                                      >\n                                        {[\n                                          newLocalCurrent.region,\n                                          newLocalCurrent.section?.letter +\n                                            newLocalCurrent.section?.number,\n                                          newLocalCurrent.bin &&\n                                            `B${newLocalCurrent.bin}`,\n                                          newLocalCurrent.pallet &&\n                                            `P${newLocalCurrent.pallet}`,\n                                        ]\n                                          .filter(Boolean)\n                                          .join(\"-\")}\n                                      </Button>\n                                      <Modal\n                                        show={showNewLocalModalCurrent}\n                                        onHide={() =>\n                                          setShowNewLocalModalCurrent(false)\n                                        }\n                                        centered\n                                      >\n                                        <Modal.Header>\n                                          <Modal.Title>\n                                            Edit Local Loc (Current)\n                                          </Modal.Title>\n                                        </Modal.Header>\n                                        <Modal.Body>\n                                          <NewLocal\n                                            selectedClient={\n                                              selectedClientCurrent\n                                            }\n                                            showLocalLoc={\n                                              showNewLocalModalCurrent\n                                            }\n                                            value={newLocalCurrent}\n                                            onChange={setNewLocalCurrent}\n                                            onSave={(p) => {\n                                              setNewLocalCurrent(p);\n                                              setShowNewLocalModalCurrent(\n                                                false\n                                              );\n                                            }}\n                                            onCancel={() =>\n                                              setShowNewLocalModalCurrent(false)\n                                            }\n                                          />\n                                        </Modal.Body>\n                                        {/* <Modal.Footer>\n                                          <Button\n                                            variant=\"secondary\"\n                                            onClick={() => setShowNewLocalModalCurrent(false)}\n                                          >\n                                            Close\n                                          </Button>\n                                        </Modal.Footer> */}\n                                      </Modal>\n                                    </>\n                                  )}\n                                </>\n                              )}\n                            </div>\n                          </div>\n                        )}\n                      </Col>\n                      <Col>\n                        <Button\n                          variant=\"outline-secondary\"\n                          onClick={handleShowParentModal}\n                          className=\"me-2\"\n                        >\n                          Select Parent\n                        </Button>\n                        {selectedParent && (\n                          <Form.Control\n                            type=\"text\"\n                            placeholder=\"Selected Parent\"\n                            value={selectedParent.name}\n                            readOnly\n                            style={{ marginTop: \"0.5rem\" }}\n                          />\n                        )}\n                      </Col>\n                    </Row>\n                  </div>\n                  {/* Photo and Website Options */}\n                  <div style={{ marginBottom: \"1rem\" }}>\n                    <Row className=\"mb-3\">\n                      <Col xs={6}>\n                        <ButtonGroup>\n                          <Button\n                            variant=\"outline-secondary\"\n                            onClick={handleShowCameraModal}\n                          >\n                            Take Photo\n                          </Button>\n                          <Button\n                            variant=\"outline-secondary\"\n                            onClick={handleBrowsePhotos}\n                          >\n                            Browse\n                          </Button>\n                        </ButtonGroup>\n                      </Col>\n                      <Col xs={6} className=\"d-flex align-items-center\">\n                        <Button\n                          variant=\"success\"\n                          onClick={handleSendToInflow}\n                          style={{ marginLeft: \"auto\" }}\n                        >\n                          Send to inFlow\n                        </Button>\n                        <Button\n                          variant=\"secondary\"\n                          onClick={handleBluefolderButton}\n                          style={{ marginLeft: \"0.5rem\", marginRight: \".5rem\" }}\n                        >\n                          BlueFolder\n                        </Button>\n                        \n\n                        <Button\n                          variant={addToWebsite ? \"primary\" : \"outline-primary\"}\n                          onClick={() => setAddToWebsite((prev) => !prev)}\n                        >\n                          {addToWebsite ? \"✓ Add to Website\" : \"Add to Website\"}\n                        </Button>\n\n                        <Form.Check\n                          type=\"checkbox\"\n                          id=\"hide-checkbox\"\n                          label=\"Hide\"\n                          // box is checked when we want visible = false\n                          checked={!items.visible}\n                          onChange={(e) => {\n                            // grab checked immediately\n                            const isHidden = e.currentTarget.checked;\n                            setItems((prev) => ({\n                              ...prev,\n                              visible: !isHidden,\n                            }));\n                          }}\n                          className=\"ms-3\"\n                        />\n                      </Col>\n                    </Row>\n                    <input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      multiple\n                      ref={browseInputRef}\n                      style={{ display: \"none\" }}\n                      onChange={handleFilesSelected}\n                    />\n                  </div>\n                  {/* Photo Gallery */}\n                  {photos && photos.length > 0 && (\n                    <div\n                      className=\"photo-gallery\"\n                      style={{\n                        display: \"flex\",\n                        flexWrap: \"wrap\",\n                        gap: \"10px\",\n                        marginBottom: \"1rem\",\n                      }}\n                    >\n                      {photos.map((photo, index) => (\n                        <div\n                          key={index}\n                          style={{\n                            position: \"relative\",\n                            width: \"100px\",\n                            height: \"100px\",\n                          }}\n                        >\n                          <img\n                            src={photo.url}\n                            alt={`Photo ${index + 1}`}\n                            style={{\n                              width: \"100%\",\n                              height: \"100%\",\n                              objectFit: \"cover\",\n                            }}\n                          />\n                          {photo.file && (\n                            <Button\n                              variant=\"danger\"\n                              size=\"sm\"\n                              style={{\n                                position: \"absolute\",\n                                top: 0,\n                                right: 0,\n                                padding: \"0 5px\",\n                              }}\n                              onClick={() => removePhoto(index)}\n                            >\n                              x\n                            </Button>\n                          )}\n                        </div>\n                      ))}\n                    </div>\n                  )}\n                  {/* Action Buttons */}\n                  <div className=\"mt-3 d-flex flex-wrap align-items-center\">\n                    <Button\n                      variant=\"primary\"\n                      type=\"submit\"\n                      style={{ marginRight: \"1rem\" }}\n                    >\n                      Save\n                    </Button>\n                    <Button\n                      variant=\"secondary\"\n                      onClick={handleShowInfoModal}\n                      style={{ marginRight: \"1rem\" }}\n                    >\n                      More Info\n                    </Button>\n                    <LoadingButton\n                      type=\"primary\"\n                      name=\"Back\"\n                      route=\"NewSearch/mainSearch\"\n                    />\n                    <div style={{ display: \"flex\", flexDirection: \"column\", marginLeft: \".5rem\" }}>\n                      <span style={{ fontSize: 12, lineHeight: \"12px\", textAlign: \"center\" }}>Slack</span>\n                      <div style={{ display: \"flex\", border: \"1px solid #ced4da\", borderRadius: 6, overflow: \"hidden\" }}>\n                        <Button\n                          variant=\"outline-primary\"\n                          onClick={() => handleAddToSlack(\"receiving\")}\n                          style={{ border: \"none\", borderRight: \"1px solid #ced4da\" }}\n                        >\n                          Receiving\n                        </Button>\n                        <Button\n                          variant=\"outline-primary\"\n                          onClick={() => handleAddToSlack(\"shipping\")}\n                          style={{ border: \"none\" }}\n                        >\n                          Shipping\n                        </Button>\n                        <Button\n                          variant=\"outline-primary\"\n                          onClick={() => handleAddToSlack(\"tasks\")}\n                        >\n                          Tasks\n                        </Button>\n                      </div>\n                    </div>\n\n                    <Button\n                      variant=\"info\"\n                      onClick={handlePrint}\n                      style={{ marginLeft: \"auto\" }}\n                    >\n                      Print Label\n                    </Button>\n                  </div>\n                  <div style={{ textAlign: \"center\", margin: \"1rem 0\" }}>\n                    <Button\n                      variant=\"link\"\n                      style={{\n                        textDecoration: \"none\",\n                        color: \"black\",\n                        fontSize: \"24px\",\n                      }}\n                      onClick={() => setShowExtra(!showExtra)}\n                    >\n                      ▼\n                    </Button>\n                  </div>\n                  <Collapse in={showExtra}>\n                    <div id=\"extra-collapse\" className=\"mt-3\">\n                      <Row>\n                        <Form.Group as={Col} controlId=\"dimensions\">\n                          <Form.Label>Dimensions</Form.Label>\n                          <div\n                            style={{ display: \"flex\", alignItems: \"center\" }}\n                          >\n                            <Form.Control\n                              placeholder=\"Length\"\n                              type=\"text\"\n                              value={items.length}\n                              onChange={handleChange(\"length\")}\n                            />\n                            <span style={{ padding: \"0 5px\" }}>x</span>\n                            <Form.Control\n                              placeholder=\"Width\"\n                              type=\"text\"\n                              value={items.width}\n                              onChange={handleChange(\"width\")}\n                            />\n                            <span style={{ padding: \"0 5px\" }}>x</span>\n                            <Form.Control\n                              placeholder=\"Height\"\n                              type=\"text\"\n                              value={items.height}\n                              onChange={handleChange(\"height\")}\n                            />\n                          </div>\n                        </Form.Group>\n                        <Form.Group as={Col} controlId=\"trackingNumber\">\n                          <Form.Label>Tracking Number</Form.Label>\n                          <Form.Control\n                            placeholder=\"Tracking Number\"\n                            type=\"text\"\n                            value={items.trackingNumber}\n                            onChange={handleChange(\"trackingNumber\")}\n                          />\n                        </Form.Group>\n                      </Row>\n\n                      <Row className=\"mt-3\">\n                        <Form.Group as={Col} controlId=\"Price\">\n                          <Form.Label>Price</Form.Label>\n                          <Form.Control\n                            placeholder=\"Price\"\n                            type=\"text\"\n                            value={items.price}\n                            onChange={handleChange(\"price\")}\n                          />\n                        </Form.Group>\n                        <Form.Group as={Col} controlId=\"DOM\">\n                          <Form.Label>DOM</Form.Label>\n                          <Form.Control\n                            placeholder=\"Date of Manufacture\"\n                            type=\"date\"\n                            value={DOM}\n                            onChange={(e) => setDOM(e.target.value)}\n                          />\n                        </Form.Group>\n                        <Form.Group as={Col} controlId=\"poNumber\">\n                          <Form.Label>PO Number</Form.Label>\n                          <Form.Control\n                            type=\"text\"\n                            placeholder=\"PO Number\"\n                            value={items.poNumber || \"\"}\n                            onChange={handleChange(\"poNumber\")}\n                          />\n                        </Form.Group>\n                      </Row>\n                      <Row className=\"mt-3\">\n                        <Form.Group as={Col} controlId=\"localSN\">\n                          <Form.Label>Local SN</Form.Label>\n                          <Form.Control\n                            type=\"text\"\n                            placeholder=\"Enter Local SN\"\n                            value={items.localSN || \"\"}\n                            onChange={handleChange(\"localSN\")}\n                          />\n                        </Form.Group>\n                        <Form.Group as={Col} controlId=\"arrivalDate\">\n                          <Form.Label>Arrival Date</Form.Label>\n                          <Form.Control\n                            placeholder=\"Enter Arrival Date\"\n                            type=\"date\"\n                            value={items.arrival_date}\n                            onChange={(e) => {\n                              const value = e.target.value;\n                              setItems((prev) => ({\n                                ...prev,\n                                arrival_date: value,\n                              }));\n                            }}\n                          />\n                        </Form.Group>\n                      </Row>\n                    </div>\n                  </Collapse>\n                </Form>\n              </Card.Body>\n            </Card>\n          </div>\n        </Container>\n      </div>\n      {/* Camera Modal */}\n      <Modal show={showCameraModal} onHide={handleCloseCameraModal}>\n        <Modal.Header closeButton>\n          <Modal.Title>Take a Photo</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <div className=\"camera\">\n            {!capturedPhoto ? (\n              <BarcodeScannerComponent\n                width=\"100%\"\n                height={300}\n                onUpdate={handleCapture}\n                facingMode={cameraFacing}\n              />\n            ) : (\n              <div className=\"photo-preview\">\n                <img\n                  src={URL.createObjectURL(capturedPhoto)}\n                  alt=\"captured\"\n                  style={{ width: \"100%\" }}\n                />\n              </div>\n            )}\n          </div>\n        </Modal.Body>\n        <Modal.Footer>\n          {!capturedPhoto ? (\n            <>\n              <Button\n                onClick={capturePhoto}\n                style={{\n                  borderRadius: \"50%\",\n                  width: \"60px\",\n                  height: \"60px\",\n                  position: \"absolute\",\n                  left: \"50%\",\n                  transform: \"translateX(-50%)\",\n                  bottom: \"10px\",\n                }}\n              >\n                📷\n              </Button>\n              <Button\n                onClick={() =>\n                  setCameraFacing((prev) =>\n                    prev === \"environment\" ? \"user\" : \"environment\"\n                  )\n                }\n              >\n                Flip Camera\n              </Button>\n              <Button variant=\"secondary\" onClick={handleCloseCameraModal}>\n                Cancel\n              </Button>\n            </>\n          ) : (\n            <>\n              <Button\n                variant=\"secondary\"\n                onClick={() => setCapturedPhoto(null)}\n              >\n                Retake\n              </Button>\n              <Button variant=\"primary\" onClick={savePhoto}>\n                OK\n              </Button>\n            </>\n          )}\n        </Modal.Footer>\n      </Modal>\n    </LoggedIn>\n  );\n}\n\n// Server-side rendering function\nexport async function getServerSideProps(context) {\n  const { id } = context.params;\n\n  try {\n    const itemDoc = await adminDb.collection(\"Test\").doc(id).get();\n    if (!itemDoc.exists) return { notFound: true };\n\n    const itemData = itemDoc.data();\n\n    // normalize to arrays for consistent client-side handling\n    const pnArray = Array.isArray(itemData.pn)\n      ? itemData.pn\n      : (itemData.pn ? [itemData.pn] : []);\n    const snArray = Array.isArray(itemData.sn)\n      ? itemData.sn\n      : (itemData.sn ? [itemData.sn] : []);\n\n    // fetch machineData (optional; you already had this)\n    let machineData = {};\n    if (itemData.Machine && itemData.Machine.path) {\n      try {\n        const machineDoc = await adminDb.doc(itemData.Machine.path).get();\n        if (machineDoc.exists) {\n          machineData = machineDoc.data();\n          if (machineData.client && machineData.client.path) {\n            const clientDoc = await adminDb.doc(machineData.client.path).get();\n            if (clientDoc.exists) machineData.Client = clientDoc.data().name;\n          }\n        }\n      } catch (e) {\n        console.error(\"Error fetching machine data:\", e);\n      }\n    }\n\n    const serializedItem = {\n      id,\n      name: itemData.name || \"\",\n      pn: pnArray,\n      sn: snArray,\n      price: itemData.price || \"\",\n      status: itemData.status || \"\",\n      length: itemData.length || \"\",\n      width: itemData.width || \"\",\n      height: itemData.height || \"\",\n      poNumber: itemData.poNumber || \"\",\n      trackingNumber: itemData.trackingNumber || \"\",\n      localSN: itemData.localSN || \"\",\n      arrival_date: itemData.arrival_date || \"\",\n      visible: itemData.visible !== undefined ? itemData.visible : true,\n\n      // add the pieces the UI reads directly\n      descriptions: itemData.descriptions || [],\n      workOrders: itemData.workOrders || [],\n      DOM: itemData.DOM || \"\",\n    };\n\n    return {\n      props: {\n        initialItem: serializedItem,\n        initialMachineData: machineData,\n      },\n    };\n  } catch (error) {\n    console.error(\"Error in getServerSideProps:\", error);\n    return { props: { error: \"Failed to load item data\" } };\n  }\n}\n\n"]},"metadata":{},"sourceType":"module"}