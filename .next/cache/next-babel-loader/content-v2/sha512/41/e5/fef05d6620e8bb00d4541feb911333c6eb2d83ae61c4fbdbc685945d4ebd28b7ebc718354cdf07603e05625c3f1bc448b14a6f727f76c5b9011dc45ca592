{"ast":null,"code":"import _defineProperty from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\NewSearch\\\\inventory\\\\inventoryManage.js\",\n    _s2 = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState, useMemo } from \"react\";\nimport LoggedIn from \"../../LoggedIn\";\nimport firebase from \"../../../context/Firebase\";\nimport { Table, Form, Button, Container, Row, Col, Spinner } from \"react-bootstrap\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Link from \"next/link\";\nexport default function InventoryManage() {\n  _s2();\n\n  var _s = $RefreshSig$(),\n      _this = this;\n\n  var _useState = useState([]),\n      items = _useState[0],\n      setItems = _useState[1];\n\n  var _useState2 = useState(true),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState(new Set()),\n      selectedIds = _useState3[0],\n      setSelectedIds = _useState3[1];\n\n  var _useState4 = useState({\n    region: \"\",\n    section: \"\",\n    bin: \"\",\n    pallet: \"\",\n    localSN: \"\"\n  }),\n      filters = _useState4[0],\n      setFilters = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      bulkField = _useState5[0],\n      setBulkField = _useState5[1];\n\n  var _useState6 = useState(\"\"),\n      bulkValue = _useState6[0],\n      setBulkValue = _useState6[1]; // ---- load data once ----\n\n\n  useEffect(function () {\n    var db = firebase.firestore();\n    db.collection(\"Test\").get().then(function (snap) {\n      var data = snap.docs.map(function (d) {\n        var _loc$region$toString, _loc$region, _loc$section$toString, _loc$section, _loc$bin$toString, _loc$bin, _loc$pallet$toString, _loc$pallet;\n\n        var doc = d.data();\n        var loc = doc.newLocalCurrent || {};\n        return {\n          id: d.id,\n          name: doc.name || \"\",\n          pn: doc.pn || \"\",\n          sn: doc.sn || \"\",\n          localSN: doc.localSN || \"\",\n          region: (_loc$region$toString = (_loc$region = loc.region) === null || _loc$region === void 0 ? void 0 : _loc$region.toString()) !== null && _loc$region$toString !== void 0 ? _loc$region$toString : \"\",\n          section: (_loc$section$toString = (_loc$section = loc.section) === null || _loc$section === void 0 ? void 0 : _loc$section.toString()) !== null && _loc$section$toString !== void 0 ? _loc$section$toString : \"\",\n          bin: (_loc$bin$toString = (_loc$bin = loc.bin) === null || _loc$bin === void 0 ? void 0 : _loc$bin.toString()) !== null && _loc$bin$toString !== void 0 ? _loc$bin$toString : \"\",\n          pallet: (_loc$pallet$toString = (_loc$pallet = loc.pallet) === null || _loc$pallet === void 0 ? void 0 : _loc$pallet.toString()) !== null && _loc$pallet$toString !== void 0 ? _loc$pallet$toString : \"\"\n        };\n      });\n      setItems(data);\n    })[\"finally\"](function () {\n      return setLoading(false);\n    });\n  }, []); // ---- derive distinct filter options ----\n\n  var distinct = function distinct(arr) {\n    return Array.from(new Set(arr.filter(function (v) {\n      return v;\n    }))).sort();\n  };\n\n  var regions = useMemo(function () {\n    return distinct(items.map(function (i) {\n      return i.region;\n    }));\n  }, [items]);\n  var sections = useMemo(function () {\n    return distinct(items.map(function (i) {\n      return i.section;\n    }));\n  }, [items]);\n  var bins = useMemo(function () {\n    return distinct(items.map(function (i) {\n      return i.bin;\n    }));\n  }, [items]);\n  var pallets = useMemo(function () {\n    return distinct(items.map(function (i) {\n      return i.pallet;\n    }));\n  }, [items]); // ---- toggles ----\n\n  var toggleSelect = function toggleSelect(id) {\n    setSelectedIds(function (prev) {\n      var next = new Set(prev);\n      next.has(id) ? next[\"delete\"](id) : next.add(id);\n      return next;\n    });\n  };\n\n  var toggleSelectAll = function toggleSelectAll() {\n    var visibleIds = filteredItems.map(function (i) {\n      return i.id;\n    });\n    setSelectedIds(function (prev) {\n      var next = new Set(prev);\n\n      if (visibleIds.every(function (id) {\n        return next.has(id);\n      })) {\n        visibleIds.forEach(function (id) {\n          return next[\"delete\"](id);\n        });\n      } else {\n        visibleIds.forEach(function (id) {\n          return next.add(id);\n        });\n      }\n\n      return next;\n    });\n  }; // ---- filtered list ----\n\n\n  var filteredItems = items.filter(function (it) {\n    return [\"region\", \"section\", \"bin\", \"pallet\", \"localSN\"].every(function (f) {\n      return !filters[f] || it[f] === filters[f];\n    });\n  }); // ---- bulk update handler ----\n\n  var applyBulkUpdate = function applyBulkUpdate() {\n    if (!bulkField || !bulkValue) return;\n    var db = firebase.firestore();\n    var updates = Array.from(selectedIds).map(function (id) {\n      var orig = items.find(function (i) {\n        return i.id === id;\n      }) || {};\n      var newRegion = bulkField === \"region\" ? bulkValue : orig.region;\n      var newSection = bulkField === \"section\" ? bulkValue : orig.section;\n      var newBin = bulkField === \"bin\" ? bulkValue : orig.bin;\n      var newPallet = bulkField === \"pallet\" ? bulkValue : orig.pallet;\n      var parts = [];\n      if (newRegion) parts.push(newRegion);\n      if (newSection) parts.push(newSection);\n      if (newBin) parts.push(\"B\".concat(newBin));\n      if (newPallet) parts.push(\"P\".concat(newPallet));\n      var newLocString = parts.join(\"-\");\n      var updateObj = {\n        region: newRegion,\n        section: newSection,\n        bin: newBin,\n        pallet: newPallet,\n        localLocCurrent: newLocString,\n        newLocalCurrent: {\n          region: newRegion,\n          section: newSection,\n          bin: newBin,\n          pallet: newPallet\n        }\n      };\n      return db.collection(\"Test\").doc(id).update(updateObj).then(function () {\n        setItems(function (prev) {\n          return prev.map(function (item) {\n            return item.id === id ? _objectSpread(_objectSpread({}, item), {}, {\n              region: newRegion,\n              section: newSection,\n              bin: newBin,\n              pallet: newPallet\n            }) : item;\n          });\n        });\n      });\n    });\n    Promise.all(updates).then(function () {\n      setSelectedIds(new Set());\n      setBulkField(\"\");\n      setBulkValue(\"\");\n    });\n  }; // ---- loading state ----\n\n\n  if (loading) {\n    return __jsx(Container, {\n      className: \"py-5 text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 7\n      }\n    }, __jsx(Spinner, {\n      animation: \"border\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  function LoadingButton(_ref) {\n    _s();\n\n    var type = _ref.type,\n        name = _ref.name,\n        route = _ref.route;\n\n    var _useState7 = useState(false),\n        isLoading = _useState7[0],\n        setLoading = _useState7[1];\n\n    useEffect(function () {\n      if (isLoading) {\n        simulateNetworkRequest().then(function () {\n          return setLoading(false);\n        });\n      }\n    }, [isLoading]);\n\n    var handleClick = function handleClick() {\n      return setLoading(true);\n    };\n\n    return __jsx(Link, {\n      href: \"/\".concat(route),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }\n    }, __jsx(\"a\", {\n      className: \"btn btn-\".concat(type),\n      disabled: isLoading,\n      onClick: !isLoading ? handleClick : null,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 17\n      }\n    }, isLoading ? \"Loading…\" : name));\n  }\n\n  _s(LoadingButton, \"LHJkidtbt8bk0SOCXf2Y2viet6g=\");\n\n  function simulateNetworkRequest() {\n    return new Promise(function (resolve) {\n      return setTimeout(resolve, 2000);\n    });\n  }\n\n  return __jsx(LoggedIn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }\n  }, __jsx(Container, {\n    className: \"py-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }\n  }, __jsx(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 17\n    }\n  }, \"Inventory Management\"), __jsx(LoadingButton, {\n    type: \"primary\",\n    name: \"Back\",\n    route: \"Warehousedb/WarehouseSelect\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 17\n    }\n  }), __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 17\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 25\n    }\n  }, \"Region\"), __jsx(Form.Select, {\n    value: filters.region,\n    onChange: function onChange(e) {\n      var v = e.target.value;\n      setFilters(function (p) {\n        return _objectSpread(_objectSpread({}, p), {}, {\n          region: v\n        });\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 25\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 15\n    }\n  }, \"All regions\"), regions.map(function (r) {\n    return __jsx(\"option\", {\n      key: r,\n      value: r,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 17\n      }\n    }, r);\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 13\n    }\n  }, \"Section\"), __jsx(Form.Select, {\n    value: filters.section,\n    onChange: function onChange(e) {\n      var v = e.target.value;\n      setFilters(function (p) {\n        return _objectSpread(_objectSpread({}, p), {}, {\n          section: v\n        });\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 15\n    }\n  }, \"All sections\"), sections.map(function (s) {\n    return __jsx(\"option\", {\n      key: s,\n      value: s,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 17\n      }\n    }, s);\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 13\n    }\n  }, \"Bin\"), __jsx(Form.Select, {\n    value: filters.bin,\n    onChange: function onChange(e) {\n      var v = e.target.value;\n      setFilters(function (p) {\n        return _objectSpread(_objectSpread({}, p), {}, {\n          bin: v\n        });\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 241,\n      columnNumber: 15\n    }\n  }, \"All bins\"), bins.map(function (b) {\n    return __jsx(\"option\", {\n      key: b,\n      value: b,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 17\n      }\n    }, b);\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 247,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 248,\n      columnNumber: 13\n    }\n  }, \"Pallet\"), __jsx(Form.Select, {\n    value: filters.pallet,\n    onChange: function onChange(e) {\n      var v = e.target.value;\n      setFilters(function (p) {\n        return _objectSpread(_objectSpread({}, p), {}, {\n          pallet: v\n        });\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 249,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 15\n    }\n  }, \"All pallets\"), pallets.map(function (p) {\n    return __jsx(\"option\", {\n      key: p,\n      value: p,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 17\n      }\n    }, p);\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 13\n    }\n  }, \"Local SN\"), __jsx(Form.Control, {\n    placeholder: \"Search SN\",\n    value: filters.localSN,\n    onChange: function onChange(e) {\n      var v = e.target.value;\n      setFilters(function (p) {\n        return _objectSpread(_objectSpread({}, p), {}, {\n          localSN: v\n        });\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 13\n    }\n  }))), __jsx(\"div\", {\n    className: \"d-flex mb-2 align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Check, {\n    type: \"checkbox\",\n    label: \"Select All\",\n    onChange: toggleSelectAll,\n    checked: filteredItems.length > 0 && filteredItems.every(function (i) {\n      return selectedIds.has(i.id);\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 11\n    }\n  }), selectedIds.size > 0 && __jsx(React.Fragment, null, __jsx(Form.Select, {\n    className: \"mx-2\",\n    value: bulkField,\n    onChange: function onChange(e) {\n      return setBulkField(e.target.value);\n    },\n    style: {\n      width: \"150px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 15\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 17\n    }\n  }, \"Change\\u2026\"), __jsx(\"option\", {\n    value: \"region\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 295,\n      columnNumber: 17\n    }\n  }, \"Region\"), __jsx(\"option\", {\n    value: \"section\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 17\n    }\n  }, \"Section\"), __jsx(\"option\", {\n    value: \"bin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 17\n    }\n  }, \"Bin\"), __jsx(\"option\", {\n    value: \"pallet\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 17\n    }\n  }, \"Pallet\")), __jsx(Form.Control, {\n    style: {\n      width: \"100px\"\n    },\n    placeholder: \"New value\",\n    value: bulkValue,\n    onChange: function onChange(e) {\n      return setBulkValue(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 15\n    }\n  }), __jsx(Button, {\n    className: \"ms-2\",\n    onClick: applyBulkUpdate,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 15\n    }\n  }, \"Apply\"))), __jsx(Table, {\n    bordered: true,\n    hover: true,\n    responsive: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 9\n    }\n  }, __jsx(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 11\n    }\n  }, __jsx(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 13\n    }\n  }, __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 317,\n      columnNumber: 15\n    }\n  }), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 318,\n      columnNumber: 15\n    }\n  }, \"Name\"), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 15\n    }\n  }, \"PN\"), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 15\n    }\n  }, \"SN\"), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 15\n    }\n  }, \"LocalSN\"), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 15\n    }\n  }, \"Region\"), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 15\n    }\n  }, \"Section\"), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 15\n    }\n  }, \"Bin\"), __jsx(\"th\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 15\n    }\n  }, \"Pallet\"))), __jsx(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 11\n    }\n  }, filteredItems.map(function (it) {\n    return __jsx(\"tr\", {\n      key: it.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330,\n        columnNumber: 15\n      }\n    }, __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 17\n      }\n    }, __jsx(Form.Check, {\n      type: \"checkbox\",\n      checked: selectedIds.has(it.id),\n      onChange: function onChange() {\n        return toggleSelect(it.id);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 19\n      }\n    })), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 338,\n        columnNumber: 17\n      }\n    }, it.name), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 17\n      }\n    }, it.pn), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 17\n      }\n    }, it.sn), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 17\n      }\n    }, it.localSN), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 17\n      }\n    }, it.region), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 17\n      }\n    }, it.section), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 344,\n        columnNumber: 17\n      }\n    }, it.bin), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 345,\n        columnNumber: 17\n      }\n    }, it.pallet));\n  })))));\n}\n\n_s2(InventoryManage, \"/isUbqr1fp6NgWZogpXSd+gdwFw=\");\n\n_c = InventoryManage;\n\nvar _c;\n\n$RefreshReg$(_c, \"InventoryManage\");","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/NewSearch/inventory/inventoryManage.js"],"names":["React","useEffect","useState","useMemo","LoggedIn","firebase","Table","Form","Button","Container","Row","Col","Spinner","Link","InventoryManage","items","setItems","loading","setLoading","Set","selectedIds","setSelectedIds","region","section","bin","pallet","localSN","filters","setFilters","bulkField","setBulkField","bulkValue","setBulkValue","db","firestore","collection","get","then","snap","data","docs","map","d","doc","loc","newLocalCurrent","id","name","pn","sn","toString","distinct","arr","Array","from","filter","v","sort","regions","i","sections","bins","pallets","toggleSelect","prev","next","has","add","toggleSelectAll","visibleIds","filteredItems","every","forEach","it","f","applyBulkUpdate","updates","orig","find","newRegion","newSection","newBin","newPallet","parts","push","newLocString","join","updateObj","localLocCurrent","update","item","Promise","all","LoadingButton","type","route","isLoading","simulateNetworkRequest","handleClick","resolve","setTimeout","e","target","value","p","r","s","b","length","size","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useMemo } from \"react\";\nimport LoggedIn from \"../../LoggedIn\";\nimport firebase from \"../../../context/Firebase\";\nimport {\n  Table,\n  Form,\n  Button,\n  Container,\n  Row,\n  Col,\n  Spinner,\n} from \"react-bootstrap\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Link from \"next/link\";\n\n\nexport default function InventoryManage() {\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [selectedIds, setSelectedIds] = useState(new Set());\n  const [filters, setFilters] = useState({\n    region: \"\",\n    section: \"\",\n    bin: \"\",\n    pallet: \"\",\n    localSN: \"\",\n  });\n  const [bulkField, setBulkField] = useState(\"\");\n  const [bulkValue, setBulkValue] = useState(\"\");\n\n  // ---- load data once ----\n  useEffect(() => {\n    const db = firebase.firestore();\n    db.collection(\"Test\")\n      .get()\n      .then((snap) => {\n        const data = snap.docs.map((d) => {\n          const doc = d.data();\n          const loc = doc.newLocalCurrent || {};\n          return {\n            id: d.id,\n            name: doc.name || \"\",\n            pn: doc.pn || \"\",\n            sn: doc.sn || \"\",\n            localSN: doc.localSN || \"\",\n            region: loc.region?.toString() ?? \"\",\n            section: loc.section?.toString() ?? \"\",\n            bin: loc.bin?.toString() ?? \"\",\n            pallet: loc.pallet?.toString() ?? \"\",\n          };\n        });\n        setItems(data);\n      })\n      .finally(() => setLoading(false));\n  }, []);\n\n  // ---- derive distinct filter options ----\n  const distinct = (arr) =>\n    Array.from(new Set(arr.filter((v) => v))).sort();\n  const regions  = useMemo(() => distinct(items.map((i) => i.region)),  [items]);\n  const sections = useMemo(() => distinct(items.map((i) => i.section)), [items]);\n  const bins     = useMemo(() => distinct(items.map((i) => i.bin)),     [items]);\n  const pallets  = useMemo(() => distinct(items.map((i) => i.pallet)),  [items]);\n\n  // ---- toggles ----\n  const toggleSelect = (id) => {\n    setSelectedIds((prev) => {\n      const next = new Set(prev);\n      next.has(id) ? next.delete(id) : next.add(id);\n      return next;\n    });\n  };\n  const toggleSelectAll = () => {\n    const visibleIds = filteredItems.map((i) => i.id);\n    setSelectedIds((prev) => {\n      const next = new Set(prev);\n      if (visibleIds.every((id) => next.has(id))) {\n        visibleIds.forEach((id) => next.delete(id));\n      } else {\n        visibleIds.forEach((id) => next.add(id));\n      }\n      return next;\n    });\n  };\n\n  // ---- filtered list ----\n  const filteredItems = items.filter((it) =>\n    [\"region\", \"section\", \"bin\", \"pallet\", \"localSN\"].every(\n      (f) => !filters[f] || it[f] === filters[f]\n    )\n  );\n\n  // ---- bulk update handler ----\n  const applyBulkUpdate = () => {\n    if (!bulkField || !bulkValue) return;\n    const db = firebase.firestore();\n\n    const updates = Array.from(selectedIds).map((id) => {\n      const orig = items.find((i) => i.id === id) || {};\n      const newRegion  = bulkField === \"region\"  ? bulkValue : orig.region;\n      const newSection = bulkField === \"section\" ? bulkValue : orig.section;\n      const newBin     = bulkField === \"bin\"     ? bulkValue : orig.bin;\n      const newPallet  = bulkField === \"pallet\"  ? bulkValue : orig.pallet;\n\n      const parts = [];\n      if (newRegion)  parts.push(newRegion);\n      if (newSection) parts.push(newSection);\n      if (newBin)     parts.push(`B${newBin}`);\n      if (newPallet)  parts.push(`P${newPallet}`);\n      const newLocString = parts.join(\"-\");\n\n      const updateObj = {\n        region: newRegion,\n        section: newSection,\n        bin: newBin,\n        pallet: newPallet,\n        localLocCurrent: newLocString,\n        newLocalCurrent: {\n          region: newRegion,\n          section: newSection,\n          bin: newBin,\n          pallet: newPallet,\n        },\n      };\n\n      return db\n        .collection(\"Test\")\n        .doc(id)\n        .update(updateObj)\n        .then(() => {\n          setItems((prev) =>\n            prev.map((item) =>\n              item.id === id\n                ? {\n                    ...item,\n                    region: newRegion,\n                    section: newSection,\n                    bin: newBin,\n                    pallet: newPallet,\n                  }\n                : item\n            )\n          );\n        });\n    });\n\n    Promise.all(updates).then(() => {\n      setSelectedIds(new Set());\n      setBulkField(\"\");\n      setBulkValue(\"\");\n    });\n  };\n\n  // ---- loading state ----\n  if (loading) {\n    return (\n      <Container className=\"py-5 text-center\">\n        <Spinner animation=\"border\" />\n            </Container>\n        );\n    }\n\n    function LoadingButton({ type, name, route }) {\n      const [isLoading, setLoading] = useState(false);\n    \n      useEffect(() => {\n        if (isLoading) {\n          simulateNetworkRequest().then(() => setLoading(false));\n        }\n      }, [isLoading]);\n    \n      const handleClick = () => setLoading(true);\n    \n      return (\n        <Link href={`/${route}`}>\n                <a\n                    className={`btn btn-${type}`}\n                    disabled={isLoading}\n                    onClick={!isLoading ? handleClick : null}\n                >\n                    {isLoading ? \"Loading…\" : name}\n                </a>\n            </Link>\n        );\n    }\n\n    function simulateNetworkRequest() {\n        return new Promise(resolve => setTimeout(resolve, 2000));\n    }\n\n    return (\n        <LoggedIn>\n            <Container className=\"py-4\">\n                <h2>Inventory Management</h2>\n                <LoadingButton\n                    type=\"primary\"\n                    name=\"Back\"\n                    route=\"Warehousedb/WarehouseSelect\"\n                />\n                {/* dropdown filters */}\n                <Row className=\"mb-3\">\n                    <Col>\n                        <Form.Label>Region</Form.Label>\n                        <Form.Select\n                            value={filters.region}\n                            onChange={(e) => {\n                const v = e.target.value;\n                setFilters((p) => ({ ...p, region: v }));\n              }}\n            >\n              <option value=\"\">All regions</option>\n              {regions.map((r) => (\n                <option key={r} value={r}>{r}</option>\n              ))}\n            </Form.Select>\n          </Col>\n          <Col>\n            <Form.Label>Section</Form.Label>\n            <Form.Select\n              value={filters.section}\n              onChange={(e) => {\n                const v = e.target.value;\n                setFilters((p) => ({ ...p, section: v }));\n              }}\n            >\n              <option value=\"\">All sections</option>\n              {sections.map((s) => (\n                <option key={s} value={s}>{s}</option>\n              ))}\n            </Form.Select>\n          </Col>\n          <Col>\n            <Form.Label>Bin</Form.Label>\n            <Form.Select\n              value={filters.bin}\n              onChange={(e) => {\n                const v = e.target.value;\n                setFilters((p) => ({ ...p, bin: v }));\n              }}\n            >\n              <option value=\"\">All bins</option>\n              {bins.map((b) => (\n                <option key={b} value={b}>{b}</option>\n              ))}\n            </Form.Select>\n          </Col>\n          <Col>\n            <Form.Label>Pallet</Form.Label>\n            <Form.Select\n              value={filters.pallet}\n              onChange={(e) => {\n                const v = e.target.value;\n                setFilters((p) => ({ ...p, pallet: v }));\n              }}\n            >\n              <option value=\"\">All pallets</option>\n              {pallets.map((p) => (\n                <option key={p} value={p}>{p}</option>\n              ))}\n            </Form.Select>\n          </Col>\n          <Col>\n            <Form.Label>Local SN</Form.Label>\n            <Form.Control\n              placeholder=\"Search SN\"\n              value={filters.localSN}\n              onChange={(e) => {\n                const v = e.target.value;\n                setFilters((p) => ({ ...p, localSN: v }));\n              }}\n            />\n          </Col>\n        </Row>\n\n        {/* bulk action bar */}\n        <div className=\"d-flex mb-2 align-items-center\">\n          <Form.Check\n            type=\"checkbox\"\n            label=\"Select All\"\n            onChange={toggleSelectAll}\n            checked={\n              filteredItems.length > 0 &&\n              filteredItems.every((i) => selectedIds.has(i.id))\n            }\n          />\n          {selectedIds.size > 0 && (\n            <>\n              <Form.Select\n                className=\"mx-2\"\n                value={bulkField}\n                onChange={(e) => setBulkField(e.target.value)}\n                style={{ width: \"150px\" }}\n              >\n                <option value=\"\">Change…</option>\n                <option value=\"region\">Region</option>\n                <option value=\"section\">Section</option>\n                <option value=\"bin\">Bin</option>\n                <option value=\"pallet\">Pallet</option>\n              </Form.Select>\n              <Form.Control\n                style={{ width: \"100px\" }}\n                placeholder=\"New value\"\n                value={bulkValue}\n                onChange={(e) => setBulkValue(e.target.value)}\n              />\n              <Button className=\"ms-2\" onClick={applyBulkUpdate}>\n                Apply\n              </Button>\n            </>\n          )}\n        </div>\n\n        {/* data table */}\n        <Table bordered hover responsive>\n          <thead>\n            <tr>\n              <th></th>\n              <th>Name</th>\n              <th>PN</th>\n              <th>SN</th>\n              <th>LocalSN</th>\n              <th>Region</th>\n              <th>Section</th>\n              <th>Bin</th>\n              <th>Pallet</th>\n            </tr>\n          </thead>\n          <tbody>\n            {filteredItems.map((it) => (\n              <tr key={it.id}>\n                <td>\n                  <Form.Check\n                    type=\"checkbox\"\n                    checked={selectedIds.has(it.id)}\n                    onChange={() => toggleSelect(it.id)}\n                  />\n                </td>\n                <td>{it.name}</td>\n                <td>{it.pn}</td>\n                <td>{it.sn}</td>\n                <td>{it.localSN}</td>\n                <td>{it.region}</td>\n                <td>{it.section}</td>\n                <td>{it.bin}</td>\n                <td>{it.pallet}</td>\n              </tr>\n            ))}\n          </tbody>\n        </Table>\n      </Container>\n    </LoggedIn>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}