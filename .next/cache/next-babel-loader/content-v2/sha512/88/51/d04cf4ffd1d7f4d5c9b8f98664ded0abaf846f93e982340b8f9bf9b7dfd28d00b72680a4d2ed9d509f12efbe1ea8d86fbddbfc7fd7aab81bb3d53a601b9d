{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\NewSearch\\\\mainSearch.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from \"react\";\nimport { Container, Card, Row, Col, InputGroup, Dropdown, FormControl, Button, NavDropdown, Form, Modal, Spinner, Pagination } from \"react-bootstrap\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { fetchPartsWithMachineDataPage, fetchClients, fetchModels, formatDate } from \"../../utils/fetchAssociations\";\nimport { useAuth } from \"../../context/AuthUserContext\";\nimport LoggedIn from \"../LoggedIn\";\nimport ClientTable from \"../../utils/ClientTable\";\nimport ModelTable from \"../../utils/ModelTable\";\nimport PartTable from \"../../utils/PartTable\";\nimport styles from \"../../styles/MainSearch.module.css\";\nimport firebase from \"../../context/Firebase\"; // Predefined warehouse client IDs and display names\n\nconst SOCAL_CLIENT_ID = \"AIS17182\";\nconst NORCAL_CLIENT_ID = \"AIS25097\";\nconst UNASSIGNED_CLIENT_ID = \"AIS00404\";\nconst PAGE_SIZE = 25; // Simulates a network request delay\n\nfunction simulateNetworkRequest() {\n  return new Promise(resolve => setTimeout(resolve, 2000));\n} // Custom LoadingButton component\n\n\nfunction LoadingButton({\n  type,\n  name,\n  route\n}) {\n  const {\n    0: isLoading,\n    1: setLoading\n  } = useState(false);\n  useEffect(() => {\n    if (isLoading) {\n      let cancelled = false;\n      simulateNetworkRequest().then(() => {\n        if (!cancelled) setLoading(false);\n      });\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [isLoading]);\n  return __jsx(Link, {\n    href: `/${route}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", {\n    className: `btn btn-${type}`,\n    disabled: isLoading,\n    onClick: () => !isLoading && setLoading(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }\n  }, isLoading ? \"Loading…\" : name));\n} // ---- DATE HELPERS (top-level scope) ----\n// Convert anything date-ish into a timestamp (ms since epoch).\n\n\nfunction toTime(value) {\n  if (!value) return null; // Firestore Timestamp { seconds, nanoseconds }\n\n  if (typeof value === \"object\" && value !== null && value.seconds != null) {\n    try {\n      return value.seconds * 1000;\n    } catch {\n      /* ignore */\n    }\n  } // Native Date\n\n\n  if (value instanceof Date) {\n    const t = value.getTime();\n    return isNaN(t) ? null : t;\n  } // Strings\n\n\n  if (typeof value === \"string\") {\n    // ISO / yyyy-mm-dd\n    const iso = Date.parse(value);\n    if (!isNaN(iso)) return iso; // mm/dd/yyyy\n\n    const parts = value.split(\"/\");\n\n    if (parts.length === 3) {\n      const [mm, dd, yyyy] = parts;\n      const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\n      if (!isNaN(alt)) return alt;\n    }\n  } // Last resort\n\n\n  const t = Date.parse(value);\n  return isNaN(t) ? null : t;\n} // Canonicalize to 'yyyy-mm-dd' (matches <input type=\"date\">)\n\n\nfunction toYMD(value) {\n  const t = toTime(value);\n  if (t == null) return null;\n  const d = new Date(t);\n  const yyyy = d.getFullYear();\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  const dd = String(d.getDate()).padStart(2, \"0\");\n  return `${yyyy}-${mm}-${dd}`;\n}\n\nexport default function MainSearch() {\n  const {\n    signOut\n  } = useAuth();\n  const {\n    0: info,\n    1: setInfo\n  } = useState([]);\n  const {\n    0: backupInfo,\n    1: setBackupInfo\n  } = useState([]);\n  const {\n    0: augmentedInfo,\n    1: setAugmentedInfo\n  } = useState([]); // items with clientFromId/currentId added\n\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n  const {\n    0: ids,\n    1: setID\n  } = useState([]);\n  const {\n    0: show,\n    1: setShow\n  } = useState(false);\n  const {\n    0: dItem,\n    1: setDItem\n  } = useState();\n  const {\n    0: select,\n    1: setSelect\n  } = useState(\"Name\");\n  const {\n    0: showList,\n    1: setShowList\n  } = useState(false);\n  const {\n    0: showListSearch,\n    1: setShowListSearch\n  } = useState(\"text\");\n  const {\n    0: search,\n    1: setSearch\n  } = useState(\"\");\n  const {\n    0: selectedOEM,\n    1: setSelectedOEM\n  } = useState(null);\n  const {\n    0: selectedModality,\n    1: setSelectedModality\n  } = useState(null); // Replace the old single client state with two sets:\n\n  const {\n    0: selectedClientFrom,\n    1: setSelectedClientFrom\n  } = useState(null);\n  const {\n    0: clientFromButtonText,\n    1: setClientFromButtonText\n  } = useState(\"Select Option\");\n  const {\n    0: selectedClientCurrent,\n    1: setSelectedClientCurrent\n  } = useState(null);\n  const {\n    0: clientCurrentButtonText,\n    1: setClientCurrentButtonText\n  } = useState(\"Select Option\");\n  const {\n    0: clients,\n    1: setClients\n  } = useState([]);\n  const {\n    0: showClientModal,\n    1: setShowClientModal\n  } = useState(false); // This state tells the modal which client box is being updated: \"from\" or \"current\"\n\n  const {\n    0: clientSelectionType,\n    1: setClientSelectionType\n  } = useState(null);\n  const router = useRouter();\n  const labelBase = [\"name\", \"date\", \"w/o\", \"p/n\", \"s/n\"];\n  const labelBaseNames = [\"name\", \"date\", \"wo\", \"pn\", \"sn\"];\n  const sortCheckBase = [false, false, false, false, false, false];\n\n  function withSortIcon(baseLabels, activeIndex, isDesc) {\n    return baseLabels.map((text, i) => {\n      if (i !== activeIndex) return text; // untouched\n\n      const arrow = isDesc ? \" ▼\" : \" ▲\";\n      return `${text}${arrow}`;\n    });\n  }\n\n  const {\n    0: labels,\n    1: setLabels\n  } = useState(labelBase);\n  const {\n    0: sortCheck,\n    1: setSortCheck\n  } = useState(sortCheckBase);\n  const {\n    0: hoverIndex,\n    1: setHoverIndex\n  } = useState(null);\n  const {\n    0: selectedModel,\n    1: setSelectedModel\n  } = useState(null);\n  const {\n    0: gPos,\n    1: setGPos\n  } = useState(null);\n  const {\n    0: gIde,\n    1: setGIde\n  } = useState(null);\n  const {\n    0: isDeleting,\n    1: setIsDeleting\n  } = useState(false);\n  const {\n    0: page,\n    1: setPage\n  } = useState(1);\n  const {\n    0: pageCursors,\n    1: setPageCursors\n  } = useState([]);\n  const {\n    0: hasNextPage,\n    1: setHasNextPage\n  } = useState(false); // Fetch data on component mount and route change\n\n  useEffect(() => {\n    fetchData(page);\n  }, [router.route, page]);\n\n  async function fetchData(requestedPage = 1) {\n    setIsLoading(true);\n\n    try {\n      if (router.query.inputText && router.query.selectedType) {\n        setSelect(router.query.selectedType);\n        setSearch(router.query.inputText);\n      }\n\n      const startAfterDoc = requestedPage > 1 ? pageCursors[requestedPage - 2] : null;\n\n      if (requestedPage > 1 && !startAfterDoc) {\n        setPage(1);\n        return;\n      } // light retry for transient Firestore hiccups\n\n\n      const load = async (attempt = 1) => {\n        try {\n          return await fetchPartsWithMachineDataPage({\n            pageSize: PAGE_SIZE,\n            startAfterDoc\n          });\n        } catch (e) {\n          if (attempt >= 3) throw e;\n          await new Promise(r => setTimeout(r, 250 * Math.pow(2, attempt - 1)));\n          return load(attempt + 1);\n        }\n      };\n\n      const {\n        parts: data,\n        lastDoc,\n        hasNextPage: nextPage\n      } = await load();\n      setBackupInfo(data);\n      setLabels(labelBase); // <-- add this line after setBackupInfo(data)\n\n      setID(data.map(item => item.id));\n      setHasNextPage(nextPage);\n      setPageCursors(prev => {\n        const next = [...prev];\n        next[requestedPage - 1] = lastDoc;\n        return next;\n      });\n      setSelectedItems([]); // --- Pre-augment: resolve client ids of Machine / CurrentMachine once ---\n\n      const db = firebase.firestore();\n      const machineIds = [];\n      const curMachineIds = [];\n      const theMachineIds = []; // <-- ADD\n\n      for (const item of data) {\n        var _item$Machine, _item$CurrentMachine, _item$TheMachine;\n\n        if (item !== null && item !== void 0 && (_item$Machine = item.Machine) !== null && _item$Machine !== void 0 && _item$Machine.id) machineIds.push(item.Machine.id);\n        if (item !== null && item !== void 0 && (_item$CurrentMachine = item.CurrentMachine) !== null && _item$CurrentMachine !== void 0 && _item$CurrentMachine.id) curMachineIds.push(item.CurrentMachine.id);\n        if (item !== null && item !== void 0 && (_item$TheMachine = item.TheMachine) !== null && _item$TheMachine !== void 0 && _item$TheMachine.id) theMachineIds.push(item.TheMachine.id); // <-- ADD\n      }\n\n      const uniq = arr => [...new Set(arr)];\n\n      const mIds = uniq(machineIds);\n      const cIds = uniq(curMachineIds);\n\n      const fetchMachineClients = async ids => {\n        if (!ids.length) return {};\n        const out = {}; // Firestore \"in\" supports up to 10 document IDs per query\n\n        const chunks = [];\n\n        for (let i = 0; i < ids.length; i += 10) chunks.push(ids.slice(i, i + 10));\n\n        for (const chunk of chunks) {\n          const snap = await db.collection(\"Machine\").where(firebase.firestore.FieldPath.documentId(), \"in\", chunk).get();\n          snap.forEach(doc => {\n            var _md$client;\n\n            const md = doc.data() || {};\n            out[doc.id] = ((_md$client = md.client) === null || _md$client === void 0 ? void 0 : _md$client.id) || null;\n          });\n        }\n\n        return out;\n      }; // Fetch full machine docs (OEM/Modality/Model/Client/etc.) for a set of ids\n\n\n      const fetchMachinesData = async ids => {\n        if (!ids.length) return {};\n        const out = {};\n        const chunks = [];\n\n        for (let i = 0; i < ids.length; i += 10) chunks.push(ids.slice(i, i + 10));\n\n        for (const chunk of chunks) {\n          const snap = await db.collection(\"Machine\").where(firebase.firestore.FieldPath.documentId(), \"in\", chunk).get();\n          snap.forEach(doc => {\n            out[doc.id] = _objectSpread({\n              id: doc.id\n            }, doc.data() || {});\n          });\n        }\n\n        return out;\n      };\n\n      const [fromMap, curMap, theMap] = await Promise.all([fetchMachineClients(mIds), fetchMachineClients(cIds), fetchMachinesData(uniq(theMachineIds)) // <-- now captured as theMap\n      ]); // New-style only: take client ids straight from item refs\n\n      const augmented = data.map(item => {\n        var _item$ClientFrom$id, _item$ClientFrom, _item$ClientCurrent$i, _item$ClientCurrent;\n\n        return _objectSpread(_objectSpread({}, item), {}, {\n          clientFromId: (_item$ClientFrom$id = item === null || item === void 0 ? void 0 : (_item$ClientFrom = item.ClientFrom) === null || _item$ClientFrom === void 0 ? void 0 : _item$ClientFrom.id) !== null && _item$ClientFrom$id !== void 0 ? _item$ClientFrom$id : null,\n          clientCurrentId: (_item$ClientCurrent$i = item === null || item === void 0 ? void 0 : (_item$ClientCurrent = item.ClientCurrent) === null || _item$ClientCurrent === void 0 ? void 0 : _item$ClientCurrent.id) !== null && _item$ClientCurrent$i !== void 0 ? _item$ClientCurrent$i : null\n        });\n      });\n      setAugmentedInfo(augmented); // default view = everything not explicitly hidden\n\n      setInfo(augmented.filter(it => it.visible !== false));\n    } catch (err) {\n      console.error(\"Error fetching data:\", err);\n      setInfo([]);\n      setAugmentedInfo([]);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\n  const searchChangeHandler = event => setSearch(event.target.value); // Asynchronous filter function that loops through backupInfo and,\n  // for each item, fetches its Machine and CurrentMachine documents,\n  // then compares the client id (from machineData.client.id) to the selected client.\n\n\n  useEffect(() => {\n    function filterParts() {\n      const base = augmentedInfo; // already has clientFromId/clientCurrentId\n\n      const noFilters = !selectedOEM && !selectedModality && !selectedModel && !selectedClientFrom && !selectedClientCurrent && !search;\n\n      if (noFilters) {\n        setInfo(base.filter(it => it.visible !== false));\n        return;\n      }\n\n      const filtered = base.filter(item => {\n        var _ref, _item$machineData$OEM, _item$machineData, _item$theMachineData, _item$TheMachine2, _ref2, _item$machineData$Mod, _item$machineData2, _item$theMachineData2, _item$TheMachine3, _ref3, _item$machineData$Mod2, _item$machineData3, _item$theMachineData3, _item$TheMachine4;\n\n        // only hide when explicitly false\n        if (item.visible === false) return false; // OEM/modality/model via machineData (you already put this in items)\n        // OEM / Modality / Model filtering\n        // Prefer machineData; fall back to theMachineData; finally try inline TheMachine if it has plain fields\n\n        const OEM = (_ref = (_item$machineData$OEM = item === null || item === void 0 ? void 0 : (_item$machineData = item.machineData) === null || _item$machineData === void 0 ? void 0 : _item$machineData.OEM) !== null && _item$machineData$OEM !== void 0 ? _item$machineData$OEM : item === null || item === void 0 ? void 0 : (_item$theMachineData = item.theMachineData) === null || _item$theMachineData === void 0 ? void 0 : _item$theMachineData.OEM) !== null && _ref !== void 0 ? _ref : item === null || item === void 0 ? void 0 : (_item$TheMachine2 = item.TheMachine) === null || _item$TheMachine2 === void 0 ? void 0 : _item$TheMachine2.OEM;\n        const Modality = (_ref2 = (_item$machineData$Mod = item === null || item === void 0 ? void 0 : (_item$machineData2 = item.machineData) === null || _item$machineData2 === void 0 ? void 0 : _item$machineData2.Modality) !== null && _item$machineData$Mod !== void 0 ? _item$machineData$Mod : item === null || item === void 0 ? void 0 : (_item$theMachineData2 = item.theMachineData) === null || _item$theMachineData2 === void 0 ? void 0 : _item$theMachineData2.Modality) !== null && _ref2 !== void 0 ? _ref2 : item === null || item === void 0 ? void 0 : (_item$TheMachine3 = item.TheMachine) === null || _item$TheMachine3 === void 0 ? void 0 : _item$TheMachine3.Modality;\n        const Model = (_ref3 = (_item$machineData$Mod2 = item === null || item === void 0 ? void 0 : (_item$machineData3 = item.machineData) === null || _item$machineData3 === void 0 ? void 0 : _item$machineData3.Model) !== null && _item$machineData$Mod2 !== void 0 ? _item$machineData$Mod2 : item === null || item === void 0 ? void 0 : (_item$theMachineData3 = item.theMachineData) === null || _item$theMachineData3 === void 0 ? void 0 : _item$theMachineData3.Model) !== null && _ref3 !== void 0 ? _ref3 : item === null || item === void 0 ? void 0 : (_item$TheMachine4 = item.TheMachine) === null || _item$TheMachine4 === void 0 ? void 0 : _item$TheMachine4.Model;\n        if (selectedOEM && OEM !== selectedOEM) return false;\n        if (selectedModality && Modality !== selectedModality) return false;\n        if (selectedModel && Model !== selectedModel) return false; // Client filters (now instant)\n\n        if (selectedClientFrom && item.clientFromId !== selectedClientFrom) return false;\n        if (selectedClientCurrent && item.clientCurrentId !== selectedClientCurrent) return false; // Search\n\n        if (search) {\n          const s = String(search).toLowerCase();\n\n          if (select === \"Name\") {\n            return (item.name || \"\").toLowerCase().includes(s);\n          }\n\n          if (select === \"Date\") {\n            // If user hasn't picked a date yet, don't hide anything\n            if (!search) return true;\n            const wantedDay = search; // already 'yyyy-mm-dd' from <input type=\"date\">\n            // 1) Match item.date, regardless of its format or type\n\n            const itemYMD = toYMD(item.date);\n            if (itemYMD && itemYMD === wantedDay) return true; // 2) Also check any description dates (if you store dates there)\n\n            if (Array.isArray(item.descriptions)) {\n              const hitDesc = item.descriptions.some(d => toYMD(d === null || d === void 0 ? void 0 : d.date) === wantedDay);\n              if (hitDesc) return true;\n            } // 3) And work order dates (if present)\n\n\n            if (Array.isArray(item.workOrders)) {\n              const hitWO = item.workOrders.some(w => toYMD(w === null || w === void 0 ? void 0 : w.date) === wantedDay);\n              if (hitWO) return true;\n            }\n\n            return false;\n          }\n\n          if (select === \"Work Order\") {\n            return Array.isArray(item.workOrders) && item.workOrders.some(wo => String(wo.workOrder || \"\").toLowerCase().includes(s));\n          }\n\n          if (select === \"Product Number\") {\n            return String(item.pn || \"\").toLowerCase().includes(s);\n          }\n\n          if (select === \"Description\") {\n            return String(item.desc || \"\").toLowerCase().includes(s);\n          }\n\n          if (select === \"SKU\") {\n            return String(item.id || \"\").toLowerCase().includes(s);\n          }\n        }\n\n        return true;\n      });\n      setInfo(filtered);\n    }\n\n    filterParts();\n  }, [selectedOEM, selectedModality, selectedClientFrom, selectedClientCurrent, selectedModel, search, select, augmentedInfo]);\n\n  function sortCheckAll(pos) {\n    // Determine next direction: toggle the clicked column only\n    const nextSortCheck = sortCheck.map((v, i) => i === pos ? !v : v);\n    const isDesc = nextSortCheck[pos]; // true means descending\n\n    const sortedInfo = [...info].sort((a, b) => {\n      const key = labelBaseNames[pos];\n\n      if (pos === 1) {\n        // DATE column\n        const ta = toTime(a[key]);\n        const tb = toTime(b[key]); // Put missing dates at the end for ascending, at the start for descending\n\n        if (ta === null && tb === null) return 0;\n        if (ta === null) return isDesc ? -1 : 1;\n        if (tb === null) return isDesc ? 1 : -1;\n        return isDesc ? tb - ta : ta - tb;\n      } // NAME or SKU (string-y columns): indexes 0 or 5 in your original logic\n\n\n      if (pos === 0 || pos === 5) {\n        var _a$key, _b$key;\n\n        const av = ((_a$key = a[key]) !== null && _a$key !== void 0 ? _a$key : \"\").toString();\n        const bv = ((_b$key = b[key]) !== null && _b$key !== void 0 ? _b$key : \"\").toString();\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\n      } // Numeric-ish columns (wo, pn, sn) — fall back to string compare if NaN\n\n\n      const an = Number(a[key]);\n      const bn = Number(b[key]);\n\n      if (!isNaN(an) && !isNaN(bn)) {\n        return isDesc ? bn - an : an - bn;\n      } else {\n        var _a$key2, _b$key2;\n\n        const av = ((_a$key2 = a[key]) !== null && _a$key2 !== void 0 ? _a$key2 : \"\").toString();\n        const bv = ((_b$key2 = b[key]) !== null && _b$key2 !== void 0 ? _b$key2 : \"\").toString();\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\n      }\n    });\n    setInfo(sortedInfo);\n    setSortCheck(nextSortCheck); // Update header labels to show the little arrow on the active column\n\n    setLabels(withSortIcon(labelBase, pos, isDesc));\n  }\n\n  const rowSelect = item => {\n    if (item && item.id) {\n      console.log(\"Selected item:\", item);\n      router.push(\"./item/\" + item.id);\n    } else {\n      console.error(\"Unable to determine the selected item’s ID: \", item);\n    }\n  };\n\n  const {\n    0: selectedItems,\n    1: setSelectedItems\n  } = useState([]);\n  const {\n    0: showDeleteModal,\n    1: setShowDeleteModal\n  } = useState(false);\n\n  const handleSelectItem = id => {\n    setSelectedItems(prev => prev.includes(id) ? prev.filter(x => x !== id) : [...prev, id]);\n  }; // setSelectedItems((prev) => {\n  //   const newSelection = prev.includes(id)\n  //     ? prev.filter((itemId) => itemId !== id)\n  //     : [...prev, id];\n  //   console.log(\"Selected items:\", newSelection);\n  //   return newSelection; // <- important\n  // });\n\n\n  const handleShowDeleteModal = () => setShowDeleteModal(true);\n\n  const handleCloseDeleteModal = () => setShowDeleteModal(false);\n\n  const handleDeleteSelected = async () => {\n    setIsDeleting(true);\n    const db = firebase.firestore();\n\n    try {\n      // Loop over each selected item one at a time\n      for (const itemId of selectedItems) {\n        console.log(itemId);\n\n        try {\n          // Delete from \"Test\" collection\n          await db.collection(\"Test\").doc(itemId).delete();\n        } catch (err) {\n          console.error(`Error deleting document ${itemId} from Test:`, err);\n        }\n\n        try {\n          // Delete from \"Parts\" collection\n          await db.collection(\"Parts\").doc(itemId).delete();\n        } catch (err) {\n          console.error(`Error deleting document ${itemId} from Parts:`, err);\n        }\n\n        try {\n          // Delete associated photos from storage\n          await deleteFromStorage(itemId);\n        } catch (err) {\n          console.error(`Error deleting storage for ${itemId}:`, err);\n        }\n      } // Update local state by filtering out the deleted items\n\n\n      setInfo(info.filter(item => !selectedItems.includes(item.id)));\n      setSelectedItems([]);\n    } catch (error) {\n      console.error(\"Error deleting items:\", error);\n    } finally {\n      setIsDeleting(false);\n      handleCloseDeleteModal(); // Optionally, reload the page\n      // router.reload();\n    }\n  };\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true);\n\n  const checkDelete = (event, pos, idsToDelete, name) => {\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n\n    console.log(\"Selected IDs to delete:\", idsToDelete);\n    setSelectedItems(idsToDelete);\n    setDItem(name);\n    setShowDeleteModal(true);\n  }; // const handleDelete = async () => {\n  //   let itemId = gIde;\n  //   try {\n  //     setIsDeleting(true);\n  //     const db = firebase.firestore();\n  //     await db.collection(\"Test\").doc(itemId).delete();\n  //     await deleteFromPartsCollection(itemId);\n  //     await deleteFromStorage(itemId);\n  //     setInfo(info.filter((_, i) => gPos !== i));\n  //     console.log(`Deleted item: ${itemId}`);\n  //   } catch (error) {\n  //     console.error(\"Error deleting item:\", error);\n  //   } finally {\n  //     setIsDeleting(false);\n  //   }\n  //   handleClose();\n  // };\n\n\n  const hoverStyle = index => ({\n    backgroundColor: hoverIndex === index ? \"#ddd\" : \"transparent\",\n    textAlign: \"center\",\n    cursor: \"default\"\n  });\n\n  const {\n    0: dropdown1Text,\n    1: setDropdown1Text\n  } = useState(\"Select Option\");\n  const {\n    0: dropdown2Text,\n    1: setDropdown2Text\n  } = useState(\"Select Option\");\n\n  const handleSelect1 = (eventKey, event) => {\n    if (eventKey === \"unassigned\") {\n      setDropdown1Text(\"Select Option\");\n      setSelectedOEM(null);\n    } else {\n      setDropdown1Text(event.target.textContent);\n      setSelectedOEM(event.target.textContent);\n    }\n  };\n\n  const handleSelect2 = (eventKey, event) => {\n    if (eventKey === \"unassigned\") {\n      setDropdown2Text(\"Select Option\");\n      setSelectedModality(null);\n    } else {\n      setDropdown2Text(event.target.textContent);\n      setSelectedModality(event.target.textContent);\n    }\n  }; // Build a unique list of clients from the items currently loaded, filtered by OEM/Modality.\n  // `type` is \"from\" or \"current\" to decide which client ref to read.\n\n\n  async function buildClientsFromItems(type) {\n    const db = firebase.firestore();\n    const ids = new Set(); // Respect current OEM / Modality filters when deriving client options\n\n    const filtered = augmentedInfo.filter(item => {\n      var _ref4, _item$machineData$OEM2, _item$machineData4, _ref5, _item$machineData$Mod3, _item$machineData5;\n\n      const OEM = (_ref4 = (_item$machineData$OEM2 = item === null || item === void 0 ? void 0 : (_item$machineData4 = item.machineData) === null || _item$machineData4 === void 0 ? void 0 : _item$machineData4.OEM) !== null && _item$machineData$OEM2 !== void 0 ? _item$machineData$OEM2 : item === null || item === void 0 ? void 0 : item.OEM) !== null && _ref4 !== void 0 ? _ref4 : null;\n      const Modality = (_ref5 = (_item$machineData$Mod3 = item === null || item === void 0 ? void 0 : (_item$machineData5 = item.machineData) === null || _item$machineData5 === void 0 ? void 0 : _item$machineData5.Modality) !== null && _item$machineData$Mod3 !== void 0 ? _item$machineData$Mod3 : item === null || item === void 0 ? void 0 : item.Modality) !== null && _ref5 !== void 0 ? _ref5 : null;\n      if (selectedOEM && OEM !== selectedOEM) return false;\n      if (selectedModality && Modality !== selectedModality) return false;\n      return true;\n    });\n\n    for (const it of filtered) {\n      const id = type === \"from\" ? it.clientFromId : it.clientCurrentId;\n      if (id) ids.add(id);\n    }\n\n    const out = [];\n    const idArray = [...ids];\n\n    for (let i = 0; i < idArray.length; i += 10) {\n      const chunk = idArray.slice(i, i + 10);\n      const snap = await db.collection(\"Client\").where(firebase.firestore.FieldPath.documentId(), \"in\", chunk).get();\n      snap.forEach(doc => {\n        const d = doc.data() || {};\n        out.push({\n          id: doc.id,\n          name: d.name || doc.id\n        });\n      });\n    } // sort by name for nicer UX\n\n\n    out.sort((a, b) => (a.name || \"\").localeCompare(b.name || \"\"));\n    return out;\n  } // --------------------\n  // CLIENT SELECTION HANDLING\n  // --------------------\n  // This function fetches clients and opens the client modal.\n\n\n  const handleClientClick = async () => {\n    let safeClients = [];\n\n    try {\n      const clientsData = await fetchClients(selectedOEM, selectedModality);\n      safeClients = Array.isArray(clientsData) ? clientsData : [];\n    } catch (e) {\n      console.error(\"fetchClients failed:\", e);\n    } // Fallback to building from loaded items if API gave us nothing\n\n\n    if (safeClients.length === 0) {\n      try {\n        if (!clientSelectionType) {\n          // if somehow not set yet, default to \"from\"\n          setClientSelectionType(\"from\");\n        }\n\n        const derived = await buildClientsFromItems(clientSelectionType || \"from\");\n        safeClients = derived;\n      } catch (e) {\n        console.error(\"Fallback buildClientsFromItems failed:\", e);\n        safeClients = [];\n      }\n    }\n\n    setClients(safeClients);\n    setClientSearchTerm(\"\");\n    setShowClientModal(true);\n  }; // When a client is selected in the modal, we now assume the parameter is a client ID.\n  // If the passed value is null, we clear the selection.\n\n\n  const handleClientSelect = async clientId => {\n    console.log(\"User selected client id:\", clientId);\n\n    if (!clientId) {\n      if (clientSelectionType === \"from\") {\n        setClientFromButtonText(\"Select Option\");\n        setSelectedClientFrom(null);\n      } else if (clientSelectionType === \"current\") {\n        setClientCurrentButtonText(\"Select Option\");\n        setSelectedClientCurrent(null);\n      }\n\n      setShowClientModal(false);\n      return;\n    }\n\n    try {\n      const clientSnap = await firebase.firestore().collection(\"Client\").doc(clientId).get();\n\n      if (clientSnap.exists) {\n        const clientData = clientSnap.data();\n\n        if (clientSelectionType === \"from\") {\n          setClientFromButtonText(clientData.name);\n          setSelectedClientFrom(clientId);\n        } else if (clientSelectionType === \"current\") {\n          setClientCurrentButtonText(clientData.name);\n          setSelectedClientCurrent(clientId);\n        }\n      } else {\n        console.error(\"No client document found for id:\", clientId);\n      }\n    } catch (error) {\n      console.error(\"Error fetching client data:\", error);\n    }\n\n    setShowClientModal(false);\n  };\n\n  const handleClientInfo = (clientId, clientName) => {\n    console.log(`Client ID: ${clientId}, Client Name: ${clientName}`);\n    router.push(\"client/\" + clientId);\n  };\n\n  const handleClearClientSelection = () => {\n    if (clientSelectionType === \"from\") {\n      setClientFromButtonText(\"Select Option\");\n      setSelectedClientFrom(null);\n    } else if (clientSelectionType === \"current\") {\n      setClientCurrentButtonText(\"Select Option\");\n      setSelectedClientCurrent(null);\n    }\n\n    setShowClientModal(false);\n  }; // --------------------\n  // MODEL SELECTION HANDLING\n  // --------------------\n\n\n  const {\n    0: models,\n    1: setModels\n  } = useState([]);\n  const {\n    0: showModelModal,\n    1: setShowModelModal\n  } = useState(false);\n  const {\n    0: modelButtonText,\n    1: setModelButtonText\n  } = useState(\"Select Option\");\n\n  const handleModelClick = async () => {\n    const modelsData = await fetchModels(selectedOEM, selectedModality, selectedClientFrom);\n    setModels(modelsData);\n    setModelSearchTerm(\"\");\n    setShowModelModal(true);\n  };\n\n  const handleModelSelect = modelName => {\n    setModelButtonText(modelName || \"Select Option\");\n    setSelectedModel(modelName || null);\n    setShowModelModal(false);\n  };\n\n  const handleClearModelSelection = () => {\n    setModelButtonText(\"Select Option\");\n    setSelectedModel(null);\n    setShowModelModal(false);\n  }; // --------------------\n  // WAREHOUSE BUTTONS (for Client Current)\n  // --------------------\n\n\n  const handleSoCalWarehouseClick = () => {\n    setClientCurrentButtonText(\"SoCal Warehouse\");\n    setSelectedClientCurrent(SOCAL_CLIENT_ID);\n    console.log(\"Warehouse button clicked: setting Client Current to\", SOCAL_CLIENT_ID);\n  };\n\n  const handleNorCalWarehouseClick = () => {\n    setClientCurrentButtonText(\"NorCal Warehouse\");\n    setSelectedClientCurrent(NORCAL_CLIENT_ID);\n    console.log(\"Warehouse button clicked: setting Client Current to\", NORCAL_CLIENT_ID);\n  };\n\n  const handleWarehouseUnassignedClick = () => {\n    setClientCurrentButtonText(\"Unassigned\");\n    setSelectedClientCurrent(UNASSIGNED_CLIENT_ID);\n    console.log(\"Warehouse button clicked: setting Client Current to\", UNASSIGNED_CLIENT_ID);\n  };\n\n  const {\n    0: clientSearchTerm,\n    1: setClientSearchTerm\n  } = useState(\"\");\n  const {\n    0: modelSearchTerm,\n    1: setModelSearchTerm\n  } = useState(\"\");\n\n  const deleteFromStorage = async itemId => {\n    const storageRef = firebase.storage().ref();\n    const folderRef = storageRef.child(`Parts/${itemId}/`);\n\n    try {\n      const listResult = await folderRef.listAll();\n      const deletePromises = listResult.items.map(item => item.delete());\n      await Promise.all(deletePromises);\n    } catch (error) {\n      console.error(\"Error deleting from storage:\", error);\n    }\n  };\n\n  const deleteFromPartsCollection = async itemId => {\n    const db = firebase.firestore();\n\n    try {\n      await db.collection(\"Parts\").doc(itemId).delete();\n      console.log(`Deleted item from Parts collection: ${itemId}`);\n    } catch (error) {\n      console.error(\"Error deleting from Parts collection:\", error);\n    }\n  }; //   // Safely convert any date-ish value into a comparable timestamp (ms since epoch).\n  // function toTime(value) {\n  //   if (!value) return null;\n  //   // Firestore Timestamp: { seconds, nanoseconds }\n  //   if (typeof value === \"object\" && value.seconds) {\n  //     try {\n  //       return value.seconds * 1000;\n  //     } catch { /* fallthrough */ }\n  //   }\n  //   // If already a Date\n  //   if (value instanceof Date) return isNaN(value.getTime()) ? null : value.getTime();\n  //   // If string: try ISO first\n  //   if (typeof value === \"string\") {\n  //     // yyyy-mm-dd (from your form inputs)\n  //     const iso = Date.parse(value);\n  //     if (!isNaN(iso)) return iso;\n  //     // mm/dd/yyyy fallback (older items)\n  //     const parts = value.split(\"/\");\n  //     if (parts.length === 3) {\n  //       const [mm, dd, yyyy] = parts;\n  //       const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\n  //       if (!isNaN(alt)) return alt;\n  //     }\n  //   }\n  //   // Canonicalize any date-ish value to 'yyyy-mm-dd' so it matches <input type=\"date\"> values\n  //   function toYMD(value) {\n  //     const t = toTime(value);\n  //     if (t == null) return null;\n  //     const d = new Date(t);\n  //     const yyyy = d.getFullYear();\n  //     const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  //     const dd = String(d.getDate()).padStart(2, \"0\");\n  //     return `${yyyy}-${mm}-${dd}`;\n  //   }\n  //   // Last resort\n  //   const t = Date.parse(value);\n  //   return isNaN(t) ? null : t;\n  // }\n\n\n  const totalKnownPages = Math.max(1, pageCursors.length + (hasNextPage ? 1 : 0));\n  const pageButtons = [];\n\n  for (let i = 1; i <= totalKnownPages; i++) {\n    pageButtons.push(__jsx(Pagination.Item, {\n      key: i,\n      active: i === page,\n      onClick: () => setPage(i),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 829,\n        columnNumber: 7\n      }\n    }, i));\n  }\n\n  return __jsx(LoggedIn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 841,\n      columnNumber: 5\n    }\n  }, isDeleting && __jsx(\"div\", {\n    className: \"loading-overlay\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 843,\n      columnNumber: 9\n    }\n  }, __jsx(Spinner, {\n    animation: \"border\",\n    role: \"status\",\n    className: \"spinner-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 844,\n      columnNumber: 11\n    }\n  }, __jsx(\"span\", {\n    className: \"sr-only\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 845,\n      columnNumber: 13\n    }\n  }, \"Loading...\"))), __jsx(Modal, {\n    show: showDeleteModal,\n    onHide: handleCloseDeleteModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 849,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 850,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 851,\n      columnNumber: 11\n    }\n  }, \"Confirm Deletion\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 853,\n      columnNumber: 9\n    }\n  }, \"Are you sure you want to delete \", selectedItems.length, \" item\", selectedItems.length > 1 ? \"s\" : \"\", \"?\"), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 857,\n      columnNumber: 9\n    }\n  }, __jsx(Button, {\n    variant: \"danger\",\n    onClick: handleDeleteSelected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 858,\n      columnNumber: 11\n    }\n  }, \"Yes, delete\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseDeleteModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 861,\n      columnNumber: 11\n    }\n  }, \"Cancel\"))), __jsx(Modal, {\n    show: showClientModal,\n    onHide: () => setShowClientModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 867,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 868,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 869,\n      columnNumber: 11\n    }\n  }, \"Select \", clientSelectionType === \"from\" ? \"Client From\" : \"Client Current\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 873,\n      columnNumber: 9\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: clientSearchTerm,\n    onChange: e => setClientSearchTerm(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 874,\n      columnNumber: 11\n    }\n  }), __jsx(ClientTable, {\n    clients: (Array.isArray(clients) ? clients : []).filter(client => {\n      var _client$name;\n\n      return ((_client$name = client === null || client === void 0 ? void 0 : client.name) !== null && _client$name !== void 0 ? _client$name : \"\").toLowerCase().includes(clientSearchTerm.toLowerCase());\n    }),\n    onSelectClient: handleClientSelect,\n    onInfoClick: handleClientInfo,\n    isClientSearch: false,\n    clearSelection: () => handleClientSelect(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 881,\n      columnNumber: 11\n    }\n  }))), __jsx(Modal, {\n    show: showModelModal,\n    onHide: () => setShowModelModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 893,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 894,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 895,\n      columnNumber: 11\n    }\n  }, \"Select Model\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 897,\n      columnNumber: 9\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: modelSearchTerm,\n    onChange: e => setModelSearchTerm(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 898,\n      columnNumber: 11\n    }\n  }), __jsx(ModelTable, {\n    models: models.filter(model => typeof model === \"string\" ? model.toLowerCase().includes(modelSearchTerm.toLowerCase()) : false),\n    onSelectModel: handleModelSelect,\n    clearSelection: () => handleModelSelect(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 905,\n      columnNumber: 11\n    }\n  }))), __jsx(Container, {\n    className: \"d-flex align-items-center justify-content-center\",\n    style: {\n      minHeight: \"100vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 917,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"w-100\",\n    style: {\n      maxWidth: \"1200px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 921,\n      columnNumber: 9\n    }\n  }, __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 922,\n      columnNumber: 11\n    }\n  }, __jsx(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 923,\n      columnNumber: 13\n    }\n  }, __jsx(\"h2\", {\n    className: \"text-center mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 924,\n      columnNumber: 15\n    }\n  }, \"Magmo\"), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 925,\n      columnNumber: 15\n    }\n  }, __jsx(Col, {\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 926,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 928,\n      columnNumber: 19\n    }\n  }, __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 929,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 930,\n      columnNumber: 23\n    }\n  }, \"OEM\"), __jsx(Dropdown, {\n    onSelect: handleSelect1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 931,\n      columnNumber: 23\n    }\n  }, __jsx(Dropdown.Toggle, {\n    variant: \"outline-secondary\",\n    id: \"dropdown-button-1\",\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 932,\n      columnNumber: 25\n    }\n  }, dropdown1Text), __jsx(Dropdown.Menu, {\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 939,\n      columnNumber: 25\n    }\n  }, __jsx(Dropdown.Item, {\n    eventKey: \"unassigned\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 940,\n      columnNumber: 27\n    }\n  }, \"Select Option\"), __jsx(Dropdown.Item, {\n    eventKey: \"GE\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 943,\n      columnNumber: 27\n    }\n  }, \"GE\"), __jsx(Dropdown.Item, {\n    eventKey: \"Toshiba\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 944,\n      columnNumber: 27\n    }\n  }, \"Toshiba\"), __jsx(Dropdown.Item, {\n    eventKey: \"Siemens\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 947,\n      columnNumber: 27\n    }\n  }, \"Siemens\"), __jsx(Dropdown.Item, {\n    eventKey: \"Philips\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 950,\n      columnNumber: 27\n    }\n  }, \"Philips\")))), __jsx(InputGroup, {\n    className: \"mb-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 957,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 958,\n      columnNumber: 23\n    }\n  }, \"Modality\"), __jsx(Dropdown, {\n    onSelect: handleSelect2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 959,\n      columnNumber: 23\n    }\n  }, __jsx(Dropdown.Toggle, {\n    variant: \"outline-secondary\",\n    id: \"dropdown-button-2\",\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 960,\n      columnNumber: 25\n    }\n  }, dropdown2Text), __jsx(Dropdown.Menu, {\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 967,\n      columnNumber: 25\n    }\n  }, __jsx(Dropdown.Item, {\n    eventKey: \"unassigned\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 968,\n      columnNumber: 27\n    }\n  }, \"Select Option\"), __jsx(Dropdown.Item, {\n    eventKey: \"CT\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 971,\n      columnNumber: 27\n    }\n  }, \"CT\"), __jsx(Dropdown.Item, {\n    eventKey: \"MRI\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 972,\n      columnNumber: 27\n    }\n  }, \"MRI\"))))), __jsx(\"div\", {\n    className: styles.divider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 978,\n      columnNumber: 19\n    }\n  }), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 981,\n      columnNumber: 19\n    }\n  }, __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 982,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 983,\n      columnNumber: 23\n    }\n  }, \"Client From\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: () => handleClientClick(\"from\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 984,\n      columnNumber: 23\n    }\n  }, clientFromButtonText)), __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 993,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 994,\n      columnNumber: 23\n    }\n  }, \"Client Current\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: () => handleClientClick(\"current\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 995,\n      columnNumber: 23\n    }\n  }, clientCurrentButtonText)), __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1005,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1006,\n      columnNumber: 23\n    }\n  }, \"Model\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: handleModelClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1007,\n      columnNumber: 23\n    }\n  }, modelButtonText)), __jsx(\"div\", {\n    className: styles.divider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1016,\n      columnNumber: 21\n    }\n  }), __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1019,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1020,\n      columnNumber: 23\n    }\n  }, \"Warehouse\"), __jsx(\"div\", {\n    className: styles.buttonGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1021,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.flexButton,\n    onClick: handleSoCalWarehouseClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1022,\n      columnNumber: 25\n    }\n  }, \"SoCal Warehouse\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.flexButton,\n    onClick: handleNorCalWarehouseClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1029,\n      columnNumber: 25\n    }\n  }, \"NorCal Warehouse\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.flexButton,\n    onClick: handleWarehouseUnassignedClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1036,\n      columnNumber: 25\n    }\n  }, \"Unassigned\"))))), __jsx(Col, {\n    md: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1048,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: styles.tableContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1049,\n      columnNumber: 19\n    }\n  }, isLoading ? __jsx(\"div\", {\n    className: \"jsx-1682384643\" + \" \" + \"d-flex justify-content-center align-items-center p-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1051,\n      columnNumber: 23\n    }\n  }, __jsx(\"img\", {\n    src: \"/magmo-logo.png\" // make sure it's in /public\n    ,\n    alt: \"Loading Magmo\",\n    style: {\n      width: 64,\n      height: 64,\n      animation: \"magmo-spin 1s linear infinite\",\n      transformOrigin: \"50% 50%\",\n      display: \"block\"\n    },\n    className: \"jsx-1682384643\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1052,\n      columnNumber: 25\n    }\n  }), __jsx(_JSXStyle, {\n    id: \"1682384643\",\n    __self: this,\n    __source: void 0\n  }, \"@-webkit-keyframes magmo-spin{from{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}to{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}@keyframes magmo-spin{from{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}to{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFjazJcXERlc2t0b3BcXGNvZGVcXHBhZ2VzXFxOZXdTZWFyY2hcXG1haW5TZWFyY2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBd2lDMkMsQUFJa0MsQUFHRSxpRkFGM0IsTUFHQSIsImZpbGUiOiJDOlxcVXNlcnNcXG1hY2syXFxEZXNrdG9wXFxjb2RlXFxwYWdlc1xcTmV3U2VhcmNoXFxtYWluU2VhcmNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcclxuaW1wb3J0IHtcclxuICBDb250YWluZXIsXG4gIENhcmQsXG4gIFJvdyxcbiAgQ29sLFxuICBJbnB1dEdyb3VwLFxuICBEcm9wZG93bixcbiAgRm9ybUNvbnRyb2wsXG4gIEJ1dHRvbixcbiAgTmF2RHJvcGRvd24sXG4gIEZvcm0sXG4gIE1vZGFsLFxuICBTcGlubmVyLFxuICBQYWdpbmF0aW9uLFxufSBmcm9tIFwicmVhY3QtYm9vdHN0cmFwXCI7XG5pbXBvcnQgTGluayBmcm9tIFwibmV4dC9saW5rXCI7XG5pbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tIFwibmV4dC9yb3V0ZXJcIjtcbmltcG9ydCB7XG4gIGZldGNoUGFydHNXaXRoTWFjaGluZURhdGFQYWdlLFxuICBmZXRjaENsaWVudHMsXG4gIGZldGNoTW9kZWxzLFxuICBmb3JtYXREYXRlLFxufSBmcm9tIFwiLi4vLi4vdXRpbHMvZmV0Y2hBc3NvY2lhdGlvbnNcIjtcbmltcG9ydCB7IHVzZUF1dGggfSBmcm9tIFwiLi4vLi4vY29udGV4dC9BdXRoVXNlckNvbnRleHRcIjtcclxuaW1wb3J0IExvZ2dlZEluIGZyb20gXCIuLi9Mb2dnZWRJblwiO1xyXG5pbXBvcnQgQ2xpZW50VGFibGUgZnJvbSBcIi4uLy4uL3V0aWxzL0NsaWVudFRhYmxlXCI7XHJcbmltcG9ydCBNb2RlbFRhYmxlIGZyb20gXCIuLi8uLi91dGlscy9Nb2RlbFRhYmxlXCI7XHJcbmltcG9ydCBQYXJ0VGFibGUgZnJvbSBcIi4uLy4uL3V0aWxzL1BhcnRUYWJsZVwiO1xyXG5pbXBvcnQgc3R5bGVzIGZyb20gXCIuLi8uLi9zdHlsZXMvTWFpblNlYXJjaC5tb2R1bGUuY3NzXCI7XHJcbmltcG9ydCBmaXJlYmFzZSBmcm9tIFwiLi4vLi4vY29udGV4dC9GaXJlYmFzZVwiO1xyXG5cclxuLy8gUHJlZGVmaW5lZCB3YXJlaG91c2UgY2xpZW50IElEcyBhbmQgZGlzcGxheSBuYW1lc1xyXG5jb25zdCBTT0NBTF9DTElFTlRfSUQgPSBcIkFJUzE3MTgyXCI7XHJcbmNvbnN0IE5PUkNBTF9DTElFTlRfSUQgPSBcIkFJUzI1MDk3XCI7XG5jb25zdCBVTkFTU0lHTkVEX0NMSUVOVF9JRCA9IFwiQUlTMDA0MDRcIjtcbmNvbnN0IFBBR0VfU0laRSA9IDI1O1xuXHJcblxyXG4vLyBTaW11bGF0ZXMgYSBuZXR3b3JrIHJlcXVlc3QgZGVsYXlcclxuZnVuY3Rpb24gc2ltdWxhdGVOZXR3b3JrUmVxdWVzdCgpIHtcclxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMjAwMCkpO1xyXG59XHJcblxyXG4vLyBDdXN0b20gTG9hZGluZ0J1dHRvbiBjb21wb25lbnRcclxuZnVuY3Rpb24gTG9hZGluZ0J1dHRvbih7IHR5cGUsIG5hbWUsIHJvdXRlIH0pIHtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0TG9hZGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICBsZXQgY2FuY2VsbGVkID0gZmFsc2U7XG4gICAgICBzaW11bGF0ZU5ldHdvcmtSZXF1ZXN0KCkudGhlbigoKSA9PiB7XG4gICAgICAgIGlmICghY2FuY2VsbGVkKSBzZXRMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuICgpID0+IHtcbiAgICAgICAgY2FuY2VsbGVkID0gdHJ1ZTtcbiAgICAgIH07XG4gICAgfVxuICB9LCBbaXNMb2FkaW5nXSk7XG5cclxuICByZXR1cm4gKFxyXG4gICAgPExpbmsgaHJlZj17YC8ke3JvdXRlfWB9PlxyXG4gICAgICA8YVxyXG4gICAgICAgIGNsYXNzTmFtZT17YGJ0biBidG4tJHt0eXBlfWB9XHJcbiAgICAgICAgZGlzYWJsZWQ9e2lzTG9hZGluZ31cclxuICAgICAgICBvbkNsaWNrPXsoKSA9PiAhaXNMb2FkaW5nICYmIHNldExvYWRpbmcodHJ1ZSl9XHJcbiAgICAgID5cclxuICAgICAgICB7aXNMb2FkaW5nID8gXCJMb2FkaW5n4oCmXCIgOiBuYW1lfVxyXG4gICAgICA8L2E+XHJcbiAgICA8L0xpbms+XHJcbiAgKTtcclxufVxyXG5cclxuLy8gLS0tLSBEQVRFIEhFTFBFUlMgKHRvcC1sZXZlbCBzY29wZSkgLS0tLVxyXG5cclxuLy8gQ29udmVydCBhbnl0aGluZyBkYXRlLWlzaCBpbnRvIGEgdGltZXN0YW1wIChtcyBzaW5jZSBlcG9jaCkuXHJcbmZ1bmN0aW9uIHRvVGltZSh2YWx1ZSkge1xyXG4gIGlmICghdmFsdWUpIHJldHVybiBudWxsO1xyXG5cclxuICAvLyBGaXJlc3RvcmUgVGltZXN0YW1wIHsgc2Vjb25kcywgbmFub3NlY29uZHMgfVxyXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiYgdmFsdWUgIT09IG51bGwgJiYgdmFsdWUuc2Vjb25kcyAhPSBudWxsKSB7XHJcbiAgICB0cnkgeyByZXR1cm4gdmFsdWUuc2Vjb25kcyAqIDEwMDA7IH0gY2F0Y2ggeyAvKiBpZ25vcmUgKi8gfVxyXG4gIH1cclxuXHJcbiAgLy8gTmF0aXZlIERhdGVcclxuICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XHJcbiAgICBjb25zdCB0ID0gdmFsdWUuZ2V0VGltZSgpO1xyXG4gICAgcmV0dXJuIGlzTmFOKHQpID8gbnVsbCA6IHQ7XHJcbiAgfVxyXG5cclxuICAvLyBTdHJpbmdzXHJcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgLy8gSVNPIC8geXl5eS1tbS1kZFxyXG4gICAgY29uc3QgaXNvID0gRGF0ZS5wYXJzZSh2YWx1ZSk7XHJcbiAgICBpZiAoIWlzTmFOKGlzbykpIHJldHVybiBpc287XHJcblxyXG4gICAgLy8gbW0vZGQveXl5eVxyXG4gICAgY29uc3QgcGFydHMgPSB2YWx1ZS5zcGxpdChcIi9cIik7XHJcbiAgICBpZiAocGFydHMubGVuZ3RoID09PSAzKSB7XHJcbiAgICAgIGNvbnN0IFttbSwgZGQsIHl5eXldID0gcGFydHM7XHJcbiAgICAgIGNvbnN0IGFsdCA9IERhdGUucGFyc2UoYCR7eXl5eX0tJHttbX0tJHtkZH1gKTtcclxuICAgICAgaWYgKCFpc05hTihhbHQpKSByZXR1cm4gYWx0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gTGFzdCByZXNvcnRcclxuICBjb25zdCB0ID0gRGF0ZS5wYXJzZSh2YWx1ZSk7XHJcbiAgcmV0dXJuIGlzTmFOKHQpID8gbnVsbCA6IHQ7XHJcbn1cclxuXHJcbi8vIENhbm9uaWNhbGl6ZSB0byAneXl5eS1tbS1kZCcgKG1hdGNoZXMgPGlucHV0IHR5cGU9XCJkYXRlXCI+KVxyXG5mdW5jdGlvbiB0b1lNRCh2YWx1ZSkge1xyXG4gIGNvbnN0IHQgPSB0b1RpbWUodmFsdWUpO1xyXG4gIGlmICh0ID09IG51bGwpIHJldHVybiBudWxsO1xyXG4gIGNvbnN0IGQgPSBuZXcgRGF0ZSh0KTtcclxuICBjb25zdCB5eXl5ID0gZC5nZXRGdWxsWWVhcigpO1xyXG4gIGNvbnN0IG1tID0gU3RyaW5nKGQuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcclxuICBjb25zdCBkZCA9IFN0cmluZyhkLmdldERhdGUoKSkucGFkU3RhcnQoMiwgXCIwXCIpO1xyXG4gIHJldHVybiBgJHt5eXl5fS0ke21tfS0ke2RkfWA7XHJcbn1cclxuXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBNYWluU2VhcmNoKCkge1xyXG4gIGNvbnN0IHsgc2lnbk91dCB9ID0gdXNlQXV0aCgpO1xyXG4gIGNvbnN0IFtpbmZvLCBzZXRJbmZvXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCBbYmFja3VwSW5mbywgc2V0QmFja3VwSW5mb10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW2F1Z21lbnRlZEluZm8sIHNldEF1Z21lbnRlZEluZm9dID0gdXNlU3RhdGUoW10pOyAvLyBpdGVtcyB3aXRoIGNsaWVudEZyb21JZC9jdXJyZW50SWQgYWRkZWRcclxuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUodHJ1ZSk7XHJcbiAgY29uc3QgW2lkcywgc2V0SURdID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFtzaG93LCBzZXRTaG93XSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbZEl0ZW0sIHNldERJdGVtXSA9IHVzZVN0YXRlKCk7XHJcbiAgY29uc3QgW3NlbGVjdCwgc2V0U2VsZWN0XSA9IHVzZVN0YXRlKFwiTmFtZVwiKTtcclxuICBjb25zdCBbc2hvd0xpc3QsIHNldFNob3dMaXN0XSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbc2hvd0xpc3RTZWFyY2gsIHNldFNob3dMaXN0U2VhcmNoXSA9IHVzZVN0YXRlKFwidGV4dFwiKTtcclxuICBjb25zdCBbc2VhcmNoLCBzZXRTZWFyY2hdID0gdXNlU3RhdGUoXCJcIik7XHJcbiAgY29uc3QgW3NlbGVjdGVkT0VNLCBzZXRTZWxlY3RlZE9FTV0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbc2VsZWN0ZWRNb2RhbGl0eSwgc2V0U2VsZWN0ZWRNb2RhbGl0eV0gPSB1c2VTdGF0ZShudWxsKTtcclxuICAvLyBSZXBsYWNlIHRoZSBvbGQgc2luZ2xlIGNsaWVudCBzdGF0ZSB3aXRoIHR3byBzZXRzOlxyXG4gIGNvbnN0IFtzZWxlY3RlZENsaWVudEZyb20sIHNldFNlbGVjdGVkQ2xpZW50RnJvbV0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbY2xpZW50RnJvbUJ1dHRvblRleHQsIHNldENsaWVudEZyb21CdXR0b25UZXh0XSA9IHVzZVN0YXRlKFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICBjb25zdCBbc2VsZWN0ZWRDbGllbnRDdXJyZW50LCBzZXRTZWxlY3RlZENsaWVudEN1cnJlbnRdID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgY29uc3QgW2NsaWVudEN1cnJlbnRCdXR0b25UZXh0LCBzZXRDbGllbnRDdXJyZW50QnV0dG9uVGV4dF0gPSB1c2VTdGF0ZShcIlNlbGVjdCBPcHRpb25cIik7XHJcblxyXG4gIGNvbnN0IFtjbGllbnRzLCBzZXRDbGllbnRzXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCBbc2hvd0NsaWVudE1vZGFsLCBzZXRTaG93Q2xpZW50TW9kYWxdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIC8vIFRoaXMgc3RhdGUgdGVsbHMgdGhlIG1vZGFsIHdoaWNoIGNsaWVudCBib3ggaXMgYmVpbmcgdXBkYXRlZDogXCJmcm9tXCIgb3IgXCJjdXJyZW50XCJcclxuICBjb25zdCBbY2xpZW50U2VsZWN0aW9uVHlwZSwgc2V0Q2xpZW50U2VsZWN0aW9uVHlwZV0gPSB1c2VTdGF0ZShudWxsKTtcclxuXHJcbiAgY29uc3Qgcm91dGVyID0gdXNlUm91dGVyKCk7XHJcbiAgY29uc3QgbGFiZWxCYXNlID0gW1wibmFtZVwiLCBcImRhdGVcIiwgXCJ3L29cIiwgXCJwL25cIiwgXCJzL25cIl07XHJcbiAgY29uc3QgbGFiZWxCYXNlTmFtZXMgPSBbXCJuYW1lXCIsIFwiZGF0ZVwiLCBcIndvXCIsIFwicG5cIiwgXCJzblwiXTtcclxuICBjb25zdCBzb3J0Q2hlY2tCYXNlID0gW2ZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2VdO1xyXG5cclxuICBmdW5jdGlvbiB3aXRoU29ydEljb24oYmFzZUxhYmVscywgYWN0aXZlSW5kZXgsIGlzRGVzYykge1xyXG4gICAgcmV0dXJuIGJhc2VMYWJlbHMubWFwKCh0ZXh0LCBpKSA9PiB7XHJcbiAgICAgIGlmIChpICE9PSBhY3RpdmVJbmRleCkgcmV0dXJuIHRleHQ7IC8vIHVudG91Y2hlZFxyXG4gICAgICBjb25zdCBhcnJvdyA9IGlzRGVzYyA/IFwiIOKWvFwiIDogXCIg4payXCI7XHJcbiAgICAgIHJldHVybiBgJHt0ZXh0fSR7YXJyb3d9YDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcblxyXG4gIGNvbnN0IFtsYWJlbHMsIHNldExhYmVsc10gPSB1c2VTdGF0ZShsYWJlbEJhc2UpO1xyXG4gIGNvbnN0IFtzb3J0Q2hlY2ssIHNldFNvcnRDaGVja10gPSB1c2VTdGF0ZShzb3J0Q2hlY2tCYXNlKTtcclxuICBjb25zdCBbaG92ZXJJbmRleCwgc2V0SG92ZXJJbmRleF0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbc2VsZWN0ZWRNb2RlbCwgc2V0U2VsZWN0ZWRNb2RlbF0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbZ1Bvcywgc2V0R1Bvc10gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbZ0lkZSwgc2V0R0lkZV0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbaXNEZWxldGluZywgc2V0SXNEZWxldGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtwYWdlLCBzZXRQYWdlXSA9IHVzZVN0YXRlKDEpO1xuICBjb25zdCBbcGFnZUN1cnNvcnMsIHNldFBhZ2VDdXJzb3JzXSA9IHVzZVN0YXRlKFtdKTtcbiAgY29uc3QgW2hhc05leHRQYWdlLCBzZXRIYXNOZXh0UGFnZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG5cclxuXHJcbiAgLy8gRmV0Y2ggZGF0YSBvbiBjb21wb25lbnQgbW91bnQgYW5kIHJvdXRlIGNoYW5nZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGZldGNoRGF0YShwYWdlKTtcbiAgfSwgW3JvdXRlci5yb3V0ZSwgcGFnZV0pO1xuXG4gIGFzeW5jIGZ1bmN0aW9uIGZldGNoRGF0YShyZXF1ZXN0ZWRQYWdlID0gMSkge1xuICAgIHNldElzTG9hZGluZyh0cnVlKTtcbiAgICB0cnkge1xuICAgICAgaWYgKHJvdXRlci5xdWVyeS5pbnB1dFRleHQgJiYgcm91dGVyLnF1ZXJ5LnNlbGVjdGVkVHlwZSkge1xuICAgICAgICBzZXRTZWxlY3Qocm91dGVyLnF1ZXJ5LnNlbGVjdGVkVHlwZSk7XG4gICAgICAgIHNldFNlYXJjaChyb3V0ZXIucXVlcnkuaW5wdXRUZXh0KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHN0YXJ0QWZ0ZXJEb2MgPVxuICAgICAgICByZXF1ZXN0ZWRQYWdlID4gMSA/IHBhZ2VDdXJzb3JzW3JlcXVlc3RlZFBhZ2UgLSAyXSA6IG51bGw7XG4gICAgICBpZiAocmVxdWVzdGVkUGFnZSA+IDEgJiYgIXN0YXJ0QWZ0ZXJEb2MpIHtcbiAgICAgICAgc2V0UGFnZSgxKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgLy8gbGlnaHQgcmV0cnkgZm9yIHRyYW5zaWVudCBGaXJlc3RvcmUgaGljY3Vwc1xuICAgICAgY29uc3QgbG9hZCA9IGFzeW5jIChhdHRlbXB0ID0gMSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJldHVybiBhd2FpdCBmZXRjaFBhcnRzV2l0aE1hY2hpbmVEYXRhUGFnZSh7XG4gICAgICAgICAgICBwYWdlU2l6ZTogUEFHRV9TSVpFLFxuICAgICAgICAgICAgc3RhcnRBZnRlckRvYyxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGlmIChhdHRlbXB0ID49IDMpIHRocm93IGU7XG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UociA9PiBzZXRUaW1lb3V0KHIsIDI1MCAqIE1hdGgucG93KDIsIGF0dGVtcHQgLSAxKSkpO1xuICAgICAgICAgIHJldHVybiBsb2FkKGF0dGVtcHQgKyAxKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGNvbnN0IHsgcGFydHM6IGRhdGEsIGxhc3REb2MsIGhhc05leHRQYWdlOiBuZXh0UGFnZSB9ID0gYXdhaXQgbG9hZCgpO1xuICAgICAgc2V0QmFja3VwSW5mbyhkYXRhKTtcbiAgICAgIHNldExhYmVscyhsYWJlbEJhc2UpOyAvLyA8LS0gYWRkIHRoaXMgbGluZSBhZnRlciBzZXRCYWNrdXBJbmZvKGRhdGEpXG4gICAgICBzZXRJRChkYXRhLm1hcCgoaXRlbSkgPT4gaXRlbS5pZCkpO1xuICAgICAgc2V0SGFzTmV4dFBhZ2UobmV4dFBhZ2UpO1xuICAgICAgc2V0UGFnZUN1cnNvcnMoKHByZXYpID0+IHtcbiAgICAgICAgY29uc3QgbmV4dCA9IFsuLi5wcmV2XTtcbiAgICAgICAgbmV4dFtyZXF1ZXN0ZWRQYWdlIC0gMV0gPSBsYXN0RG9jO1xuICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgIH0pO1xuICAgICAgc2V0U2VsZWN0ZWRJdGVtcyhbXSk7XG5cbiAgICAgIC8vIC0tLSBQcmUtYXVnbWVudDogcmVzb2x2ZSBjbGllbnQgaWRzIG9mIE1hY2hpbmUgLyBDdXJyZW50TWFjaGluZSBvbmNlIC0tLVxuICAgICAgY29uc3QgZGIgPSBmaXJlYmFzZS5maXJlc3RvcmUoKTtcbiAgICAgIGNvbnN0IG1hY2hpbmVJZHMgPSBbXTtcclxuICAgICAgY29uc3QgY3VyTWFjaGluZUlkcyA9IFtdO1xyXG4gICAgICBjb25zdCB0aGVNYWNoaW5lSWRzID0gW107IC8vIDwtLSBBRERcclxuXHJcbiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBkYXRhKSB7XHJcbiAgICAgICAgaWYgKGl0ZW0/Lk1hY2hpbmU/LmlkKSBtYWNoaW5lSWRzLnB1c2goaXRlbS5NYWNoaW5lLmlkKTtcclxuICAgICAgICBpZiAoaXRlbT8uQ3VycmVudE1hY2hpbmU/LmlkKSBjdXJNYWNoaW5lSWRzLnB1c2goaXRlbS5DdXJyZW50TWFjaGluZS5pZCk7XHJcbiAgICAgICAgaWYgKGl0ZW0/LlRoZU1hY2hpbmU/LmlkKSB0aGVNYWNoaW5lSWRzLnB1c2goaXRlbS5UaGVNYWNoaW5lLmlkKTsgLy8gPC0tIEFERFxyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHVuaXEgPSAoYXJyKSA9PiBbLi4ubmV3IFNldChhcnIpXTtcclxuICAgICAgY29uc3QgbUlkcyA9IHVuaXEobWFjaGluZUlkcyk7XHJcbiAgICAgIGNvbnN0IGNJZHMgPSB1bmlxKGN1ck1hY2hpbmVJZHMpO1xyXG5cclxuICAgICAgY29uc3QgZmV0Y2hNYWNoaW5lQ2xpZW50cyA9IGFzeW5jIChpZHMpID0+IHtcclxuICAgICAgICBpZiAoIWlkcy5sZW5ndGgpIHJldHVybiB7fTtcclxuICAgICAgICBjb25zdCBvdXQgPSB7fTtcclxuICAgICAgICAvLyBGaXJlc3RvcmUgXCJpblwiIHN1cHBvcnRzIHVwIHRvIDEwIGRvY3VtZW50IElEcyBwZXIgcXVlcnlcclxuICAgICAgICBjb25zdCBjaHVua3MgPSBbXTtcclxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlkcy5sZW5ndGg7IGkgKz0gMTApIGNodW5rcy5wdXNoKGlkcy5zbGljZShpLCBpICsgMTApKTtcclxuICAgICAgICBmb3IgKGNvbnN0IGNodW5rIG9mIGNodW5rcykge1xyXG4gICAgICAgICAgY29uc3Qgc25hcCA9IGF3YWl0IGRiXHJcbiAgICAgICAgICAgIC5jb2xsZWN0aW9uKFwiTWFjaGluZVwiKVxyXG4gICAgICAgICAgICAud2hlcmUoZmlyZWJhc2UuZmlyZXN0b3JlLkZpZWxkUGF0aC5kb2N1bWVudElkKCksIFwiaW5cIiwgY2h1bmspXHJcbiAgICAgICAgICAgIC5nZXQoKTtcclxuICAgICAgICAgIHNuYXAuZm9yRWFjaCgoZG9jKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1kID0gZG9jLmRhdGEoKSB8fCB7fTtcclxuICAgICAgICAgICAgb3V0W2RvYy5pZF0gPSBtZC5jbGllbnQ/LmlkIHx8IG51bGw7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dDtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIEZldGNoIGZ1bGwgbWFjaGluZSBkb2NzIChPRU0vTW9kYWxpdHkvTW9kZWwvQ2xpZW50L2V0Yy4pIGZvciBhIHNldCBvZiBpZHNcclxuICAgICAgY29uc3QgZmV0Y2hNYWNoaW5lc0RhdGEgPSBhc3luYyAoaWRzKSA9PiB7XHJcbiAgICAgICAgaWYgKCFpZHMubGVuZ3RoKSByZXR1cm4ge307XHJcbiAgICAgICAgY29uc3Qgb3V0ID0ge307XHJcbiAgICAgICAgY29uc3QgY2h1bmtzID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyBpICs9IDEwKSBjaHVua3MucHVzaChpZHMuc2xpY2UoaSwgaSArIDEwKSk7XHJcbiAgICAgICAgZm9yIChjb25zdCBjaHVuayBvZiBjaHVua3MpIHtcclxuICAgICAgICAgIGNvbnN0IHNuYXAgPSBhd2FpdCBkYlxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbihcIk1hY2hpbmVcIilcclxuICAgICAgICAgICAgLndoZXJlKGZpcmViYXNlLmZpcmVzdG9yZS5GaWVsZFBhdGguZG9jdW1lbnRJZCgpLCBcImluXCIsIGNodW5rKVxyXG4gICAgICAgICAgICAuZ2V0KCk7XHJcbiAgICAgICAgICBzbmFwLmZvckVhY2goKGRvYykgPT4ge1xyXG4gICAgICAgICAgICBvdXRbZG9jLmlkXSA9IHsgaWQ6IGRvYy5pZCwgLi4uKGRvYy5kYXRhKCkgfHwge30pIH07XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG91dDtcclxuICAgICAgfTtcclxuXHJcblxyXG4gICAgICBjb25zdCBbZnJvbU1hcCwgY3VyTWFwLCB0aGVNYXBdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgIGZldGNoTWFjaGluZUNsaWVudHMobUlkcyksXHJcbiAgICAgICAgZmV0Y2hNYWNoaW5lQ2xpZW50cyhjSWRzKSxcclxuICAgICAgICBmZXRjaE1hY2hpbmVzRGF0YSh1bmlxKHRoZU1hY2hpbmVJZHMpKSwgLy8gPC0tIG5vdyBjYXB0dXJlZCBhcyB0aGVNYXBcclxuICAgICAgXSk7XHJcblxyXG4gICAgICAvLyBOZXctc3R5bGUgb25seTogdGFrZSBjbGllbnQgaWRzIHN0cmFpZ2h0IGZyb20gaXRlbSByZWZzXHJcbiAgICAgIGNvbnN0IGF1Z21lbnRlZCA9IGRhdGEubWFwKChpdGVtKSA9PiAoe1xyXG4gICAgICAgIC4uLml0ZW0sXHJcbiAgICAgICAgY2xpZW50RnJvbUlkOiBpdGVtPy5DbGllbnRGcm9tPy5pZCA/PyBudWxsLFxyXG4gICAgICAgIGNsaWVudEN1cnJlbnRJZDogaXRlbT8uQ2xpZW50Q3VycmVudD8uaWQgPz8gbnVsbCxcclxuICAgICAgfSkpO1xyXG5cclxuICAgICAgc2V0QXVnbWVudGVkSW5mbyhhdWdtZW50ZWQpO1xuICAgICAgLy8gZGVmYXVsdCB2aWV3ID0gZXZlcnl0aGluZyBub3QgZXhwbGljaXRseSBoaWRkZW5cbiAgICAgIHNldEluZm8oYXVnbWVudGVkLmZpbHRlcigoaXQpID0+IGl0LnZpc2libGUgIT09IGZhbHNlKSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgZGF0YTpcIiwgZXJyKTtcbiAgICAgIHNldEluZm8oW10pO1xuICAgICAgc2V0QXVnbWVudGVkSW5mbyhbXSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9XG5cclxuICBjb25zdCBzZWFyY2hDaGFuZ2VIYW5kbGVyID0gKGV2ZW50KSA9PiBzZXRTZWFyY2goZXZlbnQudGFyZ2V0LnZhbHVlKTtcclxuXHJcbiAgLy8gQXN5bmNocm9ub3VzIGZpbHRlciBmdW5jdGlvbiB0aGF0IGxvb3BzIHRocm91Z2ggYmFja3VwSW5mbyBhbmQsXHJcbiAgLy8gZm9yIGVhY2ggaXRlbSwgZmV0Y2hlcyBpdHMgTWFjaGluZSBhbmQgQ3VycmVudE1hY2hpbmUgZG9jdW1lbnRzLFxyXG4gIC8vIHRoZW4gY29tcGFyZXMgdGhlIGNsaWVudCBpZCAoZnJvbSBtYWNoaW5lRGF0YS5jbGllbnQuaWQpIHRvIHRoZSBzZWxlY3RlZCBjbGllbnQuXHJcbiAgdXNlRWZmZWN0KCgpID0+IHtcclxuICAgIGZ1bmN0aW9uIGZpbHRlclBhcnRzKCkge1xyXG4gICAgICBjb25zdCBiYXNlID0gYXVnbWVudGVkSW5mbzsgLy8gYWxyZWFkeSBoYXMgY2xpZW50RnJvbUlkL2NsaWVudEN1cnJlbnRJZFxyXG4gICAgICBjb25zdCBub0ZpbHRlcnMgPVxyXG4gICAgICAgICFzZWxlY3RlZE9FTSAmJlxyXG4gICAgICAgICFzZWxlY3RlZE1vZGFsaXR5ICYmXHJcbiAgICAgICAgIXNlbGVjdGVkTW9kZWwgJiZcclxuICAgICAgICAhc2VsZWN0ZWRDbGllbnRGcm9tICYmXHJcbiAgICAgICAgIXNlbGVjdGVkQ2xpZW50Q3VycmVudCAmJlxyXG4gICAgICAgICFzZWFyY2g7XHJcbiAgICAgIGlmIChub0ZpbHRlcnMpIHtcclxuICAgICAgICBzZXRJbmZvKGJhc2UuZmlsdGVyKChpdCkgPT4gaXQudmlzaWJsZSAhPT0gZmFsc2UpKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGNvbnN0IGZpbHRlcmVkID0gYmFzZS5maWx0ZXIoKGl0ZW0pID0+IHtcclxuICAgICAgICAvLyBvbmx5IGhpZGUgd2hlbiBleHBsaWNpdGx5IGZhbHNlXHJcbiAgICAgICAgaWYgKGl0ZW0udmlzaWJsZSA9PT0gZmFsc2UpIHJldHVybiBmYWxzZTtcclxuXHJcbiAgICAgICAgLy8gT0VNL21vZGFsaXR5L21vZGVsIHZpYSBtYWNoaW5lRGF0YSAoeW91IGFscmVhZHkgcHV0IHRoaXMgaW4gaXRlbXMpXHJcbiAgICAgICAgLy8gT0VNIC8gTW9kYWxpdHkgLyBNb2RlbCBmaWx0ZXJpbmdcclxuICAgICAgICAvLyBQcmVmZXIgbWFjaGluZURhdGE7IGZhbGwgYmFjayB0byB0aGVNYWNoaW5lRGF0YTsgZmluYWxseSB0cnkgaW5saW5lIFRoZU1hY2hpbmUgaWYgaXQgaGFzIHBsYWluIGZpZWxkc1xyXG4gICAgICAgIGNvbnN0IE9FTSA9IGl0ZW0/Lm1hY2hpbmVEYXRhPy5PRU1cclxuICAgICAgICAgID8/IGl0ZW0/LnRoZU1hY2hpbmVEYXRhPy5PRU1cclxuICAgICAgICAgID8/IGl0ZW0/LlRoZU1hY2hpbmU/Lk9FTTtcclxuICAgICAgICBjb25zdCBNb2RhbGl0eSA9IGl0ZW0/Lm1hY2hpbmVEYXRhPy5Nb2RhbGl0eVxyXG4gICAgICAgICAgPz8gaXRlbT8udGhlTWFjaGluZURhdGE/Lk1vZGFsaXR5XHJcbiAgICAgICAgICA/PyBpdGVtPy5UaGVNYWNoaW5lPy5Nb2RhbGl0eTtcclxuICAgICAgICBjb25zdCBNb2RlbCA9IGl0ZW0/Lm1hY2hpbmVEYXRhPy5Nb2RlbFxyXG4gICAgICAgICAgPz8gaXRlbT8udGhlTWFjaGluZURhdGE/Lk1vZGVsXHJcbiAgICAgICAgICA/PyBpdGVtPy5UaGVNYWNoaW5lPy5Nb2RlbDtcclxuXHJcbiAgICAgICAgaWYgKHNlbGVjdGVkT0VNICYmIE9FTSAhPT0gc2VsZWN0ZWRPRU0pIHJldHVybiBmYWxzZTtcclxuICAgICAgICBpZiAoc2VsZWN0ZWRNb2RhbGl0eSAmJiBNb2RhbGl0eSAhPT0gc2VsZWN0ZWRNb2RhbGl0eSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIGlmIChzZWxlY3RlZE1vZGVsICYmIE1vZGVsICE9PSBzZWxlY3RlZE1vZGVsKSByZXR1cm4gZmFsc2U7XHJcblxyXG5cclxuICAgICAgICAvLyBDbGllbnQgZmlsdGVycyAobm93IGluc3RhbnQpXHJcbiAgICAgICAgaWYgKHNlbGVjdGVkQ2xpZW50RnJvbSAmJiBpdGVtLmNsaWVudEZyb21JZCAhPT0gc2VsZWN0ZWRDbGllbnRGcm9tKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgaWYgKHNlbGVjdGVkQ2xpZW50Q3VycmVudCAmJiBpdGVtLmNsaWVudEN1cnJlbnRJZCAhPT0gc2VsZWN0ZWRDbGllbnRDdXJyZW50KSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vIFNlYXJjaFxyXG4gICAgICAgIGlmIChzZWFyY2gpIHtcclxuICAgICAgICAgIGNvbnN0IHMgPSBTdHJpbmcoc2VhcmNoKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJOYW1lXCIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIChpdGVtLm5hbWUgfHwgXCJcIikudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGlmIChzZWxlY3QgPT09IFwiRGF0ZVwiKSB7XHJcbiAgICAgICAgICAgIC8vIElmIHVzZXIgaGFzbid0IHBpY2tlZCBhIGRhdGUgeWV0LCBkb24ndCBoaWRlIGFueXRoaW5nXHJcbiAgICAgICAgICAgIGlmICghc2VhcmNoKSByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHdhbnRlZERheSA9IHNlYXJjaDsgLy8gYWxyZWFkeSAneXl5eS1tbS1kZCcgZnJvbSA8aW5wdXQgdHlwZT1cImRhdGVcIj5cclxuXHJcbiAgICAgICAgICAgIC8vIDEpIE1hdGNoIGl0ZW0uZGF0ZSwgcmVnYXJkbGVzcyBvZiBpdHMgZm9ybWF0IG9yIHR5cGVcclxuICAgICAgICAgICAgY29uc3QgaXRlbVlNRCA9IHRvWU1EKGl0ZW0uZGF0ZSk7XHJcbiAgICAgICAgICAgIGlmIChpdGVtWU1EICYmIGl0ZW1ZTUQgPT09IHdhbnRlZERheSkgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgICAgICAgICAvLyAyKSBBbHNvIGNoZWNrIGFueSBkZXNjcmlwdGlvbiBkYXRlcyAoaWYgeW91IHN0b3JlIGRhdGVzIHRoZXJlKVxyXG4gICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVtLmRlc2NyaXB0aW9ucykpIHtcclxuICAgICAgICAgICAgICBjb25zdCBoaXREZXNjID0gaXRlbS5kZXNjcmlwdGlvbnMuc29tZSgoZCkgPT4gdG9ZTUQoZD8uZGF0ZSkgPT09IHdhbnRlZERheSk7XHJcbiAgICAgICAgICAgICAgaWYgKGhpdERlc2MpIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyAzKSBBbmQgd29yayBvcmRlciBkYXRlcyAoaWYgcHJlc2VudClcclxuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbS53b3JrT3JkZXJzKSkge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGhpdFdPID0gaXRlbS53b3JrT3JkZXJzLnNvbWUoKHcpID0+IHRvWU1EKHc/LmRhdGUpID09PSB3YW50ZWREYXkpO1xyXG4gICAgICAgICAgICAgIGlmIChoaXRXTykgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICBpZiAoc2VsZWN0ID09PSBcIldvcmsgT3JkZXJcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheShpdGVtLndvcmtPcmRlcnMpICYmXHJcbiAgICAgICAgICAgICAgaXRlbS53b3JrT3JkZXJzLnNvbWUoKHdvKSA9PiBTdHJpbmcod28ud29ya09yZGVyIHx8IFwiXCIpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocykpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJQcm9kdWN0IE51bWJlclwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcoaXRlbS5wbiB8fCBcIlwiKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJEZXNjcmlwdGlvblwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcoaXRlbS5kZXNjIHx8IFwiXCIpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoc2VsZWN0ID09PSBcIlNLVVwiKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcoaXRlbS5pZCB8fCBcIlwiKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHMpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSk7XHJcbiAgICAgIHNldEluZm8oZmlsdGVyZWQpO1xyXG4gICAgfVxyXG4gICAgZmlsdGVyUGFydHMoKTtcclxuICB9LCBbc2VsZWN0ZWRPRU0sIHNlbGVjdGVkTW9kYWxpdHksIHNlbGVjdGVkQ2xpZW50RnJvbSwgc2VsZWN0ZWRDbGllbnRDdXJyZW50LCBzZWxlY3RlZE1vZGVsLCBzZWFyY2gsIHNlbGVjdCwgYXVnbWVudGVkSW5mb10pO1xyXG5cclxuICBmdW5jdGlvbiBzb3J0Q2hlY2tBbGwocG9zKSB7XHJcbiAgICAvLyBEZXRlcm1pbmUgbmV4dCBkaXJlY3Rpb246IHRvZ2dsZSB0aGUgY2xpY2tlZCBjb2x1bW4gb25seVxyXG4gICAgY29uc3QgbmV4dFNvcnRDaGVjayA9IHNvcnRDaGVjay5tYXAoKHYsIGkpID0+IChpID09PSBwb3MgPyAhdiA6IHYpKTtcclxuICAgIGNvbnN0IGlzRGVzYyA9IG5leHRTb3J0Q2hlY2tbcG9zXTsgLy8gdHJ1ZSBtZWFucyBkZXNjZW5kaW5nXHJcblxyXG4gICAgY29uc3Qgc29ydGVkSW5mbyA9IFsuLi5pbmZvXS5zb3J0KChhLCBiKSA9PiB7XHJcbiAgICAgIGNvbnN0IGtleSA9IGxhYmVsQmFzZU5hbWVzW3Bvc107XHJcblxyXG4gICAgICBpZiAocG9zID09PSAxKSB7XHJcbiAgICAgICAgLy8gREFURSBjb2x1bW5cclxuICAgICAgICBjb25zdCB0YSA9IHRvVGltZShhW2tleV0pO1xyXG4gICAgICAgIGNvbnN0IHRiID0gdG9UaW1lKGJba2V5XSk7XHJcblxyXG4gICAgICAgIC8vIFB1dCBtaXNzaW5nIGRhdGVzIGF0IHRoZSBlbmQgZm9yIGFzY2VuZGluZywgYXQgdGhlIHN0YXJ0IGZvciBkZXNjZW5kaW5nXHJcbiAgICAgICAgaWYgKHRhID09PSBudWxsICYmIHRiID09PSBudWxsKSByZXR1cm4gMDtcclxuICAgICAgICBpZiAodGEgPT09IG51bGwpIHJldHVybiBpc0Rlc2MgPyAtMSA6IDE7XHJcbiAgICAgICAgaWYgKHRiID09PSBudWxsKSByZXR1cm4gaXNEZXNjID8gMSA6IC0xO1xyXG5cclxuICAgICAgICByZXR1cm4gaXNEZXNjID8gKHRiIC0gdGEpIDogKHRhIC0gdGIpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBOQU1FIG9yIFNLVSAoc3RyaW5nLXkgY29sdW1ucyk6IGluZGV4ZXMgMCBvciA1IGluIHlvdXIgb3JpZ2luYWwgbG9naWNcclxuICAgICAgaWYgKHBvcyA9PT0gMCB8fCBwb3MgPT09IDUpIHtcclxuICAgICAgICBjb25zdCBhdiA9IChhW2tleV0gPz8gXCJcIikudG9TdHJpbmcoKTtcclxuICAgICAgICBjb25zdCBidiA9IChiW2tleV0gPz8gXCJcIikudG9TdHJpbmcoKTtcclxuICAgICAgICByZXR1cm4gaXNEZXNjID8gYnYubG9jYWxlQ29tcGFyZShhdikgOiBhdi5sb2NhbGVDb21wYXJlKGJ2KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gTnVtZXJpYy1pc2ggY29sdW1ucyAod28sIHBuLCBzbikg4oCUIGZhbGwgYmFjayB0byBzdHJpbmcgY29tcGFyZSBpZiBOYU5cclxuICAgICAgY29uc3QgYW4gPSBOdW1iZXIoYVtrZXldKTtcclxuICAgICAgY29uc3QgYm4gPSBOdW1iZXIoYltrZXldKTtcclxuXHJcbiAgICAgIGlmICghaXNOYU4oYW4pICYmICFpc05hTihibikpIHtcclxuICAgICAgICByZXR1cm4gaXNEZXNjID8gKGJuIC0gYW4pIDogKGFuIC0gYm4pO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnN0IGF2ID0gKGFba2V5XSA/PyBcIlwiKS50b1N0cmluZygpO1xyXG4gICAgICAgIGNvbnN0IGJ2ID0gKGJba2V5XSA/PyBcIlwiKS50b1N0cmluZygpO1xyXG4gICAgICAgIHJldHVybiBpc0Rlc2MgPyBidi5sb2NhbGVDb21wYXJlKGF2KSA6IGF2LmxvY2FsZUNvbXBhcmUoYnYpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICBzZXRJbmZvKHNvcnRlZEluZm8pO1xyXG4gICAgc2V0U29ydENoZWNrKG5leHRTb3J0Q2hlY2spO1xyXG5cclxuICAgIC8vIFVwZGF0ZSBoZWFkZXIgbGFiZWxzIHRvIHNob3cgdGhlIGxpdHRsZSBhcnJvdyBvbiB0aGUgYWN0aXZlIGNvbHVtblxyXG4gICAgc2V0TGFiZWxzKHdpdGhTb3J0SWNvbihsYWJlbEJhc2UsIHBvcywgaXNEZXNjKSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgY29uc3Qgcm93U2VsZWN0ID0gKGl0ZW0pID0+IHtcclxuICAgIGlmIChpdGVtICYmIGl0ZW0uaWQpIHtcclxuICAgICAgY29uc29sZS5sb2coXCJTZWxlY3RlZCBpdGVtOlwiLCBpdGVtKTtcclxuICAgICAgcm91dGVyLnB1c2goXCIuL2l0ZW0vXCIgKyBpdGVtLmlkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJVbmFibGUgdG8gZGV0ZXJtaW5lIHRoZSBzZWxlY3RlZCBpdGVt4oCZcyBJRDogXCIsIGl0ZW0pO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IFtzZWxlY3RlZEl0ZW1zLCBzZXRTZWxlY3RlZEl0ZW1zXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCBbc2hvd0RlbGV0ZU1vZGFsLCBzZXRTaG93RGVsZXRlTW9kYWxdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG5cclxuICBjb25zdCBoYW5kbGVTZWxlY3RJdGVtID0gKGlkKSA9PiB7XHJcbiAgICBzZXRTZWxlY3RlZEl0ZW1zKHByZXYgPT5cclxuICAgICAgcHJldi5pbmNsdWRlcyhpZCkgPyBwcmV2LmZpbHRlcih4ID0+IHggIT09IGlkKSA6IFsuLi5wcmV2LCBpZF1cclxuICAgICk7XHJcbiAgfTtcclxuXHJcblxyXG4gIC8vIHNldFNlbGVjdGVkSXRlbXMoKHByZXYpID0+IHtcclxuICAvLyAgIGNvbnN0IG5ld1NlbGVjdGlvbiA9IHByZXYuaW5jbHVkZXMoaWQpXHJcbiAgLy8gICAgID8gcHJldi5maWx0ZXIoKGl0ZW1JZCkgPT4gaXRlbUlkICE9PSBpZClcclxuICAvLyAgICAgOiBbLi4ucHJldiwgaWRdO1xyXG4gIC8vICAgY29uc29sZS5sb2coXCJTZWxlY3RlZCBpdGVtczpcIiwgbmV3U2VsZWN0aW9uKTtcclxuICAvLyAgIHJldHVybiBuZXdTZWxlY3Rpb247IC8vIDwtIGltcG9ydGFudFxyXG4gIC8vIH0pO1xyXG5cclxuICBjb25zdCBoYW5kbGVTaG93RGVsZXRlTW9kYWwgPSAoKSA9PiBzZXRTaG93RGVsZXRlTW9kYWwodHJ1ZSk7XHJcbiAgY29uc3QgaGFuZGxlQ2xvc2VEZWxldGVNb2RhbCA9ICgpID0+IHNldFNob3dEZWxldGVNb2RhbChmYWxzZSk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZURlbGV0ZVNlbGVjdGVkID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgc2V0SXNEZWxldGluZyh0cnVlKTtcclxuICAgIGNvbnN0IGRiID0gZmlyZWJhc2UuZmlyZXN0b3JlKCk7XHJcbiAgICB0cnkge1xyXG4gICAgICAvLyBMb29wIG92ZXIgZWFjaCBzZWxlY3RlZCBpdGVtIG9uZSBhdCBhIHRpbWVcclxuICAgICAgZm9yIChjb25zdCBpdGVtSWQgb2Ygc2VsZWN0ZWRJdGVtcykge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGl0ZW1JZClcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgLy8gRGVsZXRlIGZyb20gXCJUZXN0XCIgY29sbGVjdGlvblxyXG4gICAgICAgICAgYXdhaXQgZGIuY29sbGVjdGlvbihcIlRlc3RcIikuZG9jKGl0ZW1JZCkuZGVsZXRlKCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBkZWxldGluZyBkb2N1bWVudCAke2l0ZW1JZH0gZnJvbSBUZXN0OmAsIGVycik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBEZWxldGUgZnJvbSBcIlBhcnRzXCIgY29sbGVjdGlvblxyXG4gICAgICAgICAgYXdhaXQgZGIuY29sbGVjdGlvbihcIlBhcnRzXCIpLmRvYyhpdGVtSWQpLmRlbGV0ZSgpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZGVsZXRpbmcgZG9jdW1lbnQgJHtpdGVtSWR9IGZyb20gUGFydHM6YCwgZXJyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIC8vIERlbGV0ZSBhc3NvY2lhdGVkIHBob3RvcyBmcm9tIHN0b3JhZ2VcclxuICAgICAgICAgIGF3YWl0IGRlbGV0ZUZyb21TdG9yYWdlKGl0ZW1JZCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBkZWxldGluZyBzdG9yYWdlIGZvciAke2l0ZW1JZH06YCwgZXJyKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgLy8gVXBkYXRlIGxvY2FsIHN0YXRlIGJ5IGZpbHRlcmluZyBvdXQgdGhlIGRlbGV0ZWQgaXRlbXNcclxuICAgICAgc2V0SW5mbyhpbmZvLmZpbHRlcigoaXRlbSkgPT4gIXNlbGVjdGVkSXRlbXMuaW5jbHVkZXMoaXRlbS5pZCkpKTtcclxuICAgICAgc2V0U2VsZWN0ZWRJdGVtcyhbXSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgaXRlbXM6XCIsIGVycm9yKTtcclxuICAgIH0gZmluYWxseSB7XHJcbiAgICAgIHNldElzRGVsZXRpbmcoZmFsc2UpO1xyXG4gICAgICBoYW5kbGVDbG9zZURlbGV0ZU1vZGFsKCk7XHJcbiAgICAgIC8vIE9wdGlvbmFsbHksIHJlbG9hZCB0aGUgcGFnZVxyXG4gICAgICAvLyByb3V0ZXIucmVsb2FkKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcblxyXG4gIGNvbnN0IGhhbmRsZUNsb3NlID0gKCkgPT4gc2V0U2hvdyhmYWxzZSk7XHJcbiAgY29uc3QgaGFuZGxlU2hvdyA9ICgpID0+IHNldFNob3codHJ1ZSk7XHJcblxyXG4gIGNvbnN0IGNoZWNrRGVsZXRlID0gKGV2ZW50LCBwb3MsIGlkc1RvRGVsZXRlLCBuYW1lKSA9PiB7XHJcbiAgICBpZiAoZXZlbnQpIHtcclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICB9XHJcbiAgICBjb25zb2xlLmxvZyhcIlNlbGVjdGVkIElEcyB0byBkZWxldGU6XCIsIGlkc1RvRGVsZXRlKTtcclxuICAgIHNldFNlbGVjdGVkSXRlbXMoaWRzVG9EZWxldGUpO1xyXG4gICAgc2V0REl0ZW0obmFtZSk7XHJcbiAgICBzZXRTaG93RGVsZXRlTW9kYWwodHJ1ZSk7XHJcbiAgfTtcclxuXHJcbiAgLy8gY29uc3QgaGFuZGxlRGVsZXRlID0gYXN5bmMgKCkgPT4ge1xyXG4gIC8vICAgbGV0IGl0ZW1JZCA9IGdJZGU7XHJcbiAgLy8gICB0cnkge1xyXG4gIC8vICAgICBzZXRJc0RlbGV0aW5nKHRydWUpO1xyXG4gIC8vICAgICBjb25zdCBkYiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpO1xyXG4gIC8vICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKFwiVGVzdFwiKS5kb2MoaXRlbUlkKS5kZWxldGUoKTtcclxuICAvLyAgICAgYXdhaXQgZGVsZXRlRnJvbVBhcnRzQ29sbGVjdGlvbihpdGVtSWQpO1xyXG4gIC8vICAgICBhd2FpdCBkZWxldGVGcm9tU3RvcmFnZShpdGVtSWQpO1xyXG4gIC8vICAgICBzZXRJbmZvKGluZm8uZmlsdGVyKChfLCBpKSA9PiBnUG9zICE9PSBpKSk7XHJcbiAgLy8gICAgIGNvbnNvbGUubG9nKGBEZWxldGVkIGl0ZW06ICR7aXRlbUlkfWApO1xyXG4gIC8vICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAvLyAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGl0ZW06XCIsIGVycm9yKTtcclxuICAvLyAgIH0gZmluYWxseSB7XHJcbiAgLy8gICAgIHNldElzRGVsZXRpbmcoZmFsc2UpO1xyXG4gIC8vICAgfVxyXG4gIC8vICAgaGFuZGxlQ2xvc2UoKTtcclxuICAvLyB9O1xyXG5cclxuICBjb25zdCBob3ZlclN0eWxlID0gKGluZGV4KSA9PiAoe1xyXG4gICAgYmFja2dyb3VuZENvbG9yOiBob3ZlckluZGV4ID09PSBpbmRleCA/IFwiI2RkZFwiIDogXCJ0cmFuc3BhcmVudFwiLFxyXG4gICAgdGV4dEFsaWduOiBcImNlbnRlclwiLFxyXG4gICAgY3Vyc29yOiBcImRlZmF1bHRcIixcclxuICB9KTtcclxuXHJcbiAgY29uc3QgW2Ryb3Bkb3duMVRleHQsIHNldERyb3Bkb3duMVRleHRdID0gdXNlU3RhdGUoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gIGNvbnN0IFtkcm9wZG93bjJUZXh0LCBzZXREcm9wZG93bjJUZXh0XSA9IHVzZVN0YXRlKFwiU2VsZWN0IE9wdGlvblwiKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlU2VsZWN0MSA9IChldmVudEtleSwgZXZlbnQpID0+IHtcclxuICAgIGlmIChldmVudEtleSA9PT0gXCJ1bmFzc2lnbmVkXCIpIHtcclxuICAgICAgc2V0RHJvcGRvd24xVGV4dChcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgICAgIHNldFNlbGVjdGVkT0VNKG51bGwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2V0RHJvcGRvd24xVGV4dChldmVudC50YXJnZXQudGV4dENvbnRlbnQpO1xyXG4gICAgICBzZXRTZWxlY3RlZE9FTShldmVudC50YXJnZXQudGV4dENvbnRlbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVNlbGVjdDIgPSAoZXZlbnRLZXksIGV2ZW50KSA9PiB7XHJcbiAgICBpZiAoZXZlbnRLZXkgPT09IFwidW5hc3NpZ25lZFwiKSB7XHJcbiAgICAgIHNldERyb3Bkb3duMlRleHQoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gICAgICBzZXRTZWxlY3RlZE1vZGFsaXR5KG51bGwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2V0RHJvcGRvd24yVGV4dChldmVudC50YXJnZXQudGV4dENvbnRlbnQpO1xyXG4gICAgICBzZXRTZWxlY3RlZE1vZGFsaXR5KGV2ZW50LnRhcmdldC50ZXh0Q29udGVudCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gQnVpbGQgYSB1bmlxdWUgbGlzdCBvZiBjbGllbnRzIGZyb20gdGhlIGl0ZW1zIGN1cnJlbnRseSBsb2FkZWQsIGZpbHRlcmVkIGJ5IE9FTS9Nb2RhbGl0eS5cclxuICAvLyBgdHlwZWAgaXMgXCJmcm9tXCIgb3IgXCJjdXJyZW50XCIgdG8gZGVjaWRlIHdoaWNoIGNsaWVudCByZWYgdG8gcmVhZC5cclxuICBhc3luYyBmdW5jdGlvbiBidWlsZENsaWVudHNGcm9tSXRlbXModHlwZSkge1xyXG4gICAgY29uc3QgZGIgPSBmaXJlYmFzZS5maXJlc3RvcmUoKTtcclxuICAgIGNvbnN0IGlkcyA9IG5ldyBTZXQoKTtcclxuXHJcbiAgICAvLyBSZXNwZWN0IGN1cnJlbnQgT0VNIC8gTW9kYWxpdHkgZmlsdGVycyB3aGVuIGRlcml2aW5nIGNsaWVudCBvcHRpb25zXHJcbiAgICBjb25zdCBmaWx0ZXJlZCA9IGF1Z21lbnRlZEluZm8uZmlsdGVyKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IE9FTSA9IGl0ZW0/Lm1hY2hpbmVEYXRhPy5PRU0gPz8gaXRlbT8uT0VNID8/IG51bGw7XHJcbiAgICAgIGNvbnN0IE1vZGFsaXR5ID0gaXRlbT8ubWFjaGluZURhdGE/Lk1vZGFsaXR5ID8/IGl0ZW0/Lk1vZGFsaXR5ID8/IG51bGw7XHJcbiAgICAgIGlmIChzZWxlY3RlZE9FTSAmJiBPRU0gIT09IHNlbGVjdGVkT0VNKSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGlmIChzZWxlY3RlZE1vZGFsaXR5ICYmIE1vZGFsaXR5ICE9PSBzZWxlY3RlZE1vZGFsaXR5KSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZm9yIChjb25zdCBpdCBvZiBmaWx0ZXJlZCkge1xyXG4gICAgICBjb25zdCBpZCA9IHR5cGUgPT09IFwiZnJvbVwiID8gaXQuY2xpZW50RnJvbUlkIDogaXQuY2xpZW50Q3VycmVudElkO1xyXG4gICAgICBpZiAoaWQpIGlkcy5hZGQoaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IG91dCA9IFtdO1xyXG4gICAgY29uc3QgaWRBcnJheSA9IFsuLi5pZHNdO1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZEFycmF5Lmxlbmd0aDsgaSArPSAxMCkge1xyXG4gICAgICBjb25zdCBjaHVuayA9IGlkQXJyYXkuc2xpY2UoaSwgaSArIDEwKTtcclxuICAgICAgY29uc3Qgc25hcCA9IGF3YWl0IGRiXHJcbiAgICAgICAgLmNvbGxlY3Rpb24oXCJDbGllbnRcIilcclxuICAgICAgICAud2hlcmUoZmlyZWJhc2UuZmlyZXN0b3JlLkZpZWxkUGF0aC5kb2N1bWVudElkKCksIFwiaW5cIiwgY2h1bmspXHJcbiAgICAgICAgLmdldCgpO1xyXG4gICAgICBzbmFwLmZvckVhY2goKGRvYykgPT4ge1xyXG4gICAgICAgIGNvbnN0IGQgPSBkb2MuZGF0YSgpIHx8IHt9O1xyXG4gICAgICAgIG91dC5wdXNoKHsgaWQ6IGRvYy5pZCwgbmFtZTogZC5uYW1lIHx8IGRvYy5pZCB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gc29ydCBieSBuYW1lIGZvciBuaWNlciBVWFxyXG4gICAgb3V0LnNvcnQoKGEsIGIpID0+IChhLm5hbWUgfHwgXCJcIikubG9jYWxlQ29tcGFyZShiLm5hbWUgfHwgXCJcIikpO1xyXG4gICAgcmV0dXJuIG91dDtcclxuICB9XHJcblxyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIENMSUVOVCBTRUxFQ1RJT04gSEFORExJTkdcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIFRoaXMgZnVuY3Rpb24gZmV0Y2hlcyBjbGllbnRzIGFuZCBvcGVucyB0aGUgY2xpZW50IG1vZGFsLlxyXG4gIGNvbnN0IGhhbmRsZUNsaWVudENsaWNrID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgbGV0IHNhZmVDbGllbnRzID0gW107XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjbGllbnRzRGF0YSA9IGF3YWl0IGZldGNoQ2xpZW50cyhzZWxlY3RlZE9FTSwgc2VsZWN0ZWRNb2RhbGl0eSk7XHJcbiAgICAgIHNhZmVDbGllbnRzID0gQXJyYXkuaXNBcnJheShjbGllbnRzRGF0YSkgPyBjbGllbnRzRGF0YSA6IFtdO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiZmV0Y2hDbGllbnRzIGZhaWxlZDpcIiwgZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gRmFsbGJhY2sgdG8gYnVpbGRpbmcgZnJvbSBsb2FkZWQgaXRlbXMgaWYgQVBJIGdhdmUgdXMgbm90aGluZ1xyXG4gICAgaWYgKHNhZmVDbGllbnRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGlmICghY2xpZW50U2VsZWN0aW9uVHlwZSkge1xyXG4gICAgICAgICAgLy8gaWYgc29tZWhvdyBub3Qgc2V0IHlldCwgZGVmYXVsdCB0byBcImZyb21cIlxyXG4gICAgICAgICAgc2V0Q2xpZW50U2VsZWN0aW9uVHlwZShcImZyb21cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IGRlcml2ZWQgPSBhd2FpdCBidWlsZENsaWVudHNGcm9tSXRlbXMoY2xpZW50U2VsZWN0aW9uVHlwZSB8fCBcImZyb21cIik7XHJcbiAgICAgICAgc2FmZUNsaWVudHMgPSBkZXJpdmVkO1xyXG4gICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkZhbGxiYWNrIGJ1aWxkQ2xpZW50c0Zyb21JdGVtcyBmYWlsZWQ6XCIsIGUpO1xyXG4gICAgICAgIHNhZmVDbGllbnRzID0gW107XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRDbGllbnRzKHNhZmVDbGllbnRzKTtcclxuICAgIHNldENsaWVudFNlYXJjaFRlcm0oXCJcIik7XHJcbiAgICBzZXRTaG93Q2xpZW50TW9kYWwodHJ1ZSk7XHJcbiAgfTtcclxuXHJcblxyXG5cclxuICAvLyBXaGVuIGEgY2xpZW50IGlzIHNlbGVjdGVkIGluIHRoZSBtb2RhbCwgd2Ugbm93IGFzc3VtZSB0aGUgcGFyYW1ldGVyIGlzIGEgY2xpZW50IElELlxyXG4gIC8vIElmIHRoZSBwYXNzZWQgdmFsdWUgaXMgbnVsbCwgd2UgY2xlYXIgdGhlIHNlbGVjdGlvbi5cclxuICBjb25zdCBoYW5kbGVDbGllbnRTZWxlY3QgPSBhc3luYyAoY2xpZW50SWQpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKFwiVXNlciBzZWxlY3RlZCBjbGllbnQgaWQ6XCIsIGNsaWVudElkKTtcclxuICAgIGlmICghY2xpZW50SWQpIHtcclxuICAgICAgaWYgKGNsaWVudFNlbGVjdGlvblR5cGUgPT09IFwiZnJvbVwiKSB7XHJcbiAgICAgICAgc2V0Q2xpZW50RnJvbUJ1dHRvblRleHQoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gICAgICAgIHNldFNlbGVjdGVkQ2xpZW50RnJvbShudWxsKTtcclxuICAgICAgfSBlbHNlIGlmIChjbGllbnRTZWxlY3Rpb25UeXBlID09PSBcImN1cnJlbnRcIikge1xyXG4gICAgICAgIHNldENsaWVudEN1cnJlbnRCdXR0b25UZXh0KFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICAgICAgICBzZXRTZWxlY3RlZENsaWVudEN1cnJlbnQobnVsbCk7XHJcbiAgICAgIH1cclxuICAgICAgc2V0U2hvd0NsaWVudE1vZGFsKGZhbHNlKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY2xpZW50U25hcCA9IGF3YWl0IGZpcmViYXNlLmZpcmVzdG9yZSgpLmNvbGxlY3Rpb24oXCJDbGllbnRcIikuZG9jKGNsaWVudElkKS5nZXQoKTtcclxuICAgICAgaWYgKGNsaWVudFNuYXAuZXhpc3RzKSB7XHJcbiAgICAgICAgY29uc3QgY2xpZW50RGF0YSA9IGNsaWVudFNuYXAuZGF0YSgpO1xyXG4gICAgICAgIGlmIChjbGllbnRTZWxlY3Rpb25UeXBlID09PSBcImZyb21cIikge1xyXG4gICAgICAgICAgc2V0Q2xpZW50RnJvbUJ1dHRvblRleHQoY2xpZW50RGF0YS5uYW1lKTtcclxuICAgICAgICAgIHNldFNlbGVjdGVkQ2xpZW50RnJvbShjbGllbnRJZCk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChjbGllbnRTZWxlY3Rpb25UeXBlID09PSBcImN1cnJlbnRcIikge1xyXG4gICAgICAgICAgc2V0Q2xpZW50Q3VycmVudEJ1dHRvblRleHQoY2xpZW50RGF0YS5uYW1lKTtcclxuICAgICAgICAgIHNldFNlbGVjdGVkQ2xpZW50Q3VycmVudChjbGllbnRJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJObyBjbGllbnQgZG9jdW1lbnQgZm91bmQgZm9yIGlkOlwiLCBjbGllbnRJZCk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBjbGllbnQgZGF0YTpcIiwgZXJyb3IpO1xyXG4gICAgfVxyXG4gICAgc2V0U2hvd0NsaWVudE1vZGFsKGZhbHNlKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVDbGllbnRJbmZvID0gKGNsaWVudElkLCBjbGllbnROYW1lKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhgQ2xpZW50IElEOiAke2NsaWVudElkfSwgQ2xpZW50IE5hbWU6ICR7Y2xpZW50TmFtZX1gKTtcclxuICAgIHJvdXRlci5wdXNoKFwiY2xpZW50L1wiICsgY2xpZW50SWQpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZUNsZWFyQ2xpZW50U2VsZWN0aW9uID0gKCkgPT4ge1xyXG4gICAgaWYgKGNsaWVudFNlbGVjdGlvblR5cGUgPT09IFwiZnJvbVwiKSB7XHJcbiAgICAgIHNldENsaWVudEZyb21CdXR0b25UZXh0KFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICAgICAgc2V0U2VsZWN0ZWRDbGllbnRGcm9tKG51bGwpO1xyXG4gICAgfSBlbHNlIGlmIChjbGllbnRTZWxlY3Rpb25UeXBlID09PSBcImN1cnJlbnRcIikge1xyXG4gICAgICBzZXRDbGllbnRDdXJyZW50QnV0dG9uVGV4dChcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgICAgIHNldFNlbGVjdGVkQ2xpZW50Q3VycmVudChudWxsKTtcclxuICAgIH1cclxuICAgIHNldFNob3dDbGllbnRNb2RhbChmYWxzZSk7XHJcbiAgfTtcclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyBNT0RFTCBTRUxFQ1RJT04gSEFORExJTkdcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIGNvbnN0IFttb2RlbHMsIHNldE1vZGVsc10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW3Nob3dNb2RlbE1vZGFsLCBzZXRTaG93TW9kZWxNb2RhbF0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW21vZGVsQnV0dG9uVGV4dCwgc2V0TW9kZWxCdXR0b25UZXh0XSA9IHVzZVN0YXRlKFwiU2VsZWN0IE9wdGlvblwiKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlTW9kZWxDbGljayA9IGFzeW5jICgpID0+IHtcclxuICAgIGNvbnN0IG1vZGVsc0RhdGEgPSBhd2FpdCBmZXRjaE1vZGVscyhcclxuICAgICAgc2VsZWN0ZWRPRU0sXHJcbiAgICAgIHNlbGVjdGVkTW9kYWxpdHksXHJcbiAgICAgIHNlbGVjdGVkQ2xpZW50RnJvbVxyXG4gICAgKTtcclxuICAgIHNldE1vZGVscyhtb2RlbHNEYXRhKTtcclxuICAgIHNldE1vZGVsU2VhcmNoVGVybShcIlwiKTtcclxuICAgIHNldFNob3dNb2RlbE1vZGFsKHRydWUpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZU1vZGVsU2VsZWN0ID0gKG1vZGVsTmFtZSkgPT4ge1xyXG4gICAgc2V0TW9kZWxCdXR0b25UZXh0KG1vZGVsTmFtZSB8fCBcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgICBzZXRTZWxlY3RlZE1vZGVsKG1vZGVsTmFtZSB8fCBudWxsKTtcclxuICAgIHNldFNob3dNb2RlbE1vZGFsKGZhbHNlKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVDbGVhck1vZGVsU2VsZWN0aW9uID0gKCkgPT4ge1xyXG4gICAgc2V0TW9kZWxCdXR0b25UZXh0KFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICAgIHNldFNlbGVjdGVkTW9kZWwobnVsbCk7XHJcbiAgICBzZXRTaG93TW9kZWxNb2RhbChmYWxzZSk7XHJcbiAgfTtcclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyBXQVJFSE9VU0UgQlVUVE9OUyAoZm9yIENsaWVudCBDdXJyZW50KVxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgY29uc3QgaGFuZGxlU29DYWxXYXJlaG91c2VDbGljayA9ICgpID0+IHtcclxuICAgIHNldENsaWVudEN1cnJlbnRCdXR0b25UZXh0KFwiU29DYWwgV2FyZWhvdXNlXCIpO1xyXG4gICAgc2V0U2VsZWN0ZWRDbGllbnRDdXJyZW50KFNPQ0FMX0NMSUVOVF9JRCk7XHJcbiAgICBjb25zb2xlLmxvZyhcIldhcmVob3VzZSBidXR0b24gY2xpY2tlZDogc2V0dGluZyBDbGllbnQgQ3VycmVudCB0b1wiLCBTT0NBTF9DTElFTlRfSUQpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZU5vckNhbFdhcmVob3VzZUNsaWNrID0gKCkgPT4ge1xyXG4gICAgc2V0Q2xpZW50Q3VycmVudEJ1dHRvblRleHQoXCJOb3JDYWwgV2FyZWhvdXNlXCIpO1xyXG4gICAgc2V0U2VsZWN0ZWRDbGllbnRDdXJyZW50KE5PUkNBTF9DTElFTlRfSUQpO1xyXG4gICAgY29uc29sZS5sb2coXCJXYXJlaG91c2UgYnV0dG9uIGNsaWNrZWQ6IHNldHRpbmcgQ2xpZW50IEN1cnJlbnQgdG9cIiwgTk9SQ0FMX0NMSUVOVF9JRCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlV2FyZWhvdXNlVW5hc3NpZ25lZENsaWNrID0gKCkgPT4ge1xyXG4gICAgc2V0Q2xpZW50Q3VycmVudEJ1dHRvblRleHQoXCJVbmFzc2lnbmVkXCIpO1xyXG4gICAgc2V0U2VsZWN0ZWRDbGllbnRDdXJyZW50KFVOQVNTSUdORURfQ0xJRU5UX0lEKTtcclxuICAgIGNvbnNvbGUubG9nKFwiV2FyZWhvdXNlIGJ1dHRvbiBjbGlja2VkOiBzZXR0aW5nIENsaWVudCBDdXJyZW50IHRvXCIsIFVOQVNTSUdORURfQ0xJRU5UX0lEKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBbY2xpZW50U2VhcmNoVGVybSwgc2V0Q2xpZW50U2VhcmNoVGVybV0gPSB1c2VTdGF0ZShcIlwiKTtcclxuICBjb25zdCBbbW9kZWxTZWFyY2hUZXJtLCBzZXRNb2RlbFNlYXJjaFRlcm1dID0gdXNlU3RhdGUoXCJcIik7XHJcblxyXG4gIGNvbnN0IGRlbGV0ZUZyb21TdG9yYWdlID0gYXN5bmMgKGl0ZW1JZCkgPT4ge1xyXG4gICAgY29uc3Qgc3RvcmFnZVJlZiA9IGZpcmViYXNlLnN0b3JhZ2UoKS5yZWYoKTtcclxuICAgIGNvbnN0IGZvbGRlclJlZiA9IHN0b3JhZ2VSZWYuY2hpbGQoYFBhcnRzLyR7aXRlbUlkfS9gKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGxpc3RSZXN1bHQgPSBhd2FpdCBmb2xkZXJSZWYubGlzdEFsbCgpO1xyXG4gICAgICBjb25zdCBkZWxldGVQcm9taXNlcyA9IGxpc3RSZXN1bHQuaXRlbXMubWFwKChpdGVtKSA9PiBpdGVtLmRlbGV0ZSgpKTtcclxuICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoZGVsZXRlUHJvbWlzZXMpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGZyb20gc3RvcmFnZTpcIiwgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIGNvbnN0IGRlbGV0ZUZyb21QYXJ0c0NvbGxlY3Rpb24gPSBhc3luYyAoaXRlbUlkKSA9PiB7XHJcbiAgICBjb25zdCBkYiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgYXdhaXQgZGIuY29sbGVjdGlvbihcIlBhcnRzXCIpLmRvYyhpdGVtSWQpLmRlbGV0ZSgpO1xyXG4gICAgICBjb25zb2xlLmxvZyhgRGVsZXRlZCBpdGVtIGZyb20gUGFydHMgY29sbGVjdGlvbjogJHtpdGVtSWR9YCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgZnJvbSBQYXJ0cyBjb2xsZWN0aW9uOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgLy8gICAvLyBTYWZlbHkgY29udmVydCBhbnkgZGF0ZS1pc2ggdmFsdWUgaW50byBhIGNvbXBhcmFibGUgdGltZXN0YW1wIChtcyBzaW5jZSBlcG9jaCkuXHJcbiAgLy8gZnVuY3Rpb24gdG9UaW1lKHZhbHVlKSB7XHJcbiAgLy8gICBpZiAoIXZhbHVlKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgLy8gICAvLyBGaXJlc3RvcmUgVGltZXN0YW1wOiB7IHNlY29uZHMsIG5hbm9zZWNvbmRzIH1cclxuICAvLyAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiYgdmFsdWUuc2Vjb25kcykge1xyXG4gIC8vICAgICB0cnkge1xyXG4gIC8vICAgICAgIHJldHVybiB2YWx1ZS5zZWNvbmRzICogMTAwMDtcclxuICAvLyAgICAgfSBjYXRjaCB7IC8qIGZhbGx0aHJvdWdoICovIH1cclxuICAvLyAgIH1cclxuXHJcbiAgLy8gICAvLyBJZiBhbHJlYWR5IGEgRGF0ZVxyXG4gIC8vICAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkgcmV0dXJuIGlzTmFOKHZhbHVlLmdldFRpbWUoKSkgPyBudWxsIDogdmFsdWUuZ2V0VGltZSgpO1xyXG5cclxuICAvLyAgIC8vIElmIHN0cmluZzogdHJ5IElTTyBmaXJzdFxyXG4gIC8vICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xyXG4gIC8vICAgICAvLyB5eXl5LW1tLWRkIChmcm9tIHlvdXIgZm9ybSBpbnB1dHMpXHJcbiAgLy8gICAgIGNvbnN0IGlzbyA9IERhdGUucGFyc2UodmFsdWUpO1xyXG4gIC8vICAgICBpZiAoIWlzTmFOKGlzbykpIHJldHVybiBpc287XHJcblxyXG4gIC8vICAgICAvLyBtbS9kZC95eXl5IGZhbGxiYWNrIChvbGRlciBpdGVtcylcclxuICAvLyAgICAgY29uc3QgcGFydHMgPSB2YWx1ZS5zcGxpdChcIi9cIik7XHJcbiAgLy8gICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDMpIHtcclxuICAvLyAgICAgICBjb25zdCBbbW0sIGRkLCB5eXl5XSA9IHBhcnRzO1xyXG4gIC8vICAgICAgIGNvbnN0IGFsdCA9IERhdGUucGFyc2UoYCR7eXl5eX0tJHttbX0tJHtkZH1gKTtcclxuICAvLyAgICAgICBpZiAoIWlzTmFOKGFsdCkpIHJldHVybiBhbHQ7XHJcbiAgLy8gICAgIH1cclxuICAvLyAgIH1cclxuXHJcbiAgLy8gICAvLyBDYW5vbmljYWxpemUgYW55IGRhdGUtaXNoIHZhbHVlIHRvICd5eXl5LW1tLWRkJyBzbyBpdCBtYXRjaGVzIDxpbnB1dCB0eXBlPVwiZGF0ZVwiPiB2YWx1ZXNcclxuICAvLyAgIGZ1bmN0aW9uIHRvWU1EKHZhbHVlKSB7XHJcbiAgLy8gICAgIGNvbnN0IHQgPSB0b1RpbWUodmFsdWUpO1xyXG4gIC8vICAgICBpZiAodCA9PSBudWxsKSByZXR1cm4gbnVsbDtcclxuICAvLyAgICAgY29uc3QgZCA9IG5ldyBEYXRlKHQpO1xyXG4gIC8vICAgICBjb25zdCB5eXl5ID0gZC5nZXRGdWxsWWVhcigpO1xyXG4gIC8vICAgICBjb25zdCBtbSA9IFN0cmluZyhkLmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCBcIjBcIik7XHJcbiAgLy8gICAgIGNvbnN0IGRkID0gU3RyaW5nKGQuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCBcIjBcIik7XHJcbiAgLy8gICAgIHJldHVybiBgJHt5eXl5fS0ke21tfS0ke2RkfWA7XHJcbiAgLy8gICB9XHJcblxyXG5cclxuICAvLyAgIC8vIExhc3QgcmVzb3J0XG4gIC8vICAgY29uc3QgdCA9IERhdGUucGFyc2UodmFsdWUpO1xuICAvLyAgIHJldHVybiBpc05hTih0KSA/IG51bGwgOiB0O1xuICAvLyB9XG5cbiAgY29uc3QgdG90YWxLbm93blBhZ2VzID0gTWF0aC5tYXgoXG4gICAgMSxcbiAgICBwYWdlQ3Vyc29ycy5sZW5ndGggKyAoaGFzTmV4dFBhZ2UgPyAxIDogMClcbiAgKTtcbiAgY29uc3QgcGFnZUJ1dHRvbnMgPSBbXTtcbiAgZm9yIChsZXQgaSA9IDE7IGkgPD0gdG90YWxLbm93blBhZ2VzOyBpKyspIHtcbiAgICBwYWdlQnV0dG9ucy5wdXNoKFxuICAgICAgPFBhZ2luYXRpb24uSXRlbVxuICAgICAgICBrZXk9e2l9XG4gICAgICAgIGFjdGl2ZT17aSA9PT0gcGFnZX1cbiAgICAgICAgb25DbGljaz17KCkgPT4gc2V0UGFnZShpKX1cbiAgICAgID5cbiAgICAgICAge2l9XG4gICAgICA8L1BhZ2luYXRpb24uSXRlbT5cbiAgICApO1xuICB9XG5cblxuICByZXR1cm4gKFxuICAgIDxMb2dnZWRJbj5cbiAgICAgIHtpc0RlbGV0aW5nICYmIChcclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxvYWRpbmctb3ZlcmxheVwiPlxyXG4gICAgICAgICAgPFNwaW5uZXIgYW5pbWF0aW9uPVwiYm9yZGVyXCIgcm9sZT1cInN0YXR1c1wiIGNsYXNzTmFtZT1cInNwaW5uZXItY2VudGVyXCI+XHJcbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInNyLW9ubHlcIj5Mb2FkaW5nLi4uPC9zcGFuPlxyXG4gICAgICAgICAgPC9TcGlubmVyPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICApfVxyXG4gICAgICA8TW9kYWwgc2hvdz17c2hvd0RlbGV0ZU1vZGFsfSBvbkhpZGU9e2hhbmRsZUNsb3NlRGVsZXRlTW9kYWx9PlxyXG4gICAgICAgIDxNb2RhbC5IZWFkZXIgY2xvc2VCdXR0b24+XHJcbiAgICAgICAgICA8TW9kYWwuVGl0bGU+Q29uZmlybSBEZWxldGlvbjwvTW9kYWwuVGl0bGU+XHJcbiAgICAgICAgPC9Nb2RhbC5IZWFkZXI+XHJcbiAgICAgICAgPE1vZGFsLkJvZHk+XHJcbiAgICAgICAgICBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHtzZWxlY3RlZEl0ZW1zLmxlbmd0aH0gaXRlbVxyXG4gICAgICAgICAge3NlbGVjdGVkSXRlbXMubGVuZ3RoID4gMSA/IFwic1wiIDogXCJcIn0/XHJcbiAgICAgICAgPC9Nb2RhbC5Cb2R5PlxyXG4gICAgICAgIDxNb2RhbC5Gb290ZXI+XHJcbiAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9XCJkYW5nZXJcIiBvbkNsaWNrPXtoYW5kbGVEZWxldGVTZWxlY3RlZH0+XHJcbiAgICAgICAgICAgIFllcywgZGVsZXRlXHJcbiAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgIDxCdXR0b24gdmFyaWFudD1cInNlY29uZGFyeVwiIG9uQ2xpY2s9e2hhbmRsZUNsb3NlRGVsZXRlTW9kYWx9PlxyXG4gICAgICAgICAgICBDYW5jZWxcclxuICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgIDwvTW9kYWwuRm9vdGVyPlxyXG4gICAgICA8L01vZGFsPlxyXG5cclxuICAgICAgPE1vZGFsIHNob3c9e3Nob3dDbGllbnRNb2RhbH0gb25IaWRlPXsoKSA9PiBzZXRTaG93Q2xpZW50TW9kYWwoZmFsc2UpfT5cclxuICAgICAgICA8TW9kYWwuSGVhZGVyIGNsb3NlQnV0dG9uPlxyXG4gICAgICAgICAgPE1vZGFsLlRpdGxlPlxyXG4gICAgICAgICAgICBTZWxlY3Qge2NsaWVudFNlbGVjdGlvblR5cGUgPT09IFwiZnJvbVwiID8gXCJDbGllbnQgRnJvbVwiIDogXCJDbGllbnQgQ3VycmVudFwifVxyXG4gICAgICAgICAgPC9Nb2RhbC5UaXRsZT5cclxuICAgICAgICA8L01vZGFsLkhlYWRlcj5cclxuICAgICAgICA8TW9kYWwuQm9keT5cclxuICAgICAgICAgIDxGb3JtQ29udHJvbFxyXG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiU2VhcmNoIGJ5IG5hbWVcIlxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJtYi0zXCJcclxuICAgICAgICAgICAgdmFsdWU9e2NsaWVudFNlYXJjaFRlcm19XHJcbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0Q2xpZW50U2VhcmNoVGVybShlLnRhcmdldC52YWx1ZSl9XHJcbiAgICAgICAgICAvPlxyXG4gICAgICAgICAgPENsaWVudFRhYmxlXHJcbiAgICAgICAgICAgIGNsaWVudHM9eyhBcnJheS5pc0FycmF5KGNsaWVudHMpID8gY2xpZW50cyA6IFtdKS5maWx0ZXIoXHJcbiAgICAgICAgICAgICAgKGNsaWVudCkgPT4gKGNsaWVudD8ubmFtZSA/PyBcIlwiKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGNsaWVudFNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgb25TZWxlY3RDbGllbnQ9e2hhbmRsZUNsaWVudFNlbGVjdH1cclxuICAgICAgICAgICAgb25JbmZvQ2xpY2s9e2hhbmRsZUNsaWVudEluZm99XHJcbiAgICAgICAgICAgIGlzQ2xpZW50U2VhcmNoPXtmYWxzZX1cclxuICAgICAgICAgICAgY2xlYXJTZWxlY3Rpb249eygpID0+IGhhbmRsZUNsaWVudFNlbGVjdChudWxsKX1cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgPC9Nb2RhbC5Cb2R5PlxyXG4gICAgICA8L01vZGFsPlxyXG5cclxuICAgICAgPE1vZGFsIHNob3c9e3Nob3dNb2RlbE1vZGFsfSBvbkhpZGU9eygpID0+IHNldFNob3dNb2RlbE1vZGFsKGZhbHNlKX0+XHJcbiAgICAgICAgPE1vZGFsLkhlYWRlciBjbG9zZUJ1dHRvbj5cclxuICAgICAgICAgIDxNb2RhbC5UaXRsZT5TZWxlY3QgTW9kZWw8L01vZGFsLlRpdGxlPlxyXG4gICAgICAgIDwvTW9kYWwuSGVhZGVyPlxyXG4gICAgICAgIDxNb2RhbC5Cb2R5PlxyXG4gICAgICAgICAgPEZvcm1Db250cm9sXHJcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJTZWFyY2ggYnkgbmFtZVwiXHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cIm1iLTNcIlxyXG4gICAgICAgICAgICB2YWx1ZT17bW9kZWxTZWFyY2hUZXJtfVxyXG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldE1vZGVsU2VhcmNoVGVybShlLnRhcmdldC52YWx1ZSl9XHJcbiAgICAgICAgICAvPlxyXG4gICAgICAgICAgPE1vZGVsVGFibGVcclxuICAgICAgICAgICAgbW9kZWxzPXttb2RlbHMuZmlsdGVyKChtb2RlbCkgPT5cclxuICAgICAgICAgICAgICB0eXBlb2YgbW9kZWwgPT09IFwic3RyaW5nXCJcclxuICAgICAgICAgICAgICAgID8gbW9kZWwudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhtb2RlbFNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAgICAgICAgIDogZmFsc2VcclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgb25TZWxlY3RNb2RlbD17aGFuZGxlTW9kZWxTZWxlY3R9XHJcbiAgICAgICAgICAgIGNsZWFyU2VsZWN0aW9uPXsoKSA9PiBoYW5kbGVNb2RlbFNlbGVjdChudWxsKX1cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgPC9Nb2RhbC5Cb2R5PlxyXG4gICAgICA8L01vZGFsPlxyXG5cclxuICAgICAgPENvbnRhaW5lclxyXG4gICAgICAgIGNsYXNzTmFtZT1cImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1jb250ZW50LWNlbnRlclwiXHJcbiAgICAgICAgc3R5bGU9e3sgbWluSGVpZ2h0OiBcIjEwMHZoXCIgfX1cclxuICAgICAgPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0xMDBcIiBzdHlsZT17eyBtYXhXaWR0aDogXCIxMjAwcHhcIiB9fT5cclxuICAgICAgICAgIDxDYXJkPlxyXG4gICAgICAgICAgICA8Q2FyZC5Cb2R5PlxyXG4gICAgICAgICAgICAgIDxoMiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlciBtYi00XCI+TWFnbW88L2gyPlxyXG4gICAgICAgICAgICAgIDxSb3c+XHJcbiAgICAgICAgICAgICAgICA8Q29sIG1kPXs0fT5cclxuICAgICAgICAgICAgICAgICAgey8qIERyb3Bkb3ducyAqL31cclxuICAgICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cCBjbGFzc05hbWU9XCJtYi0zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cC5UZXh0Pk9FTTwvSW5wdXRHcm91cC5UZXh0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duIG9uU2VsZWN0PXtoYW5kbGVTZWxlY3QxfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLlRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lLXNlY29uZGFyeVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9XCJkcm9wZG93bi1idXR0b24tMVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0xMDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAge2Ryb3Bkb3duMVRleHR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24uVG9nZ2xlPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uTWVudSBjbGFzc05hbWU9XCJ3LTEwMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5JdGVtIGV2ZW50S2V5PVwidW5hc3NpZ25lZFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2VsZWN0IE9wdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uSXRlbSBldmVudEtleT1cIkdFXCI+R0U8L0Ryb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLkl0ZW0gZXZlbnRLZXk9XCJUb3NoaWJhXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb3NoaWJhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5JdGVtIGV2ZW50S2V5PVwiU2llbWVuc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2llbWVuc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uSXRlbSBldmVudEtleT1cIlBoaWxpcHNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBoaWxpcHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24uTWVudT5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9JbnB1dEdyb3VwPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cCBjbGFzc05hbWU9XCJtYi01XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cC5UZXh0Pk1vZGFsaXR5PC9JbnB1dEdyb3VwLlRleHQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24gb25TZWxlY3Q9e2hhbmRsZVNlbGVjdDJ9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uVG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmUtc2Vjb25kYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cImRyb3Bkb3duLWJ1dHRvbi0yXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEwMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB7ZHJvcGRvd24yVGV4dH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5Ub2dnbGU+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5NZW51IGNsYXNzTmFtZT1cInctMTAwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLkl0ZW0gZXZlbnRLZXk9XCJ1bmFzc2lnbmVkXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZWxlY3QgT3B0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5JdGVtIGV2ZW50S2V5PVwiQ1RcIj5DVDwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uSXRlbSBldmVudEtleT1cIk1SSVwiPk1SSTwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5NZW51PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bj5cclxuICAgICAgICAgICAgICAgICAgICA8L0lucHV0R3JvdXA+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e3N0eWxlcy5kaXZpZGVyfT48L2Rpdj5cclxuXHJcbiAgICAgICAgICAgICAgICAgIHsvKiBDbGllbnQgc2VsZWN0aW9uIGJveGVzICovfVxyXG4gICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxJbnB1dEdyb3VwIGNsYXNzTmFtZT1cIm1iLTNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxJbnB1dEdyb3VwLlRleHQ+Q2xpZW50IEZyb208L0lucHV0R3JvdXAuVGV4dD5cclxuICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmUtc2Vjb25kYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0xMDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVDbGllbnRDbGljayhcImZyb21cIil9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7Y2xpZW50RnJvbUJ1dHRvblRleHR9XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICA8L0lucHV0R3JvdXA+XHJcbiAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAgY2xhc3NOYW1lPVwibWItM1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAuVGV4dD5DbGllbnQgQ3VycmVudDwvSW5wdXRHcm91cC5UZXh0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEwMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUNsaWVudENsaWNrKFwiY3VycmVudFwiKX1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtjbGllbnRDdXJyZW50QnV0dG9uVGV4dH1cclxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvSW5wdXRHcm91cD5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAgY2xhc3NOYW1lPVwibWItM1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAuVGV4dD5Nb2RlbDwvSW5wdXRHcm91cC5UZXh0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEwMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZU1vZGVsQ2xpY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHttb2RlbEJ1dHRvblRleHR9XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICA8L0lucHV0R3JvdXA+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZXMuZGl2aWRlcn0+PC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHsvKiBXYXJlaG91c2UgYnV0dG9ucyBmb3IgQ2xpZW50IEN1cnJlbnQgKi99XHJcbiAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAgY2xhc3NOYW1lPVwibWItM1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAuVGV4dD5XYXJlaG91c2U8L0lucHV0R3JvdXAuVGV4dD5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZXMuYnV0dG9uR3JvdXB9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmUtc2Vjb25kYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3N0eWxlcy5mbGV4QnV0dG9ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVNvQ2FsV2FyZWhvdXNlQ2xpY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBTb0NhbCBXYXJlaG91c2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17c3R5bGVzLmZsZXhCdXR0b259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlTm9yQ2FsV2FyZWhvdXNlQ2xpY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBOb3JDYWwgV2FyZWhvdXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmUtc2Vjb25kYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3N0eWxlcy5mbGV4QnV0dG9ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVdhcmVob3VzZVVuYXNzaWduZWRDbGlja31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFVuYXNzaWduZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L0lucHV0R3JvdXA+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9Db2w+XHJcblxyXG4gICAgICAgICAgICAgICAgPENvbCBtZD17OH0+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZXMudGFibGVDb250YWluZXJ9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtpc0xvYWRpbmcgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyIGFsaWduLWl0ZW1zLWNlbnRlciBwLTVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGltZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNyYz1cIi9tYWdtby1sb2dvLnBuZ1wiIC8vIG1ha2Ugc3VyZSBpdCdzIGluIC9wdWJsaWNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBhbHQ9XCJMb2FkaW5nIE1hZ21vXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDY0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA2NCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogXCJtYWdtby1zcGluIDFzIGxpbmVhciBpbmZpbml0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtT3JpZ2luOiBcIjUwJSA1MCVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwiYmxvY2tcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgey8qIGdsb2JhbCBzbyBzdHlsZWQtanN4IGRvZXNuJ3QgaGFzaCB0aGUgbmFtZSAqL31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0eWxlIGpzeCBnbG9iYWw+e2BcclxuICAgICAgQGtleWZyYW1lcyBtYWdtby1zcGluIHtcclxuICAgICAgICBmcm9tIHtcclxuICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDBkZWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0byB7XHJcbiAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgYH08L3N0eWxlPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgICAgICAgIDxQYXJ0VGFibGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5mbz17aW5mb31cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzPXtsYWJlbHN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkcz17aWRzfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBob3ZlclN0eWxlPXtob3ZlclN0eWxlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3J0Q2hlY2tBbGw9e3NvcnRDaGVja0FsbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tEZWxldGU9e2NoZWNrRGVsZXRlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0RlbGV0aW5nPXtpc0RlbGV0aW5nfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dTZWxlY3Q9e3Jvd1NlbGVjdH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0SG92ZXJJbmRleD17c2V0SG92ZXJJbmRleH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaG92ZXJJbmRleD17aG92ZXJJbmRleH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtcz17c2VsZWN0ZWRJdGVtc31cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRJdGVtcz17c2V0U2VsZWN0ZWRJdGVtc31cclxuICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgKX1cblxuXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZXMuc2VhcmNoQ29udGFpbmVyfT5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17c3R5bGVzLnBhZ2luYXRpb25Sb3d9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFBhZ2luYXRpb24gc2l6ZT1cInNtXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxQYWdpbmF0aW9uLlByZXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRQYWdlKChwKSA9PiBNYXRoLm1heCgxLCBwIC0gMSkpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtwYWdlIDw9IDF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtwYWdlQnV0dG9uc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPFBhZ2luYXRpb24uTmV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldFBhZ2UoKHApID0+IHAgKyAxKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IWhhc05leHRQYWdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9QYWdpbmF0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxGb3JtIGNsYXNzTmFtZT1cImQtZmxleCBwYi0yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT17c2hvd0xpc3RTZWFyY2h9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiU2VhcmNoXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibWUtMiBmbGV4LWdyb3ctMVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cIlNlYXJjaFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3NlYXJjaH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17c2VhcmNoQ2hhbmdlSGFuZGxlcn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBmbGV4OiBcIjFcIiB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8TmF2RHJvcGRvd25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17c2VsZWN0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwiY29sbGFzaWJsZS1uYXYtZHJvcGRvd25cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c9e3Nob3dMaXN0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uTW91c2VFbnRlcj17KCkgPT4gc2V0U2hvd0xpc3QodHJ1ZSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25Nb3VzZUxlYXZlPXsoKSA9PiBzZXRTaG93TGlzdChmYWxzZSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgbWFyZ2luVG9wOiBcIi01cHhcIiB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPE5hdkRyb3Bkb3duLkl0ZW0gb25DbGljaz17KCkgPT4geyBzZXRTZWxlY3QoXCJOYW1lXCIpOyBzZXRTaG93TGlzdFNlYXJjaChcInRleHRcIik7IH19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8TmF2RHJvcGRvd24uSXRlbSBvbkNsaWNrPXsoKSA9PiB7IHNldFNlbGVjdChcIkRhdGVcIik7IHNldFNob3dMaXN0U2VhcmNoKFwiZGF0ZVwiKTsgfX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9OYXZEcm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxOYXZEcm9wZG93bi5JdGVtIG9uQ2xpY2s9eygpID0+IHsgc2V0U2VsZWN0KFwiV29yayBPcmRlclwiKTsgc2V0U2hvd0xpc3RTZWFyY2goXCJudW1iZXJcIik7IH19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgV29yayBPcmRlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8TmF2RHJvcGRvd24uSXRlbSBvbkNsaWNrPXsoKSA9PiB7IHNldFNlbGVjdChcIlByb2R1Y3QgTnVtYmVyXCIpOyBzZXRTaG93TGlzdFNlYXJjaChcIm51bWJlclwiKTsgfX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQcm9kdWN0IE51bWJlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8TmF2RHJvcGRvd24uSXRlbSBvbkNsaWNrPXsoKSA9PiB7IHNldFNlbGVjdChcIkRlc2NyaXB0aW9uXCIpOyBzZXRTaG93TGlzdFNlYXJjaChcInRleHRcIik7IH19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVzY3JpcHRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L05hdkRyb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPE5hdkRyb3Bkb3duLkl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0U2VsZWN0KFwiU0tVXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRTaG93TGlzdFNlYXJjaChcInRleHRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNLVVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9OYXZEcm9wZG93bj5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvRm9ybT5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZC1mbGV4IGp1c3RpZnktY29udGVudC1iZXR3ZWVuXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxMb2FkaW5nQnV0dG9uIHR5cGU9XCJzZWNvbmRhcnlcIiBuYW1lPVwiQWRkIE5ldyBJdGVtXCIgcm91dGU9XCJOZXdTZWFyY2gvQWRkSXRlbS9OZXdJdGVtXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPExvYWRpbmdCdXR0b24gdHlwZT1cInByaW1hcnlcIiBuYW1lPVwiQmFja1wiIHJvdXRlPVwiV2FyZWhvdXNlZGIvV2FyZWhvdXNlU2VsZWN0XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvQ29sPlxyXG4gICAgICAgICAgICAgIDwvUm93PlxyXG4gICAgICAgICAgICA8L0NhcmQuQm9keT5cclxuICAgICAgICAgIDwvQ2FyZD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9Db250YWluZXI+XHJcbiAgICA8L0xvZ2dlZEluPlxyXG4gICk7XHJcblxyXG5cclxufVxyXG5cclxuIl19 */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\mack2\\\\\\\\Desktop\\\\\\\\code\\\\\\\\pages\\\\\\\\NewSearch\\\\\\\\mainSearch.js */\")) : __jsx(PartTable, {\n    info: info,\n    labels: labels,\n    ids: ids,\n    hoverStyle: hoverStyle,\n    sortCheckAll: sortCheckAll,\n    checkDelete: checkDelete,\n    isDeleting: isDeleting,\n    rowSelect: rowSelect,\n    setHoverIndex: setHoverIndex,\n    hoverIndex: hoverIndex,\n    selectedItems: selectedItems,\n    setSelectedItems: setSelectedItems,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1077,\n      columnNumber: 23\n    }\n  }), __jsx(\"div\", {\n    className: styles.searchContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1094,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: styles.paginationRow,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1095,\n      columnNumber: 23\n    }\n  }, __jsx(Pagination, {\n    size: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1096,\n      columnNumber: 25\n    }\n  }, __jsx(Pagination.Prev, {\n    onClick: () => setPage(p => Math.max(1, p - 1)),\n    disabled: page <= 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1097,\n      columnNumber: 27\n    }\n  }), pageButtons, __jsx(Pagination.Next, {\n    onClick: () => setPage(p => p + 1),\n    disabled: !hasNextPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1102,\n      columnNumber: 27\n    }\n  }))), __jsx(Form, {\n    className: \"d-flex pb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1108,\n      columnNumber: 23\n    }\n  }, __jsx(FormControl, {\n    type: showListSearch,\n    placeholder: \"Search\",\n    className: \"me-2 flex-grow-1\",\n    \"aria-label\": \"Search\",\n    value: search,\n    onChange: searchChangeHandler,\n    style: {\n      flex: \"1\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1109,\n      columnNumber: 25\n    }\n  }), __jsx(NavDropdown, {\n    title: select,\n    id: \"collasible-nav-dropdown\",\n    show: showList,\n    onMouseEnter: () => setShowList(true),\n    onMouseLeave: () => setShowList(false),\n    style: {\n      marginTop: \"-5px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1118,\n      columnNumber: 25\n    }\n  }, __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Name\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1126,\n      columnNumber: 27\n    }\n  }, \"Name\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Date\");\n      setShowListSearch(\"date\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1129,\n      columnNumber: 27\n    }\n  }, \"Date\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Work Order\");\n      setShowListSearch(\"number\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1132,\n      columnNumber: 27\n    }\n  }, \"Work Order\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Product Number\");\n      setShowListSearch(\"number\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1135,\n      columnNumber: 27\n    }\n  }, \"Product Number\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Description\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1138,\n      columnNumber: 27\n    }\n  }, \"Description\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"SKU\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1141,\n      columnNumber: 27\n    }\n  }, \"SKU\"))), __jsx(\"div\", {\n    className: \"d-flex justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1151,\n      columnNumber: 23\n    }\n  }, __jsx(LoadingButton, {\n    type: \"secondary\",\n    name: \"Add New Item\",\n    route: \"NewSearch/AddItem/NewItem\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1152,\n      columnNumber: 25\n    }\n  }), __jsx(LoadingButton, {\n    type: \"primary\",\n    name: \"Back\",\n    route: \"Warehousedb/WarehouseSelect\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1153,\n      columnNumber: 25\n    }\n  })))))))))));\n}","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/NewSearch/mainSearch.js"],"names":["React","useEffect","useState","Container","Card","Row","Col","InputGroup","Dropdown","FormControl","Button","NavDropdown","Form","Modal","Spinner","Pagination","Link","useRouter","fetchPartsWithMachineDataPage","fetchClients","fetchModels","formatDate","useAuth","LoggedIn","ClientTable","ModelTable","PartTable","styles","firebase","SOCAL_CLIENT_ID","NORCAL_CLIENT_ID","UNASSIGNED_CLIENT_ID","PAGE_SIZE","simulateNetworkRequest","Promise","resolve","setTimeout","LoadingButton","type","name","route","isLoading","setLoading","cancelled","then","toTime","value","seconds","Date","t","getTime","isNaN","iso","parse","parts","split","length","mm","dd","yyyy","alt","toYMD","d","getFullYear","String","getMonth","padStart","getDate","MainSearch","signOut","info","setInfo","backupInfo","setBackupInfo","augmentedInfo","setAugmentedInfo","setIsLoading","ids","setID","show","setShow","dItem","setDItem","select","setSelect","showList","setShowList","showListSearch","setShowListSearch","search","setSearch","selectedOEM","setSelectedOEM","selectedModality","setSelectedModality","selectedClientFrom","setSelectedClientFrom","clientFromButtonText","setClientFromButtonText","selectedClientCurrent","setSelectedClientCurrent","clientCurrentButtonText","setClientCurrentButtonText","clients","setClients","showClientModal","setShowClientModal","clientSelectionType","setClientSelectionType","router","labelBase","labelBaseNames","sortCheckBase","withSortIcon","baseLabels","activeIndex","isDesc","map","text","i","arrow","labels","setLabels","sortCheck","setSortCheck","hoverIndex","setHoverIndex","selectedModel","setSelectedModel","gPos","setGPos","gIde","setGIde","isDeleting","setIsDeleting","page","setPage","pageCursors","setPageCursors","hasNextPage","setHasNextPage","fetchData","requestedPage","query","inputText","selectedType","startAfterDoc","load","attempt","pageSize","e","r","Math","pow","data","lastDoc","nextPage","item","id","prev","next","setSelectedItems","db","firestore","machineIds","curMachineIds","theMachineIds","Machine","push","CurrentMachine","TheMachine","uniq","arr","Set","mIds","cIds","fetchMachineClients","out","chunks","slice","chunk","snap","collection","where","FieldPath","documentId","get","forEach","doc","md","client","fetchMachinesData","fromMap","curMap","theMap","all","augmented","clientFromId","ClientFrom","clientCurrentId","ClientCurrent","filter","it","visible","err","console","error","searchChangeHandler","event","target","filterParts","base","noFilters","filtered","OEM","machineData","theMachineData","Modality","Model","s","toLowerCase","includes","wantedDay","itemYMD","date","Array","isArray","descriptions","hitDesc","some","workOrders","hitWO","w","wo","workOrder","pn","desc","sortCheckAll","pos","nextSortCheck","v","sortedInfo","sort","a","b","key","ta","tb","av","toString","bv","localeCompare","an","Number","bn","rowSelect","log","selectedItems","showDeleteModal","setShowDeleteModal","handleSelectItem","x","handleShowDeleteModal","handleCloseDeleteModal","handleDeleteSelected","itemId","delete","deleteFromStorage","handleClose","handleShow","checkDelete","idsToDelete","preventDefault","stopPropagation","hoverStyle","index","backgroundColor","textAlign","cursor","dropdown1Text","setDropdown1Text","dropdown2Text","setDropdown2Text","handleSelect1","eventKey","textContent","handleSelect2","buildClientsFromItems","add","idArray","handleClientClick","safeClients","clientsData","derived","setClientSearchTerm","handleClientSelect","clientId","clientSnap","exists","clientData","handleClientInfo","clientName","handleClearClientSelection","models","setModels","showModelModal","setShowModelModal","modelButtonText","setModelButtonText","handleModelClick","modelsData","setModelSearchTerm","handleModelSelect","modelName","handleClearModelSelection","handleSoCalWarehouseClick","handleNorCalWarehouseClick","handleWarehouseUnassignedClick","clientSearchTerm","modelSearchTerm","storageRef","storage","ref","folderRef","child","listResult","listAll","deletePromises","items","deleteFromPartsCollection","totalKnownPages","max","pageButtons","model","minHeight","maxWidth","divider","buttonGroup","flexButton","tableContainer","width","height","animation","transformOrigin","display","searchContainer","paginationRow","p","flex","marginTop"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport {\r\n  Container,\n  Card,\n  Row,\n  Col,\n  InputGroup,\n  Dropdown,\n  FormControl,\n  Button,\n  NavDropdown,\n  Form,\n  Modal,\n  Spinner,\n  Pagination,\n} from \"react-bootstrap\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport {\n  fetchPartsWithMachineDataPage,\n  fetchClients,\n  fetchModels,\n  formatDate,\n} from \"../../utils/fetchAssociations\";\nimport { useAuth } from \"../../context/AuthUserContext\";\r\nimport LoggedIn from \"../LoggedIn\";\r\nimport ClientTable from \"../../utils/ClientTable\";\r\nimport ModelTable from \"../../utils/ModelTable\";\r\nimport PartTable from \"../../utils/PartTable\";\r\nimport styles from \"../../styles/MainSearch.module.css\";\r\nimport firebase from \"../../context/Firebase\";\r\n\r\n// Predefined warehouse client IDs and display names\r\nconst SOCAL_CLIENT_ID = \"AIS17182\";\r\nconst NORCAL_CLIENT_ID = \"AIS25097\";\nconst UNASSIGNED_CLIENT_ID = \"AIS00404\";\nconst PAGE_SIZE = 25;\n\r\n\r\n// Simulates a network request delay\r\nfunction simulateNetworkRequest() {\r\n  return new Promise((resolve) => setTimeout(resolve, 2000));\r\n}\r\n\r\n// Custom LoadingButton component\r\nfunction LoadingButton({ type, name, route }) {\n  const [isLoading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (isLoading) {\n      let cancelled = false;\n      simulateNetworkRequest().then(() => {\n        if (!cancelled) setLoading(false);\n      });\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [isLoading]);\n\r\n  return (\r\n    <Link href={`/${route}`}>\r\n      <a\r\n        className={`btn btn-${type}`}\r\n        disabled={isLoading}\r\n        onClick={() => !isLoading && setLoading(true)}\r\n      >\r\n        {isLoading ? \"Loading…\" : name}\r\n      </a>\r\n    </Link>\r\n  );\r\n}\r\n\r\n// ---- DATE HELPERS (top-level scope) ----\r\n\r\n// Convert anything date-ish into a timestamp (ms since epoch).\r\nfunction toTime(value) {\r\n  if (!value) return null;\r\n\r\n  // Firestore Timestamp { seconds, nanoseconds }\r\n  if (typeof value === \"object\" && value !== null && value.seconds != null) {\r\n    try { return value.seconds * 1000; } catch { /* ignore */ }\r\n  }\r\n\r\n  // Native Date\r\n  if (value instanceof Date) {\r\n    const t = value.getTime();\r\n    return isNaN(t) ? null : t;\r\n  }\r\n\r\n  // Strings\r\n  if (typeof value === \"string\") {\r\n    // ISO / yyyy-mm-dd\r\n    const iso = Date.parse(value);\r\n    if (!isNaN(iso)) return iso;\r\n\r\n    // mm/dd/yyyy\r\n    const parts = value.split(\"/\");\r\n    if (parts.length === 3) {\r\n      const [mm, dd, yyyy] = parts;\r\n      const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\r\n      if (!isNaN(alt)) return alt;\r\n    }\r\n  }\r\n\r\n  // Last resort\r\n  const t = Date.parse(value);\r\n  return isNaN(t) ? null : t;\r\n}\r\n\r\n// Canonicalize to 'yyyy-mm-dd' (matches <input type=\"date\">)\r\nfunction toYMD(value) {\r\n  const t = toTime(value);\r\n  if (t == null) return null;\r\n  const d = new Date(t);\r\n  const yyyy = d.getFullYear();\r\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  const dd = String(d.getDate()).padStart(2, \"0\");\r\n  return `${yyyy}-${mm}-${dd}`;\r\n}\r\n\r\n\r\nexport default function MainSearch() {\r\n  const { signOut } = useAuth();\r\n  const [info, setInfo] = useState([]);\r\n  const [backupInfo, setBackupInfo] = useState([]);\r\n  const [augmentedInfo, setAugmentedInfo] = useState([]); // items with clientFromId/currentId added\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [ids, setID] = useState([]);\r\n  const [show, setShow] = useState(false);\r\n  const [dItem, setDItem] = useState();\r\n  const [select, setSelect] = useState(\"Name\");\r\n  const [showList, setShowList] = useState(false);\r\n  const [showListSearch, setShowListSearch] = useState(\"text\");\r\n  const [search, setSearch] = useState(\"\");\r\n  const [selectedOEM, setSelectedOEM] = useState(null);\r\n  const [selectedModality, setSelectedModality] = useState(null);\r\n  // Replace the old single client state with two sets:\r\n  const [selectedClientFrom, setSelectedClientFrom] = useState(null);\r\n  const [clientFromButtonText, setClientFromButtonText] = useState(\"Select Option\");\r\n  const [selectedClientCurrent, setSelectedClientCurrent] = useState(null);\r\n  const [clientCurrentButtonText, setClientCurrentButtonText] = useState(\"Select Option\");\r\n\r\n  const [clients, setClients] = useState([]);\r\n  const [showClientModal, setShowClientModal] = useState(false);\r\n  // This state tells the modal which client box is being updated: \"from\" or \"current\"\r\n  const [clientSelectionType, setClientSelectionType] = useState(null);\r\n\r\n  const router = useRouter();\r\n  const labelBase = [\"name\", \"date\", \"w/o\", \"p/n\", \"s/n\"];\r\n  const labelBaseNames = [\"name\", \"date\", \"wo\", \"pn\", \"sn\"];\r\n  const sortCheckBase = [false, false, false, false, false, false];\r\n\r\n  function withSortIcon(baseLabels, activeIndex, isDesc) {\r\n    return baseLabels.map((text, i) => {\r\n      if (i !== activeIndex) return text; // untouched\r\n      const arrow = isDesc ? \" ▼\" : \" ▲\";\r\n      return `${text}${arrow}`;\r\n    });\r\n  }\r\n\r\n\r\n  const [labels, setLabels] = useState(labelBase);\r\n  const [sortCheck, setSortCheck] = useState(sortCheckBase);\r\n  const [hoverIndex, setHoverIndex] = useState(null);\r\n  const [selectedModel, setSelectedModel] = useState(null);\r\n  const [gPos, setGPos] = useState(null);\r\n  const [gIde, setGIde] = useState(null);\r\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [page, setPage] = useState(1);\n  const [pageCursors, setPageCursors] = useState([]);\n  const [hasNextPage, setHasNextPage] = useState(false);\n\r\n\r\n  // Fetch data on component mount and route change\n  useEffect(() => {\n    fetchData(page);\n  }, [router.route, page]);\n\n  async function fetchData(requestedPage = 1) {\n    setIsLoading(true);\n    try {\n      if (router.query.inputText && router.query.selectedType) {\n        setSelect(router.query.selectedType);\n        setSearch(router.query.inputText);\n      }\n      const startAfterDoc =\n        requestedPage > 1 ? pageCursors[requestedPage - 2] : null;\n      if (requestedPage > 1 && !startAfterDoc) {\n        setPage(1);\n        return;\n      }\n      // light retry for transient Firestore hiccups\n      const load = async (attempt = 1) => {\n        try {\n          return await fetchPartsWithMachineDataPage({\n            pageSize: PAGE_SIZE,\n            startAfterDoc,\n          });\n        } catch (e) {\n          if (attempt >= 3) throw e;\n          await new Promise(r => setTimeout(r, 250 * Math.pow(2, attempt - 1)));\n          return load(attempt + 1);\n        }\n      };\n      const { parts: data, lastDoc, hasNextPage: nextPage } = await load();\n      setBackupInfo(data);\n      setLabels(labelBase); // <-- add this line after setBackupInfo(data)\n      setID(data.map((item) => item.id));\n      setHasNextPage(nextPage);\n      setPageCursors((prev) => {\n        const next = [...prev];\n        next[requestedPage - 1] = lastDoc;\n        return next;\n      });\n      setSelectedItems([]);\n\n      // --- Pre-augment: resolve client ids of Machine / CurrentMachine once ---\n      const db = firebase.firestore();\n      const machineIds = [];\r\n      const curMachineIds = [];\r\n      const theMachineIds = []; // <-- ADD\r\n\r\n      for (const item of data) {\r\n        if (item?.Machine?.id) machineIds.push(item.Machine.id);\r\n        if (item?.CurrentMachine?.id) curMachineIds.push(item.CurrentMachine.id);\r\n        if (item?.TheMachine?.id) theMachineIds.push(item.TheMachine.id); // <-- ADD\r\n      }\r\n      const uniq = (arr) => [...new Set(arr)];\r\n      const mIds = uniq(machineIds);\r\n      const cIds = uniq(curMachineIds);\r\n\r\n      const fetchMachineClients = async (ids) => {\r\n        if (!ids.length) return {};\r\n        const out = {};\r\n        // Firestore \"in\" supports up to 10 document IDs per query\r\n        const chunks = [];\r\n        for (let i = 0; i < ids.length; i += 10) chunks.push(ids.slice(i, i + 10));\r\n        for (const chunk of chunks) {\r\n          const snap = await db\r\n            .collection(\"Machine\")\r\n            .where(firebase.firestore.FieldPath.documentId(), \"in\", chunk)\r\n            .get();\r\n          snap.forEach((doc) => {\r\n            const md = doc.data() || {};\r\n            out[doc.id] = md.client?.id || null;\r\n          });\r\n        }\r\n        return out;\r\n      };\r\n\r\n      // Fetch full machine docs (OEM/Modality/Model/Client/etc.) for a set of ids\r\n      const fetchMachinesData = async (ids) => {\r\n        if (!ids.length) return {};\r\n        const out = {};\r\n        const chunks = [];\r\n        for (let i = 0; i < ids.length; i += 10) chunks.push(ids.slice(i, i + 10));\r\n        for (const chunk of chunks) {\r\n          const snap = await db\r\n            .collection(\"Machine\")\r\n            .where(firebase.firestore.FieldPath.documentId(), \"in\", chunk)\r\n            .get();\r\n          snap.forEach((doc) => {\r\n            out[doc.id] = { id: doc.id, ...(doc.data() || {}) };\r\n          });\r\n        }\r\n        return out;\r\n      };\r\n\r\n\r\n      const [fromMap, curMap, theMap] = await Promise.all([\r\n        fetchMachineClients(mIds),\r\n        fetchMachineClients(cIds),\r\n        fetchMachinesData(uniq(theMachineIds)), // <-- now captured as theMap\r\n      ]);\r\n\r\n      // New-style only: take client ids straight from item refs\r\n      const augmented = data.map((item) => ({\r\n        ...item,\r\n        clientFromId: item?.ClientFrom?.id ?? null,\r\n        clientCurrentId: item?.ClientCurrent?.id ?? null,\r\n      }));\r\n\r\n      setAugmentedInfo(augmented);\n      // default view = everything not explicitly hidden\n      setInfo(augmented.filter((it) => it.visible !== false));\n    } catch (err) {\n      console.error(\"Error fetching data:\", err);\n      setInfo([]);\n      setAugmentedInfo([]);\n    } finally {\n      setIsLoading(false);\n    }\n  }\n\r\n  const searchChangeHandler = (event) => setSearch(event.target.value);\r\n\r\n  // Asynchronous filter function that loops through backupInfo and,\r\n  // for each item, fetches its Machine and CurrentMachine documents,\r\n  // then compares the client id (from machineData.client.id) to the selected client.\r\n  useEffect(() => {\r\n    function filterParts() {\r\n      const base = augmentedInfo; // already has clientFromId/clientCurrentId\r\n      const noFilters =\r\n        !selectedOEM &&\r\n        !selectedModality &&\r\n        !selectedModel &&\r\n        !selectedClientFrom &&\r\n        !selectedClientCurrent &&\r\n        !search;\r\n      if (noFilters) {\r\n        setInfo(base.filter((it) => it.visible !== false));\r\n        return;\r\n      }\r\n\r\n      const filtered = base.filter((item) => {\r\n        // only hide when explicitly false\r\n        if (item.visible === false) return false;\r\n\r\n        // OEM/modality/model via machineData (you already put this in items)\r\n        // OEM / Modality / Model filtering\r\n        // Prefer machineData; fall back to theMachineData; finally try inline TheMachine if it has plain fields\r\n        const OEM = item?.machineData?.OEM\r\n          ?? item?.theMachineData?.OEM\r\n          ?? item?.TheMachine?.OEM;\r\n        const Modality = item?.machineData?.Modality\r\n          ?? item?.theMachineData?.Modality\r\n          ?? item?.TheMachine?.Modality;\r\n        const Model = item?.machineData?.Model\r\n          ?? item?.theMachineData?.Model\r\n          ?? item?.TheMachine?.Model;\r\n\r\n        if (selectedOEM && OEM !== selectedOEM) return false;\r\n        if (selectedModality && Modality !== selectedModality) return false;\r\n        if (selectedModel && Model !== selectedModel) return false;\r\n\r\n\r\n        // Client filters (now instant)\r\n        if (selectedClientFrom && item.clientFromId !== selectedClientFrom) return false;\r\n        if (selectedClientCurrent && item.clientCurrentId !== selectedClientCurrent) return false;\r\n\r\n        // Search\r\n        if (search) {\r\n          const s = String(search).toLowerCase();\r\n          if (select === \"Name\") {\r\n            return (item.name || \"\").toLowerCase().includes(s);\r\n          }\r\n          if (select === \"Date\") {\r\n            // If user hasn't picked a date yet, don't hide anything\r\n            if (!search) return true;\r\n\r\n            const wantedDay = search; // already 'yyyy-mm-dd' from <input type=\"date\">\r\n\r\n            // 1) Match item.date, regardless of its format or type\r\n            const itemYMD = toYMD(item.date);\r\n            if (itemYMD && itemYMD === wantedDay) return true;\r\n\r\n            // 2) Also check any description dates (if you store dates there)\r\n            if (Array.isArray(item.descriptions)) {\r\n              const hitDesc = item.descriptions.some((d) => toYMD(d?.date) === wantedDay);\r\n              if (hitDesc) return true;\r\n            }\r\n\r\n            // 3) And work order dates (if present)\r\n            if (Array.isArray(item.workOrders)) {\r\n              const hitWO = item.workOrders.some((w) => toYMD(w?.date) === wantedDay);\r\n              if (hitWO) return true;\r\n            }\r\n\r\n            return false;\r\n          }\r\n\r\n          if (select === \"Work Order\") {\r\n            return Array.isArray(item.workOrders) &&\r\n              item.workOrders.some((wo) => String(wo.workOrder || \"\").toLowerCase().includes(s));\r\n          }\r\n          if (select === \"Product Number\") {\r\n            return String(item.pn || \"\").toLowerCase().includes(s);\r\n          }\r\n          if (select === \"Description\") {\r\n            return String(item.desc || \"\").toLowerCase().includes(s);\r\n          }\r\n          if (select === \"SKU\") {\r\n            return String(item.id || \"\").toLowerCase().includes(s);\r\n          }\r\n        }\r\n        return true;\r\n      });\r\n      setInfo(filtered);\r\n    }\r\n    filterParts();\r\n  }, [selectedOEM, selectedModality, selectedClientFrom, selectedClientCurrent, selectedModel, search, select, augmentedInfo]);\r\n\r\n  function sortCheckAll(pos) {\r\n    // Determine next direction: toggle the clicked column only\r\n    const nextSortCheck = sortCheck.map((v, i) => (i === pos ? !v : v));\r\n    const isDesc = nextSortCheck[pos]; // true means descending\r\n\r\n    const sortedInfo = [...info].sort((a, b) => {\r\n      const key = labelBaseNames[pos];\r\n\r\n      if (pos === 1) {\r\n        // DATE column\r\n        const ta = toTime(a[key]);\r\n        const tb = toTime(b[key]);\r\n\r\n        // Put missing dates at the end for ascending, at the start for descending\r\n        if (ta === null && tb === null) return 0;\r\n        if (ta === null) return isDesc ? -1 : 1;\r\n        if (tb === null) return isDesc ? 1 : -1;\r\n\r\n        return isDesc ? (tb - ta) : (ta - tb);\r\n      }\r\n\r\n      // NAME or SKU (string-y columns): indexes 0 or 5 in your original logic\r\n      if (pos === 0 || pos === 5) {\r\n        const av = (a[key] ?? \"\").toString();\r\n        const bv = (b[key] ?? \"\").toString();\r\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\r\n      }\r\n\r\n      // Numeric-ish columns (wo, pn, sn) — fall back to string compare if NaN\r\n      const an = Number(a[key]);\r\n      const bn = Number(b[key]);\r\n\r\n      if (!isNaN(an) && !isNaN(bn)) {\r\n        return isDesc ? (bn - an) : (an - bn);\r\n      } else {\r\n        const av = (a[key] ?? \"\").toString();\r\n        const bv = (b[key] ?? \"\").toString();\r\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\r\n      }\r\n    });\r\n\r\n    setInfo(sortedInfo);\r\n    setSortCheck(nextSortCheck);\r\n\r\n    // Update header labels to show the little arrow on the active column\r\n    setLabels(withSortIcon(labelBase, pos, isDesc));\r\n  }\r\n\r\n\r\n  const rowSelect = (item) => {\r\n    if (item && item.id) {\r\n      console.log(\"Selected item:\", item);\r\n      router.push(\"./item/\" + item.id);\r\n    } else {\r\n      console.error(\"Unable to determine the selected item’s ID: \", item);\r\n    }\r\n  };\r\n\r\n  const [selectedItems, setSelectedItems] = useState([]);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n\r\n  const handleSelectItem = (id) => {\r\n    setSelectedItems(prev =>\r\n      prev.includes(id) ? prev.filter(x => x !== id) : [...prev, id]\r\n    );\r\n  };\r\n\r\n\r\n  // setSelectedItems((prev) => {\r\n  //   const newSelection = prev.includes(id)\r\n  //     ? prev.filter((itemId) => itemId !== id)\r\n  //     : [...prev, id];\r\n  //   console.log(\"Selected items:\", newSelection);\r\n  //   return newSelection; // <- important\r\n  // });\r\n\r\n  const handleShowDeleteModal = () => setShowDeleteModal(true);\r\n  const handleCloseDeleteModal = () => setShowDeleteModal(false);\r\n\r\n  const handleDeleteSelected = async () => {\r\n    setIsDeleting(true);\r\n    const db = firebase.firestore();\r\n    try {\r\n      // Loop over each selected item one at a time\r\n      for (const itemId of selectedItems) {\r\n        console.log(itemId)\r\n        try {\r\n          // Delete from \"Test\" collection\r\n          await db.collection(\"Test\").doc(itemId).delete();\r\n        } catch (err) {\r\n          console.error(`Error deleting document ${itemId} from Test:`, err);\r\n        }\r\n        try {\r\n          // Delete from \"Parts\" collection\r\n          await db.collection(\"Parts\").doc(itemId).delete();\r\n        } catch (err) {\r\n          console.error(`Error deleting document ${itemId} from Parts:`, err);\r\n        }\r\n        try {\r\n          // Delete associated photos from storage\r\n          await deleteFromStorage(itemId);\r\n        } catch (err) {\r\n          console.error(`Error deleting storage for ${itemId}:`, err);\r\n        }\r\n      }\r\n      // Update local state by filtering out the deleted items\r\n      setInfo(info.filter((item) => !selectedItems.includes(item.id)));\r\n      setSelectedItems([]);\r\n    } catch (error) {\r\n      console.error(\"Error deleting items:\", error);\r\n    } finally {\r\n      setIsDeleting(false);\r\n      handleCloseDeleteModal();\r\n      // Optionally, reload the page\r\n      // router.reload();\r\n    }\r\n  };\r\n\r\n\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n\r\n  const checkDelete = (event, pos, idsToDelete, name) => {\r\n    if (event) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }\r\n    console.log(\"Selected IDs to delete:\", idsToDelete);\r\n    setSelectedItems(idsToDelete);\r\n    setDItem(name);\r\n    setShowDeleteModal(true);\r\n  };\r\n\r\n  // const handleDelete = async () => {\r\n  //   let itemId = gIde;\r\n  //   try {\r\n  //     setIsDeleting(true);\r\n  //     const db = firebase.firestore();\r\n  //     await db.collection(\"Test\").doc(itemId).delete();\r\n  //     await deleteFromPartsCollection(itemId);\r\n  //     await deleteFromStorage(itemId);\r\n  //     setInfo(info.filter((_, i) => gPos !== i));\r\n  //     console.log(`Deleted item: ${itemId}`);\r\n  //   } catch (error) {\r\n  //     console.error(\"Error deleting item:\", error);\r\n  //   } finally {\r\n  //     setIsDeleting(false);\r\n  //   }\r\n  //   handleClose();\r\n  // };\r\n\r\n  const hoverStyle = (index) => ({\r\n    backgroundColor: hoverIndex === index ? \"#ddd\" : \"transparent\",\r\n    textAlign: \"center\",\r\n    cursor: \"default\",\r\n  });\r\n\r\n  const [dropdown1Text, setDropdown1Text] = useState(\"Select Option\");\r\n  const [dropdown2Text, setDropdown2Text] = useState(\"Select Option\");\r\n\r\n  const handleSelect1 = (eventKey, event) => {\r\n    if (eventKey === \"unassigned\") {\r\n      setDropdown1Text(\"Select Option\");\r\n      setSelectedOEM(null);\r\n    } else {\r\n      setDropdown1Text(event.target.textContent);\r\n      setSelectedOEM(event.target.textContent);\r\n    }\r\n  };\r\n\r\n  const handleSelect2 = (eventKey, event) => {\r\n    if (eventKey === \"unassigned\") {\r\n      setDropdown2Text(\"Select Option\");\r\n      setSelectedModality(null);\r\n    } else {\r\n      setDropdown2Text(event.target.textContent);\r\n      setSelectedModality(event.target.textContent);\r\n    }\r\n  };\r\n\r\n  // Build a unique list of clients from the items currently loaded, filtered by OEM/Modality.\r\n  // `type` is \"from\" or \"current\" to decide which client ref to read.\r\n  async function buildClientsFromItems(type) {\r\n    const db = firebase.firestore();\r\n    const ids = new Set();\r\n\r\n    // Respect current OEM / Modality filters when deriving client options\r\n    const filtered = augmentedInfo.filter((item) => {\r\n      const OEM = item?.machineData?.OEM ?? item?.OEM ?? null;\r\n      const Modality = item?.machineData?.Modality ?? item?.Modality ?? null;\r\n      if (selectedOEM && OEM !== selectedOEM) return false;\r\n      if (selectedModality && Modality !== selectedModality) return false;\r\n      return true;\r\n    });\r\n\r\n    for (const it of filtered) {\r\n      const id = type === \"from\" ? it.clientFromId : it.clientCurrentId;\r\n      if (id) ids.add(id);\r\n    }\r\n\r\n    const out = [];\r\n    const idArray = [...ids];\r\n    for (let i = 0; i < idArray.length; i += 10) {\r\n      const chunk = idArray.slice(i, i + 10);\r\n      const snap = await db\r\n        .collection(\"Client\")\r\n        .where(firebase.firestore.FieldPath.documentId(), \"in\", chunk)\r\n        .get();\r\n      snap.forEach((doc) => {\r\n        const d = doc.data() || {};\r\n        out.push({ id: doc.id, name: d.name || doc.id });\r\n      });\r\n    }\r\n\r\n    // sort by name for nicer UX\r\n    out.sort((a, b) => (a.name || \"\").localeCompare(b.name || \"\"));\r\n    return out;\r\n  }\r\n\r\n\r\n  // --------------------\r\n  // CLIENT SELECTION HANDLING\r\n  // --------------------\r\n  // This function fetches clients and opens the client modal.\r\n  const handleClientClick = async () => {\r\n    let safeClients = [];\r\n    try {\r\n      const clientsData = await fetchClients(selectedOEM, selectedModality);\r\n      safeClients = Array.isArray(clientsData) ? clientsData : [];\r\n    } catch (e) {\r\n      console.error(\"fetchClients failed:\", e);\r\n    }\r\n\r\n    // Fallback to building from loaded items if API gave us nothing\r\n    if (safeClients.length === 0) {\r\n      try {\r\n        if (!clientSelectionType) {\r\n          // if somehow not set yet, default to \"from\"\r\n          setClientSelectionType(\"from\");\r\n        }\r\n        const derived = await buildClientsFromItems(clientSelectionType || \"from\");\r\n        safeClients = derived;\r\n      } catch (e) {\r\n        console.error(\"Fallback buildClientsFromItems failed:\", e);\r\n        safeClients = [];\r\n      }\r\n    }\r\n\r\n    setClients(safeClients);\r\n    setClientSearchTerm(\"\");\r\n    setShowClientModal(true);\r\n  };\r\n\r\n\r\n\r\n  // When a client is selected in the modal, we now assume the parameter is a client ID.\r\n  // If the passed value is null, we clear the selection.\r\n  const handleClientSelect = async (clientId) => {\r\n    console.log(\"User selected client id:\", clientId);\r\n    if (!clientId) {\r\n      if (clientSelectionType === \"from\") {\r\n        setClientFromButtonText(\"Select Option\");\r\n        setSelectedClientFrom(null);\r\n      } else if (clientSelectionType === \"current\") {\r\n        setClientCurrentButtonText(\"Select Option\");\r\n        setSelectedClientCurrent(null);\r\n      }\r\n      setShowClientModal(false);\r\n      return;\r\n    }\r\n    try {\r\n      const clientSnap = await firebase.firestore().collection(\"Client\").doc(clientId).get();\r\n      if (clientSnap.exists) {\r\n        const clientData = clientSnap.data();\r\n        if (clientSelectionType === \"from\") {\r\n          setClientFromButtonText(clientData.name);\r\n          setSelectedClientFrom(clientId);\r\n        } else if (clientSelectionType === \"current\") {\r\n          setClientCurrentButtonText(clientData.name);\r\n          setSelectedClientCurrent(clientId);\r\n        }\r\n      } else {\r\n        console.error(\"No client document found for id:\", clientId);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching client data:\", error);\r\n    }\r\n    setShowClientModal(false);\r\n  };\r\n\r\n  const handleClientInfo = (clientId, clientName) => {\r\n    console.log(`Client ID: ${clientId}, Client Name: ${clientName}`);\r\n    router.push(\"client/\" + clientId);\r\n  };\r\n\r\n  const handleClearClientSelection = () => {\r\n    if (clientSelectionType === \"from\") {\r\n      setClientFromButtonText(\"Select Option\");\r\n      setSelectedClientFrom(null);\r\n    } else if (clientSelectionType === \"current\") {\r\n      setClientCurrentButtonText(\"Select Option\");\r\n      setSelectedClientCurrent(null);\r\n    }\r\n    setShowClientModal(false);\r\n  };\r\n\r\n  // --------------------\r\n  // MODEL SELECTION HANDLING\r\n  // --------------------\r\n  const [models, setModels] = useState([]);\r\n  const [showModelModal, setShowModelModal] = useState(false);\r\n  const [modelButtonText, setModelButtonText] = useState(\"Select Option\");\r\n\r\n  const handleModelClick = async () => {\r\n    const modelsData = await fetchModels(\r\n      selectedOEM,\r\n      selectedModality,\r\n      selectedClientFrom\r\n    );\r\n    setModels(modelsData);\r\n    setModelSearchTerm(\"\");\r\n    setShowModelModal(true);\r\n  };\r\n\r\n  const handleModelSelect = (modelName) => {\r\n    setModelButtonText(modelName || \"Select Option\");\r\n    setSelectedModel(modelName || null);\r\n    setShowModelModal(false);\r\n  };\r\n\r\n  const handleClearModelSelection = () => {\r\n    setModelButtonText(\"Select Option\");\r\n    setSelectedModel(null);\r\n    setShowModelModal(false);\r\n  };\r\n\r\n  // --------------------\r\n  // WAREHOUSE BUTTONS (for Client Current)\r\n  // --------------------\r\n  const handleSoCalWarehouseClick = () => {\r\n    setClientCurrentButtonText(\"SoCal Warehouse\");\r\n    setSelectedClientCurrent(SOCAL_CLIENT_ID);\r\n    console.log(\"Warehouse button clicked: setting Client Current to\", SOCAL_CLIENT_ID);\r\n  };\r\n\r\n  const handleNorCalWarehouseClick = () => {\r\n    setClientCurrentButtonText(\"NorCal Warehouse\");\r\n    setSelectedClientCurrent(NORCAL_CLIENT_ID);\r\n    console.log(\"Warehouse button clicked: setting Client Current to\", NORCAL_CLIENT_ID);\r\n  };\r\n\r\n  const handleWarehouseUnassignedClick = () => {\r\n    setClientCurrentButtonText(\"Unassigned\");\r\n    setSelectedClientCurrent(UNASSIGNED_CLIENT_ID);\r\n    console.log(\"Warehouse button clicked: setting Client Current to\", UNASSIGNED_CLIENT_ID);\r\n  };\r\n\r\n  const [clientSearchTerm, setClientSearchTerm] = useState(\"\");\r\n  const [modelSearchTerm, setModelSearchTerm] = useState(\"\");\r\n\r\n  const deleteFromStorage = async (itemId) => {\r\n    const storageRef = firebase.storage().ref();\r\n    const folderRef = storageRef.child(`Parts/${itemId}/`);\r\n    try {\r\n      const listResult = await folderRef.listAll();\r\n      const deletePromises = listResult.items.map((item) => item.delete());\r\n      await Promise.all(deletePromises);\r\n    } catch (error) {\r\n      console.error(\"Error deleting from storage:\", error);\r\n    }\r\n  };\r\n\r\n  const deleteFromPartsCollection = async (itemId) => {\r\n    const db = firebase.firestore();\r\n    try {\r\n      await db.collection(\"Parts\").doc(itemId).delete();\r\n      console.log(`Deleted item from Parts collection: ${itemId}`);\r\n    } catch (error) {\r\n      console.error(\"Error deleting from Parts collection:\", error);\r\n    }\r\n  };\r\n\r\n  //   // Safely convert any date-ish value into a comparable timestamp (ms since epoch).\r\n  // function toTime(value) {\r\n  //   if (!value) return null;\r\n\r\n  //   // Firestore Timestamp: { seconds, nanoseconds }\r\n  //   if (typeof value === \"object\" && value.seconds) {\r\n  //     try {\r\n  //       return value.seconds * 1000;\r\n  //     } catch { /* fallthrough */ }\r\n  //   }\r\n\r\n  //   // If already a Date\r\n  //   if (value instanceof Date) return isNaN(value.getTime()) ? null : value.getTime();\r\n\r\n  //   // If string: try ISO first\r\n  //   if (typeof value === \"string\") {\r\n  //     // yyyy-mm-dd (from your form inputs)\r\n  //     const iso = Date.parse(value);\r\n  //     if (!isNaN(iso)) return iso;\r\n\r\n  //     // mm/dd/yyyy fallback (older items)\r\n  //     const parts = value.split(\"/\");\r\n  //     if (parts.length === 3) {\r\n  //       const [mm, dd, yyyy] = parts;\r\n  //       const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\r\n  //       if (!isNaN(alt)) return alt;\r\n  //     }\r\n  //   }\r\n\r\n  //   // Canonicalize any date-ish value to 'yyyy-mm-dd' so it matches <input type=\"date\"> values\r\n  //   function toYMD(value) {\r\n  //     const t = toTime(value);\r\n  //     if (t == null) return null;\r\n  //     const d = new Date(t);\r\n  //     const yyyy = d.getFullYear();\r\n  //     const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  //     const dd = String(d.getDate()).padStart(2, \"0\");\r\n  //     return `${yyyy}-${mm}-${dd}`;\r\n  //   }\r\n\r\n\r\n  //   // Last resort\n  //   const t = Date.parse(value);\n  //   return isNaN(t) ? null : t;\n  // }\n\n  const totalKnownPages = Math.max(\n    1,\n    pageCursors.length + (hasNextPage ? 1 : 0)\n  );\n  const pageButtons = [];\n  for (let i = 1; i <= totalKnownPages; i++) {\n    pageButtons.push(\n      <Pagination.Item\n        key={i}\n        active={i === page}\n        onClick={() => setPage(i)}\n      >\n        {i}\n      </Pagination.Item>\n    );\n  }\n\n\n  return (\n    <LoggedIn>\n      {isDeleting && (\r\n        <div className=\"loading-overlay\">\r\n          <Spinner animation=\"border\" role=\"status\" className=\"spinner-center\">\r\n            <span className=\"sr-only\">Loading...</span>\r\n          </Spinner>\r\n        </div>\r\n      )}\r\n      <Modal show={showDeleteModal} onHide={handleCloseDeleteModal}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Confirm Deletion</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          Are you sure you want to delete {selectedItems.length} item\r\n          {selectedItems.length > 1 ? \"s\" : \"\"}?\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"danger\" onClick={handleDeleteSelected}>\r\n            Yes, delete\r\n          </Button>\r\n          <Button variant=\"secondary\" onClick={handleCloseDeleteModal}>\r\n            Cancel\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n\r\n      <Modal show={showClientModal} onHide={() => setShowClientModal(false)}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>\r\n            Select {clientSelectionType === \"from\" ? \"Client From\" : \"Client Current\"}\r\n          </Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <FormControl\r\n            type=\"text\"\r\n            placeholder=\"Search by name\"\r\n            className=\"mb-3\"\r\n            value={clientSearchTerm}\r\n            onChange={(e) => setClientSearchTerm(e.target.value)}\r\n          />\r\n          <ClientTable\r\n            clients={(Array.isArray(clients) ? clients : []).filter(\r\n              (client) => (client?.name ?? \"\").toLowerCase().includes(clientSearchTerm.toLowerCase())\r\n            )}\r\n            onSelectClient={handleClientSelect}\r\n            onInfoClick={handleClientInfo}\r\n            isClientSearch={false}\r\n            clearSelection={() => handleClientSelect(null)}\r\n          />\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      <Modal show={showModelModal} onHide={() => setShowModelModal(false)}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Select Model</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <FormControl\r\n            type=\"text\"\r\n            placeholder=\"Search by name\"\r\n            className=\"mb-3\"\r\n            value={modelSearchTerm}\r\n            onChange={(e) => setModelSearchTerm(e.target.value)}\r\n          />\r\n          <ModelTable\r\n            models={models.filter((model) =>\r\n              typeof model === \"string\"\r\n                ? model.toLowerCase().includes(modelSearchTerm.toLowerCase())\r\n                : false\r\n            )}\r\n            onSelectModel={handleModelSelect}\r\n            clearSelection={() => handleModelSelect(null)}\r\n          />\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      <Container\r\n        className=\"d-flex align-items-center justify-content-center\"\r\n        style={{ minHeight: \"100vh\" }}\r\n      >\r\n        <div className=\"w-100\" style={{ maxWidth: \"1200px\" }}>\r\n          <Card>\r\n            <Card.Body>\r\n              <h2 className=\"text-center mb-4\">Magmo</h2>\r\n              <Row>\r\n                <Col md={4}>\r\n                  {/* Dropdowns */}\r\n                  <div>\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>OEM</InputGroup.Text>\r\n                      <Dropdown onSelect={handleSelect1}>\r\n                        <Dropdown.Toggle\r\n                          variant=\"outline-secondary\"\r\n                          id=\"dropdown-button-1\"\r\n                          className=\"w-100\"\r\n                        >\r\n                          {dropdown1Text}\r\n                        </Dropdown.Toggle>\r\n                        <Dropdown.Menu className=\"w-100\">\r\n                          <Dropdown.Item eventKey=\"unassigned\">\r\n                            Select Option\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"GE\">GE</Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"Toshiba\">\r\n                            Toshiba\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"Siemens\">\r\n                            Siemens\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"Philips\">\r\n                            Philips\r\n                          </Dropdown.Item>\r\n                        </Dropdown.Menu>\r\n                      </Dropdown>\r\n                    </InputGroup>\r\n\r\n                    <InputGroup className=\"mb-5\">\r\n                      <InputGroup.Text>Modality</InputGroup.Text>\r\n                      <Dropdown onSelect={handleSelect2}>\r\n                        <Dropdown.Toggle\r\n                          variant=\"outline-secondary\"\r\n                          id=\"dropdown-button-2\"\r\n                          className=\"w-100\"\r\n                        >\r\n                          {dropdown2Text}\r\n                        </Dropdown.Toggle>\r\n                        <Dropdown.Menu className=\"w-100\">\r\n                          <Dropdown.Item eventKey=\"unassigned\">\r\n                            Select Option\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"CT\">CT</Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"MRI\">MRI</Dropdown.Item>\r\n                        </Dropdown.Menu>\r\n                      </Dropdown>\r\n                    </InputGroup>\r\n                  </div>\r\n\r\n                  <div className={styles.divider}></div>\r\n\r\n                  {/* Client selection boxes */}\r\n                  <div>\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Client From</InputGroup.Text>\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        className=\"w-100\"\r\n                        onClick={() => handleClientClick(\"from\")}\r\n\r\n                      >\r\n                        {clientFromButtonText}\r\n                      </Button>\r\n                    </InputGroup>\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Client Current</InputGroup.Text>\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        className=\"w-100\"\r\n                        onClick={() => handleClientClick(\"current\")}\r\n\r\n                      >\r\n                        {clientCurrentButtonText}\r\n                      </Button>\r\n                    </InputGroup>\r\n\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Model</InputGroup.Text>\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        className=\"w-100\"\r\n                        onClick={handleModelClick}\r\n                      >\r\n                        {modelButtonText}\r\n                      </Button>\r\n                    </InputGroup>\r\n\r\n                    <div className={styles.divider}></div>\r\n\r\n                    {/* Warehouse buttons for Client Current */}\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Warehouse</InputGroup.Text>\r\n                      <div className={styles.buttonGroup}>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          className={styles.flexButton}\r\n                          onClick={handleSoCalWarehouseClick}\r\n                        >\r\n                          SoCal Warehouse\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          className={styles.flexButton}\r\n                          onClick={handleNorCalWarehouseClick}\r\n                        >\r\n                          NorCal Warehouse\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          className={styles.flexButton}\r\n                          onClick={handleWarehouseUnassignedClick}\r\n                        >\r\n                          Unassigned\r\n                        </Button>\r\n                      </div>\r\n                    </InputGroup>\r\n                  </div>\r\n                </Col>\r\n\r\n                <Col md={8}>\r\n                  <div className={styles.tableContainer}>\r\n                    {isLoading ? (\r\n                      <div className=\"d-flex justify-content-center align-items-center p-5\">\r\n                        <img\r\n                          src=\"/magmo-logo.png\" // make sure it's in /public\r\n                          alt=\"Loading Magmo\"\r\n                          style={{\r\n                            width: 64,\r\n                            height: 64,\r\n                            animation: \"magmo-spin 1s linear infinite\",\r\n                            transformOrigin: \"50% 50%\",\r\n                            display: \"block\",\r\n                          }}\r\n                        />\r\n\r\n                        {/* global so styled-jsx doesn't hash the name */}\r\n                        <style jsx global>{`\r\n      @keyframes magmo-spin {\r\n        from {\r\n          transform: rotate(0deg);\r\n        }\r\n        to {\r\n          transform: rotate(360deg);\r\n        }\r\n      }\r\n    `}</style>\r\n                      </div>\r\n                    ) : (\r\n                      <PartTable\r\n                        info={info}\r\n                        labels={labels}\r\n                        ids={ids}\r\n                        hoverStyle={hoverStyle}\r\n                        sortCheckAll={sortCheckAll}\r\n                        checkDelete={checkDelete}\r\n                        isDeleting={isDeleting}\r\n                        rowSelect={rowSelect}\r\n                        setHoverIndex={setHoverIndex}\r\n                        hoverIndex={hoverIndex}\r\n                        selectedItems={selectedItems}\r\n                        setSelectedItems={setSelectedItems}\r\n                      />\r\n                    )}\n\n\n                    <div className={styles.searchContainer}>\n                      <div className={styles.paginationRow}>\n                        <Pagination size=\"sm\">\n                          <Pagination.Prev\n                            onClick={() => setPage((p) => Math.max(1, p - 1))}\n                            disabled={page <= 1}\n                          />\n                          {pageButtons}\n                          <Pagination.Next\n                            onClick={() => setPage((p) => p + 1)}\n                            disabled={!hasNextPage}\n                          />\n                        </Pagination>\n                      </div>\n                      <Form className=\"d-flex pb-2\">\n                        <FormControl\n                          type={showListSearch}\n                          placeholder=\"Search\"\n                          className=\"me-2 flex-grow-1\"\r\n                          aria-label=\"Search\"\r\n                          value={search}\r\n                          onChange={searchChangeHandler}\r\n                          style={{ flex: \"1\" }}\r\n                        />\r\n                        <NavDropdown\r\n                          title={select}\r\n                          id=\"collasible-nav-dropdown\"\r\n                          show={showList}\r\n                          onMouseEnter={() => setShowList(true)}\r\n                          onMouseLeave={() => setShowList(false)}\r\n                          style={{ marginTop: \"-5px\" }}\r\n                        >\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Name\"); setShowListSearch(\"text\"); }}>\r\n                            Name\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Date\"); setShowListSearch(\"date\"); }}>\r\n                            Date\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Work Order\"); setShowListSearch(\"number\"); }}>\r\n                            Work Order\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Product Number\"); setShowListSearch(\"number\"); }}>\r\n                            Product Number\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Description\"); setShowListSearch(\"text\"); }}>\r\n                            Description\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item\r\n                            onClick={() => {\r\n                              setSelect(\"SKU\");\r\n                              setShowListSearch(\"text\");\r\n                            }}\r\n                          >\r\n                            SKU\r\n                          </NavDropdown.Item>\r\n                        </NavDropdown>\r\n                      </Form>\r\n                      <div className=\"d-flex justify-content-between\">\r\n                        <LoadingButton type=\"secondary\" name=\"Add New Item\" route=\"NewSearch/AddItem/NewItem\" />\r\n                        <LoadingButton type=\"primary\" name=\"Back\" route=\"Warehousedb/WarehouseSelect\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n            </Card.Body>\r\n          </Card>\r\n        </div>\r\n      </Container>\r\n    </LoggedIn>\r\n  );\r\n\r\n\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}