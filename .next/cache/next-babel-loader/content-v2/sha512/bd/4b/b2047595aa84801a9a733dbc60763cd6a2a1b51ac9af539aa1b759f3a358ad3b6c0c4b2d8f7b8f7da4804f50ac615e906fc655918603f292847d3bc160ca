{"ast":null,"code":"import { initializeApp, getApps, cert } from \"firebase-admin/app\";\nimport { getFirestore } from \"firebase-admin/firestore\"; // Import Firebase Functions for config access\n\nlet functions;\n\ntry {\n  functions = require(\"firebase-functions\");\n} catch (error) {\n  // Not running in Firebase Functions environment\n  functions = null;\n} // Initialize Firebase Admin if it hasn't been initialized\n\n\nif (!getApps().length) {\n  var _functions$config$adm, _functions$config$ssr, _functions$config$adm2, _functions$config$ssr2;\n\n  const clientEmail = process.env.FIREBASE_CLIENT_EMAIL || process.env.FIREBASE_FUNCTIONS_CLIENT_EMAIL || process.env.FIREBASE_ADMIN_CLIENT_EMAIL || (functions ? ((_functions$config$adm = functions.config().admin) === null || _functions$config$adm === void 0 ? void 0 : _functions$config$adm.client_email) || ((_functions$config$ssr = functions.config().ssr) === null || _functions$config$ssr === void 0 ? void 0 : _functions$config$ssr.firebase_client_email) : undefined);\n  const privateKey = process.env.FIREBASE_PRIVATE_KEY || process.env.FIREBASE_FUNCTIONS_PRIVATE_KEY || process.env.FIREBASE_ADMIN_PRIVATE_KEY || (functions ? ((_functions$config$adm2 = functions.config().admin) === null || _functions$config$adm2 === void 0 ? void 0 : _functions$config$adm2.private_key) || ((_functions$config$ssr2 = functions.config().ssr) === null || _functions$config$ssr2 === void 0 ? void 0 : _functions$config$ssr2.firebase_private_key) : undefined);\n\n  try {\n    if (clientEmail && privateKey) {\n      initializeApp({\n        credential: cert({\n          projectId: \"magmo-ac10c\",\n          clientEmail: clientEmail,\n          privateKey: privateKey.replace(/\\\\n/g, \"\\n\")\n        }),\n        databaseURL: \"https://magmo-ac10c.firebaseio.com\"\n      });\n    } else {\n      // Fall back to Application Default Credentials (e.g. Cloud Functions/Run)\n      initializeApp({\n        projectId: \"magmo-ac10c\",\n        databaseURL: \"https://magmo-ac10c.firebaseio.com\"\n      });\n    }\n  } catch (error) {\n    console.warn(\"Firebase Admin initialization failed:\", error.message); // Don't throw error during build process\n  }\n} // Only export Firestore if Firebase Admin is properly initialized\n\n\nlet adminDb = null;\n\ntry {\n  if (getApps().length > 0) {\n    adminDb = getFirestore();\n  }\n} catch (error) {\n  console.warn(\"Firebase Admin not available:\", error.message);\n}\n\nexport { adminDb };\nexport default adminDb;","map":{"version":3,"sources":["C:/Users/isavc/OneDrive/Documents/AIS/Apps/magmo/context/FirebaseAdmin.js"],"names":["initializeApp","getApps","cert","getFirestore","functions","require","error","length","clientEmail","process","env","FIREBASE_CLIENT_EMAIL","FIREBASE_FUNCTIONS_CLIENT_EMAIL","FIREBASE_ADMIN_CLIENT_EMAIL","config","admin","client_email","ssr","firebase_client_email","undefined","privateKey","FIREBASE_PRIVATE_KEY","FIREBASE_FUNCTIONS_PRIVATE_KEY","FIREBASE_ADMIN_PRIVATE_KEY","private_key","firebase_private_key","credential","projectId","replace","databaseURL","console","warn","message","adminDb"],"mappings":"AAAA,SAASA,aAAT,EAAwBC,OAAxB,EAAiCC,IAAjC,QAA6C,oBAA7C;AACA,SAASC,YAAT,QAA6B,0BAA7B,C,CAEA;;AACA,IAAIC,SAAJ;;AACA,IAAI;AACFA,EAAAA,SAAS,GAAGC,OAAO,CAAC,oBAAD,CAAnB;AACD,CAFD,CAEE,OAAOC,KAAP,EAAc;AACd;AACAF,EAAAA,SAAS,GAAG,IAAZ;AACD,C,CAED;;;AACA,IAAI,CAACH,OAAO,GAAGM,MAAf,EAAuB;AAAA;;AACrB,QAAMC,WAAW,GACfC,OAAO,CAACC,GAAR,CAAYC,qBAAZ,IACAF,OAAO,CAACC,GAAR,CAAYE,+BADZ,IAEAH,OAAO,CAACC,GAAR,CAAYG,2BAFZ,KAGCT,SAAS,GACN,0BAAAA,SAAS,CAACU,MAAV,GAAmBC,KAAnB,gFAA0BC,YAA1B,+BACAZ,SAAS,CAACU,MAAV,GAAmBG,GADnB,0DACA,sBAAwBC,qBADxB,CADM,GAGNC,SANJ,CADF;AASA,QAAMC,UAAU,GACdX,OAAO,CAACC,GAAR,CAAYW,oBAAZ,IACAZ,OAAO,CAACC,GAAR,CAAYY,8BADZ,IAEAb,OAAO,CAACC,GAAR,CAAYa,0BAFZ,KAGCnB,SAAS,GACN,2BAAAA,SAAS,CAACU,MAAV,GAAmBC,KAAnB,kFAA0BS,WAA1B,gCACApB,SAAS,CAACU,MAAV,GAAmBG,GADnB,2DACA,uBAAwBQ,oBADxB,CADM,GAGNN,SANJ,CADF;;AASA,MAAI;AACF,QAAIX,WAAW,IAAIY,UAAnB,EAA+B;AAC7BpB,MAAAA,aAAa,CAAC;AACZ0B,QAAAA,UAAU,EAAExB,IAAI,CAAC;AACfyB,UAAAA,SAAS,EAAE,aADI;AAEfnB,UAAAA,WAAW,EAAEA,WAFE;AAGfY,UAAAA,UAAU,EAAEA,UAAU,CAACQ,OAAX,CAAmB,MAAnB,EAA2B,IAA3B;AAHG,SAAD,CADJ;AAMZC,QAAAA,WAAW,EAAE;AAND,OAAD,CAAb;AAQD,KATD,MASO;AACL;AACA7B,MAAAA,aAAa,CAAC;AACZ2B,QAAAA,SAAS,EAAE,aADC;AAEZE,QAAAA,WAAW,EAAE;AAFD,OAAD,CAAb;AAID;AACF,GAjBD,CAiBE,OAAOvB,KAAP,EAAc;AACdwB,IAAAA,OAAO,CAACC,IAAR,CAAa,uCAAb,EAAsDzB,KAAK,CAAC0B,OAA5D,EADc,CAEd;AACD;AACF,C,CAED;;;AACA,IAAIC,OAAO,GAAG,IAAd;;AACA,IAAI;AACF,MAAIhC,OAAO,GAAGM,MAAV,GAAmB,CAAvB,EAA0B;AACxB0B,IAAAA,OAAO,GAAG9B,YAAY,EAAtB;AACD;AACF,CAJD,CAIE,OAAOG,KAAP,EAAc;AACdwB,EAAAA,OAAO,CAACC,IAAR,CAAa,+BAAb,EAA8CzB,KAAK,CAAC0B,OAApD;AACD;;AAED,SAASC,OAAT;AACA,eAAeA,OAAf","sourcesContent":["import { initializeApp, getApps, cert } from \"firebase-admin/app\";\r\nimport { getFirestore } from \"firebase-admin/firestore\";\r\n\r\n// Import Firebase Functions for config access\r\nlet functions;\r\ntry {\r\n  functions = require(\"firebase-functions\");\r\n} catch (error) {\r\n  // Not running in Firebase Functions environment\r\n  functions = null;\r\n}\r\n\r\n// Initialize Firebase Admin if it hasn't been initialized\r\nif (!getApps().length) {\r\n  const clientEmail =\r\n    process.env.FIREBASE_CLIENT_EMAIL ||\r\n    process.env.FIREBASE_FUNCTIONS_CLIENT_EMAIL ||\r\n    process.env.FIREBASE_ADMIN_CLIENT_EMAIL ||\r\n    (functions\r\n      ? functions.config().admin?.client_email ||\r\n        functions.config().ssr?.firebase_client_email\r\n      : undefined);\r\n\r\n  const privateKey =\r\n    process.env.FIREBASE_PRIVATE_KEY ||\r\n    process.env.FIREBASE_FUNCTIONS_PRIVATE_KEY ||\r\n    process.env.FIREBASE_ADMIN_PRIVATE_KEY ||\r\n    (functions\r\n      ? functions.config().admin?.private_key ||\r\n        functions.config().ssr?.firebase_private_key\r\n      : undefined);\r\n\r\n  try {\r\n    if (clientEmail && privateKey) {\r\n      initializeApp({\r\n        credential: cert({\r\n          projectId: \"magmo-ac10c\",\r\n          clientEmail: clientEmail,\r\n          privateKey: privateKey.replace(/\\\\n/g, \"\\n\"),\r\n        }),\r\n        databaseURL: \"https://magmo-ac10c.firebaseio.com\",\r\n      });\r\n    } else {\r\n      // Fall back to Application Default Credentials (e.g. Cloud Functions/Run)\r\n      initializeApp({\r\n        projectId: \"magmo-ac10c\",\r\n        databaseURL: \"https://magmo-ac10c.firebaseio.com\",\r\n      });\r\n    }\r\n  } catch (error) {\r\n    console.warn(\"Firebase Admin initialization failed:\", error.message);\r\n    // Don't throw error during build process\r\n  }\r\n}\r\n\r\n// Only export Firestore if Firebase Admin is properly initialized\r\nlet adminDb = null;\r\ntry {\r\n  if (getApps().length > 0) {\r\n    adminDb = getFirestore();\r\n  }\r\n} catch (error) {\r\n  console.warn(\"Firebase Admin not available:\", error.message);\r\n}\r\n\r\nexport { adminDb };\r\nexport default adminDb;\r\n"]},"metadata":{},"sourceType":"module"}