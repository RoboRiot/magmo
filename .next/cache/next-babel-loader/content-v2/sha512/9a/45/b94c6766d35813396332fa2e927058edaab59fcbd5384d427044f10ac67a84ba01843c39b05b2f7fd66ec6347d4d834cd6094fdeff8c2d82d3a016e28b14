{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from \"react\";\nimport { FormControl, Button, Spinner, Alert } from \"react-bootstrap\";\nimport { useRouter } from \"next/router\";\nimport { fetchClients } from \"../../utils/fetchAssociations\";\nimport ClientTable from \"../../utils/ClientTable\";\nimport styles from \"../../styles/ClientSearch.module.css\"; // import styles from \"../../styles/ClientPage.module.css\";\n\nvar ClientPage = function ClientPage() {\n  var _useState = useState([]),\n      clients = _useState[0],\n      setClients = _useState[1];\n\n  var _useState2 = useState(\"\"),\n      clientSearchTerm = _useState2[0],\n      setClientSearchTerm = _useState2[1];\n\n  var _useState3 = useState(true),\n      isLoading = _useState3[0],\n      setIsLoading = _useState3[1];\n\n  var _useState4 = useState(null),\n      loadError = _useState4[0],\n      setLoadError = _useState4[1];\n\n  var router = useRouter(); // Fetch clients when the component mounts\n\n  useEffect(function () {\n    var fetchClientData = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var clientsData;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return fetchClients();\n\n              case 3:\n                clientsData = _context.sent;\n                setClients(clientsData);\n                setLoadError(null);\n                _context.next = 12;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                console.error(\"Error fetching clients: \", _context.t0);\n                setLoadError(\"Failed to load clients. Please try again.\");\n\n              case 12:\n                _context.prev = 12;\n                setIsLoading(false);\n                return _context.finish(12);\n\n              case 15:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8, 12, 15]]);\n      }));\n\n      return function fetchClientData() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    fetchClientData();\n  }, []); // Handle search input changes\n\n  var handleSearchChange = function handleSearchChange(event) {\n    setClientSearchTerm(event.target.value);\n  }; // Handle client selection\n\n\n  var handleSelectClient = function handleSelectClient(clientId) {\n    console.log(\"Selected client ID:\", clientId); // Redirect to client-specific page\n\n    router.push(\"client/\".concat(clientId));\n  }; // Handle client info button click\n\n\n  var handleClientInfo = function handleClientInfo(clientId) {\n    router.push(\"client/\".concat(clientId, \"/addClient\"));\n  }; // Clear search input\n\n\n  var clearSelection = function clearSelection() {\n    setClientSearchTerm(\"\");\n  };\n\n  var addClient = function addClient() {\n    var randomNumber = Math.floor(10000 + Math.random() * 90000); // Navigate to the new route with the random number\n\n    router.push(\"client/AIS\".concat(randomNumber, \"/addClient\"));\n  };\n\n  var normalizedSearch = clientSearchTerm.trim().toLowerCase();\n  var filteredClients = (Array.isArray(clients) ? clients : []).filter(function (client) {\n    return ((client === null || client === void 0 ? void 0 : client.name) || \"\").toLowerCase().includes(normalizedSearch);\n  });\n  return __jsx(\"div\", {\n    className: styles.page\n  }, __jsx(\"div\", {\n    className: styles.shell\n  }, __jsx(\"header\", {\n    className: styles.header\n  }, __jsx(\"div\", {\n    className: styles.brand\n  }, __jsx(\"img\", {\n    src: \"/magmo-logo.png\",\n    alt: \"Magmo\",\n    className: styles.brandLogo\n  }), __jsx(\"div\", null, __jsx(\"div\", {\n    className: styles.brandName\n  }, \"Magmo\"), __jsx(\"div\", {\n    className: styles.brandSub\n  }, \"Client Search\"))), __jsx(\"div\", {\n    className: styles.headerActions\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.backButton,\n    onClick: function onClick() {\n      return router.push(\"../Warehousedb/WarehouseSelect\");\n    }\n  }, \"Back\"))), __jsx(\"section\", {\n    className: styles.card\n  }, __jsx(\"div\", {\n    className: styles.cardHeader\n  }, __jsx(\"div\", null, __jsx(\"div\", {\n    className: styles.cardTitle\n  }, \"Clients\"), __jsx(\"div\", {\n    className: styles.cardSubtitle\n  }, \"Search by name and manage client records.\")), __jsx(\"div\", {\n    className: styles.cardBadge\n  }, filteredClients.length, \" clients\")), __jsx(\"div\", {\n    className: styles.cardBody\n  }, loadError && __jsx(Alert, {\n    variant: \"danger\"\n  }, loadError), isLoading ? __jsx(\"div\", {\n    className: styles.loadingWrap\n  }, __jsx(Spinner, {\n    animation: \"border\",\n    role: \"status\"\n  }, __jsx(\"span\", {\n    className: \"sr-only\"\n  }, \"Loading...\"))) : __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: styles.searchRow\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    value: clientSearchTerm,\n    onChange: handleSearchChange,\n    className: styles.searchInput\n  }), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.clearButton,\n    onClick: clearSelection,\n    disabled: !clientSearchTerm\n  }, \"Clear\")), __jsx(\"div\", {\n    className: styles.actionRow\n  }, __jsx(Button, {\n    variant: \"primary\",\n    className: styles.primaryButton,\n    onClick: addClient\n  }, \"Add New Client\")), __jsx(\"div\", {\n    className: styles.tableWrap\n  }, __jsx(ClientTable, {\n    clients: filteredClients,\n    onSelectClient: handleSelectClient,\n    onInfoClick: handleClientInfo,\n    isClientSearch: true\n  })))))));\n};\n\nexport default ClientPage;","map":null,"metadata":{},"sourceType":"module"}