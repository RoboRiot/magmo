{"ast":null,"code":"import _extends from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/extends\";\nimport _toConsumableArray from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\NewSearch\\\\item\\\\[id]\\\\index.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState, useRef, useCallback, useMemo } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport { Form, Button, Card, Container, Row, Col, Modal, FormControl, Collapse, InputGroup, ButtonGroup } from \"react-bootstrap\";\nimport Link from \"next/link\";\nimport { useAuth } from \"../../../../context/AuthUserContext\";\nimport firebase from \"../../../../context/Firebase\";\nimport LoggedIn from \"../../../LoggedIn\";\nimport { useRouter } from \"next/router\";\nimport { fetchClients } from \"../../../../utils/fetchAssociations\";\nimport ClientTable from \"../../../../utils/ClientTable\";\nimport ClientInfoModal from \"../../ClientInfoModal\";\nimport ParentModal from \"../../AddItem/parentModal\";\nimport dynamic from \"next/dynamic\";\nimport InfoModal from \"../../InfoModal\";\nimport MachineSelectionModal from \"./MachineSelectionModal\";\nimport { addServiceItem } from \"../../../../utils/BluefolderService\";\nimport NewLocal from \"./NewLocal\";\nimport styles from \"../../AddItem/NewItem.module.css\"; //inflow API\n\nimport InflowAPI from \"../../../../utils/inflowAPI\";\nimport { buildLocalLocObject, formatLoc, updateMachineFields, buildNameTokens } from \"../../../../utils/itemFormShared\";\nimport MultiSelectDropdown from \"../../../../components/MultiSelectDropdown\";\nimport { fetchTrackerCatalog, buildAllOems, buildModelsForSelection, syncTrackerFromSelections, deleteTrackerOem, deleteTrackerModel } from \"../../../../utils/trackerCatalog\"; // Import for SSR\n\n// This will only load the component on the client-side.\nvar BarcodeScannerComponent = dynamic(_c = function _c() {\n  return import(\"react-qr-barcode-scanner\");\n}, {\n  ssr: false,\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak(\"react-qr-barcode-scanner\")];\n    },\n    modules: [\"NewSearch\\\\item\\\\[id]\\\\index.js -> \" + \"react-qr-barcode-scanner\"]\n  }\n}); // Simulates a network request delay.\n\n_c2 = BarcodeScannerComponent;\n\nfunction simulateNetworkRequest() {\n  return new Promise(function (resolve) {\n    return setTimeout(resolve, 2000);\n  });\n} // Custom LoadingButton component.\n\n\nfunction LoadingButton(_ref) {\n  _s();\n\n  var type = _ref.type,\n      name = _ref.name,\n      route = _ref.route;\n\n  var _useState = useState(false),\n      isLoading = _useState[0],\n      setLoading = _useState[1];\n\n  useEffect(function () {\n    if (isLoading) {\n      var cancelled = false;\n      simulateNetworkRequest().then(function () {\n        if (!cancelled) setLoading(false);\n      });\n      return function () {\n        cancelled = true;\n      };\n    }\n  }, [isLoading]);\n\n  var handleClick = function handleClick() {\n    return setLoading(true);\n  };\n\n  return __jsx(Link, {\n    href: \"/\".concat(route),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", {\n    className: \"btn btn-\".concat(type),\n    disabled: isLoading,\n    onClick: !isLoading ? handleClick : null,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 7\n    }\n  }, isLoading ? \"Loading…\" : name));\n}\n\n_s(LoadingButton, \"LHJkidtbt8bk0SOCXf2Y2viet6g=\");\n\n_c3 = LoadingButton;\n\nfunction isValidMachineValue(value) {\n  if (value == null) return false;\n\n  if (Array.isArray(value)) {\n    return value.some(function (v) {\n      var trimmed = String(v || \"\").trim();\n      return trimmed !== \"\" && trimmed.toLowerCase() !== \"n/a\";\n    });\n  }\n\n  if (typeof value !== \"string\") return Boolean(value);\n  var trimmed = value.trim();\n  return trimmed !== \"\" && trimmed.toLowerCase() !== \"n/a\";\n}\n\nfunction normalizeSelection(value) {\n  if (Array.isArray(value)) {\n    return value.map(function (v) {\n      return String(v).trim();\n    }).filter(function (v) {\n      return v && v.toLowerCase() !== \"n/a\";\n    });\n  }\n\n  if (value == null) return [];\n  var normalized = String(value).trim();\n  if (!normalized || normalized.toLowerCase() === \"n/a\") return [];\n  return [normalized];\n}\n\nfunction uniqueSelection(values) {\n  return Array.from(new Set(values || []));\n}\n\nfunction selectionToStoredValue(values) {\n  var cleaned = uniqueSelection(normalizeSelection(values));\n  if (cleaned.length === 0) return \"\";\n  if (cleaned.length === 1) return cleaned[0];\n  return cleaned;\n}\n\nfunction selectionToPrintValue(values) {\n  var cleaned = uniqueSelection(normalizeSelection(values));\n  if (cleaned.length === 0) return \"\";\n  if (cleaned.length === 1) return cleaned[0];\n  return \"Multi\";\n}\n\nfunction pickPreferredCase(current, incoming) {\n  if (!current) return incoming;\n  if (!incoming) return current;\n\n  var hasUpper = function hasUpper(value) {\n    return /[A-Z]/.test(String(value || \"\"));\n  };\n\n  var currentUpper = hasUpper(current);\n  var incomingUpper = hasUpper(incoming);\n  if (incomingUpper && !currentUpper) return incoming;\n  if (currentUpper && !incomingUpper) return current;\n  return current;\n}\n\nfunction buildCaseMap(values) {\n  var map = {};\n  (values || []).forEach(function (value) {\n    if (value == null) return;\n    var normalized = String(value).trim();\n    if (!normalized) return;\n    var key = normalized.toLowerCase();\n    map[key] = pickPreferredCase(map[key], normalized);\n  });\n  return map;\n}\n\nfunction DisplayItemInner(_ref2) {\n  _s2();\n\n  var _initialItem$price,\n      _initialItem$status,\n      _initialItem$length,\n      _initialItem$width,\n      _initialItem$height,\n      _initialItem$poNumber,\n      _initialItem$tracking,\n      _initialItem$visible,\n      _this = this,\n      _descriptions$selecte3,\n      _descriptions$selecte4,\n      _newLocalFrom$section,\n      _newLocalFrom$section2,\n      _newLocalCurrent$sect,\n      _newLocalCurrent$sect2;\n\n  var initialItem = _ref2.initialItem,\n      initialMachineData = _ref2.initialMachineData,\n      error = _ref2.error;\n  // Feature flag to show/hide the 3 Slack buttons\n  var SHOW_SLACK_BUTTONS = process.env.NEXT_PUBLIC_SHOW_SLACK_BUTTONS === \"true\";\n  var router = useRouter();\n\n  var _useAuth = useAuth(),\n      signOut = _useAuth.signOut; // const { id } = router.query;\n\n\n  var idFromRouter = router.query.id;\n  var initialId = (initialItem === null || initialItem === void 0 ? void 0 : initialItem.id) || idFromRouter; // Use a single local var everywhere in this component\n\n  var id = initialId;\n\n  var _useState2 = useState({\n    name: (initialItem === null || initialItem === void 0 ? void 0 : initialItem.name) || \"\",\n    pn: Array.isArray(initialItem === null || initialItem === void 0 ? void 0 : initialItem.pn) ? initialItem.pn : initialItem !== null && initialItem !== void 0 && initialItem.pn ? [initialItem.pn] : [],\n    sn: Array.isArray(initialItem === null || initialItem === void 0 ? void 0 : initialItem.sn) ? initialItem.sn : initialItem !== null && initialItem !== void 0 && initialItem.sn ? [initialItem.sn] : [],\n    // hydrate these from initialItem so SSR renders fully on deploy\n    price: (_initialItem$price = initialItem === null || initialItem === void 0 ? void 0 : initialItem.price) !== null && _initialItem$price !== void 0 ? _initialItem$price : \"\",\n    status: (_initialItem$status = initialItem === null || initialItem === void 0 ? void 0 : initialItem.status) !== null && _initialItem$status !== void 0 ? _initialItem$status : \"\",\n    length: (_initialItem$length = initialItem === null || initialItem === void 0 ? void 0 : initialItem.length) !== null && _initialItem$length !== void 0 ? _initialItem$length : \"\",\n    width: (_initialItem$width = initialItem === null || initialItem === void 0 ? void 0 : initialItem.width) !== null && _initialItem$width !== void 0 ? _initialItem$width : \"\",\n    height: (_initialItem$height = initialItem === null || initialItem === void 0 ? void 0 : initialItem.height) !== null && _initialItem$height !== void 0 ? _initialItem$height : \"\",\n    poNumber: (_initialItem$poNumber = initialItem === null || initialItem === void 0 ? void 0 : initialItem.poNumber) !== null && _initialItem$poNumber !== void 0 ? _initialItem$poNumber : \"\",\n    trackingNumber: (_initialItem$tracking = initialItem === null || initialItem === void 0 ? void 0 : initialItem.trackingNumber) !== null && _initialItem$tracking !== void 0 ? _initialItem$tracking : \"\",\n    localSN: (initialItem === null || initialItem === void 0 ? void 0 : initialItem.localSN) || \"\",\n    arrival_date: (initialItem === null || initialItem === void 0 ? void 0 : initialItem.arrival_date) || \"\",\n    visible: (_initialItem$visible = initialItem === null || initialItem === void 0 ? void 0 : initialItem.visible) !== null && _initialItem$visible !== void 0 ? _initialItem$visible : true\n  }),\n      items = _useState2[0],\n      setItems = _useState2[1];\n\n  var _useState3 = useState((initialItem === null || initialItem === void 0 ? void 0 : initialItem.name) || \"\"),\n      savedName = _useState3[0],\n      setSavedName = _useState3[1]; // ⬇️ put this INSIDE DisplayItem, after the related useState hooks\n\n\n  useEffect(function () {\n    if (!initialItem) return;\n    setDescriptions(initialItem.descriptions || []);\n    setWorkOrders(initialItem.workOrders || []);\n    setDOM(initialItem.DOM || \"\");\n    setItems(function (prev) {\n      var _ref3, _initialItem$status2, _ref4, _initialItem$price2, _ref5, _initialItem$length2, _ref6, _initialItem$width2, _ref7, _initialItem$height2, _ref8, _initialItem$poNumber2, _ref9, _initialItem$tracking2;\n\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        // only overwrite if SSR provided a value; otherwise keep what you have\n        status: (_ref3 = (_initialItem$status2 = initialItem.status) !== null && _initialItem$status2 !== void 0 ? _initialItem$status2 : prev.status) !== null && _ref3 !== void 0 ? _ref3 : \"\",\n        price: (_ref4 = (_initialItem$price2 = initialItem.price) !== null && _initialItem$price2 !== void 0 ? _initialItem$price2 : prev.price) !== null && _ref4 !== void 0 ? _ref4 : \"\",\n        length: (_ref5 = (_initialItem$length2 = initialItem.length) !== null && _initialItem$length2 !== void 0 ? _initialItem$length2 : prev.length) !== null && _ref5 !== void 0 ? _ref5 : \"\",\n        width: (_ref6 = (_initialItem$width2 = initialItem.width) !== null && _initialItem$width2 !== void 0 ? _initialItem$width2 : prev.width) !== null && _ref6 !== void 0 ? _ref6 : \"\",\n        height: (_ref7 = (_initialItem$height2 = initialItem.height) !== null && _initialItem$height2 !== void 0 ? _initialItem$height2 : prev.height) !== null && _ref7 !== void 0 ? _ref7 : \"\",\n        poNumber: (_ref8 = (_initialItem$poNumber2 = initialItem.poNumber) !== null && _initialItem$poNumber2 !== void 0 ? _initialItem$poNumber2 : prev.poNumber) !== null && _ref8 !== void 0 ? _ref8 : \"\",\n        trackingNumber: (_ref9 = (_initialItem$tracking2 = initialItem.trackingNumber) !== null && _initialItem$tracking2 !== void 0 ? _initialItem$tracking2 : prev.trackingNumber) !== null && _ref9 !== void 0 ? _ref9 : \"\"\n      });\n    });\n\n    if (initialItem.name) {\n      setSavedName(initialItem.name);\n    }\n  }, [initialItem]);\n\n  var _useState4 = useState({\n    region: \"\",\n    section: {\n      letter: \"\",\n      number: \"\"\n    },\n    bin: \"\",\n    pallet: \"\"\n  }),\n      newLocalFrom = _useState4[0],\n      setNewLocalFrom = _useState4[1];\n\n  var _useState5 = useState({\n    region: \"\",\n    section: {\n      letter: \"\",\n      number: \"\"\n    },\n    bin: \"\",\n    pallet: \"\"\n  }),\n      newLocalCurrent = _useState5[0],\n      setNewLocalCurrent = _useState5[1]; // New states for separate client selections:\n\n\n  var _useState6 = useState(null),\n      selectedClientFrom = _useState6[0],\n      setSelectedClientFrom = _useState6[1];\n\n  var _useState7 = useState(null),\n      selectedClientCurrent = _useState7[0],\n      setSelectedClientCurrent = _useState7[1];\n\n  var _useState8 = useState(null),\n      selectedMachine = _useState8[0],\n      setSelectedMachine = _useState8[1];\n\n  var _useState9 = useState(null),\n      selectedCurrentMachine = _useState9[0],\n      setSelectedCurrentMachine = _useState9[1]; // whenever you pick a new “From” client or machine, clear the old From-loc:\n  // useEffect(() => {\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientFrom, selectedMachine]);\n  // const didMountFrom = useRef(false);\n  // useEffect(() => {\n  //   if (!didMountFrom.current) {\n  //     // first time through (the data-load phase), don’t clear\n  //     didMountFrom.current = true;\n  //     return;\n  //   }\n  //   // thereafter, when the user picks a new client or machine, clear:\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  //   setLocalLocFrom(\"\");\n  // }, [selectedClientFrom, selectedMachine]);\n  // whenever you pick a new “Current” client or machine, clear the old Current-loc:\n  // useEffect(() => {\n  //   setNewLocalCurrent({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\n  // const [didFetch, setDidFetch] = useState(false);\n  // useEffect(() => {\n  //   if (!didFetch) {\n  //     // we’re in the data-load phase, skip clearing\n  //     setDidFetch(true);\n  //     return;\n  //   }\n  //   // only clear on subsequent user changes:\n  //   setNewLocalCurrent({ region: \"\", section: {}, bin: \"\", pallet: \"\" });\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\n  // These arrays will be populated from Firebase.\n\n\n  var _useState10 = useState([]),\n      pnOptions = _useState10[0],\n      setPnOptions = _useState10[1];\n\n  var _useState11 = useState([]),\n      snOptions = _useState11[0],\n      setSnOptions = _useState11[1];\n\n  var _useState12 = useState(false),\n      pnSnLoaded = _useState12[0],\n      setPnSnLoaded = _useState12[1];\n\n  var _useState13 = useState(false),\n      pnSnLoading = _useState13[0],\n      setPnSnLoading = _useState13[1];\n\n  var _useState14 = useState([{\n    description: \"\",\n    date: \"\"\n  }]),\n      descriptions = _useState14[0],\n      setDescriptions = _useState14[1];\n\n  var _useState15 = useState([{\n    workOrder: \"\",\n    date: \"\"\n  }]),\n      workOrders = _useState15[0],\n      setWorkOrders = _useState15[1];\n\n  var _useState16 = useState([]),\n      clients = _useState16[0],\n      setClients = _useState16[1];\n\n  var _useState17 = useState(false),\n      clientsLoaded = _useState17[0],\n      setClientsLoaded = _useState17[1];\n\n  var _useState18 = useState(false),\n      clientsLoading = _useState18[0],\n      setClientsLoading = _useState18[1];\n\n  var _useState19 = useState([]),\n      photos = _useState19[0],\n      setPhotos = _useState19[1];\n\n  var _useState20 = useState(false),\n      show = _useState20[0],\n      setShow = _useState20[1];\n\n  var _useState21 = useState(false),\n      showErr = _useState21[0],\n      setShowErr = _useState21[1];\n\n  var _useState22 = useState(\"N/A\"),\n      Err = _useState22[0],\n      setErr = _useState22[1];\n\n  var _useState23 = useState(false),\n      showDescModal = _useState23[0],\n      setShowDescModal = _useState23[1];\n\n  var _useState24 = useState(false),\n      showWoModal = _useState24[0],\n      setShowWoModal = _useState24[1];\n\n  var _useState25 = useState(false),\n      showClientModal = _useState25[0],\n      setShowClientModal = _useState25[1];\n\n  var _useState26 = useState(false),\n      showMachineModal = _useState26[0],\n      setShowMachineModal = _useState26[1];\n\n  var _useState27 = useState(false),\n      showParentModal = _useState27[0],\n      setShowParentModal = _useState27[1];\n\n  var _useState28 = useState(false),\n      showCameraModal = _useState28[0],\n      setShowCameraModal = _useState28[1];\n\n  var _useState29 = useState(false),\n      showSaveModal = _useState29[0],\n      setShowSaveModal = _useState29[1];\n\n  var _useState30 = useState(false),\n      showPrintModal = _useState30[0],\n      setShowPrintModal = _useState30[1];\n\n  var _useState31 = useState(false),\n      machineSelectionModal = _useState31[0],\n      setMachineSelectionModal = _useState31[1];\n\n  var _useState32 = useState(0),\n      selectedDesc = _useState32[0],\n      setSelectedDesc = _useState32[1];\n\n  var _useState33 = useState(null),\n      selectedClient = _useState33[0],\n      setSelectedClient = _useState33[1];\n\n  var _useState34 = useState(null),\n      selectedParent = _useState34[0],\n      setSelectedParent = _useState34[1];\n\n  var _useState35 = useState(null),\n      TheMachine = _useState35[0],\n      setTheMachine = _useState35[1];\n\n  var _useState36 = useState([]),\n      machineOptions = _useState36[0],\n      setMachineOptions = _useState36[1];\n\n  var _useState37 = useState(\"\"),\n      search = _useState37[0],\n      setSearch = _useState37[1];\n\n  var _useState38 = useState(null),\n      capturedPhoto = _useState38[0],\n      setCapturedPhoto = _useState38[1];\n\n  var _useState39 = useState(\"environment\"),\n      cameraFacing = _useState39[0],\n      setCameraFacing = _useState39[1];\n\n  var _useState40 = useState(false),\n      addToWebsite = _useState40[0],\n      setAddToWebsite = _useState40[1];\n\n  var _useState41 = useState(false),\n      machinePick = _useState41[0],\n      setMachinePick = _useState41[1];\n\n  var _useState42 = useState(0),\n      freqItem = _useState42[0],\n      setFreqItem = _useState42[1];\n\n  var _useState43 = useState(0),\n      usagePastYear = _useState43[0],\n      setUsagePastYear = _useState43[1];\n\n  var _useState44 = useState(0),\n      machineFrequency = _useState44[0],\n      setMachineFrequency = _useState44[1]; // State for the extra (dimensions/price/DOM/PO Number) section.\n\n\n  var _useState45 = useState(false),\n      showExtra = _useState45[0],\n      setShowExtra = _useState45[1];\n\n  var _useState46 = useState({\n    modalities: [],\n    oemsByModality: {},\n    modelsByModalityOem: {},\n    meta: {}\n  }),\n      trackerCatalog = _useState46[0],\n      setTrackerCatalog = _useState46[1];\n\n  var _useState47 = useState(false),\n      trackerLoading = _useState47[0],\n      setTrackerLoading = _useState47[1]; // State for the local warehouse location inputs.\n\n\n  var _useState48 = useState(\"\"),\n      localLocFrom = _useState48[0],\n      setLocalLocFrom = _useState48[1];\n\n  var _useState49 = useState(\"\"),\n      localLocCurrent = _useState49[0],\n      setLocalLocCurrent = _useState49[1]; // New state for DOM (Date of Manufacture)\n\n\n  var _useState50 = useState(\"\"),\n      DOM = _useState50[0],\n      setDOM = _useState50[1]; // New state for OEM, Modality, and Model (multi-select).\n\n\n  var _useState51 = useState([]),\n      selectedModalities = _useState51[0],\n      setSelectedModalities = _useState51[1];\n\n  var _useState52 = useState([]),\n      selectedOems = _useState52[0],\n      setSelectedOems = _useState52[1];\n\n  var _useState53 = useState([]),\n      selectedModels = _useState53[0],\n      setSelectedModels = _useState53[1];\n\n  var applyMergedMachineFields = function applyMergedMachineFields(merged) {\n    if (!merged) return;\n    setSelectedOems(function (prev) {\n      if (prev.length) return prev;\n      return uniqueSelection(normalizeSelection(merged.oem));\n    });\n    setSelectedModalities(function (prev) {\n      if (prev.length) return prev;\n      return uniqueSelection(normalizeSelection(merged.modality));\n    });\n    setSelectedModels(function (prev) {\n      if (prev.length) return prev;\n      return uniqueSelection(normalizeSelection(merged.model));\n    });\n  }; // More info modal state.\n\n\n  var _useState54 = useState(false),\n      showInfoModal = _useState54[0],\n      setShowInfoModal = _useState54[1];\n\n  var _useState55 = useState(\"\"),\n      itemName = _useState55[0],\n      setItemName = _useState55[1];\n\n  var _useState56 = useState(false),\n      machineFieldsInitialized = _useState56[0],\n      setMachineFieldsInitialized = _useState56[1];\n\n  var _useState57 = useState(true),\n      isLoading = _useState57[0],\n      setIsLoading = _useState57[1]; // near the top of DisplayItem()\n\n\n  var _useState58 = useState(false),\n      showLocalModalFrom = _useState58[0],\n      setShowLocalModalFrom = _useState58[1];\n\n  var _useState59 = useState(false),\n      showLocalModalCurrent = _useState59[0],\n      setShowLocalModalCurrent = _useState59[1];\n\n  var openLocalModalFrom = function openLocalModalFrom() {\n    return setShowLocalModalFrom(true);\n  };\n\n  var closeLocalModalFrom = function closeLocalModalFrom() {\n    return setShowLocalModalFrom(false);\n  };\n\n  var openLocalModalCurrent = function openLocalModalCurrent() {\n    return setShowLocalModalCurrent(true);\n  };\n\n  var closeLocalModalCurrent = function closeLocalModalCurrent() {\n    return setShowLocalModalCurrent(false);\n  }; // at the top of DisplayItem()\n\n\n  var _useState60 = useState(false),\n      showNewLocalModalFrom = _useState60[0],\n      setShowNewLocalModalFrom = _useState60[1];\n\n  var _useState61 = useState(false),\n      showNewLocalModalCurrent = _useState61[0],\n      setShowNewLocalModalCurrent = _useState61[1]; // when the From-client changes, clear any old local-loc\n  // useEffect(() => {\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientFrom]);\n  // // when the From-machine changes, clear any old local-loc\n  // useEffect(() => {\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedMachine]);\n  // same for Current:\n  // useEffect(() => {\n  //   setNewLocalCurrent({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\n  // const handleSendToInflow = async () => {\n  //   try {\n  //     const name = items.name;\n  //     const description = descriptions[selectedDesc]?.description || \"\";\n  //     // gather every photo URL from Firebase Storage\n  //     const imageUrls = photos.map((p) => p.url);\n  //     await InflowAPI.upsertProduct({ name, description, imageUrls });\n  //     alert(\"Sent to inFlow successfully!\");\n  //   } catch (err) {\n  //     console.error(err);\n  //     alert(\"Error sending to inFlow: \" + err.message);\n  //   }\n  // };\n\n\n  var handleSendToInflow = /*#__PURE__*/function () {\n    var _ref10 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _descriptions$selecte, name, description, imageUrls, sku, toCSV, arrivalISO, pnStr, snStr, mostRecentWO, customFields, created;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              name = (items.name || '').trim();\n\n              if (name) {\n                _context.next = 5;\n                break;\n              }\n\n              alert('Item needs a name before sending to inFlow.');\n              return _context.abrupt(\"return\");\n\n            case 5:\n              // Regular description (don’t also send a custom “Description” unless you truly have one)\n              description = (((_descriptions$selecte = descriptions[selectedDesc]) === null || _descriptions$selecte === void 0 ? void 0 : _descriptions$selecte.description) || '').trim(); // Photos already fetched from storage\n\n              imageUrls = photos.map(function (p) {\n                return p.url;\n              }).filter(Boolean); // SKU = your item id\n\n              sku = (id !== null && id !== void 0 ? id : '').toString(); // Basic normalizers\n\n              toCSV = function toCSV(arr) {\n                return Array.isArray(arr) ? arr.filter(Boolean).join(', ') : arr || '';\n              }; // YYYY-MM-DD for the date field in inFlow\n\n\n              arrivalISO = items.arrival_date ? new Date(items.arrival_date).toISOString().slice(0, 10) : '';\n              pnStr = Array.isArray(items.pn) ? items.pn.filter(Boolean).join(', ') : items.pn || '';\n              snStr = Array.isArray(items.sn) ? items.sn.filter(Boolean).join(', ') : items.sn || ''; // Most recent WO (you already have this)\n\n              mostRecentWO = workOrders !== null && workOrders !== void 0 && workOrders.length ? workOrders.reduce(function (latest, cur) {\n                return new Date(cur.date) > new Date(latest.date) ? cur : latest;\n              }, workOrders[0]) : {\n                workOrder: '',\n                date: ''\n              }; // Build the numbered fields (match your inFlow “Field 1..10”)\n\n              customFields = {\n                custom1: selectionToPrintValue(selectedOems),\n                // OEM   (dropdown)\n                custom2: selectionToPrintValue(selectedModalities),\n                // Modality (dropdown)\n                custom3: selectionToPrintValue(selectedModels),\n                // Model (dropdown)\n                custom4: (description || '').trim(),\n                // Description (text) - optional duplicate\n                custom5: (mostRecentWO.workOrder || '').trim(),\n                // Work Order (text)\n                custom6: ((selectedClientFrom === null || selectedClientFrom === void 0 ? void 0 : selectedClientFrom.name) || '').trim(),\n                // From (text)\n                custom7: pnStr,\n                // Product Number (text)\n                custom8: snStr,\n                // Serial Number (text)\n                custom9: arrivalISO,\n                // Arrival Date (date)\n                custom10: ((selectedClientCurrent === null || selectedClientCurrent === void 0 ? void 0 : selectedClientCurrent.name) || '').trim() // Current (text)\n\n              };\n              console.log('[inFlow] customFields to send (numbered):', customFields);\n              _context.next = 17;\n              return InflowAPI.upsertProduct({\n                name: name,\n                description: description,\n                sku: sku,\n                imageUrls: imageUrls,\n                customFields: customFields\n              });\n\n            case 17:\n              created = _context.sent;\n              alert(\"Sent to inFlow successfully. ID: \".concat((created === null || created === void 0 ? void 0 : created.productId) || (created === null || created === void 0 ? void 0 : created.id) || '(unknown)'));\n              _context.next = 25;\n              break;\n\n            case 21:\n              _context.prev = 21;\n              _context.t0 = _context[\"catch\"](0);\n              console.error(_context.t0);\n              alert('Error sending to inFlow: ' + _context.t0.message);\n\n            case 25:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 21]]);\n    }));\n\n    return function handleSendToInflow() {\n      return _ref10.apply(this, arguments);\n    };\n  }(); // const [storedMachine, setStoredMachine] = useState(null);\n  // useEffect(() => {\n  //   // once any of these three change, re-merge:\n  //   if (TheMachine || selectedCurrentMachine || selectedMachine) {\n  //     const merged = updateMachineFields(\n  //       TheMachine,\n  //       selectedCurrentMachine,\n  //       selectedMachine\n  //     );\n  //     setOem(merged.oem);\n  //     setModality(merged.modality);\n  //     setModel(merged.model);\n  //   }\n  // }, [TheMachine, selectedCurrentMachine, selectedMachine]);\n  // whenever the “From” client changes:\n\n\n  useEffect(function () {\n    var _selectedClientFrom$n;\n\n    setShowLocalLocFrom((selectedClientFrom === null || selectedClientFrom === void 0 ? void 0 : (_selectedClientFrom$n = selectedClientFrom.name) === null || _selectedClientFrom$n === void 0 ? void 0 : _selectedClientFrom$n.toLowerCase()) === \"socalwarehouse\");\n  }, [selectedClientFrom]); // whenever the “Current” client changes:\n\n  useEffect(function () {\n    var _selectedClientCurren;\n\n    setShowLocalLocCurrent((selectedClientCurrent === null || selectedClientCurrent === void 0 ? void 0 : (_selectedClientCurren = selectedClientCurrent.name) === null || _selectedClientCurren === void 0 ? void 0 : _selectedClientCurren.toLowerCase()) === \"socalwarehouse\");\n  }, [selectedClientCurrent]);\n\n  var loadClients = /*#__PURE__*/function () {\n    var _ref11 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var clientsData;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              if (!(clientsLoaded || clientsLoading)) {\n                _context2.next = 2;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 2:\n              setClientsLoading(true);\n              _context2.prev = 3;\n              _context2.next = 6;\n              return fetchClients();\n\n            case 6:\n              clientsData = _context2.sent;\n              setClients(clientsData);\n              setClientsLoaded(true);\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](3);\n              console.error(\"Error fetching clients: \", _context2.t0);\n\n            case 14:\n              _context2.prev = 14;\n              setClientsLoading(false);\n              return _context2.finish(14);\n\n            case 17:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[3, 11, 14, 17]]);\n    }));\n\n    return function loadClients() {\n      return _ref11.apply(this, arguments);\n    };\n  }();\n\n  var loadTracker = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n    var force,\n        catalog,\n        _args3 = arguments;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            force = _args3.length > 0 && _args3[0] !== undefined ? _args3[0] : false;\n\n            if (!trackerLoading) {\n              _context3.next = 3;\n              break;\n            }\n\n            return _context3.abrupt(\"return\");\n\n          case 3:\n            if (!(!force && trackerCatalog.modalities.length)) {\n              _context3.next = 5;\n              break;\n            }\n\n            return _context3.abrupt(\"return\");\n\n          case 5:\n            setTrackerLoading(true);\n            _context3.prev = 6;\n            _context3.next = 9;\n            return fetchTrackerCatalog();\n\n          case 9:\n            catalog = _context3.sent;\n            setTrackerCatalog(catalog);\n            _context3.next = 16;\n            break;\n\n          case 13:\n            _context3.prev = 13;\n            _context3.t0 = _context3[\"catch\"](6);\n            console.error(\"Failed to load tracker catalog:\", _context3.t0);\n\n          case 16:\n            _context3.prev = 16;\n            setTrackerLoading(false);\n            return _context3.finish(16);\n\n          case 19:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3, null, [[6, 13, 16, 19]]);\n  })), [trackerLoading, trackerCatalog.modalities.length]);\n  useEffect(function () {\n    loadTracker();\n  }, [loadTracker]);\n  var allOemOptions = useMemo(function () {\n    return buildAllOems(trackerCatalog);\n  }, [trackerCatalog]);\n  var modelOptions = useMemo(function () {\n    return buildModelsForSelection(trackerCatalog, selectedModalities, selectedOems);\n  }, [trackerCatalog, selectedModalities, selectedOems]); // Keep selected models even if they are not in the catalog yet.\n  // The tracker sync will add any missing models automatically.\n\n  useEffect(function () {\n    if (!trackerCatalog.modalities.length) return;\n    var selections = {\n      modalities: selectedModalities,\n      oems: selectedOems,\n      models: selectedModels\n    };\n    syncTrackerFromSelections({\n      selections: selections,\n      catalog: trackerCatalog\n    }).then(function (updated) {\n      if (updated) loadTracker(true);\n    })[\"catch\"](function (error) {\n      console.error(\"Failed to sync tracker selections:\", error);\n    });\n  }, [selectedModalities, selectedOems, selectedModels, trackerCatalog, loadTracker]);\n  var handleDeleteOemOption = useCallback( /*#__PURE__*/function () {\n    var _ref13 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4(oem) {\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              if (oem) {\n                _context4.next = 2;\n                break;\n              }\n\n              return _context4.abrupt(\"return\");\n\n            case 2:\n              _context4.prev = 2;\n              _context4.next = 5;\n              return deleteTrackerOem({\n                oem: oem,\n                catalog: trackerCatalog\n              });\n\n            case 5:\n              setSelectedOems(function (prev) {\n                return prev.filter(function (value) {\n                  return value !== oem;\n                });\n              });\n              loadTracker(true);\n              _context4.next = 12;\n              break;\n\n            case 9:\n              _context4.prev = 9;\n              _context4.t0 = _context4[\"catch\"](2);\n              console.error(\"Failed to delete OEM:\", _context4.t0);\n\n            case 12:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[2, 9]]);\n    }));\n\n    return function (_x) {\n      return _ref13.apply(this, arguments);\n    };\n  }(), [trackerCatalog, loadTracker]);\n  var handleDeleteModelOption = useCallback( /*#__PURE__*/function () {\n    var _ref14 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(model) {\n      var ops;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              if (!(!model || !selectedModalities.length || !selectedOems.length)) {\n                _context5.next = 2;\n                break;\n              }\n\n              return _context5.abrupt(\"return\");\n\n            case 2:\n              _context5.prev = 2;\n              ops = [];\n              selectedModalities.forEach(function (modalityValue) {\n                selectedOems.forEach(function (oemValue) {\n                  ops.push(deleteTrackerModel({\n                    modality: modalityValue,\n                    oem: oemValue,\n                    model: model,\n                    catalog: trackerCatalog\n                  }));\n                });\n              });\n              _context5.next = 7;\n              return Promise.allSettled(ops);\n\n            case 7:\n              setSelectedModels(function (prev) {\n                return prev.filter(function (value) {\n                  return value !== model;\n                });\n              });\n              loadTracker(true);\n              _context5.next = 14;\n              break;\n\n            case 11:\n              _context5.prev = 11;\n              _context5.t0 = _context5[\"catch\"](2);\n              console.error(\"Failed to delete model:\", _context5.t0);\n\n            case 14:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[2, 11]]);\n    }));\n\n    return function (_x2) {\n      return _ref14.apply(this, arguments);\n    };\n  }(), [selectedModalities, selectedOems, trackerCatalog, loadTracker]);\n\n  var loadPnSnOptions = /*#__PURE__*/function () {\n    var _ref15 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n      var db, snapshot, pnSet, snSet;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              if (!(pnSnLoaded || pnSnLoading)) {\n                _context6.next = 2;\n                break;\n              }\n\n              return _context6.abrupt(\"return\");\n\n            case 2:\n              setPnSnLoading(true);\n              _context6.prev = 3;\n              db = firebase.firestore();\n              _context6.next = 7;\n              return db.collection(\"Test\").orderBy(firebase.firestore.FieldPath.documentId()).limit(500).get();\n\n            case 7:\n              snapshot = _context6.sent;\n              pnSet = new Set();\n              snSet = new Set();\n              snapshot.forEach(function (doc) {\n                var data = doc.data();\n\n                if (Array.isArray(data.pn)) {\n                  data.pn.forEach(function (pn) {\n                    return pn && pnSet.add(pn);\n                  });\n                } else if (data.pn) {\n                  pnSet.add(data.pn);\n                }\n\n                if (Array.isArray(data.sn)) {\n                  data.sn.forEach(function (sn) {\n                    return sn && snSet.add(sn);\n                  });\n                } else if (data.sn) {\n                  snSet.add(data.sn);\n                }\n              });\n              setPnOptions(_toConsumableArray(pnSet));\n              setSnOptions(_toConsumableArray(snSet));\n              setPnSnLoaded(true);\n              _context6.next = 19;\n              break;\n\n            case 16:\n              _context6.prev = 16;\n              _context6.t0 = _context6[\"catch\"](3);\n              console.error(\"Error fetching PN/SN options:\", _context6.t0);\n\n            case 19:\n              _context6.prev = 19;\n              setPnSnLoading(false);\n              return _context6.finish(19);\n\n            case 22:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6, null, [[3, 16, 19, 22]]);\n    }));\n\n    return function loadPnSnOptions() {\n      return _ref15.apply(this, arguments);\n    };\n  }();\n\n  useEffect(function () {\n    if (id) fetchData(); // always hydrate on the client\n  }, [id]);\n\n  function resolveClientFromMachine(_x3, _x4, _x5) {\n    return _resolveClientFromMachine.apply(this, arguments);\n  }\n\n  function _resolveClientFromMachine() {\n    _resolveClientFromMachine = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee19(machineRef, setClient, setMachine) {\n      var isFrom,\n          machineDoc,\n          _machineData$name,\n          machineData,\n          clientDoc,\n          clientName,\n          isSocalInterior,\n          shouldShow,\n          _clientDoc2,\n          _args19 = arguments;\n\n      return _regeneratorRuntime.wrap(function _callee19$(_context19) {\n        while (1) {\n          switch (_context19.prev = _context19.next) {\n            case 0:\n              isFrom = _args19.length > 3 && _args19[3] !== undefined ? _args19[3] : true;\n              _context19.next = 3;\n              return machineRef.get();\n\n            case 3:\n              machineDoc = _context19.sent;\n\n              if (!machineDoc.exists) {\n                _context19.next = 24;\n                break;\n              }\n\n              machineData = machineDoc.data();\n              setMachine(_objectSpread({\n                id: machineDoc.id\n              }, machineData)); // Determine if the machine is \"interior socal\"\n              // const isSocalInterior = machineData.name && machineData.name.toLowerCase() === \"interior socal\";\n              // if (isSocalInterior) {\n              //   if (isFrom) {\n              //     setShowLocalLocFrom(true);\n              //   } else {\n              //     setShowLocalLocCurrent(true);\n              //   }\n              // } else {\n              // Optionally clear the flag if it is not \"interior socal\"\n              // if (isFrom) {\n              //   setShowLocalLocFrom(false);\n              // } else {\n              //   setShowLocalLocCurrent(false);\n              // }\n              // }\n              // new: fetch client name and combine both checks\n\n              if (!(machineData.client && typeof machineData.client.get === \"function\")) {\n                _context19.next = 13;\n                break;\n              }\n\n              _context19.next = 10;\n              return machineData.client.get();\n\n            case 10:\n              _context19.t0 = _context19.sent;\n              _context19.next = 14;\n              break;\n\n            case 13:\n              _context19.t0 = null;\n\n            case 14:\n              clientDoc = _context19.t0;\n              clientName = clientDoc && clientDoc.exists ? clientDoc.data().name : null;\n              isSocalInterior = ((_machineData$name = machineData.name) === null || _machineData$name === void 0 ? void 0 : _machineData$name.toLowerCase()) === \"interior socal\";\n              shouldShow = isSocalInterior || clientName === \"SoCalWarehouse\";\n\n              if (isFrom) {\n                setShowLocalLocFrom(shouldShow);\n              } else {\n                setShowLocalLocCurrent(shouldShow);\n              }\n\n              if (!(machineData.client && typeof machineData.client.get === \"function\")) {\n                _context19.next = 24;\n                break;\n              }\n\n              _context19.next = 22;\n              return machineData.client.get();\n\n            case 22:\n              _clientDoc2 = _context19.sent;\n\n              if (_clientDoc2.exists) {\n                setClient(_objectSpread({\n                  id: _clientDoc2.id\n                }, _clientDoc2.data()));\n              }\n\n            case 24:\n            case \"end\":\n              return _context19.stop();\n          }\n        }\n      }, _callee19);\n    }));\n    return _resolveClientFromMachine.apply(this, arguments);\n  }\n\n  var fetchData = /*#__PURE__*/function () {\n    var _ref16 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n      var id, db, doc, _machineFromData, _machineFromData$name, _machineCurrentData, _machineCurrentData$n, _selectedClientFrom$n2, _selectedClientCurren2, data, normalizedPN, normalizedSN, clientFromDoc, clientCurrentDoc, machineFromData, machineCurrentData, _doc, _doc2, nameFrom, nameCurrent, theMachineData, _theMachineData$oem, _theMachineData$modal, _theMachineData$model, OEM, Modality, Model, merged, parentDoc;\n\n      return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n        while (1) {\n          switch (_context7.prev = _context7.next) {\n            case 0:\n              id = (initialItem === null || initialItem === void 0 ? void 0 : initialItem.id) || idFromRouter; // <- make sure id exists here\n\n              if (id) {\n                _context7.next = 3;\n                break;\n              }\n\n              return _context7.abrupt(\"return\");\n\n            case 3:\n              setIsLoading(true);\n              db = firebase.firestore();\n              _context7.prev = 5;\n              _context7.next = 8;\n              return db.collection(\"Test\").doc(id).get();\n\n            case 8:\n              doc = _context7.sent;\n\n              if (!doc.exists) {\n                _context7.next = 75;\n                break;\n              }\n\n              console.log(\"test\");\n              data = doc.data();\n              normalizedPN = Array.isArray(data.pn) ? data.pn : [data.pn];\n              normalizedSN = Array.isArray(data.sn) ? data.sn : [data.sn];\n              setItems(_objectSpread(_objectSpread({}, data), {}, {\n                pn: normalizedPN,\n                sn: normalizedSN\n              }));\n              setSavedName(data.name || \"\");\n              setDescriptions(data.descriptions || []);\n              setWorkOrders(data.workOrders || []);\n              if (data.localLocFrom) setLocalLocFrom(data.localLocFrom);\n              if (data.localLocCurrent) setLocalLocCurrent(data.localLocCurrent);\n\n              if (data.DOM) {\n                setDOM(data.DOM);\n              } // …after you do setItems, setDescriptions, etc.\n              // load the “newLocal” maps\n\n\n              if (data.newLocalFrom) setNewLocalFrom(data.newLocalFrom);\n              if (data.newLocalCurrent) setNewLocalCurrent(data.newLocalCurrent); // Load PO Number if it exists.\n\n              if (data.poNumber) {\n                setItems(function (prev) {\n                  return _objectSpread(_objectSpread({}, prev), {}, {\n                    poNumber: data.poNumber\n                  });\n                });\n              }\n\n              if (!data.ClientFrom) {\n                _context7.next = 29;\n                break;\n              }\n\n              _context7.next = 27;\n              return data.ClientFrom.get();\n\n            case 27:\n              clientFromDoc = _context7.sent;\n\n              if (clientFromDoc.exists) {\n                setSelectedClientFrom(_objectSpread({\n                  id: clientFromDoc.id\n                }, clientFromDoc.data()));\n              }\n\n            case 29:\n              if (!data.ClientCurrent) {\n                _context7.next = 34;\n                break;\n              }\n\n              _context7.next = 32;\n              return data.ClientCurrent.get();\n\n            case 32:\n              clientCurrentDoc = _context7.sent;\n\n              if (clientCurrentDoc.exists) {\n                setSelectedClientCurrent(_objectSpread({\n                  id: clientCurrentDoc.id\n                }, clientCurrentDoc.data()));\n              }\n\n            case 34:\n              if (!(!data.ClientFrom && data.Machine && typeof data.Machine.get === \"function\")) {\n                _context7.next = 38;\n                break;\n              }\n\n              console.log(\"Entered resolveClientFromMachine for Machine (old style for From)\");\n              _context7.next = 38;\n              return resolveClientFromMachine(data.Machine, setSelectedClientFrom, setSelectedMachine, true);\n\n            case 38:\n              if (!(!data.ClientCurrent && data.CurrentMachine && typeof data.CurrentMachine.get === \"function\")) {\n                _context7.next = 42;\n                break;\n              }\n\n              console.log(\"Entered resolveClientFromMachine for CurrentMachine (old style for Current)\");\n              _context7.next = 42;\n              return resolveClientFromMachine(data.CurrentMachine, setSelectedClientCurrent, setSelectedCurrentMachine, false);\n\n            case 42:\n              machineFromData = null;\n              machineCurrentData = null;\n\n              if (!data.MachineFrom) {\n                _context7.next = 50;\n                break;\n              }\n\n              _context7.next = 47;\n              return data.MachineFrom.get();\n\n            case 47:\n              _doc = _context7.sent;\n              machineFromData = _doc.exists ? _doc.data() : null;\n              setSelectedMachine(_objectSpread({\n                id: _doc.id\n              }, _doc.data()));\n\n            case 50:\n              if (!data.MachineCurrent) {\n                _context7.next = 56;\n                break;\n              }\n\n              _context7.next = 53;\n              return data.MachineCurrent.get();\n\n            case 53:\n              _doc2 = _context7.sent;\n              machineCurrentData = _doc2.exists ? _doc2.data() : null;\n              setSelectedCurrentMachine(_objectSpread({\n                id: _doc2.id\n              }, _doc2.data()));\n\n            case 56:\n              nameFrom = (_machineFromData = machineFromData) === null || _machineFromData === void 0 ? void 0 : (_machineFromData$name = _machineFromData.name) === null || _machineFromData$name === void 0 ? void 0 : _machineFromData$name.toLowerCase();\n              nameCurrent = (_machineCurrentData = machineCurrentData) === null || _machineCurrentData === void 0 ? void 0 : (_machineCurrentData$n = _machineCurrentData.name) === null || _machineCurrentData$n === void 0 ? void 0 : _machineCurrentData$n.toLowerCase(); // If the machine’s name is “interior socal”, show that branch:\n              // setShowLocalLocFrom(nameFrom === \"interior socal\");\n              // // Or if your Firestore already has a value for localLocFrom, show it anyway:\n              // if (data.localLocFrom) setShowLocalLocFrom(true);\n              // setShowLocalLocCurrent(nameCurrent === \"interior socal\");\n              // if (data.localLocCurrent) setShowLocalLocCurrent(true);\n              // new: combine machine-name OR client-name check, keep existing-data\n\n              setShowLocalLocFrom(nameFrom === \"interior socal\" || (selectedClientFrom === null || selectedClientFrom === void 0 ? void 0 : (_selectedClientFrom$n2 = selectedClientFrom.name) === null || _selectedClientFrom$n2 === void 0 ? void 0 : _selectedClientFrom$n2.toLowerCase()) === \"socalwarehouse\" || Boolean(data.localLocFrom));\n              setShowLocalLocCurrent(nameCurrent === \"interior socal\" || (selectedClientCurrent === null || selectedClientCurrent === void 0 ? void 0 : (_selectedClientCurren2 = selectedClientCurrent.name) === null || _selectedClientCurren2 === void 0 ? void 0 : _selectedClientCurren2.toLowerCase()) === \"socalwarehouse\" || Boolean(data.localLocCurrent));\n              theMachineData = data.TheMachine || null;\n              setTheMachine(theMachineData);\n\n              if (theMachineData) {\n                // pull both variants, prefer lowercase if it exists\n                OEM = (_theMachineData$oem = theMachineData.oem) !== null && _theMachineData$oem !== void 0 ? _theMachineData$oem : theMachineData.OEM;\n                Modality = (_theMachineData$modal = theMachineData.modality) !== null && _theMachineData$modal !== void 0 ? _theMachineData$modal : theMachineData.Modality;\n                Model = (_theMachineData$model = theMachineData.model) !== null && _theMachineData$model !== void 0 ? _theMachineData$model : theMachineData.Model;\n                setTheMachine(_objectSpread(_objectSpread({}, theMachineData), {}, {\n                  OEM: OEM,\n                  Modality: Modality,\n                  Model: Model\n                }));\n              } // setStoredMachine(theMachineData);\n              // **right here** merge from the three sources you just fetched:\n\n\n              merged = updateMachineFields(theMachineData, machineCurrentData, machineFromData);\n              applyMergedMachineFields(merged);\n              console.log(\"SelectedMachine:\", selectedMachine, \"SelectedCurrentMachine:\", selectedCurrentMachine); // Show local loc inputs if applicable\n              // if (\n              //   selectedMachine &&\n              //   selectedMachine.name &&\n              //   selectedMachine.name.toLowerCase() === \"interior socal\"\n              // ) {\n              //   setShowLocalLocFrom(true);\n              // }\n              // if (\n              //   selectedCurrentMachine &&\n              //   selectedCurrentMachine.name &&\n              //   selectedCurrentMachine.name.toLowerCase() === \"interior socal\"\n              // ) {\n              //   setShowLocalLocCurrent(true);\n              // }\n\n              if (!data.Parent) {\n                _context7.next = 71;\n                break;\n              }\n\n              _context7.next = 69;\n              return data.Parent.get();\n\n            case 69:\n              parentDoc = _context7.sent;\n              setSelectedParent(_objectSpread({\n                id: parentDoc.id\n              }, parentDoc.data()));\n\n            case 71:\n              // Priority auto‑population of machine fields.\n              // const updatedFields = updateMachineFields(storedMachine, selectedCurrentMachine, selectedMachine);\n              // // console.log(\"Updated machine fields:\", updatedFields);\n              // setOem(updatedFields.oem);\n              // setModality(updatedFields.modality);\n              // setModel(updatedFields.model);\n              setIsLoading(false);\n              Promise.all([fetchPhotos(id), checkIfAddedToWebsite(id), calculateItemFrequencyAndUsage(data.pn)])[\"catch\"](function (err) {\n                console.error(\"Background item loads failed:\", err);\n              });\n              _context7.next = 76;\n              break;\n\n            case 75:\n              router.push({\n                pathname: \"../AddItem/NewItem\",\n                query: {\n                  signal: id\n                }\n              });\n\n            case 76:\n              _context7.next = 81;\n              break;\n\n            case 78:\n              _context7.prev = 78;\n              _context7.t0 = _context7[\"catch\"](5);\n              console.error(\"Error fetching item:\", _context7.t0);\n\n            case 81:\n              _context7.prev = 81;\n              setIsLoading(false);\n              return _context7.finish(81);\n\n            case 84:\n            case \"end\":\n              return _context7.stop();\n          }\n        }\n      }, _callee7, null, [[5, 78, 81, 84]]);\n    }));\n\n    return function fetchData() {\n      return _ref16.apply(this, arguments);\n    };\n  }();\n\n  var calculateItemFrequencyAndUsage = /*#__PURE__*/function () {\n    var _ref17 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(pn) {\n      var db, currentDate, oneYearAgo, normalizedPN, itemsSnapshot, usagePastYear;\n      return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n        while (1) {\n          switch (_context8.prev = _context8.next) {\n            case 0:\n              db = firebase.firestore();\n              currentDate = new Date();\n              oneYearAgo = new Date();\n              oneYearAgo.setFullYear(currentDate.getFullYear() - 1);\n              normalizedPN = pn !== undefined ? pn : \"\";\n              _context8.next = 7;\n              return db.collection(\"Test\").where(\"pn\", \"==\", normalizedPN).get();\n\n            case 7:\n              itemsSnapshot = _context8.sent;\n              setFreqItem(itemsSnapshot.size);\n              usagePastYear = 0;\n              itemsSnapshot.forEach(function (doc) {\n                var itemData = doc.data();\n                itemData.workOrders.forEach(function (workOrder) {\n                  var workOrderDate = new Date(workOrder.date);\n\n                  if (workOrderDate >= oneYearAgo && workOrderDate <= currentDate) {\n                    usagePastYear++;\n                  }\n                });\n              });\n              setUsagePastYear(usagePastYear);\n\n            case 12:\n            case \"end\":\n              return _context8.stop();\n          }\n        }\n      }, _callee8);\n    }));\n\n    return function calculateItemFrequencyAndUsage(_x6) {\n      return _ref17.apply(this, arguments);\n    };\n  }();\n\n  var fetchMachine = /*#__PURE__*/function () {\n    var _ref18 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(machineId) {\n      var db, doc, machineData, merged, machinesSnapshot;\n      return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n        while (1) {\n          switch (_context9.prev = _context9.next) {\n            case 0:\n              db = firebase.firestore();\n              _context9.next = 3;\n              return db.collection(\"Machine\").doc(machineId).get();\n\n            case 3:\n              doc = _context9.sent;\n\n              if (!doc.exists) {\n                _context9.next = 15;\n                break;\n              }\n\n              machineData = doc.data();\n              setTheMachine(machineData); // re-merge all three sources with correct priority:\n\n              merged = updateMachineFields(machineData, selectedCurrentMachine, selectedMachine);\n              applyMergedMachineFields(merged);\n              _context9.next = 11;\n              return db.collection(\"Machine\").where(\"Model\", \"==\", machineData.Model || machineData.model).get();\n\n            case 11:\n              machinesSnapshot = _context9.sent;\n              setMachineFrequency(machinesSnapshot.size);\n              _context9.next = 16;\n              break;\n\n            case 15:\n              console.error(\"Machine not found\");\n\n            case 16:\n            case \"end\":\n              return _context9.stop();\n          }\n        }\n      }, _callee9);\n    }));\n\n    return function fetchMachine(_x7) {\n      return _ref18.apply(this, arguments);\n    };\n  }();\n\n  var fetchPhotos = /*#__PURE__*/function () {\n    var _ref19 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10(docID) {\n      var storageRef, listRef, res, urls;\n      return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              storageRef = firebase.storage().ref();\n              listRef = storageRef.child(\"Parts/\".concat(docID));\n              _context10.prev = 2;\n              _context10.next = 5;\n              return listRef.listAll();\n\n            case 5:\n              res = _context10.sent;\n              _context10.next = 8;\n              return Promise.all(res.items.map(function (item) {\n                return item.getDownloadURL();\n              }));\n\n            case 8:\n              urls = _context10.sent;\n              setPhotos(urls.map(function (url) {\n                return {\n                  url: url,\n                  file: null\n                };\n              }));\n              _context10.next = 15;\n              break;\n\n            case 12:\n              _context10.prev = 12;\n              _context10.t0 = _context10[\"catch\"](2);\n              console.error(\"Error fetching photos: \", _context10.t0);\n\n            case 15:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10, null, [[2, 12]]);\n    }));\n\n    return function fetchPhotos(_x8) {\n      return _ref19.apply(this, arguments);\n    };\n  }();\n\n  var checkIfAddedToWebsite = /*#__PURE__*/function () {\n    var _ref20 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(docID) {\n      var db, partsDoc;\n      return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              db = firebase.firestore();\n              _context11.next = 3;\n              return db.collection(\"Parts\").doc(docID).get();\n\n            case 3:\n              partsDoc = _context11.sent;\n\n              if (partsDoc.exists) {\n                setAddToWebsite(true);\n              }\n\n            case 5:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11);\n    }));\n\n    return function checkIfAddedToWebsite(_x9) {\n      return _ref20.apply(this, arguments);\n    };\n  }();\n\n  var handleClose = function handleClose() {\n    return setShow(false);\n  };\n\n  var handleShow = function handleShow() {\n    return setShow(true);\n  };\n\n  var handleCloseErr = function handleCloseErr() {\n    return setShowErr(false);\n  };\n\n  var handleShowErr = function handleShowErr() {\n    return setShowErr(true);\n  };\n\n  var handleCloseSaveModal = function handleCloseSaveModal() {\n    return setShowSaveModal(false);\n  };\n\n  var handleClosePrintModal = function handleClosePrintModal() {\n    return setShowPrintModal(false);\n  };\n\n  var handleShowSaveModal = function handleShowSaveModal() {\n    return setShowSaveModal(true);\n  };\n\n  var handleShowPrintModal = function handleShowPrintModal() {\n    return setShowPrintModal(true);\n  };\n\n  var handleMachineSelectionModal = function handleMachineSelectionModal() {\n    return setMachineSelectionModal(false);\n  };\n\n  var handleCloseDescModal = function handleCloseDescModal() {\n    return setShowDescModal(false);\n  };\n\n  var handleShowDescModal = function handleShowDescModal() {\n    return setShowDescModal(true);\n  };\n\n  var handleCloseWoModal = function handleCloseWoModal() {\n    return setShowWoModal(false);\n  };\n\n  var handleShowWoModal = function handleShowWoModal() {\n    return setShowWoModal(true);\n  };\n\n  var handleCloseClientModal = function handleCloseClientModal() {\n    return setShowClientModal(false);\n  };\n\n  var handleShowClientModal = /*#__PURE__*/function () {\n    var _ref21 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n      return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n        while (1) {\n          switch (_context12.prev = _context12.next) {\n            case 0:\n              _context12.next = 2;\n              return loadClients();\n\n            case 2:\n              setShowClientModal(true);\n\n            case 3:\n            case \"end\":\n              return _context12.stop();\n          }\n        }\n      }, _callee12);\n    }));\n\n    return function handleShowClientModal() {\n      return _ref21.apply(this, arguments);\n    };\n  }();\n\n  var handleCloseMachineModal = function handleCloseMachineModal() {\n    return setShowMachineModal(false);\n  };\n\n  var handleShowMachineModal = function handleShowMachineModal() {\n    setShowMachineModal(true);\n    setShowClientModal(false);\n  };\n\n  var handleCloseParentModal = function handleCloseParentModal() {\n    return setShowParentModal(false);\n  };\n\n  var handleShowParentModal = function handleShowParentModal() {\n    return setShowParentModal(true);\n  }; // When a client is selected from the client table.\n\n\n  var handleClientInfo = /*#__PURE__*/function () {\n    var _ref22 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee13(clientId) {\n      var db, clientDoc, clientData, machinePromises, machineDocs, machines;\n      return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n        while (1) {\n          switch (_context13.prev = _context13.next) {\n            case 0:\n              // Clear any previously selected machine and local loc info for this branch.\n              if (machinePick) {\n                setSelectedMachine(null);\n                setShowLocalLocFrom(false);\n              } else {\n                setSelectedCurrentMachine(null);\n                setShowLocalLocCurrent(false);\n              }\n\n              db = firebase.firestore();\n              _context13.next = 4;\n              return db.collection(\"Client\").doc(clientId).get();\n\n            case 4:\n              clientDoc = _context13.sent;\n\n              if (!clientDoc.exists) {\n                _context13.next = 16;\n                break;\n              }\n\n              clientData = _objectSpread({\n                id: clientDoc.id\n              }, clientDoc.data());\n\n              if (machinePick) {\n                setSelectedClientFrom(clientData);\n              } else {\n                setSelectedClientCurrent(clientData);\n              } // after setting selectedClientFrom/Current:\n\n\n              if (clientData.name === \"SoCalWarehouse\") {\n                if (machinePick) setShowLocalLocFrom(true);else setShowLocalLocCurrent(true);\n              } // Fetch machines for this client:\n\n\n              machinePromises = clientData.machines.map(function (machineRef) {\n                return machineRef.get();\n              });\n              _context13.next = 12;\n              return Promise.all(machinePromises);\n\n            case 12:\n              machineDocs = _context13.sent;\n              machines = machineDocs.map(function (machineDoc) {\n                return _objectSpread({\n                  id: machineDoc.id\n                }, machineDoc.data());\n              });\n              setMachineOptions(machines); // Close the client modal\n\n              handleCloseClientModal();\n\n            case 16:\n            case \"end\":\n              return _context13.stop();\n          }\n        }\n      }, _callee13);\n    }));\n\n    return function handleClientInfo(_x10) {\n      return _ref22.apply(this, arguments);\n    };\n  }(); // Reordering function for dropdowns.\n\n\n  var reorderArray = function reorderArray(arr, selectedValue) {\n    var newArr = arr.filter(function (val) {\n      return val !== selectedValue;\n    });\n    return [selectedValue].concat(_toConsumableArray(newArr));\n  };\n\n  var _useState62 = useState(false),\n      addingNewPn = _useState62[0],\n      setAddingNewPn = _useState62[1];\n\n  var _useState63 = useState(\"\"),\n      newPn = _useState63[0],\n      setNewPn = _useState63[1];\n\n  var _useState64 = useState(false),\n      addingNewSn = _useState64[0],\n      setAddingNewSn = _useState64[1];\n\n  var _useState65 = useState(\"\"),\n      newSn = _useState65[0],\n      setNewSn = _useState65[1];\n\n  var handlePnSelect = function handlePnSelect(e) {\n    var selected = e.target.value;\n    setItems(function (prev) {\n      var updatedPn = Array.isArray(prev.pn) ? _toConsumableArray(prev.pn) : [];\n      updatedPn[0] = selected;\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        pn: updatedPn\n      });\n    });\n  };\n\n  var handleSnSelect = function handleSnSelect(e) {\n    var selected = e.target.value;\n    setItems(function (prev) {\n      var updatedSn = Array.isArray(prev.sn) ? _toConsumableArray(prev.sn) : [];\n      updatedSn[0] = selected;\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        sn: updatedSn\n      });\n    });\n  };\n\n  var handleAddNewPn = function handleAddNewPn() {\n    if (newPn.trim() !== \"\") {\n      setItems(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          pn: [].concat(_toConsumableArray(prev.pn), [newPn.trim()])\n        });\n      });\n    }\n\n    setNewPn(\"\");\n    setAddingNewPn(false);\n  };\n\n  var handleAddNewSn = function handleAddNewSn() {\n    if (newSn.trim() !== \"\") {\n      setItems(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          sn: [].concat(_toConsumableArray(prev.sn), [newSn.trim()])\n        });\n      });\n    }\n\n    setNewSn(\"\");\n    setAddingNewSn(false);\n  }; // Generate custom document ID if needed.\n\n\n  var generateCustomID = function generateCustomID() {\n    var randomNum = Math.floor(10000 + Math.random() * 90000);\n    return \"AIS\".concat(randomNum);\n  };\n\n  function shallowClean(obj) {\n    var newObj = {};\n\n    for (var key in obj) {\n      console.log(key, obj[key]);\n\n      if (obj.hasOwnProperty(key)) {\n        newObj[key] = obj[key] === undefined ? \"\" : obj[key];\n      }\n    }\n\n    return newObj;\n  }\n\n  function toSend() {\n    return _toSend.apply(this, arguments);\n  } // Additional state for local warehouse location inputs.\n\n\n  function _toSend() {\n    _toSend = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee20() {\n      var _fromDetails$section, _fromDetails$section2, _currentDetails$secti, _currentDetails$secti2;\n\n      var db, currentUser, userEmail, storedOem, storedModality, storedModel, machineData, formattedItems, fromDetails, currentDetails, docId, newDocId, machineRef, machineDoc, currentMachineRef, currentMachineDoc, cleanFormattedItems, _machineRef, _machineDoc, _currentMachineRef, _currentMachineDoc, _machineRef2, _machineDoc2, _currentMachineRef2, _currentMachineDoc2;\n\n      return _regeneratorRuntime.wrap(function _callee20$(_context20) {\n        while (1) {\n          switch (_context20.prev = _context20.next) {\n            case 0:\n              db = firebase.firestore();\n              currentUser = firebase.auth().currentUser;\n              userEmail = currentUser ? currentUser.email : \"unknown\"; // Always use the current state values for OEM, modality, and model.\n\n              storedOem = selectionToStoredValue(selectedOems);\n              storedModality = selectionToStoredValue(selectedModalities);\n              storedModel = selectionToStoredValue(selectedModels);\n              machineData = _objectSpread(_objectSpread({}, TheMachine || {}), {}, {\n                oem: storedOem,\n                OEM: storedOem,\n                modality: storedModality,\n                Modality: storedModality,\n                model: storedModel,\n                Model: storedModel\n              });\n              formattedItems = _objectSpread(_objectSpread({}, items), {}, {\n                descriptions: descriptions,\n                workOrders: workOrders\n              }); // Remove any unused fields.\n\n              formattedItems.status = items.status || \"\";\n              formattedItems.nameLower = (items.name || \"\").toLowerCase();\n              formattedItems.nameTokens = buildNameTokens(items.name);\n              formattedItems.DOM = DOM; // Date of Manufacture\n\n              formattedItems.localLocFrom = localLocFrom || \"\";\n              formattedItems.localLocCurrent = localLocCurrent || \"\";\n              formattedItems.date = items.date || \"\";\n              formattedItems.arrival_date = items.arrival_date || \"\"; // NEW: Arrival Date\n\n              formattedItems.poNumber = items.poNumber || \"\";\n              formattedItems.trackingNumber = items.trackingNumber || \"\";\n              formattedItems.TheMachine = machineData || {};\n              formattedItems.addedToWebsite = addToWebsite; // NEW: Add the user's email under the field \"user\"\n\n              formattedItems.lastEdited = userEmail; // Clean pn and sn arrays to replace undefined values with an empty string.\n\n              formattedItems.pn = (items.pn || []).map(function (value) {\n                return value === undefined ? \"\" : value;\n              });\n              formattedItems.sn = (items.sn || []).map(function (value) {\n                return value === undefined ? \"\" : value;\n              });\n              fromDetails = buildLocalLocObject(newLocalFrom);\n              currentDetails = buildLocalLocObject(newLocalCurrent);\n              console.log(\"From Details: \" + fromDetails.region + \" \" + ((_fromDetails$section = fromDetails.section) === null || _fromDetails$section === void 0 ? void 0 : _fromDetails$section.letter) + ((_fromDetails$section2 = fromDetails.section) === null || _fromDetails$section2 === void 0 ? void 0 : _fromDetails$section2.number) + \" \" + fromDetails.bin + \" \" + fromDetails.pallet);\n              console.log(\"Current Details: \" + currentDetails.region + \" \" + ((_currentDetails$secti = currentDetails.section) === null || _currentDetails$secti === void 0 ? void 0 : _currentDetails$secti.letter) + ((_currentDetails$secti2 = currentDetails.section) === null || _currentDetails$secti2 === void 0 ? void 0 : _currentDetails$secti2.number) + \" \" + currentDetails.bin + \" \" + currentDetails.pallet);\n\n              if (Object.keys(fromDetails).length) {\n                formattedItems.newLocalFrom = fromDetails;\n                formattedItems.localLocFrom = formatLoc(newLocalFrom) || \"\";\n              } else {\n                // all fields empty — force an empty string and remove any stray map\n                console.log(\"entered empty fromDetails else\");\n                formattedItems.localLocFrom = \"\";\n                formattedItems.newLocalFrom = {};\n              }\n\n              if (Object.keys(currentDetails).length) {\n                formattedItems.newLocalCurrent = currentDetails;\n                formattedItems.localLocCurrent = formatLoc(newLocalCurrent) || \"\";\n              } else {\n                // all fields empty — force an empty string and remove any stray map\n                formattedItems.localLocCurrent = \"\";\n                formattedItems.newLocalCurrent = {};\n              }\n\n              if (selectedMachine && selectedMachine.id) {\n                formattedItems.MachineFrom = db.collection(\"Machine\").doc(selectedMachine.id);\n              }\n\n              if (selectedCurrentMachine && selectedCurrentMachine.id) {\n                formattedItems.MachineCurrent = db.collection(\"Machine\").doc(selectedCurrentMachine.id);\n              }\n\n              if (selectedParent && selectedParent.id) {\n                formattedItems.Parent = db.collection(\"Test\").doc(selectedParent.id);\n              } // NEW: Set separate client references.\n\n\n              if (selectedClientFrom && selectedClientFrom.id) {\n                formattedItems.ClientFrom = db.collection(\"Client\").doc(selectedClientFrom.id);\n              }\n\n              if (selectedClientCurrent && selectedClientCurrent.id) {\n                formattedItems.ClientCurrent = db.collection(\"Client\").doc(selectedClientCurrent.id);\n              } // Only attach the richer “newLocal” map when the user actually filled something in\n\n\n              if (Object.keys(fromDetails).length) {\n                formattedItems.newLocalFrom = fromDetails;\n              }\n\n              if (Object.keys(currentDetails).length) {\n                formattedItems.newLocalCurrent = currentDetails;\n              }\n\n              docId = id;\n              _context20.prev = 37;\n\n              if (!docId) {\n                _context20.next = 85;\n                break;\n              }\n\n              // Check if a localSN is provided and if it differs from the current docId.\n              newDocId = items.localSN && items.localSN.trim() !== \"\" ? items.localSN.trim() : docId;\n\n              if (!(docId !== newDocId)) {\n                _context20.next = 64;\n                break;\n              }\n\n              _context20.next = 43;\n              return db.collection(\"Test\").doc(newDocId).set(formattedItems);\n\n            case 43:\n              if (!(selectedMachine && selectedMachine.id)) {\n                _context20.next = 51;\n                break;\n              }\n\n              machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\n              _context20.next = 47;\n              return machineRef.get();\n\n            case 47:\n              machineDoc = _context20.sent;\n\n              if (!machineDoc.exists) {\n                _context20.next = 51;\n                break;\n              }\n\n              _context20.next = 51;\n              return machineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(newDocId))\n              });\n\n            case 51:\n              if (!(selectedCurrentMachine && selectedCurrentMachine.id)) {\n                _context20.next = 59;\n                break;\n              }\n\n              currentMachineRef = db.collection(\"Machine\").doc(selectedCurrentMachine.id);\n              _context20.next = 55;\n              return currentMachineRef.get();\n\n            case 55:\n              currentMachineDoc = _context20.sent;\n\n              if (!currentMachineDoc.exists) {\n                _context20.next = 59;\n                break;\n              }\n\n              _context20.next = 59;\n              return currentMachineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(newDocId))\n              });\n\n            case 59:\n              _context20.next = 61;\n              return db.collection(\"Test\").doc(docId)[\"delete\"]();\n\n            case 61:\n              // Set docId to the new document ID.\n              docId = newDocId;\n              _context20.next = 83;\n              break;\n\n            case 64:\n              // Deep-clean the formattedItems to remove any undefined nested values.\n              cleanFormattedItems = shallowClean(formattedItems);\n              _context20.next = 67;\n              return db.collection(\"Test\").doc(docId).update(cleanFormattedItems);\n\n            case 67:\n              if (!(selectedMachine && selectedMachine.id)) {\n                _context20.next = 75;\n                break;\n              }\n\n              _machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\n              _context20.next = 71;\n              return _machineRef.get();\n\n            case 71:\n              _machineDoc = _context20.sent;\n\n              if (!_machineDoc.exists) {\n                _context20.next = 75;\n                break;\n              }\n\n              _context20.next = 75;\n              return _machineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(docId))\n              });\n\n            case 75:\n              if (!(selectedCurrentMachine && selectedCurrentMachine.id)) {\n                _context20.next = 83;\n                break;\n              }\n\n              _currentMachineRef = db.collection(\"Machine\").doc(selectedCurrentMachine.id);\n              _context20.next = 79;\n              return _currentMachineRef.get();\n\n            case 79:\n              _currentMachineDoc = _context20.sent;\n\n              if (!_currentMachineDoc.exists) {\n                _context20.next = 83;\n                break;\n              }\n\n              _context20.next = 83;\n              return _currentMachineRef.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(docId))\n              });\n\n            case 83:\n              _context20.next = 104;\n              break;\n\n            case 85:\n              // For a new item, if localSN is provided, use it; otherwise, generate a custom ID.\n              docId = items.localSN && items.localSN.trim() !== \"\" ? items.localSN.trim() : generateCustomID();\n              _context20.next = 88;\n              return db.collection(\"Test\").doc(docId).set(formattedItems);\n\n            case 88:\n              if (!(selectedMachine && selectedMachine.id)) {\n                _context20.next = 96;\n                break;\n              }\n\n              _machineRef2 = db.collection(\"Machine\").doc(selectedMachine.id);\n              _context20.next = 92;\n              return _machineRef2.get();\n\n            case 92:\n              _machineDoc2 = _context20.sent;\n\n              if (!_machineDoc2.exists) {\n                _context20.next = 96;\n                break;\n              }\n\n              _context20.next = 96;\n              return _machineRef2.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(docId))\n              });\n\n            case 96:\n              if (!(selectedCurrentMachine && selectedCurrentMachine.id)) {\n                _context20.next = 104;\n                break;\n              }\n\n              _currentMachineRef2 = db.collection(\"Machine\").doc(selectedCurrentMachine.id);\n              _context20.next = 100;\n              return _currentMachineRef2.get();\n\n            case 100:\n              _currentMachineDoc2 = _context20.sent;\n\n              if (!_currentMachineDoc2.exists) {\n                _context20.next = 104;\n                break;\n              }\n\n              _context20.next = 104;\n              return _currentMachineRef2.update({\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(db.collection(\"Test\").doc(docId))\n              });\n\n            case 104:\n              _context20.next = 106;\n              return uploadPhotos(docId);\n\n            case 106:\n              console.log(\"Item saved and associatedParts updated!\");\n              setSavedName(items.name || \"\"); // Redirect to the new URL using the new document id.\n\n              router.push(\"/NewSearch/item/\".concat(docId)); // Optionally, you can also show a save confirmation modal:\n\n              handleShowSaveModal();\n              _context20.next = 115;\n              break;\n\n            case 112:\n              _context20.prev = 112;\n              _context20.t0 = _context20[\"catch\"](37);\n              console.error(\"Error saving data:\", _context20.t0);\n\n            case 115:\n            case \"end\":\n              return _context20.stop();\n          }\n        }\n      }, _callee20, null, [[37, 112]]);\n    }));\n    return _toSend.apply(this, arguments);\n  }\n\n  var _useState66 = useState(false),\n      showLocalLocFrom = _useState66[0],\n      setShowLocalLocFrom = _useState66[1];\n\n  var _useState67 = useState(false),\n      showLocalLocCurrent = _useState67[0],\n      setShowLocalLocCurrent = _useState67[1]; // When a machine is selected from the modal.\n\n\n  var handleSetSelectedMachine = function handleSetSelectedMachine(machine) {\n    var _machine$name;\n\n    // const condition = (name) => name && name.toLowerCase() === \"interior socal\";\n    var isSocalInterior = ((_machine$name = machine.name) === null || _machine$name === void 0 ? void 0 : _machine$name.toLowerCase()) === \"interior socal\";\n\n    if (machinePick) {\n      var _selectedClientFrom$n3;\n\n      setSelectedMachine({\n        id: machine.id,\n        name: machine.name\n      });\n      setShowLocalLocFrom(isSocalInterior || (selectedClientFrom === null || selectedClientFrom === void 0 ? void 0 : (_selectedClientFrom$n3 = selectedClientFrom.name) === null || _selectedClientFrom$n3 === void 0 ? void 0 : _selectedClientFrom$n3.toLowerCase()) === \"socalwarehouse\");\n    } else {\n      var _selectedClientCurren3;\n\n      setSelectedCurrentMachine({\n        id: machine.id,\n        name: machine.name\n      });\n      setShowLocalLocCurrent(isSocalInterior || (selectedClientCurrent === null || selectedClientCurrent === void 0 ? void 0 : (_selectedClientCurren3 = selectedClientCurrent.name) === null || _selectedClientCurren3 === void 0 ? void 0 : _selectedClientCurren3.toLowerCase()) === \"socalwarehouse\");\n    }\n\n    fetchMachine(machine.id); // Close the machine modal (assuming you're using showMachineModal to control it)\n\n    setShowMachineModal(false);\n  };\n\n  var uploadPhotos = /*#__PURE__*/function () {\n    var _ref23 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee14(docID) {\n      var storageRef, i, photoRef, metadata, url;\n      return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n        while (1) {\n          switch (_context14.prev = _context14.next) {\n            case 0:\n              storageRef = firebase.storage().ref();\n              i = 0;\n\n            case 2:\n              if (!(i < photos.length)) {\n                _context14.next = 15;\n                break;\n              }\n\n              if (!photos[i].file) {\n                _context14.next = 12;\n                break;\n              }\n\n              photoRef = storageRef.child(\"Parts/\".concat(docID, \"/\").concat(docID).concat(i === 0 ? \".jpg\" : \".\".concat(i + 1, \".jpg\")));\n              metadata = {\n                contentType: \"image/png\"\n              };\n              _context14.next = 8;\n              return photoRef.put(photos[i].file, metadata);\n\n            case 8:\n              _context14.next = 10;\n              return photoRef.getDownloadURL();\n\n            case 10:\n              url = _context14.sent;\n              photos[i].url = url;\n\n            case 12:\n              i++;\n              _context14.next = 2;\n              break;\n\n            case 15:\n            case \"end\":\n              return _context14.stop();\n          }\n        }\n      }, _callee14);\n    }));\n\n    return function uploadPhotos(_x11) {\n      return _ref23.apply(this, arguments);\n    };\n  }(); // Function to handle printing the label.\n\n\n  var handlePrint = /*#__PURE__*/function () {\n    var _ref24 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee15() {\n      var clientName, machineDoc, machineData, clientDoc, _clientDoc, payload, response, result;\n\n      return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n        while (1) {\n          switch (_context15.prev = _context15.next) {\n            case 0:\n              if (items.name) {\n                _context15.next = 3;\n                break;\n              }\n\n              alert(\"Missing name\");\n              return _context15.abrupt(\"return\");\n\n            case 3:\n              clientName = \"\"; // Attempt to fetch client name from the Machine document reference.\n\n              if (!(items.Machine && typeof items.Machine.get === \"function\")) {\n                _context15.next = 23;\n                break;\n              }\n\n              _context15.prev = 5;\n              _context15.next = 8;\n              return items.Machine.get();\n\n            case 8:\n              machineDoc = _context15.sent;\n\n              if (!machineDoc.exists) {\n                _context15.next = 16;\n                break;\n              }\n\n              machineData = machineDoc.data();\n\n              if (!(machineData.client && typeof machineData.client.get === \"function\")) {\n                _context15.next = 16;\n                break;\n              }\n\n              _context15.next = 14;\n              return machineData.client.get();\n\n            case 14:\n              clientDoc = _context15.sent;\n\n              if (clientDoc.exists) {\n                clientName = clientDoc.data().name || \"\";\n              }\n\n            case 16:\n              _context15.next = 21;\n              break;\n\n            case 18:\n              _context15.prev = 18;\n              _context15.t0 = _context15[\"catch\"](5);\n              console.error(\"Error fetching machine or client:\", _context15.t0);\n\n            case 21:\n              _context15.next = 24;\n              break;\n\n            case 23:\n              console.warn(\"No Machine reference available in the item\");\n\n            case 24:\n              console.log(clientName, \":\", items.client); // Fallback: if no client name was found, check items.client.\n\n              if (!(!clientName && items.client)) {\n                _context15.next = 40;\n                break;\n              }\n\n              if (!(typeof items.client.get === \"function\")) {\n                _context15.next = 39;\n                break;\n              }\n\n              _context15.prev = 27;\n              _context15.next = 30;\n              return items.client.get();\n\n            case 30:\n              _clientDoc = _context15.sent;\n\n              if (_clientDoc.exists) {\n                clientName = _clientDoc.data().name || \"\";\n              }\n\n              _context15.next = 37;\n              break;\n\n            case 34:\n              _context15.prev = 34;\n              _context15.t1 = _context15[\"catch\"](27);\n              console.error(\"Error fetching client from items.client:\", _context15.t1);\n\n            case 37:\n              _context15.next = 40;\n              break;\n\n            case 39:\n              clientName = items.client;\n\n            case 40:\n              console.log(\"descriptions:\", descriptions[selectedDesc]);\n              payload = {\n                name: items.name,\n                pn: items.pn,\n                sn: items.sn,\n                wo: workOrders && workOrders.length > 0 ? workOrders[0].workOrder : \"\",\n                client: clientName,\n                status: items.status,\n                local_sn: id,\n                descriptions: [descriptions[selectedDesc] || {\n                  description: \"\",\n                  date: \"\"\n                }],\n                date: items.dateCreated || \"\",\n                DOM: DOM,\n                oem: selectionToPrintValue(selectedOems),\n                modality: selectionToPrintValue(selectedModalities),\n                model: selectionToPrintValue(selectedModels),\n                poNumber: items.poNumber,\n                arrival_date: items.arrival_date // NEW: Include arrival_date\n\n              };\n              console.log(\"Payload for printing:\", payload);\n              _context15.prev = 43;\n              _context15.next = 46;\n              return fetch(\"https://9d70-174-76-22-138.ngrok-free.app/print-label\", {\n                method: \"POST\",\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(payload)\n              });\n\n            case 46:\n              response = _context15.sent;\n              _context15.next = 49;\n              return response.json();\n\n            case 49:\n              result = _context15.sent;\n              console.log(\"Print result:\", result.status);\n\n              if (result.status.includes(\"successfully.\")) {\n                handleShowPrintModal();\n              } else {\n                console.error(\"Error printing label:\", result.error);\n              }\n\n              _context15.next = 57;\n              break;\n\n            case 54:\n              _context15.prev = 54;\n              _context15.t2 = _context15[\"catch\"](43);\n              console.error(\"Error printing label:\", _context15.t2);\n\n            case 57:\n            case \"end\":\n              return _context15.stop();\n          }\n        }\n      }, _callee15, null, [[5, 18], [27, 34], [43, 54]]);\n    }));\n\n    return function handlePrint() {\n      return _ref24.apply(this, arguments);\n    };\n  }();\n\n  function handleSubmit(_x12) {\n    return _handleSubmit.apply(this, arguments);\n  } // Handlers for input changes.\n\n\n  function _handleSubmit() {\n    _handleSubmit = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee21(event) {\n      return _regeneratorRuntime.wrap(function _callee21$(_context21) {\n        while (1) {\n          switch (_context21.prev = _context21.next) {\n            case 0:\n              event.preventDefault(); // Only check that the Name field is filled out.\n\n              if (!items.name) {\n                handleShow(); // This shows the \"missing field\" modal.\n              } else {\n                toSend();\n              }\n\n            case 2:\n            case \"end\":\n              return _context21.stop();\n          }\n        }\n      }, _callee21);\n    }));\n    return _handleSubmit.apply(this, arguments);\n  }\n\n  var handleChange = function handleChange(field) {\n    return function (event) {\n      var value = event.target ? event.target.value : event.value;\n      setItems(function (prevItems) {\n        return _objectSpread(_objectSpread({}, prevItems), {}, _defineProperty({}, field, value));\n      });\n    };\n  };\n\n  var addDescription = function addDescription() {\n    setDescriptions([].concat(_toConsumableArray(descriptions), [{\n      description: \"\",\n      date: \"\"\n    }]));\n  };\n\n  var removeDescription = function removeDescription(index) {\n    setDescriptions(descriptions.filter(function (_, i) {\n      return i !== index;\n    }));\n  };\n\n  var handleDescriptionChange = function handleDescriptionChange(index, field, value) {\n    var newDescriptions = descriptions.map(function (desc, i) {\n      return i === index ? _objectSpread(_objectSpread({}, desc), {}, _defineProperty({}, field, value)) : desc;\n    });\n    setDescriptions(newDescriptions);\n  };\n\n  var addWorkOrder = function addWorkOrder() {\n    setWorkOrders([].concat(_toConsumableArray(workOrders), [{\n      workOrder: \"\",\n      date: \"\"\n    }]));\n  };\n\n  var removeWorkOrder = function removeWorkOrder(index) {\n    setWorkOrders(workOrders.filter(function (_, i) {\n      return i !== index;\n    }));\n  };\n\n  var handleWorkOrderChange = function handleWorkOrderChange(index, field, value) {\n    var newWorkOrders = workOrders.map(function (wo, i) {\n      return i === index ? _objectSpread(_objectSpread({}, wo), {}, _defineProperty({}, field, value)) : wo;\n    });\n    setWorkOrders(newWorkOrders);\n  };\n\n  var listDescriptions = function listDescriptions() {\n    setShowDescModal(true);\n  };\n\n  var selectDescription = function selectDescription(index) {\n    setSelectedDesc(index);\n    setShowDescModal(false);\n  };\n\n  var handleShowCameraModal = function handleShowCameraModal() {\n    setShowCameraModal(true);\n  };\n\n  var handleCloseCameraModal = function handleCloseCameraModal() {\n    setShowCameraModal(false);\n    setCapturedPhoto(null);\n  };\n\n  var handleCapture = function handleCapture(err, result) {\n    if (result) {\n      setCapturedPhoto(result);\n    }\n  };\n\n  var savePhoto = function savePhoto() {\n    setPhotos(function (prevPhotos) {\n      return [].concat(_toConsumableArray(prevPhotos), [{\n        file: capturedPhoto,\n        url: URL.createObjectURL(capturedPhoto)\n      }]);\n    });\n    setCapturedPhoto(null);\n    handleCloseCameraModal();\n  };\n\n  var removePhoto = function removePhoto(index) {\n    setPhotos(photos.filter(function (_, i) {\n      return i !== index;\n    }));\n  };\n\n  var mostRecentWorkOrder = workOrders && workOrders.length > 0 ? workOrders.reduce(function (latest, current) {\n    var latestDate = new Date(latest.date);\n    var currentDate = new Date(current.date);\n    return currentDate > latestDate ? current : latest;\n  }, workOrders[0]) : {};\n\n  var capturePhoto = function capturePhoto() {\n    var video = document.querySelector(\"video\");\n    var canvas = document.createElement(\"canvas\");\n    canvas.width = video.videoWidth;\n    canvas.height = video.videoHeight;\n    var context = canvas.getContext(\"2d\");\n    context.drawImage(video, 0, 0, canvas.width, canvas.height);\n    canvas.toBlob(function (blob) {\n      setCapturedPhoto(blob);\n    }, \"image/png\");\n  };\n\n  var handleShowInfoModal = /*#__PURE__*/function () {\n    var _ref25 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee16() {\n      var db, doc, data;\n      return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n        while (1) {\n          switch (_context16.prev = _context16.next) {\n            case 0:\n              db = firebase.firestore();\n              _context16.prev = 1;\n              _context16.next = 4;\n              return db.collection(\"Test\").doc(id).get();\n\n            case 4:\n              doc = _context16.sent;\n\n              if (doc.exists) {\n                data = doc.data();\n                setItemName(data.name || \"N/A\");\n                setShowInfoModal(true);\n              } else {\n                console.error(\"Item not found\");\n              }\n\n              _context16.next = 11;\n              break;\n\n            case 8:\n              _context16.prev = 8;\n              _context16.t0 = _context16[\"catch\"](1);\n              console.error(\"Error fetching item info:\", _context16.t0);\n\n            case 11:\n            case \"end\":\n              return _context16.stop();\n          }\n        }\n      }, _callee16, null, [[1, 8]]);\n    }));\n\n    return function handleShowInfoModal() {\n      return _ref25.apply(this, arguments);\n    };\n  }();\n\n  var handleCloseInfoModal = function handleCloseInfoModal() {\n    return setShowInfoModal(false);\n  };\n\n  var handleCloneToNewItem = function handleCloneToNewItem() {\n    if (!id) {\n      setErr(\"Item ID not ready yet.\");\n      setShowErr(true);\n      return;\n    }\n\n    router.push(\"/NewSearch/AddItem/NewItem?cloneFrom=\".concat(encodeURIComponent(id)));\n  };\n\n  var handlePnChange = function handlePnChange(index, value) {\n    setItems(function (prev) {\n      var newPn = _toConsumableArray(prev.pn);\n\n      newPn[index] = value;\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        pn: newPn\n      });\n    });\n  };\n\n  var addPn = function addPn() {\n    setItems(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        pn: [].concat(_toConsumableArray(prev.pn), [\"\"])\n      });\n    });\n  };\n\n  var handleSnChange = function handleSnChange(index, value) {\n    setItems(function (prev) {\n      var newSn = _toConsumableArray(prev.sn);\n\n      newSn[index] = value;\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        sn: newSn\n      });\n    });\n  };\n\n  var addSn = function addSn() {\n    setItems(function (prev) {\n      return _objectSpread(_objectSpread({}, prev), {}, {\n        sn: [].concat(_toConsumableArray(prev.sn), [\"\"])\n      });\n    });\n  };\n\n  var browseInputRef = useRef(null);\n\n  var handleBrowsePhotos = function handleBrowsePhotos() {\n    if (browseInputRef.current) {\n      browseInputRef.current.click();\n    }\n  };\n\n  var handleFilesSelected = function handleFilesSelected(e) {\n    var files = e.target.files;\n\n    if (files.length) {\n      var newPhotos = [];\n\n      for (var i = 0; i < files.length; i++) {\n        newPhotos.push({\n          file: files[i],\n          url: URL.createObjectURL(files[i])\n        });\n      }\n\n      setPhotos(function (prevPhotos) {\n        return [].concat(_toConsumableArray(prevPhotos), newPhotos);\n      });\n    }\n\n    e.target.value = \"\";\n  };\n\n  var _useState68 = useState(0),\n      currentPnIndex = _useState68[0],\n      setCurrentPnIndex = _useState68[1];\n\n  var _useState69 = useState(false),\n      showDropdown = _useState69[0],\n      setShowDropdown = _useState69[1];\n\n  var _useState70 = useState(0),\n      currentSnIndex = _useState70[0],\n      setCurrentSnIndex = _useState70[1];\n\n  var _useState71 = useState(false),\n      showSnDropdown = _useState71[0],\n      setShowSnDropdown = _useState71[1];\n\n  useEffect(function () {\n    if (showDropdown || showSnDropdown) {\n      loadPnSnOptions();\n    }\n  }, [showDropdown, showSnDropdown]);\n\n  var handleAddNewClient = function handleAddNewClient() {\n    var randomNum = Math.floor(10000 + Math.random() * 90000);\n    router.push(\"../client/AIS\".concat(randomNum, \"/addClient?from=item&itemId=\").concat(id || \"\"));\n  };\n\n  var handleBluefolderButton = /*#__PURE__*/function () {\n    var _ref26 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee17() {\n      var _descriptions$selecte2;\n\n      var currentWorkOrder, payload, response, result;\n      return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n        while (1) {\n          switch (_context17.prev = _context17.next) {\n            case 0:\n              // Check that the work order field is filled out (using workOrders[0].workOrder as current)\n              currentWorkOrder = workOrders && workOrders.length > 0 ? workOrders[0].workOrder : \"\";\n\n              if (currentWorkOrder) {\n                _context17.next = 4;\n                break;\n              }\n\n              alert(\"Please fill out the work order field before adding to BlueFolder.\");\n              return _context17.abrupt(\"return\");\n\n            case 4:\n              // Build the payload to send to your proxy endpoint.\n              payload = {\n                name: items.name,\n                pn: items.pn[0] || \"\",\n                sn: items.sn[0] || \"\",\n                status: items.status,\n                description: ((_descriptions$selecte2 = descriptions[selectedDesc]) === null || _descriptions$selecte2 === void 0 ? void 0 : _descriptions$selecte2.description) || \"\",\n                workOrder: currentWorkOrder,\n                localsn: items.localSN || \"\"\n              };\n              _context17.prev = 5;\n              _context17.next = 8;\n              return fetch(\"https://9d70-174-76-22-138.ngrok-free.app/bluefolder\", {\n                method: \"POST\",\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(payload)\n              });\n\n            case 8:\n              response = _context17.sent;\n              _context17.next = 11;\n              return response.json();\n\n            case 11:\n              result = _context17.sent;\n              alert(\"BlueFolder service item added successfully!\");\n              console.log(\"BlueFolder result:\", result);\n              _context17.next = 20;\n              break;\n\n            case 16:\n              _context17.prev = 16;\n              _context17.t0 = _context17[\"catch\"](5);\n              console.error(\"BlueFolder error:\", _context17.t0);\n              alert(\"Error adding data to BlueFolder.\");\n\n            case 20:\n            case \"end\":\n              return _context17.stop();\n          }\n        }\n      }, _callee17, null, [[5, 16]]);\n    }));\n\n    return function handleBluefolderButton() {\n      return _ref26.apply(this, arguments);\n    };\n  }(); // // Slack integration handler.\n  // const handleAddToSlack = async (which) => {\n  //   try {\n  //     const pn0 = Array.isArray(items.pn) ? items.pn[0] : items.pn;\n  //     const sn0 = Array.isArray(items.sn) ? items.sn[0] : items.sn;\n  //     const linkUrl = typeof window !== \"undefined\" ? window.location.href : \"\";\n  //     const safeName = (items?.name || id || \"Untitled\").trim();\n  //     const title = `${safeName}${id ? ` (${id})` : \"\"}`;\n  //     console.log(\"[SLACK][handleAddToSlack] which:\", which);\n  //     console.log(\"[SLACK] title:\", title);\n  //     console.log(\"[SLACK] PN:\", items.pn, \"SN:\", items.sn);\n  //     const resp = await fetch(\"/api/slack/add-to-list\", {\n  //       method: \"POST\",\n  //       headers: { \"Content-Type\": \"application/json\" },\n  //       body: JSON.stringify({\n  //         listKey: which,      // \"shipping\" | \"receiving\" | \"tasks\"\n  //         title,\n  //         pn: items.pn,\n  //         sn: items.sn,\n  //         // keeping it minimal by design while we stabilize PN/SN\n  //         linkUrl,\n  //       }),\n  //     });\n  // Slack integration handler (drop-in replacement)\n  // Slack integration handler (drop-in replacement)\n  // Slack integration handler (client) — replace your existing handleAddToSlack with this\n\n\n  var handleAddToSlack = /*#__PURE__*/function () {\n    var _ref27 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee18() {\n      var which,\n          _sort$,\n          _ref28,\n          _items$trackingNumber,\n          _json$debug,\n          _json$debug2,\n          safeName,\n          title,\n          pn0,\n          sn0,\n          pn_sn,\n          mostRecentWO,\n          description,\n          tracking,\n          local_sn,\n          photoUrls,\n          resp,\n          json,\n          _args18 = arguments;\n\n      return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n        while (1) {\n          switch (_context18.prev = _context18.next) {\n            case 0:\n              which = _args18.length > 0 && _args18[0] !== undefined ? _args18[0] : \"shipping\";\n              _context18.prev = 1;\n              safeName = ((items === null || items === void 0 ? void 0 : items.name) || id || \"Untitled\").trim();\n              title = \"\".concat(safeName).concat(id ? \" (\".concat(id, \")\") : \"\");\n              pn0 = Array.isArray(items === null || items === void 0 ? void 0 : items.pn) ? items.pn[0] : items === null || items === void 0 ? void 0 : items.pn;\n              sn0 = Array.isArray(items === null || items === void 0 ? void 0 : items.sn) ? items.sn[0] : items === null || items === void 0 ? void 0 : items.sn;\n              pn_sn = [pn0 && \"PN: \".concat(pn0), sn0 && \"SN: \".concat(sn0)].filter(Boolean).join(\"  \");\n              mostRecentWO = workOrders && workOrders.length ? (_sort$ = _toConsumableArray(workOrders).sort(function (a, b) {\n                return new Date((b === null || b === void 0 ? void 0 : b.date) || 0) - new Date((a === null || a === void 0 ? void 0 : a.date) || 0);\n              })[0]) === null || _sort$ === void 0 ? void 0 : _sort$.workOrder : \"\";\n              description = selectedDesc != null && descriptions !== null && descriptions !== void 0 && descriptions[selectedDesc] ? descriptions[selectedDesc].description || \"\" : (items === null || items === void 0 ? void 0 : items.description) || \"\";\n              tracking = (_ref28 = (_items$trackingNumber = items === null || items === void 0 ? void 0 : items.trackingNumber) !== null && _items$trackingNumber !== void 0 ? _items$trackingNumber : items === null || items === void 0 ? void 0 : items.tracking) !== null && _ref28 !== void 0 ? _ref28 : \"\";\n              local_sn = id || (items === null || items === void 0 ? void 0 : items.localSN) || \"\";\n              photoUrls = Array.isArray(photos) ? photos.map(function (p) {\n                return p === null || p === void 0 ? void 0 : p.url;\n              }).filter(Boolean) : [];\n              _context18.next = 14;\n              return fetch(\"/api/slack/add-to-list\", {\n                method: \"POST\",\n                headers: {\n                  \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify({\n                  listKey: which,\n                  title: title,\n                  pn_sn: pn_sn,\n                  // <— server expects this\n                  work_order: mostRecentWO || \"\",\n                  local_sn: local_sn,\n                  tracking: tracking,\n                  description: (description || \"\").trim(),\n                  photoUrls: photoUrls // array of https URLs\n\n                })\n              });\n\n            case 14:\n              resp = _context18.sent;\n              _context18.next = 17;\n              return resp.json();\n\n            case 17:\n              json = _context18.sent;\n              console.log(\"[SLACK][handleAddToSlack] response:\", json);\n              if (json !== null && json !== void 0 && (_json$debug = json.debug) !== null && _json$debug !== void 0 && _json$debug.steps) console.table(json.debug.steps);\n              if (json !== null && json !== void 0 && (_json$debug2 = json.debug) !== null && _json$debug2 !== void 0 && _json$debug2.photos) console.table(json.debug.photos);\n\n              if (!(!resp.ok || !(json !== null && json !== void 0 && json.ok))) {\n                _context18.next = 25;\n                break;\n              }\n\n              setErr(\"Slack add failed: \".concat((json === null || json === void 0 ? void 0 : json.error) || \"unknown error\"));\n              setShowErr(true);\n              return _context18.abrupt(\"return\");\n\n            case 25:\n              alert(\"Added to Slack \".concat(which === \"shipping\" ? \"Shipping\" : which === \"receiving\" ? \"Receiving\" : \"Tasks\", \" list.\"));\n              _context18.next = 33;\n              break;\n\n            case 28:\n              _context18.prev = 28;\n              _context18.t0 = _context18[\"catch\"](1);\n              console.error(_context18.t0);\n              setErr(\"Error adding to Slack\");\n              setShowErr(true);\n\n            case 33:\n            case \"end\":\n              return _context18.stop();\n          }\n        }\n      }, _callee18, null, [[1, 28]]);\n    }));\n\n    return function handleAddToSlack() {\n      return _ref27.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(LoggedIn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1840,\n      columnNumber: 5\n    }\n  }, isLoading && __jsx(\"div\", {\n    className: styles.loadingOverlay,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1842,\n      columnNumber: 9\n    }\n  }, __jsx(\"img\", {\n    src: \"/magmo-logo.png\",\n    alt: \"Loading Magmo\",\n    className: styles.loadingLogo,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1843,\n      columnNumber: 11\n    }\n  })), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1850,\n      columnNumber: 7\n    }\n  }, __jsx(Modal, {\n    show: show,\n    onHide: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1851,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1852,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1853,\n      columnNumber: 13\n    }\n  }, \"Error\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1855,\n      columnNumber: 11\n    }\n  }, \"Missing field\"), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1856,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1857,\n      columnNumber: 13\n    }\n  }, \"Ok\"))), __jsx(Modal, {\n    show: showErr,\n    onHide: handleCloseErr,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1862,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1863,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1864,\n      columnNumber: 13\n    }\n  }, \"Error\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1866,\n      columnNumber: 11\n    }\n  }, Err), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1867,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleCloseErr,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1868,\n      columnNumber: 13\n    }\n  }, \"Ok\"))), __jsx(Modal, {\n    show: showSaveModal,\n    onHide: handleCloseSaveModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1873,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1874,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1875,\n      columnNumber: 13\n    }\n  }, \"Save Confirmation\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1877,\n      columnNumber: 11\n    }\n  }, \"Data has been saved successfully.\"), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1878,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleCloseSaveModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1879,\n      columnNumber: 13\n    }\n  }, \"Ok\"))), __jsx(Modal, {\n    show: showPrintModal,\n    onHide: handleClosePrintModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1884,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1885,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1886,\n      columnNumber: 13\n    }\n  }, \"Print Confirmation\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1888,\n      columnNumber: 11\n    }\n  }, \"Info has been sent to print.\"), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1889,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleClosePrintModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1890,\n      columnNumber: 13\n    }\n  }, \"Ok\"))), __jsx(Modal, {\n    show: showDescModal,\n    onHide: handleCloseDescModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1896,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1897,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1898,\n      columnNumber: 13\n    }\n  }, \"Descriptions\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1900,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    className: \"mb-3\",\n    onClick: addDescription,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1901,\n      columnNumber: 13\n    }\n  }, \"Add Description\"), descriptions.map(function (desc, index) {\n    return __jsx(Row, {\n      key: index,\n      className: \"mb-3\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1905,\n        columnNumber: 15\n      }\n    }, __jsx(Button, {\n      variant: \"outline-secondary\",\n      className: \"w-100\",\n      onClick: function onClick() {\n        return selectDescription(index);\n      },\n      style: {\n        cursor: \"pointer\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1906,\n        columnNumber: 17\n      }\n    }, __jsx(\"div\", {\n      className: \"d-flex justify-content-between\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1912,\n        columnNumber: 19\n      }\n    }, __jsx(\"span\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1913,\n        columnNumber: 21\n      }\n    }, desc.description || \"Description\"), __jsx(\"span\", {\n      style: {\n        borderLeft: \"1px solid #ccc\",\n        paddingLeft: \"10px\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1914,\n        columnNumber: 21\n      }\n    }, desc.date || \"Date\"))));\n  }), __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleCloseDescModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1926,\n      columnNumber: 13\n    }\n  }, \"OK\"))), __jsx(Modal, {\n    show: showWoModal,\n    onHide: handleCloseWoModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1932,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1933,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1934,\n      columnNumber: 13\n    }\n  }, \"Work Orders\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1936,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    className: \"mb-3\",\n    onClick: addWorkOrder,\n    style: {\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1937,\n      columnNumber: 13\n    }\n  }, \"Add Work Order\"), workOrders.map(function (wo, index) {\n    return __jsx(Row, {\n      key: index,\n      className: \"mb-3\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1946,\n        columnNumber: 15\n      }\n    }, __jsx(Col, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1947,\n        columnNumber: 17\n      }\n    }, __jsx(Form.Control, {\n      type: \"text\",\n      placeholder: \"Work Order\",\n      value: wo.workOrder,\n      onChange: function onChange(e) {\n        return handleWorkOrderChange(index, \"workOrder\", e.target.value);\n      },\n      style: {\n        marginBottom: \"0.5rem\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1948,\n        columnNumber: 19\n      }\n    })), __jsx(Col, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1958,\n        columnNumber: 17\n      }\n    }, __jsx(Form.Control, {\n      type: \"date\",\n      placeholder: \"Date\",\n      value: wo.date,\n      onChange: function onChange(e) {\n        return handleWorkOrderChange(index, \"date\", e.target.value);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1959,\n        columnNumber: 19\n      }\n    })), __jsx(Col, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1968,\n        columnNumber: 17\n      }\n    }, __jsx(Button, {\n      variant: \"danger\",\n      onClick: function onClick() {\n        return removeWorkOrder(index);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 1969,\n        columnNumber: 19\n      }\n    }, \"Remove\")));\n  }), __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleCloseWoModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1978,\n      columnNumber: 13\n    }\n  }, \"OK\"))), __jsx(ClientInfoModal, {\n    show: showMachineModal,\n    handleClose: handleCloseMachineModal,\n    selectedClient: selectedClient,\n    machineOptions: machineOptions,\n    setSelectedMachine: handleSetSelectedMachine,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1984,\n      columnNumber: 9\n    }\n  }), __jsx(Modal, {\n    show: showClientModal,\n    onHide: handleCloseClientModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1992,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1993,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1994,\n      columnNumber: 13\n    }\n  }, \"Select Client\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1996,\n      columnNumber: 11\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: search,\n    onChange: function onChange(e) {\n      return setSearch(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1997,\n      columnNumber: 13\n    }\n  }), __jsx(ClientTable, {\n    clients: clients.filter(function (client) {\n      return (client.name || \"\").toLowerCase().includes(search.toLowerCase());\n    }),\n    onSelectClient: handleClientInfo,\n    onInfoClick: handleClientInfo,\n    clearSelection: function clearSelection() {\n      return handleClientInfo(null);\n    },\n    onAddClient: handleAddNewClient,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2004,\n      columnNumber: 13\n    }\n  }))), __jsx(ParentModal, {\n    show: showParentModal,\n    handleClose: handleCloseParentModal,\n    setSelectedParent: setSelectedParent,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2016,\n      columnNumber: 9\n    }\n  }), __jsx(MachineSelectionModal, {\n    show: machineSelectionModal,\n    handleClose: function handleClose() {\n      return setMachineSelectionModal(false);\n    },\n    setMachine: setTheMachine,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2022,\n      columnNumber: 9\n    }\n  }), __jsx(Modal, {\n    show: showCameraModal,\n    onHide: handleCloseCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2028,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2029,\n      columnNumber: 11\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2030,\n      columnNumber: 13\n    }\n  }, \"Take a Photo\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2032,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: \"camera\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2033,\n      columnNumber: 13\n    }\n  }, !capturedPhoto && __jsx(BarcodeScannerComponent, {\n    width: \"100%\",\n    height: 300,\n    onUpdate: handleCapture,\n    facingMode: cameraFacing,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2035,\n      columnNumber: 17\n    }\n  }), capturedPhoto && __jsx(\"div\", {\n    className: \"photo-preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2043,\n      columnNumber: 17\n    }\n  }, __jsx(\"img\", {\n    src: URL.createObjectURL(capturedPhoto),\n    alt: \"captured\",\n    style: {\n      width: \"100%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2044,\n      columnNumber: 19\n    }\n  })))), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2053,\n      columnNumber: 11\n    }\n  }, !capturedPhoto ? __jsx(React.Fragment, null, __jsx(Button, {\n    onClick: capturePhoto,\n    style: {\n      borderRadius: \"50%\",\n      width: \"60px\",\n      height: \"60px\",\n      position: \"absolute\",\n      left: \"50%\",\n      transform: \"translateX(-50%)\",\n      bottom: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2056,\n      columnNumber: 17\n    }\n  }, \"\\uD83D\\uDCF7\"), __jsx(Button, {\n    onClick: function onClick() {\n      return setCameraFacing(function (prev) {\n        return prev === \"environment\" ? \"user\" : \"environment\";\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2070,\n      columnNumber: 17\n    }\n  }, \"Flip Camera\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2079,\n      columnNumber: 17\n    }\n  }, \"Cancel\")) : __jsx(React.Fragment, null, __jsx(Button, {\n    variant: \"secondary\",\n    onClick: function onClick() {\n      return setCapturedPhoto(null);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2085,\n      columnNumber: 17\n    }\n  }, \"Retake\"), __jsx(Button, {\n    variant: \"primary\",\n    onClick: savePhoto,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2091,\n      columnNumber: 17\n    }\n  }, \"OK\")))), __jsx(InfoModal, {\n    show: showInfoModal,\n    handleClose: handleCloseInfoModal,\n    itemName: items.name,\n    dimensions: items.length + \",\" + items.width + \",\" + items.height,\n    price: items.price,\n    freqI: freqItem,\n    freqM: machineFrequency,\n    usage: usagePastYear,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2099,\n      columnNumber: 9\n    }\n  }), __jsx(Container, {\n    fluid: true,\n    className: styles.page,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2110,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: styles.shell,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2111,\n      columnNumber: 11\n    }\n  }, __jsx(Card, {\n    className: styles.card,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2112,\n      columnNumber: 13\n    }\n  }, __jsx(Card.Body, {\n    className: styles.cardBody,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2113,\n      columnNumber: 15\n    }\n  }, __jsx(\"div\", {\n    className: styles.header,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2114,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: styles.kicker,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2115,\n      columnNumber: 19\n    }\n  }, \"Item\"), __jsx(\"h2\", {\n    className: styles.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2116,\n      columnNumber: 19\n    }\n  }, savedName || \"Item Details\"), __jsx(\"div\", {\n    className: styles.subtitle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2119,\n      columnNumber: 19\n    }\n  }, \"Review and update fields, photos, and routing information.\")), __jsx(Form, {\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2123,\n      columnNumber: 17\n    }\n  }, __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2125,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2126,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2127,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2128,\n      columnNumber: 25\n    }\n  }, \"Name\"), __jsx(Form.Control, {\n    type: \"text\",\n    value: items.name,\n    onChange: handleChange(\"name\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2129,\n      columnNumber: 25\n    }\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2136,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"pn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2137,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2138,\n      columnNumber: 25\n    }\n  }, \"Product Number\"), __jsx(\"div\", {\n    style: {\n      position: \"relative\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2139,\n      columnNumber: 25\n    }\n  }, __jsx(InputGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2140,\n      columnNumber: 27\n    }\n  }, __jsx(Form.Control, {\n    type: \"text\",\n    value: items.pn[currentPnIndex] || \"\",\n    onChange: function onChange(e) {\n      return handlePnChange(currentPnIndex, e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2141,\n      columnNumber: 29\n    }\n  }), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      return setShowDropdown(!showDropdown);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2148,\n      columnNumber: 29\n    }\n  }, \"\\u25BE\"), __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2154,\n      columnNumber: 29\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      return setAddingNewPn(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2155,\n      columnNumber: 31\n    }\n  }, \"+\"))), showDropdown && __jsx(\"div\", {\n    style: {\n      position: \"absolute\",\n      top: \"100%\",\n      left: 0,\n      right: 0,\n      backgroundColor: \"white\",\n      border: \"1px solid #ccc\",\n      zIndex: 1000,\n      maxHeight: \"150px\",\n      overflowY: \"auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2164,\n      columnNumber: 29\n    }\n  }, pnOptions.map(function (pnOption, idx) {\n    return __jsx(\"div\", {\n      key: idx,\n      style: {\n        padding: \"8px\",\n        cursor: \"pointer\"\n      },\n      onClick: function onClick() {\n        setCurrentPnIndex(idx);\n        setShowDropdown(false);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 2178,\n        columnNumber: 33\n      }\n    }, pnOption);\n  }))), addingNewPn && __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Enter new PN\",\n    value: newPn,\n    onChange: function onChange(e) {\n      return setNewPn(e.target.value);\n    },\n    onBlur: handleAddNewPn,\n    onKeyDown: function onKeyDown(e) {\n      return e.key === \"Enter\" && handleAddNewPn();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2193,\n      columnNumber: 27\n    }\n  })))), __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2208,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2209,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"sn\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2210,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2211,\n      columnNumber: 25\n    }\n  }, \"Serial Number\"), __jsx(\"div\", {\n    style: {\n      position: \"relative\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2212,\n      columnNumber: 25\n    }\n  }, __jsx(InputGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2213,\n      columnNumber: 27\n    }\n  }, __jsx(Form.Control, {\n    type: \"text\",\n    value: items.sn[currentSnIndex] || \"\",\n    onChange: function onChange(e) {\n      return handleSnChange(currentSnIndex, e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2214,\n      columnNumber: 29\n    }\n  }), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      return setShowSnDropdown(!showSnDropdown);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2221,\n      columnNumber: 29\n    }\n  }, \"\\u25BE\"), __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2227,\n      columnNumber: 29\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      return setAddingNewSn(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2228,\n      columnNumber: 31\n    }\n  }, \"+\"))), showSnDropdown && __jsx(\"div\", {\n    style: {\n      position: \"absolute\",\n      top: \"100%\",\n      left: 0,\n      right: 0,\n      backgroundColor: \"white\",\n      border: \"1px solid #ccc\",\n      zIndex: 1000,\n      maxHeight: \"150px\",\n      overflowY: \"auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2237,\n      columnNumber: 29\n    }\n  }, snOptions.map(function (snOption, idx) {\n    return __jsx(\"div\", {\n      key: idx,\n      style: {\n        padding: \"8px\",\n        cursor: \"pointer\"\n      },\n      onClick: function onClick() {\n        setCurrentSnIndex(idx);\n        setShowSnDropdown(false);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 2251,\n        columnNumber: 33\n      }\n    }, snOption);\n  }))), addingNewSn && __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Enter new SN\",\n    value: newSn,\n    onChange: function onChange(e) {\n      return setNewSn(e.target.value);\n    },\n    onBlur: handleAddNewSn,\n    onKeyDown: function onKeyDown(e) {\n      return e.key === \"Enter\" && handleAddNewSn();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2266,\n      columnNumber: 27\n    }\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2279,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"status\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2280,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2281,\n      columnNumber: 25\n    }\n  }, \"Status\"), __jsx(Form.Select, {\n    value: items.status || \"\",\n    onChange: handleChange(\"status\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2282,\n      columnNumber: 25\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2286,\n      columnNumber: 27\n    }\n  }, \"Select status\"), __jsx(\"option\", {\n    value: \"Good\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2287,\n      columnNumber: 27\n    }\n  }, \"Good\"), __jsx(\"option\", {\n    value: \"Bad\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2288,\n      columnNumber: 27\n    }\n  }, \"Bad\"), __jsx(\"option\", {\n    value: \"Unknown\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2289,\n      columnNumber: 27\n    }\n  }, \"Unknown\"))))), __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2295,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2296,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"localSN\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2297,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2298,\n      columnNumber: 25\n    }\n  }, \"Local SN\"), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Enter Local SN\",\n    value: items.localSN || \"\",\n    onChange: handleChange(\"localSN\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2299,\n      columnNumber: 25\n    }\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2307,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"arrivalDate\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2308,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2309,\n      columnNumber: 25\n    }\n  }, \"Arrival Date\"), __jsx(Form.Control, {\n    placeholder: \"Enter Arrival Date\",\n    type: \"date\",\n    value: items.arrival_date,\n    onChange: function onChange(e) {\n      var value = e.target.value;\n      setItems(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          arrival_date: value\n        });\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2310,\n      columnNumber: 25\n    }\n  }))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2324,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"trackingNumber\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2325,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2326,\n      columnNumber: 25\n    }\n  }, \"Tracking Number\"), __jsx(Form.Control, {\n    placeholder: \"Tracking Number\",\n    type: \"text\",\n    value: items.trackingNumber,\n    onChange: handleChange(\"trackingNumber\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2327,\n      columnNumber: 25\n    }\n  })))), __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2337,\n      columnNumber: 19\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2338,\n      columnNumber: 21\n    }\n  }, __jsx(MultiSelectDropdown, {\n    label: \"OEM\",\n    placeholder: trackerLoading ? \"Loading...\" : \"Select OEM\",\n    options: allOemOptions,\n    selected: selectedOems,\n    onChange: setSelectedOems,\n    enableDelete: true,\n    onDeleteOption: handleDeleteOemOption,\n    disabled: trackerLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2339,\n      columnNumber: 23\n    }\n  })), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2350,\n      columnNumber: 21\n    }\n  }, __jsx(MultiSelectDropdown, {\n    label: \"Modality\",\n    placeholder: trackerLoading ? \"Loading...\" : \"Select Modality\",\n    options: trackerCatalog.modalities,\n    selected: selectedModalities,\n    onChange: setSelectedModalities,\n    disabled: trackerLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2351,\n      columnNumber: 23\n    }\n  })), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2360,\n      columnNumber: 21\n    }\n  }, __jsx(MultiSelectDropdown, {\n    label: \"Model\",\n    placeholder: selectedModalities.length && selectedOems.length ? \"Select Model\" : \"Select Modality + OEM\",\n    options: modelOptions,\n    selected: selectedModels,\n    onChange: setSelectedModels,\n    enableDelete: true,\n    onDeleteOption: handleDeleteModelOption,\n    disabled: trackerLoading || !selectedModalities.length || !selectedOems.length,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2361,\n      columnNumber: 23\n    }\n  }))), __jsx(\"div\", {\n    style: {\n      marginBottom: \"1rem\",\n      marginTop: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2382,\n      columnNumber: 19\n    }\n  }, __jsx(\"div\", {\n    className: \"d-flex align-items-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2383,\n      columnNumber: 21\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleShowWoModal,\n    className: \"me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2384,\n      columnNumber: 23\n    }\n  }, \"Manage Work Orders\"), workOrders.length > 0 && __jsx(\"div\", {\n    className: \"d-flex flex-column align-items-start\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2392,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2393,\n      columnNumber: 27\n    }\n  }, \"Work Order\"), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Most Recent Work Order\",\n    value: mostRecentWorkOrder.workOrder,\n    onChange: function onChange(e) {\n      return handleWorkOrderChange(workOrders.indexOf(mostRecentWorkOrder), \"workOrder\", e.target.value);\n    },\n    style: {\n      marginBottom: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2394,\n      columnNumber: 27\n    }\n  }), __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2407,\n      columnNumber: 27\n    }\n  }, \"Date\"), __jsx(Form.Control, {\n    type: \"date\",\n    placeholder: \"Work Order Date\",\n    value: mostRecentWorkOrder.date,\n    onChange: function onChange(e) {\n      return handleWorkOrderChange(workOrders.indexOf(mostRecentWorkOrder), \"date\", e.target.value);\n    },\n    style: {\n      marginBottom: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2408,\n      columnNumber: 27\n    }\n  }))), __jsx(\"div\", {\n    style: {\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2424,\n      columnNumber: 21\n    }\n  }, __jsx(Form.Group, {\n    controlId: \"desc\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2425,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: listDescriptions,\n    className: \"mb-2 me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2426,\n      columnNumber: 25\n    }\n  }, \"List Descriptions\"), __jsx(Form.Control, {\n    as: \"textarea\",\n    rows: 3,\n    placeholder: \"Enter description\",\n    value: ((_descriptions$selecte3 = descriptions[selectedDesc]) === null || _descriptions$selecte3 === void 0 ? void 0 : _descriptions$selecte3.description) || \"\",\n    onChange: function onChange(e) {\n      return handleDescriptionChange(selectedDesc, \"description\", e.target.value);\n    },\n    style: {\n      marginBottom: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2433,\n      columnNumber: 25\n    }\n  }), __jsx(Form.Control, {\n    type: \"date\",\n    value: ((_descriptions$selecte4 = descriptions[selectedDesc]) === null || _descriptions$selecte4 === void 0 ? void 0 : _descriptions$selecte4.date) || \"\",\n    onChange: function onChange(e) {\n      return handleDescriptionChange(selectedDesc, \"date\", e.target.value);\n    },\n    style: {\n      marginTop: \"0.5rem\",\n      marginBottom: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2447,\n      columnNumber: 25\n    }\n  })))), __jsx(\"div\", {\n    style: {\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2466,\n      columnNumber: 19\n    }\n  }, __jsx(Row, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2467,\n      columnNumber: 21\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2468,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      setMachinePick(true);\n      handleShowClientModal();\n    },\n    className: \"me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2469,\n      columnNumber: 25\n    }\n  }, \"Select From\"), selectedClientFrom && __jsx(\"div\", {\n    style: {\n      border: \"1px solid #ccc\",\n      padding: \"0.75rem\",\n      borderRadius: \"4px\",\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2480,\n      columnNumber: 27\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2488,\n      columnNumber: 29\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2489,\n      columnNumber: 31\n    }\n  }, \"Selected Client (From):\"), \" \", selectedClientFrom.name), __jsx(\"div\", {\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2492,\n      columnNumber: 29\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      return setShowMachineModal(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2493,\n      columnNumber: 31\n    }\n  }, \"Select Machine for \", selectedClientFrom.name), selectedMachine && __jsx(React.Fragment, null, __jsx(\"p\", {\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2501,\n      columnNumber: 35\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2502,\n      columnNumber: 37\n    }\n  }, \"Selected Machine (From):\"), \" \", selectedMachine.name), showLocalLocFrom && __jsx(React.Fragment, null, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      return setShowNewLocalModalFrom(true);\n    },\n    className: \"w-100 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2507,\n      columnNumber: 39\n    }\n  }, [newLocalFrom.region, ((_newLocalFrom$section = newLocalFrom.section) === null || _newLocalFrom$section === void 0 ? void 0 : _newLocalFrom$section.letter) + ((_newLocalFrom$section2 = newLocalFrom.section) === null || _newLocalFrom$section2 === void 0 ? void 0 : _newLocalFrom$section2.number), newLocalFrom.bin && \"B\".concat(newLocalFrom.bin), newLocalFrom.pallet && \"P\".concat(newLocalFrom.pallet)].filter(Boolean).join(\"-\")), __jsx(Modal, {\n    show: showNewLocalModalFrom,\n    onHide: function onHide() {\n      return setShowNewLocalModalFrom(false);\n    },\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2529,\n      columnNumber: 39\n    }\n  }, __jsx(Modal.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2536,\n      columnNumber: 41\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2537,\n      columnNumber: 43\n    }\n  }, \"Edit Local Loc (From)\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2541,\n      columnNumber: 41\n    }\n  }, __jsx(NewLocal, {\n    selectedClient: selectedClientFrom,\n    showLocalLoc: showNewLocalModalFrom,\n    value: newLocalFrom,\n    onChange: setNewLocalFrom,\n    onSave: function onSave(p) {\n      setNewLocalFrom(p);\n      setShowNewLocalModalFrom(false);\n    },\n    onCancel: function onCancel() {\n      return setShowNewLocalModalFrom(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2542,\n      columnNumber: 43\n    }\n  })))))))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2573,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      setMachinePick(false);\n      handleShowClientModal();\n    },\n    className: \"me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2574,\n      columnNumber: 25\n    }\n  }, \"Select Current\"), selectedClientCurrent && __jsx(\"div\", {\n    style: {\n      border: \"1px solid #ccc\",\n      padding: \"0.75rem\",\n      borderRadius: \"4px\",\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2585,\n      columnNumber: 27\n    }\n  }, __jsx(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2593,\n      columnNumber: 29\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2594,\n      columnNumber: 31\n    }\n  }, \"Selected Client (Current):\"), \" \", selectedClientCurrent.name), __jsx(\"div\", {\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2597,\n      columnNumber: 29\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      return setShowMachineModal(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2598,\n      columnNumber: 31\n    }\n  }, \"Select Machine for \", selectedClientCurrent.name), selectedCurrentMachine && __jsx(React.Fragment, null, __jsx(\"p\", {\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2606,\n      columnNumber: 35\n    }\n  }, __jsx(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2607,\n      columnNumber: 37\n    }\n  }, \"Selected Machine (Current):\"), \" \", selectedCurrentMachine.name), showLocalLocCurrent && __jsx(React.Fragment, null, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: function onClick() {\n      return setShowNewLocalModalCurrent(true);\n    },\n    className: \"w-100 mb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2612,\n      columnNumber: 39\n    }\n  }, [newLocalCurrent.region, ((_newLocalCurrent$sect = newLocalCurrent.section) === null || _newLocalCurrent$sect === void 0 ? void 0 : _newLocalCurrent$sect.letter) + ((_newLocalCurrent$sect2 = newLocalCurrent.section) === null || _newLocalCurrent$sect2 === void 0 ? void 0 : _newLocalCurrent$sect2.number), newLocalCurrent.bin && \"B\".concat(newLocalCurrent.bin), newLocalCurrent.pallet && \"P\".concat(newLocalCurrent.pallet)].filter(Boolean).join(\"-\")), __jsx(Modal, {\n    show: showNewLocalModalCurrent,\n    onHide: function onHide() {\n      return setShowNewLocalModalCurrent(false);\n    },\n    centered: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2631,\n      columnNumber: 39\n    }\n  }, __jsx(Modal.Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2638,\n      columnNumber: 41\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2639,\n      columnNumber: 43\n    }\n  }, \"Edit Local Loc (Current)\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2643,\n      columnNumber: 41\n    }\n  }, __jsx(NewLocal, {\n    selectedClient: selectedClientCurrent,\n    showLocalLoc: showNewLocalModalCurrent,\n    value: newLocalCurrent,\n    onChange: setNewLocalCurrent,\n    onSave: function onSave(p) {\n      setNewLocalCurrent(p);\n      setShowNewLocalModalCurrent(false);\n    },\n    onCancel: function onCancel() {\n      return setShowNewLocalModalCurrent(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2644,\n      columnNumber: 43\n    }\n  })))))))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2681,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleShowParentModal,\n    className: \"me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2682,\n      columnNumber: 25\n    }\n  }, \"Select Parent\"), selectedParent && __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"Selected Parent\",\n    value: selectedParent.name,\n    readOnly: true,\n    style: {\n      marginTop: \"0.5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2690,\n      columnNumber: 27\n    }\n  })))), __jsx(\"div\", {\n    style: {\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2702,\n      columnNumber: 19\n    }\n  }, __jsx(Row, {\n    className: \"mb-3 \".concat(styles.photoActionsRow),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2703,\n      columnNumber: 21\n    }\n  }, __jsx(Col, {\n    xs: 12,\n    md: 6,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2704,\n      columnNumber: 23\n    }\n  }, __jsx(ButtonGroup, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2705,\n      columnNumber: 25\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleShowCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2706,\n      columnNumber: 27\n    }\n  }, \"Take Photo\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleBrowsePhotos,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2712,\n      columnNumber: 27\n    }\n  }, \"Browse\"))), __jsx(Col, {\n    xs: 12,\n    md: 6,\n    className: styles.photoActionsRight,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2720,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"success\",\n    onClick: handleSendToInflow,\n    style: {\n      marginLeft: \"auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2721,\n      columnNumber: 25\n    }\n  }, \"Send to inFlow\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleBluefolderButton,\n    style: {\n      marginLeft: \"0.5rem\",\n      marginRight: \".5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2728,\n      columnNumber: 25\n    }\n  }, \"BlueFolder\"), __jsx(Button, {\n    variant: addToWebsite ? \"primary\" : \"outline-primary\",\n    onClick: function onClick() {\n      return setAddToWebsite(function (prev) {\n        return !prev;\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2737,\n      columnNumber: 25\n    }\n  }, addToWebsite ? \"✓ Add to Website\" : \"Add to Website\"), __jsx(Form.Check, {\n    type: \"checkbox\",\n    id: \"hide-checkbox\",\n    label: \"Hide\" // box is checked when we want visible = false\n    ,\n    checked: !items.visible,\n    onChange: function onChange(e) {\n      // grab checked immediately\n      var isHidden = e.currentTarget.checked;\n      setItems(function (prev) {\n        return _objectSpread(_objectSpread({}, prev), {}, {\n          visible: !isHidden\n        });\n      });\n    },\n    className: \"ms-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2744,\n      columnNumber: 25\n    }\n  }))), __jsx(\"input\", {\n    type: \"file\",\n    accept: \"image/*\",\n    multiple: true,\n    ref: browseInputRef,\n    style: {\n      display: \"none\"\n    },\n    onChange: handleFilesSelected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2762,\n      columnNumber: 21\n    }\n  })), photos && photos.length > 0 && __jsx(\"div\", {\n    className: \"photo-gallery\",\n    style: {\n      display: \"flex\",\n      flexWrap: \"wrap\",\n      gap: \"10px\",\n      marginBottom: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2773,\n      columnNumber: 21\n    }\n  }, photos.map(function (photo, index) {\n    return __jsx(\"div\", {\n      key: index,\n      style: {\n        position: \"relative\",\n        width: \"100px\",\n        height: \"100px\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 2783,\n        columnNumber: 25\n      }\n    }, __jsx(\"img\", {\n      src: photo.url,\n      alt: \"Photo \".concat(index + 1),\n      style: {\n        width: \"100%\",\n        height: \"100%\",\n        objectFit: \"cover\"\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 2791,\n        columnNumber: 27\n      }\n    }), photo.file && __jsx(Button, {\n      variant: \"danger\",\n      size: \"sm\",\n      style: {\n        position: \"absolute\",\n        top: 0,\n        right: 0,\n        padding: \"0 5px\"\n      },\n      onClick: function onClick() {\n        return removePhoto(index);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 2801,\n        columnNumber: 29\n      }\n    }, \"x\"));\n  })), __jsx(\"div\", {\n    className: \"mt-3 d-flex flex-wrap align-items-center \".concat(styles.actionRow),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2820,\n      columnNumber: 19\n    }\n  }, __jsx(Button, {\n    variant: \"primary\",\n    type: \"submit\",\n    style: {\n      marginRight: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2821,\n      columnNumber: 21\n    }\n  }, \"Save\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleCloneToNewItem,\n    style: {\n      marginRight: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2828,\n      columnNumber: 21\n    }\n  }, \"Clone\"), __jsx(LoadingButton, {\n    type: \"primary\",\n    name: \"Back\",\n    route: \"NewSearch/mainSearch\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2835,\n      columnNumber: 21\n    }\n  }), SHOW_SLACK_BUTTONS && __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      marginLeft: \".5rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2841,\n      columnNumber: 23\n    }\n  }, __jsx(\"span\", {\n    style: {\n      fontSize: 12,\n      lineHeight: \"12px\",\n      textAlign: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2842,\n      columnNumber: 25\n    }\n  }, \"Slack\"), __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      border: \"1px solid #ced4da\",\n      borderRadius: 6,\n      overflow: \"hidden\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2843,\n      columnNumber: 25\n    }\n  }, __jsx(Button, {\n    variant: \"outline-primary\",\n    onClick: function onClick() {\n      return handleAddToSlack(\"receiving\");\n    },\n    style: {\n      border: \"none\",\n      borderRight: \"1px solid #ced4da\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2844,\n      columnNumber: 27\n    }\n  }, \"Receiving\"), __jsx(Button, {\n    variant: \"outline-primary\",\n    onClick: function onClick() {\n      return handleAddToSlack(\"shipping\");\n    },\n    style: {\n      border: \"none\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2851,\n      columnNumber: 27\n    }\n  }, \"Shipping\"))), __jsx(Button, {\n    variant: \"info\",\n    onClick: handlePrint,\n    style: {\n      marginLeft: \"auto\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2867,\n      columnNumber: 21\n    }\n  }, \"Print Label\")), __jsx(\"div\", {\n    style: {\n      textAlign: \"center\",\n      margin: \"1rem 0\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2875,\n      columnNumber: 19\n    }\n  }, __jsx(Button, {\n    variant: \"link\",\n    style: {\n      textDecoration: \"none\",\n      color: \"black\",\n      fontSize: \"24px\"\n    },\n    onClick: function onClick() {\n      return setShowExtra(!showExtra);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2876,\n      columnNumber: 21\n    }\n  }, \"\\u25BC\")), __jsx(Collapse, {\n    \"in\": showExtra,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2888,\n      columnNumber: 19\n    }\n  }, __jsx(\"div\", {\n    id: \"extra-collapse\",\n    className: \"mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2889,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: \"d-flex justify-content-end mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2890,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleShowInfoModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2891,\n      columnNumber: 25\n    }\n  }, \"More Info\")), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2895,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Group, {\n    as: Col,\n    controlId: \"dimensions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2896,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2897,\n      columnNumber: 27\n    }\n  }, \"Dimensions\"), __jsx(\"div\", {\n    style: {\n      display: \"flex\",\n      alignItems: \"center\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2898,\n      columnNumber: 27\n    }\n  }, __jsx(Form.Control, {\n    placeholder: \"Length\",\n    type: \"text\",\n    value: items.length,\n    onChange: handleChange(\"length\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2901,\n      columnNumber: 29\n    }\n  }), __jsx(\"span\", {\n    style: {\n      padding: \"0 5px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2907,\n      columnNumber: 29\n    }\n  }, \"x\"), __jsx(Form.Control, {\n    placeholder: \"Width\",\n    type: \"text\",\n    value: items.width,\n    onChange: handleChange(\"width\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2908,\n      columnNumber: 29\n    }\n  }), __jsx(\"span\", {\n    style: {\n      padding: \"0 5px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2914,\n      columnNumber: 29\n    }\n  }, \"x\"), __jsx(Form.Control, {\n    placeholder: \"Height\",\n    type: \"text\",\n    value: items.height,\n    onChange: handleChange(\"height\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2915,\n      columnNumber: 29\n    }\n  })))), __jsx(Row, {\n    className: \"mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2925,\n      columnNumber: 23\n    }\n  }, __jsx(Form.Group, {\n    as: Col,\n    controlId: \"Price\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2926,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2927,\n      columnNumber: 27\n    }\n  }, \"Price\"), __jsx(Form.Control, {\n    placeholder: \"Price\",\n    type: \"text\",\n    value: items.price,\n    onChange: handleChange(\"price\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2928,\n      columnNumber: 27\n    }\n  })), __jsx(Form.Group, {\n    as: Col,\n    controlId: \"DOM\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2935,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2936,\n      columnNumber: 27\n    }\n  }, \"DOM\"), __jsx(Form.Control, {\n    placeholder: \"Date of Manufacture\",\n    type: \"date\",\n    value: DOM,\n    onChange: function onChange(e) {\n      return setDOM(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2937,\n      columnNumber: 27\n    }\n  })), __jsx(Form.Group, {\n    as: Col,\n    controlId: \"poNumber\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2944,\n      columnNumber: 25\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2945,\n      columnNumber: 27\n    }\n  }, \"PO Number\"), __jsx(Form.Control, {\n    type: \"text\",\n    placeholder: \"PO Number\",\n    value: items.poNumber || \"\",\n    onChange: handleChange(\"poNumber\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2946,\n      columnNumber: 27\n    }\n  }))))))))))), __jsx(Modal, {\n    show: showCameraModal,\n    onHide: handleCloseCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2962,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2963,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2964,\n      columnNumber: 11\n    }\n  }, \"Take a Photo\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2966,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"camera\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2967,\n      columnNumber: 11\n    }\n  }, !capturedPhoto ? __jsx(BarcodeScannerComponent, {\n    width: \"100%\",\n    height: 300,\n    onUpdate: handleCapture,\n    facingMode: cameraFacing,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2969,\n      columnNumber: 15\n    }\n  }) : __jsx(\"div\", {\n    className: \"photo-preview\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2976,\n      columnNumber: 15\n    }\n  }, __jsx(\"img\", {\n    src: URL.createObjectURL(capturedPhoto),\n    alt: \"captured\",\n    style: {\n      width: \"100%\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2977,\n      columnNumber: 17\n    }\n  })))), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2986,\n      columnNumber: 9\n    }\n  }, !capturedPhoto ? __jsx(React.Fragment, null, __jsx(Button, {\n    onClick: capturePhoto,\n    style: {\n      borderRadius: \"50%\",\n      width: \"60px\",\n      height: \"60px\",\n      position: \"absolute\",\n      left: \"50%\",\n      transform: \"translateX(-50%)\",\n      bottom: \"10px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 2989,\n      columnNumber: 15\n    }\n  }, \"\\uD83D\\uDCF7\"), __jsx(Button, {\n    onClick: function onClick() {\n      return setCameraFacing(function (prev) {\n        return prev === \"environment\" ? \"user\" : \"environment\";\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 3003,\n      columnNumber: 15\n    }\n  }, \"Flip Camera\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseCameraModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 3012,\n      columnNumber: 15\n    }\n  }, \"Cancel\")) : __jsx(React.Fragment, null, __jsx(Button, {\n    variant: \"secondary\",\n    onClick: function onClick() {\n      return setCapturedPhoto(null);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 3018,\n      columnNumber: 15\n    }\n  }, \"Retake\"), __jsx(Button, {\n    variant: \"primary\",\n    onClick: savePhoto,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 3024,\n      columnNumber: 15\n    }\n  }, \"OK\")))));\n}\n\n_s2(DisplayItemInner, \"OsxwjCY/iaX1Gk42BDgGnw0LPrc=\", false, function () {\n  return [useRouter, useAuth];\n});\n\n_c4 = DisplayItemInner;\nexport var __N_SSP = true;\nexport default function DisplayItemPage(props) {\n  _s3();\n\n  var _router$query, _props$initialItem;\n\n  var router = useRouter();\n  var idFromRouter = (_router$query = router.query) === null || _router$query === void 0 ? void 0 : _router$query.id;\n  var key = (props === null || props === void 0 ? void 0 : (_props$initialItem = props.initialItem) === null || _props$initialItem === void 0 ? void 0 : _props$initialItem.id) || idFromRouter || \"new-item\";\n  return __jsx(DisplayItemInner, _extends({}, props, {\n    key: key,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 3039,\n      columnNumber: 10\n    }\n  }));\n} // Server-side rendering function\n\n_s3(DisplayItemPage, \"fN7XvhJ+p5oE6+Xlo0NJmXpxjC8=\", false, function () {\n  return [useRouter];\n});\n\n_c5 = DisplayItemPage;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"BarcodeScannerComponent$dynamic\");\n$RefreshReg$(_c2, \"BarcodeScannerComponent\");\n$RefreshReg$(_c3, \"LoadingButton\");\n$RefreshReg$(_c4, \"DisplayItemInner\");\n$RefreshReg$(_c5, \"DisplayItemPage\");","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/NewSearch/item/[id]/index.js"],"names":["React","useEffect","useState","useRef","useCallback","useMemo","Form","Button","Card","Container","Row","Col","Modal","FormControl","Collapse","InputGroup","ButtonGroup","Link","useAuth","firebase","LoggedIn","useRouter","fetchClients","ClientTable","ClientInfoModal","ParentModal","dynamic","InfoModal","MachineSelectionModal","addServiceItem","NewLocal","styles","InflowAPI","buildLocalLocObject","formatLoc","updateMachineFields","buildNameTokens","MultiSelectDropdown","fetchTrackerCatalog","buildAllOems","buildModelsForSelection","syncTrackerFromSelections","deleteTrackerOem","deleteTrackerModel","BarcodeScannerComponent","ssr","simulateNetworkRequest","Promise","resolve","setTimeout","LoadingButton","type","name","route","isLoading","setLoading","cancelled","then","handleClick","isValidMachineValue","value","Array","isArray","some","v","trimmed","String","trim","toLowerCase","Boolean","normalizeSelection","map","filter","normalized","uniqueSelection","values","from","Set","selectionToStoredValue","cleaned","length","selectionToPrintValue","pickPreferredCase","current","incoming","hasUpper","test","currentUpper","incomingUpper","buildCaseMap","forEach","key","DisplayItemInner","initialItem","initialMachineData","error","SHOW_SLACK_BUTTONS","process","env","NEXT_PUBLIC_SHOW_SLACK_BUTTONS","router","signOut","idFromRouter","query","id","initialId","pn","sn","price","status","width","height","poNumber","trackingNumber","localSN","arrival_date","visible","items","setItems","savedName","setSavedName","setDescriptions","descriptions","setWorkOrders","workOrders","setDOM","DOM","prev","region","section","letter","number","bin","pallet","newLocalFrom","setNewLocalFrom","newLocalCurrent","setNewLocalCurrent","selectedClientFrom","setSelectedClientFrom","selectedClientCurrent","setSelectedClientCurrent","selectedMachine","setSelectedMachine","selectedCurrentMachine","setSelectedCurrentMachine","pnOptions","setPnOptions","snOptions","setSnOptions","pnSnLoaded","setPnSnLoaded","pnSnLoading","setPnSnLoading","description","date","workOrder","clients","setClients","clientsLoaded","setClientsLoaded","clientsLoading","setClientsLoading","photos","setPhotos","show","setShow","showErr","setShowErr","Err","setErr","showDescModal","setShowDescModal","showWoModal","setShowWoModal","showClientModal","setShowClientModal","showMachineModal","setShowMachineModal","showParentModal","setShowParentModal","showCameraModal","setShowCameraModal","showSaveModal","setShowSaveModal","showPrintModal","setShowPrintModal","machineSelectionModal","setMachineSelectionModal","selectedDesc","setSelectedDesc","selectedClient","setSelectedClient","selectedParent","setSelectedParent","TheMachine","setTheMachine","machineOptions","setMachineOptions","search","setSearch","capturedPhoto","setCapturedPhoto","cameraFacing","setCameraFacing","addToWebsite","setAddToWebsite","machinePick","setMachinePick","freqItem","setFreqItem","usagePastYear","setUsagePastYear","machineFrequency","setMachineFrequency","showExtra","setShowExtra","modalities","oemsByModality","modelsByModalityOem","meta","trackerCatalog","setTrackerCatalog","trackerLoading","setTrackerLoading","localLocFrom","setLocalLocFrom","localLocCurrent","setLocalLocCurrent","selectedModalities","setSelectedModalities","selectedOems","setSelectedOems","selectedModels","setSelectedModels","applyMergedMachineFields","merged","oem","modality","model","showInfoModal","setShowInfoModal","itemName","setItemName","machineFieldsInitialized","setMachineFieldsInitialized","setIsLoading","showLocalModalFrom","setShowLocalModalFrom","showLocalModalCurrent","setShowLocalModalCurrent","openLocalModalFrom","closeLocalModalFrom","openLocalModalCurrent","closeLocalModalCurrent","showNewLocalModalFrom","setShowNewLocalModalFrom","showNewLocalModalCurrent","setShowNewLocalModalCurrent","handleSendToInflow","alert","imageUrls","p","url","sku","toString","toCSV","arr","join","arrivalISO","Date","toISOString","slice","pnStr","snStr","mostRecentWO","reduce","latest","cur","customFields","custom1","custom2","custom3","custom4","custom5","custom6","custom7","custom8","custom9","custom10","console","log","upsertProduct","created","productId","message","setShowLocalLocFrom","setShowLocalLocCurrent","loadClients","clientsData","loadTracker","force","catalog","allOemOptions","modelOptions","selections","oems","models","updated","handleDeleteOemOption","handleDeleteModelOption","ops","modalityValue","oemValue","push","allSettled","loadPnSnOptions","db","firestore","collection","orderBy","FieldPath","documentId","limit","get","snapshot","pnSet","snSet","doc","data","add","fetchData","resolveClientFromMachine","machineRef","setClient","setMachine","isFrom","machineDoc","exists","machineData","client","clientDoc","clientName","isSocalInterior","shouldShow","normalizedPN","normalizedSN","ClientFrom","clientFromDoc","ClientCurrent","clientCurrentDoc","Machine","CurrentMachine","machineFromData","machineCurrentData","MachineFrom","MachineCurrent","nameFrom","nameCurrent","theMachineData","OEM","Modality","Model","Parent","parentDoc","all","fetchPhotos","checkIfAddedToWebsite","calculateItemFrequencyAndUsage","err","pathname","signal","currentDate","oneYearAgo","setFullYear","getFullYear","undefined","where","itemsSnapshot","size","itemData","workOrderDate","fetchMachine","machineId","machinesSnapshot","docID","storageRef","storage","ref","listRef","child","listAll","res","item","getDownloadURL","urls","file","partsDoc","handleClose","handleShow","handleCloseErr","handleShowErr","handleCloseSaveModal","handleClosePrintModal","handleShowSaveModal","handleShowPrintModal","handleMachineSelectionModal","handleCloseDescModal","handleShowDescModal","handleCloseWoModal","handleShowWoModal","handleCloseClientModal","handleShowClientModal","handleCloseMachineModal","handleShowMachineModal","handleCloseParentModal","handleShowParentModal","handleClientInfo","clientId","clientData","machinePromises","machines","machineDocs","reorderArray","selectedValue","newArr","val","addingNewPn","setAddingNewPn","newPn","setNewPn","addingNewSn","setAddingNewSn","newSn","setNewSn","handlePnSelect","e","selected","target","updatedPn","handleSnSelect","updatedSn","handleAddNewPn","handleAddNewSn","generateCustomID","randomNum","Math","floor","random","shallowClean","obj","newObj","hasOwnProperty","toSend","currentUser","auth","userEmail","email","storedOem","storedModality","storedModel","formattedItems","nameLower","nameTokens","addedToWebsite","lastEdited","fromDetails","currentDetails","Object","keys","docId","newDocId","set","update","associatedParts","FieldValue","arrayUnion","currentMachineRef","currentMachineDoc","cleanFormattedItems","uploadPhotos","showLocalLocFrom","showLocalLocCurrent","handleSetSelectedMachine","machine","i","photoRef","metadata","contentType","put","handlePrint","warn","payload","wo","local_sn","dateCreated","fetch","method","headers","body","JSON","stringify","response","json","result","includes","handleSubmit","event","preventDefault","handleChange","field","prevItems","addDescription","removeDescription","index","_","handleDescriptionChange","newDescriptions","desc","addWorkOrder","removeWorkOrder","handleWorkOrderChange","newWorkOrders","listDescriptions","selectDescription","handleShowCameraModal","handleCloseCameraModal","handleCapture","savePhoto","prevPhotos","URL","createObjectURL","removePhoto","mostRecentWorkOrder","latestDate","capturePhoto","video","document","querySelector","canvas","createElement","videoWidth","videoHeight","context","getContext","drawImage","toBlob","blob","handleShowInfoModal","handleCloseInfoModal","handleCloneToNewItem","encodeURIComponent","handlePnChange","addPn","handleSnChange","addSn","browseInputRef","handleBrowsePhotos","click","handleFilesSelected","files","newPhotos","currentPnIndex","setCurrentPnIndex","showDropdown","setShowDropdown","currentSnIndex","setCurrentSnIndex","showSnDropdown","setShowSnDropdown","handleAddNewClient","handleBluefolderButton","currentWorkOrder","localsn","handleAddToSlack","which","safeName","title","pn0","sn0","pn_sn","sort","a","b","tracking","photoUrls","listKey","work_order","resp","debug","steps","table","ok","loadingOverlay","loadingLogo","cursor","borderLeft","paddingLeft","marginBottom","borderRadius","position","left","transform","bottom","page","shell","card","cardBody","header","kicker","subtitle","top","right","backgroundColor","border","zIndex","maxHeight","overflowY","pnOption","idx","padding","snOption","marginTop","indexOf","photoActionsRow","photoActionsRight","marginLeft","marginRight","isHidden","currentTarget","checked","display","flexWrap","gap","photo","objectFit","actionRow","flexDirection","fontSize","lineHeight","textAlign","overflow","borderRight","margin","textDecoration","color","alignItems","DisplayItemPage","props"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef, useCallback, useMemo } from \"react\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport {\r\n  Form,\r\n  Button,\r\n  Card,\r\n  Container,\r\n  Row,\r\n  Col,\r\n  Modal,\r\n  FormControl,\r\n  Collapse,\r\n  InputGroup,\r\n  ButtonGroup,\r\n} from \"react-bootstrap\";\r\n\r\nimport Link from \"next/link\";\r\nimport { useAuth } from \"../../../../context/AuthUserContext\";\r\nimport firebase from \"../../../../context/Firebase\";\r\nimport LoggedIn from \"../../../LoggedIn\";\r\nimport { useRouter } from \"next/router\";\r\nimport { fetchClients } from \"../../../../utils/fetchAssociations\";\r\nimport ClientTable from \"../../../../utils/ClientTable\";\r\nimport ClientInfoModal from \"../../ClientInfoModal\";\r\nimport ParentModal from \"../../AddItem/parentModal\";\r\nimport dynamic from \"next/dynamic\";\r\nimport InfoModal from \"../../InfoModal\";\nimport MachineSelectionModal from \"./MachineSelectionModal\";\nimport { addServiceItem } from \"../../../../utils/BluefolderService\";\n\nimport NewLocal from \"./NewLocal\";\nimport styles from \"../../AddItem/NewItem.module.css\";\n\n//inflow API\nimport InflowAPI from \"../../../../utils/inflowAPI\";\nimport {\n  buildLocalLocObject,\n  formatLoc,\n  updateMachineFields,\n  buildNameTokens,\n} from \"../../../../utils/itemFormShared\";\nimport MultiSelectDropdown from \"../../../../components/MultiSelectDropdown\";\nimport {\n  fetchTrackerCatalog,\n  buildAllOems,\n  buildModelsForSelection,\n  syncTrackerFromSelections,\n  deleteTrackerOem,\n  deleteTrackerModel,\n} from \"../../../../utils/trackerCatalog\";\n\n// Import for SSR\nimport { adminDb } from \"../../../../context/FirebaseAdmin\";\n\n// This will only load the component on the client-side.\nconst BarcodeScannerComponent = dynamic(\n  () => import(\"react-qr-barcode-scanner\"),\n  { ssr: false }\n);\r\n\r\n// Simulates a network request delay.\r\nfunction simulateNetworkRequest() {\r\n  return new Promise((resolve) => setTimeout(resolve, 2000));\r\n}\r\n\r\n// Custom LoadingButton component.\r\nfunction LoadingButton({ type, name, route }) {\n  const [isLoading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (isLoading) {\n      let cancelled = false;\n      simulateNetworkRequest().then(() => {\n        if (!cancelled) setLoading(false);\n      });\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [isLoading]);\n\r\n  const handleClick = () => setLoading(true);\r\n\r\n  return (\r\n    <Link href={`/${route}`}>\r\n      <a\r\n        className={`btn btn-${type}`}\r\n        disabled={isLoading}\r\n        onClick={!isLoading ? handleClick : null}\r\n      >\r\n        {isLoading ? \"Loading…\" : name}\r\n      </a>\r\n    </Link>\r\n  );\r\n}\n\nfunction isValidMachineValue(value) {\n  if (value == null) return false;\n  if (Array.isArray(value)) {\n    return value.some((v) => {\n      const trimmed = String(v || \"\").trim();\n      return trimmed !== \"\" && trimmed.toLowerCase() !== \"n/a\";\n    });\n  }\n  if (typeof value !== \"string\") return Boolean(value);\n  const trimmed = value.trim();\n  return trimmed !== \"\" && trimmed.toLowerCase() !== \"n/a\";\n}\n\nfunction normalizeSelection(value) {\n  if (Array.isArray(value)) {\n    return value\n      .map((v) => String(v).trim())\n      .filter((v) => v && v.toLowerCase() !== \"n/a\");\n  }\n  if (value == null) return [];\n  const normalized = String(value).trim();\n  if (!normalized || normalized.toLowerCase() === \"n/a\") return [];\n  return [normalized];\n}\n\nfunction uniqueSelection(values) {\n  return Array.from(new Set(values || []));\n}\n\nfunction selectionToStoredValue(values) {\n  const cleaned = uniqueSelection(normalizeSelection(values));\n  if (cleaned.length === 0) return \"\";\n  if (cleaned.length === 1) return cleaned[0];\n  return cleaned;\n}\n\nfunction selectionToPrintValue(values) {\n  const cleaned = uniqueSelection(normalizeSelection(values));\n  if (cleaned.length === 0) return \"\";\n  if (cleaned.length === 1) return cleaned[0];\n  return \"Multi\";\n}\n\nfunction pickPreferredCase(current, incoming) {\n  if (!current) return incoming;\n  if (!incoming) return current;\n  const hasUpper = (value) => /[A-Z]/.test(String(value || \"\"));\n  const currentUpper = hasUpper(current);\n  const incomingUpper = hasUpper(incoming);\n  if (incomingUpper && !currentUpper) return incoming;\n  if (currentUpper && !incomingUpper) return current;\n  return current;\n}\n\nfunction buildCaseMap(values) {\n  const map = {};\n  (values || []).forEach((value) => {\n    if (value == null) return;\n    const normalized = String(value).trim();\n    if (!normalized) return;\n    const key = normalized.toLowerCase();\n    map[key] = pickPreferredCase(map[key], normalized);\n  });\n  return map;\n}\n\n\nfunction DisplayItemInner({ initialItem, initialMachineData, error }) {\n  // Feature flag to show/hide the 3 Slack buttons\r\n  const SHOW_SLACK_BUTTONS =\r\n    process.env.NEXT_PUBLIC_SHOW_SLACK_BUTTONS === \"true\";\r\n\r\n  const router = useRouter();\r\n  const { signOut } = useAuth();\r\n  // const { id } = router.query;\r\n  const { id: idFromRouter } = router.query;\r\n  const initialId = initialItem?.id || idFromRouter;\r\n  // Use a single local var everywhere in this component\r\n  const id = initialId;\r\n\r\n  const [items, setItems] = useState({\r\n    name: initialItem?.name || \"\",\r\n    pn: Array.isArray(initialItem?.pn)\r\n      ? initialItem.pn\r\n      : (initialItem?.pn ? [initialItem.pn] : []),\r\n    sn: Array.isArray(initialItem?.sn)\r\n      ? initialItem.sn\r\n      : (initialItem?.sn ? [initialItem.sn] : []),\r\n\r\n    // hydrate these from initialItem so SSR renders fully on deploy\r\n    price: initialItem?.price ?? \"\",\r\n    status: initialItem?.status ?? \"\",\r\n    length: initialItem?.length ?? \"\",\r\n    width: initialItem?.width ?? \"\",\r\n    height: initialItem?.height ?? \"\",\r\n    poNumber: initialItem?.poNumber ?? \"\",\r\n    trackingNumber: initialItem?.trackingNumber ?? \"\",\r\n    localSN: initialItem?.localSN || \"\",\r\n    arrival_date: initialItem?.arrival_date || \"\",\r\n    visible: initialItem?.visible ?? true,\n  });\n  const [savedName, setSavedName] = useState(initialItem?.name || \"\");\n  // ⬇️ put this INSIDE DisplayItem, after the related useState hooks\r\n  useEffect(() => {\r\n    if (!initialItem) return;\r\n\r\n    setDescriptions(initialItem.descriptions || []);\r\n    setWorkOrders(initialItem.workOrders || []);\r\n    setDOM(initialItem.DOM || \"\");\r\n\r\n    setItems(prev => ({\n      ...prev,\n      // only overwrite if SSR provided a value; otherwise keep what you have\n      status: initialItem.status ?? prev.status ?? \"\",\n      price: initialItem.price ?? prev.price ?? \"\",\n      length: initialItem.length ?? prev.length ?? \"\",\n      width: initialItem.width ?? prev.width ?? \"\",\n      height: initialItem.height ?? prev.height ?? \"\",\n      poNumber: initialItem.poNumber ?? prev.poNumber ?? \"\",\n      trackingNumber: initialItem.trackingNumber ?? prev.trackingNumber ?? \"\",\n    }));\n\n    if (initialItem.name) {\n      setSavedName(initialItem.name);\n    }\n  }, [initialItem]);\n\r\n\r\n\r\n  const [newLocalFrom, setNewLocalFrom] = useState({\r\n    region: \"\",\r\n    section: { letter: \"\", number: \"\" },\r\n    bin: \"\",\r\n    pallet: \"\",\r\n  });\r\n  const [newLocalCurrent, setNewLocalCurrent] = useState({\r\n    region: \"\",\r\n    section: { letter: \"\", number: \"\" },\r\n    bin: \"\",\r\n    pallet: \"\",\r\n  });\r\n\r\n  // New states for separate client selections:\r\n  const [selectedClientFrom, setSelectedClientFrom] = useState(null);\r\n  const [selectedClientCurrent, setSelectedClientCurrent] = useState(null);\r\n\r\n  const [selectedMachine, setSelectedMachine] = useState(null);\r\n  const [selectedCurrentMachine, setSelectedCurrentMachine] = useState(null);\r\n\r\n  // whenever you pick a new “From” client or machine, clear the old From-loc:\r\n  // useEffect(() => {\r\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\r\n  // }, [selectedClientFrom, selectedMachine]);\r\n  // const didMountFrom = useRef(false);\r\n\r\n  // useEffect(() => {\r\n  //   if (!didMountFrom.current) {\r\n  //     // first time through (the data-load phase), don’t clear\r\n  //     didMountFrom.current = true;\r\n  //     return;\r\n  //   }\r\n  //   // thereafter, when the user picks a new client or machine, clear:\r\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\r\n  //   setLocalLocFrom(\"\");\r\n  // }, [selectedClientFrom, selectedMachine]);\r\n\r\n  // whenever you pick a new “Current” client or machine, clear the old Current-loc:\r\n  // useEffect(() => {\r\n  //   setNewLocalCurrent({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\r\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\r\n  // const [didFetch, setDidFetch] = useState(false);\r\n\r\n  // useEffect(() => {\r\n  //   if (!didFetch) {\r\n  //     // we’re in the data-load phase, skip clearing\r\n  //     setDidFetch(true);\r\n  //     return;\r\n  //   }\r\n  //   // only clear on subsequent user changes:\r\n  //   setNewLocalCurrent({ region: \"\", section: {}, bin: \"\", pallet: \"\" });\r\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\r\n\r\n  // These arrays will be populated from Firebase.\r\n  const [pnOptions, setPnOptions] = useState([]);\n  const [snOptions, setSnOptions] = useState([]);\n  const [pnSnLoaded, setPnSnLoaded] = useState(false);\n  const [pnSnLoading, setPnSnLoading] = useState(false);\n\r\n  const [descriptions, setDescriptions] = useState([\r\n    { description: \"\", date: \"\" },\r\n  ]);\r\n  const [workOrders, setWorkOrders] = useState([{ workOrder: \"\", date: \"\" }]);\r\n  const [clients, setClients] = useState([]);\n  const [clientsLoaded, setClientsLoaded] = useState(false);\n  const [clientsLoading, setClientsLoading] = useState(false);\n  const [photos, setPhotos] = useState([]);\r\n  const [show, setShow] = useState(false);\r\n  const [showErr, setShowErr] = useState(false);\r\n  const [Err, setErr] = useState(\"N/A\");\r\n  const [showDescModal, setShowDescModal] = useState(false);\r\n  const [showWoModal, setShowWoModal] = useState(false);\r\n  const [showClientModal, setShowClientModal] = useState(false);\r\n  const [showMachineModal, setShowMachineModal] = useState(false);\r\n  const [showParentModal, setShowParentModal] = useState(false);\r\n  const [showCameraModal, setShowCameraModal] = useState(false);\r\n  const [showSaveModal, setShowSaveModal] = useState(false);\r\n  const [showPrintModal, setShowPrintModal] = useState(false);\r\n  const [machineSelectionModal, setMachineSelectionModal] = useState(false);\r\n  const [selectedDesc, setSelectedDesc] = useState(0);\r\n  const [selectedClient, setSelectedClient] = useState(null);\r\n\r\n  const [selectedParent, setSelectedParent] = useState(null);\r\n  const [TheMachine, setTheMachine] = useState(null);\r\n  const [machineOptions, setMachineOptions] = useState([]);\r\n  const [search, setSearch] = useState(\"\");\r\n  const [capturedPhoto, setCapturedPhoto] = useState(null);\r\n  const [cameraFacing, setCameraFacing] = useState(\"environment\");\r\n  const [addToWebsite, setAddToWebsite] = useState(false);\r\n  const [machinePick, setMachinePick] = useState(false);\r\n  const [freqItem, setFreqItem] = useState(0);\r\n  const [usagePastYear, setUsagePastYear] = useState(0);\r\n  const [machineFrequency, setMachineFrequency] = useState(0);\n  // State for the extra (dimensions/price/DOM/PO Number) section.\n  const [showExtra, setShowExtra] = useState(false);\n\n  const [trackerCatalog, setTrackerCatalog] = useState({\n    modalities: [],\n    oemsByModality: {},\n    modelsByModalityOem: {},\n    meta: {},\n  });\n  const [trackerLoading, setTrackerLoading] = useState(false);\n  // State for the local warehouse location inputs.\r\n  const [localLocFrom, setLocalLocFrom] = useState(\"\");\r\n  const [localLocCurrent, setLocalLocCurrent] = useState(\"\");\r\n\r\n  // New state for DOM (Date of Manufacture)\r\n  const [DOM, setDOM] = useState(\"\");\r\n  // New state for OEM, Modality, and Model (multi-select).\n  const [selectedModalities, setSelectedModalities] = useState([]);\n  const [selectedOems, setSelectedOems] = useState([]);\n  const [selectedModels, setSelectedModels] = useState([]);\n\n  const applyMergedMachineFields = (merged) => {\n    if (!merged) return;\n    setSelectedOems((prev) => {\n      if (prev.length) return prev;\n      return uniqueSelection(normalizeSelection(merged.oem));\n    });\n    setSelectedModalities((prev) => {\n      if (prev.length) return prev;\n      return uniqueSelection(normalizeSelection(merged.modality));\n    });\n    setSelectedModels((prev) => {\n      if (prev.length) return prev;\n      return uniqueSelection(normalizeSelection(merged.model));\n    });\n  };\n\r\n  // More info modal state.\r\n  const [showInfoModal, setShowInfoModal] = useState(false);\r\n  const [itemName, setItemName] = useState(\"\");\r\n\r\n  const [machineFieldsInitialized, setMachineFieldsInitialized] =\n    useState(false);\n  const [isLoading, setIsLoading] = useState(true);\n\r\n  // near the top of DisplayItem()\r\n  const [showLocalModalFrom, setShowLocalModalFrom] = useState(false);\r\n  const [showLocalModalCurrent, setShowLocalModalCurrent] = useState(false);\r\n\r\n  const openLocalModalFrom = () => setShowLocalModalFrom(true);\r\n  const closeLocalModalFrom = () => setShowLocalModalFrom(false);\r\n  const openLocalModalCurrent = () => setShowLocalModalCurrent(true);\r\n  const closeLocalModalCurrent = () => setShowLocalModalCurrent(false);\r\n\r\n  // at the top of DisplayItem()\r\n  const [showNewLocalModalFrom, setShowNewLocalModalFrom] = useState(false);\n  const [showNewLocalModalCurrent, setShowNewLocalModalCurrent] =\n    useState(false);\n\n  // when the From-client changes, clear any old local-loc\r\n  // useEffect(() => {\r\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\r\n  // }, [selectedClientFrom]);\r\n\r\n  // // when the From-machine changes, clear any old local-loc\r\n  // useEffect(() => {\r\n  //   setNewLocalFrom({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\r\n  // }, [selectedMachine]);\r\n\r\n  // same for Current:\r\n  // useEffect(() => {\r\n  //   setNewLocalCurrent({ region: \"\", section: { letter: \"\", number: \"\" }, bin: \"\", pallet: \"\" });\r\n  // }, [selectedClientCurrent, selectedCurrentMachine]);\r\n\r\n  // const handleSendToInflow = async () => {\r\n  //   try {\r\n  //     const name = items.name;\r\n  //     const description = descriptions[selectedDesc]?.description || \"\";\r\n  //     // gather every photo URL from Firebase Storage\r\n  //     const imageUrls = photos.map((p) => p.url);\r\n  //     await InflowAPI.upsertProduct({ name, description, imageUrls });\r\n  //     alert(\"Sent to inFlow successfully!\");\r\n  //   } catch (err) {\r\n  //     console.error(err);\r\n  //     alert(\"Error sending to inFlow: \" + err.message);\r\n  //   }\r\n  // };\r\n\r\nconst handleSendToInflow = async () => {\r\n  try {\r\n    const name = (items.name || '').trim();\r\n    if (!name) {\r\n      alert('Item needs a name before sending to inFlow.');\r\n      return;\r\n    }\r\n\r\n    // Regular description (don’t also send a custom “Description” unless you truly have one)\r\n    const description = (descriptions[selectedDesc]?.description || '').trim();\r\n\r\n    // Photos already fetched from storage\r\n    const imageUrls = photos.map(p => p.url).filter(Boolean);\r\n\r\n    // SKU = your item id\r\n    const sku = (id ?? '').toString();\r\n\r\n   \r\n\r\n    // Basic normalizers\r\n    const toCSV = arr => (Array.isArray(arr) ? arr.filter(Boolean).join(', ') : (arr || ''));\r\n\r\n    // YYYY-MM-DD for the date field in inFlow\r\n    const arrivalISO = items.arrival_date\r\n      ? new Date(items.arrival_date).toISOString().slice(0, 10)\r\n      : '';\r\n\r\n    const pnStr = Array.isArray(items.pn) ? items.pn.filter(Boolean).join(', ') : (items.pn || '');\r\n    const snStr = Array.isArray(items.sn) ? items.sn.filter(Boolean).join(', ') : (items.sn || '');\r\n\r\n    // Most recent WO (you already have this)\r\n    const mostRecentWO =\r\n      workOrders?.length\r\n        ? workOrders.reduce((latest, cur) => (new Date(cur.date) > new Date(latest.date) ? cur : latest), workOrders[0])\r\n        : { workOrder: '', date: '' };\r\n\r\n    // Build the numbered fields (match your inFlow “Field 1..10”)\r\n    const customFields = {\n      custom1: selectionToPrintValue(selectedOems),                      // OEM   (dropdown)\n      custom2: selectionToPrintValue(selectedModalities),                 // Modality (dropdown)\n      custom3: selectionToPrintValue(selectedModels),                    // Model (dropdown)\n      custom4: (description || '').trim(),              // Description (text) - optional duplicate\r\n      custom5: (mostRecentWO.workOrder || '').trim(),   // Work Order (text)\r\n      custom6: (selectedClientFrom?.name || '').trim(), // From (text)\r\n      custom7: pnStr,                                   // Product Number (text)\r\n      custom8: snStr,                                   // Serial Number (text)\r\n      custom9: arrivalISO,                              // Arrival Date (date)\r\n      custom10: (selectedClientCurrent?.name || '').trim(), // Current (text)\r\n    };\r\n\r\n    console.log('[inFlow] customFields to send (numbered):', customFields);\r\n\r\n\r\n    const created = await InflowAPI.upsertProduct({\r\n      name,\r\n      description,\r\n      sku,\r\n      imageUrls,\r\n      customFields,\r\n    });\r\n\r\n    alert(`Sent to inFlow successfully. ID: ${created?.productId || created?.id || '(unknown)'}`);\r\n  } catch (err) {\r\n    console.error(err);\r\n    alert('Error sending to inFlow: ' + err.message);\r\n  }\r\n};\r\n\r\n\r\n  // const [storedMachine, setStoredMachine] = useState(null);\r\n\r\n  // useEffect(() => {\r\n  //   // once any of these three change, re-merge:\r\n  //   if (TheMachine || selectedCurrentMachine || selectedMachine) {\r\n  //     const merged = updateMachineFields(\r\n  //       TheMachine,\r\n  //       selectedCurrentMachine,\r\n  //       selectedMachine\r\n  //     );\r\n  //     setOem(merged.oem);\r\n  //     setModality(merged.modality);\r\n  //     setModel(merged.model);\r\n  //   }\r\n  // }, [TheMachine, selectedCurrentMachine, selectedMachine]);\r\n\r\n  // whenever the “From” client changes:\r\n  useEffect(() => {\r\n    setShowLocalLocFrom(\r\n      selectedClientFrom?.name?.toLowerCase() === \"socalwarehouse\"\r\n    );\r\n  }, [selectedClientFrom]);\r\n\r\n  // whenever the “Current” client changes:\r\n  useEffect(() => {\r\n    setShowLocalLocCurrent(\r\n      selectedClientCurrent?.name?.toLowerCase() === \"socalwarehouse\"\r\n    );\r\n  }, [selectedClientCurrent]);\r\n\r\n  const loadClients = async () => {\n    if (clientsLoaded || clientsLoading) return;\n    setClientsLoading(true);\n    try {\n      const clientsData = await fetchClients();\n      setClients(clientsData);\n      setClientsLoaded(true);\n    } catch (error) {\n      console.error(\"Error fetching clients: \", error);\n    } finally {\n      setClientsLoading(false);\n    }\n  };\n\n  const loadTracker = useCallback(\n    async (force = false) => {\n      if (trackerLoading) return;\n      if (!force && trackerCatalog.modalities.length) return;\n      setTrackerLoading(true);\n      try {\n        const catalog = await fetchTrackerCatalog();\n        setTrackerCatalog(catalog);\n      } catch (error) {\n        console.error(\"Failed to load tracker catalog:\", error);\n      } finally {\n        setTrackerLoading(false);\n      }\n    },\n    [trackerLoading, trackerCatalog.modalities.length]\n  );\n\n  useEffect(() => {\n    loadTracker();\n  }, [loadTracker]);\n\n  const allOemOptions = useMemo(\n    () => buildAllOems(trackerCatalog),\n    [trackerCatalog]\n  );\n\n  const modelOptions = useMemo(\n    () =>\n      buildModelsForSelection(\n        trackerCatalog,\n        selectedModalities,\n        selectedOems\n      ),\n    [trackerCatalog, selectedModalities, selectedOems]\n  );\n\n  // Keep selected models even if they are not in the catalog yet.\n  // The tracker sync will add any missing models automatically.\n\n  useEffect(() => {\n    if (!trackerCatalog.modalities.length) return;\n    const selections = {\n      modalities: selectedModalities,\n      oems: selectedOems,\n      models: selectedModels,\n    };\n    syncTrackerFromSelections({ selections, catalog: trackerCatalog })\n      .then((updated) => {\n        if (updated) loadTracker(true);\n      })\n      .catch((error) => {\n        console.error(\"Failed to sync tracker selections:\", error);\n      });\n  }, [\n    selectedModalities,\n    selectedOems,\n    selectedModels,\n    trackerCatalog,\n    loadTracker,\n  ]);\n\n  const handleDeleteOemOption = useCallback(\n    async (oem) => {\n      if (!oem) return;\n      try {\n        await deleteTrackerOem({ oem, catalog: trackerCatalog });\n        setSelectedOems((prev) => prev.filter((value) => value !== oem));\n        loadTracker(true);\n      } catch (error) {\n        console.error(\"Failed to delete OEM:\", error);\n      }\n    },\n    [trackerCatalog, loadTracker]\n  );\n\n  const handleDeleteModelOption = useCallback(\n    async (model) => {\n      if (!model || !selectedModalities.length || !selectedOems.length) return;\n      try {\n        const ops = [];\n        selectedModalities.forEach((modalityValue) => {\n          selectedOems.forEach((oemValue) => {\n            ops.push(\n              deleteTrackerModel({\n                modality: modalityValue,\n                oem: oemValue,\n                model,\n                catalog: trackerCatalog,\n              })\n            );\n          });\n        });\n        await Promise.allSettled(ops);\n        setSelectedModels((prev) => prev.filter((value) => value !== model));\n        loadTracker(true);\n      } catch (error) {\n        console.error(\"Failed to delete model:\", error);\n      }\n    },\n    [selectedModalities, selectedOems, trackerCatalog, loadTracker]\n  );\n\n  const loadPnSnOptions = async () => {\n    if (pnSnLoaded || pnSnLoading) return;\n    setPnSnLoading(true);\n    try {\n      const db = firebase.firestore();\n      const snapshot = await db\n        .collection(\"Test\")\n        .orderBy(firebase.firestore.FieldPath.documentId())\n        .limit(500)\n        .get();\n      let pnSet = new Set();\n      let snSet = new Set();\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        if (Array.isArray(data.pn)) {\n          data.pn.forEach((pn) => pn && pnSet.add(pn));\n        } else if (data.pn) {\n          pnSet.add(data.pn);\n        }\n        if (Array.isArray(data.sn)) {\n          data.sn.forEach((sn) => sn && snSet.add(sn));\n        } else if (data.sn) {\n          snSet.add(data.sn);\n        }\n      });\n      setPnOptions([...pnSet]);\n      setSnOptions([...snSet]);\n      setPnSnLoaded(true);\n    } catch (error) {\n      console.error(\"Error fetching PN/SN options:\", error);\n    } finally {\n      setPnSnLoading(false);\n    }\n  };\n\n\r\n  useEffect(() => {\r\n    if (id) fetchData();           // always hydrate on the client\r\n  }, [id]);\r\n\r\n  async function resolveClientFromMachine(\r\n    machineRef,\r\n    setClient,\r\n    setMachine,\r\n    isFrom = true\r\n  ) {\r\n    const machineDoc = await machineRef.get();\r\n    if (machineDoc.exists) {\r\n      const machineData = machineDoc.data();\r\n      setMachine({ id: machineDoc.id, ...machineData });\r\n\r\n      // Determine if the machine is \"interior socal\"\r\n      // const isSocalInterior = machineData.name && machineData.name.toLowerCase() === \"interior socal\";\r\n      // if (isSocalInterior) {\r\n      //   if (isFrom) {\r\n      //     setShowLocalLocFrom(true);\r\n      //   } else {\r\n      //     setShowLocalLocCurrent(true);\r\n      //   }\r\n      // } else {\r\n      // Optionally clear the flag if it is not \"interior socal\"\r\n      // if (isFrom) {\r\n      //   setShowLocalLocFrom(false);\r\n      // } else {\r\n      //   setShowLocalLocCurrent(false);\r\n      // }\r\n      // }\r\n      // new: fetch client name and combine both checks\r\n      const clientDoc =\r\n        machineData.client && typeof machineData.client.get === \"function\"\r\n          ? await machineData.client.get()\r\n          : null;\r\n      const clientName =\r\n        clientDoc && clientDoc.exists ? clientDoc.data().name : null;\r\n      const isSocalInterior =\r\n        machineData.name?.toLowerCase() === \"interior socal\";\r\n      const shouldShow = isSocalInterior || clientName === \"SoCalWarehouse\";\r\n\r\n      if (isFrom) {\r\n        setShowLocalLocFrom(shouldShow);\r\n      } else {\r\n        setShowLocalLocCurrent(shouldShow);\r\n      }\r\n\r\n      if (machineData.client && typeof machineData.client.get === \"function\") {\r\n        const clientDoc = await machineData.client.get();\r\n        if (clientDoc.exists) {\r\n          setClient({ id: clientDoc.id, ...clientDoc.data() });\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const fetchData = async () => {\n    const id = initialItem?.id || idFromRouter; // <- make sure id exists here\n    if (!id) return;\n    setIsLoading(true);\n    const db = firebase.firestore();\n    try {\n      const doc = await db.collection(\"Test\").doc(id).get();\n      if (doc.exists) {\n        console.log(\"test\");\n        const data = doc.data();\n        const normalizedPN = Array.isArray(data.pn) ? data.pn : [data.pn];\n        const normalizedSN = Array.isArray(data.sn) ? data.sn : [data.sn];\n        setItems({\n          ...data,\n          pn: normalizedPN,\n          sn: normalizedSN,\n        });\n        setSavedName(data.name || \"\");\n        setDescriptions(data.descriptions || []);\n        setWorkOrders(data.workOrders || []);\n        if (data.localLocFrom) setLocalLocFrom(data.localLocFrom);\n        if (data.localLocCurrent) setLocalLocCurrent(data.localLocCurrent);\n        if (data.DOM) {\n          setDOM(data.DOM);\n        }\n\r\n      // …after you do setItems, setDescriptions, etc.\r\n\r\n      // load the “newLocal” maps\r\n      if (data.newLocalFrom) setNewLocalFrom(data.newLocalFrom);\r\n      if (data.newLocalCurrent) setNewLocalCurrent(data.newLocalCurrent);\r\n\r\n      // Load PO Number if it exists.\r\n      if (data.poNumber) {\r\n        setItems((prev) => ({ ...prev, poNumber: data.poNumber }));\r\n      }\r\n\r\n      if (data.ClientFrom) {\r\n        const clientFromDoc = await data.ClientFrom.get();\r\n        if (clientFromDoc.exists) {\r\n          setSelectedClientFrom({\r\n            id: clientFromDoc.id,\r\n            ...clientFromDoc.data(),\r\n          });\r\n        }\r\n      }\r\n      if (data.ClientCurrent) {\r\n        const clientCurrentDoc = await data.ClientCurrent.get();\r\n        if (clientCurrentDoc.exists) {\r\n          setSelectedClientCurrent({\r\n            id: clientCurrentDoc.id,\r\n            ...clientCurrentDoc.data(),\r\n          });\r\n        }\r\n      }\r\n\r\n      if (\r\n        !data.ClientFrom &&\r\n        data.Machine &&\r\n        typeof data.Machine.get === \"function\"\r\n      ) {\r\n        console.log(\r\n          \"Entered resolveClientFromMachine for Machine (old style for From)\"\r\n        );\r\n        await resolveClientFromMachine(\r\n          data.Machine,\r\n          setSelectedClientFrom,\r\n          setSelectedMachine,\r\n          true\r\n        );\r\n      }\r\n      if (\r\n        !data.ClientCurrent &&\r\n        data.CurrentMachine &&\r\n        typeof data.CurrentMachine.get === \"function\"\r\n      ) {\r\n        console.log(\r\n          \"Entered resolveClientFromMachine for CurrentMachine (old style for Current)\"\r\n        );\r\n        await resolveClientFromMachine(\r\n          data.CurrentMachine,\r\n          setSelectedClientCurrent,\r\n          setSelectedCurrentMachine,\r\n          false\r\n        );\r\n      }\r\n\r\n      let machineFromData = null;\r\n      let machineCurrentData = null;\r\n\r\n      if (data.MachineFrom) {\r\n        const doc = await data.MachineFrom.get();\r\n        machineFromData = doc.exists ? doc.data() : null;\r\n        setSelectedMachine({ id: doc.id, ...doc.data() });\r\n      }\r\n      if (data.MachineCurrent) {\r\n        const doc = await data.MachineCurrent.get();\r\n        machineCurrentData = doc.exists ? doc.data() : null;\r\n        setSelectedCurrentMachine({ id: doc.id, ...doc.data() });\r\n      }\r\n      const nameFrom = machineFromData?.name?.toLowerCase();\r\n      const nameCurrent = machineCurrentData?.name?.toLowerCase();\r\n\r\n      // If the machine’s name is “interior socal”, show that branch:\r\n      // setShowLocalLocFrom(nameFrom === \"interior socal\");\r\n      // // Or if your Firestore already has a value for localLocFrom, show it anyway:\r\n      // if (data.localLocFrom) setShowLocalLocFrom(true);\r\n\r\n      // setShowLocalLocCurrent(nameCurrent === \"interior socal\");\r\n      // if (data.localLocCurrent) setShowLocalLocCurrent(true);\r\n      // new: combine machine-name OR client-name check, keep existing-data\r\n      setShowLocalLocFrom(\r\n        nameFrom === \"interior socal\" ||\r\n          selectedClientFrom?.name?.toLowerCase() === \"socalwarehouse\" ||\r\n          Boolean(data.localLocFrom)\r\n      );\r\n      setShowLocalLocCurrent(\r\n        nameCurrent === \"interior socal\" ||\r\n          selectedClientCurrent?.name?.toLowerCase() === \"socalwarehouse\" ||\r\n          Boolean(data.localLocCurrent)\r\n      );\r\n\r\n      const theMachineData = data.TheMachine || null;\r\n\r\n      setTheMachine(theMachineData);\r\n      if (theMachineData) {\r\n        // pull both variants, prefer lowercase if it exists\r\n        const OEM = theMachineData.oem ?? theMachineData.OEM;\r\n        const Modality = theMachineData.modality ?? theMachineData.Modality;\r\n        const Model = theMachineData.model ?? theMachineData.Model;\r\n        setTheMachine({ ...theMachineData, OEM, Modality, Model });\r\n      }\r\n      // setStoredMachine(theMachineData);\r\n\r\n      // **right here** merge from the three sources you just fetched:\r\n      const merged = updateMachineFields(\n        theMachineData,\n        machineCurrentData,\n        machineFromData\n      );\n      applyMergedMachineFields(merged);\n\r\n      console.log(\r\n        \"SelectedMachine:\",\r\n        selectedMachine,\r\n        \"SelectedCurrentMachine:\",\r\n        selectedCurrentMachine\r\n      );\r\n      // Show local loc inputs if applicable\r\n      // if (\r\n      //   selectedMachine &&\r\n      //   selectedMachine.name &&\r\n      //   selectedMachine.name.toLowerCase() === \"interior socal\"\r\n      // ) {\r\n      //   setShowLocalLocFrom(true);\r\n      // }\r\n      // if (\r\n      //   selectedCurrentMachine &&\r\n      //   selectedCurrentMachine.name &&\r\n      //   selectedCurrentMachine.name.toLowerCase() === \"interior socal\"\r\n      // ) {\r\n      //   setShowLocalLocCurrent(true);\r\n      // }\r\n\r\n      if (data.Parent) {\r\n        const parentDoc = await data.Parent.get();\r\n        setSelectedParent({ id: parentDoc.id, ...parentDoc.data() });\r\n      }\r\n\r\n      // Priority auto‑population of machine fields.\r\n      // const updatedFields = updateMachineFields(storedMachine, selectedCurrentMachine, selectedMachine);\r\n      // // console.log(\"Updated machine fields:\", updatedFields);\r\n      // setOem(updatedFields.oem);\r\n      // setModality(updatedFields.modality);\r\n      // setModel(updatedFields.model);\r\n\r\n        setIsLoading(false);\n        Promise.all([\n          fetchPhotos(id),\n          checkIfAddedToWebsite(id),\n          calculateItemFrequencyAndUsage(data.pn),\n        ]).catch((err) => {\n          console.error(\"Background item loads failed:\", err);\n        });\n      } else {\n        router.push({\n          pathname: \"../AddItem/NewItem\",\n          query: { signal: id },\n        });\n      }\n    } catch (error) {\n      console.error(\"Error fetching item:\", error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\r\n  const calculateItemFrequencyAndUsage = async (pn) => {\r\n    const db = firebase.firestore();\r\n    const currentDate = new Date();\r\n    const oneYearAgo = new Date();\r\n    oneYearAgo.setFullYear(currentDate.getFullYear() - 1);\r\n\r\n    const normalizedPN = pn !== undefined ? pn : \"\";\r\n    const itemsSnapshot = await db\r\n      .collection(\"Test\")\r\n      .where(\"pn\", \"==\", normalizedPN)\r\n      .get();\r\n\r\n    setFreqItem(itemsSnapshot.size);\r\n\r\n    let usagePastYear = 0;\r\n    itemsSnapshot.forEach((doc) => {\r\n      const itemData = doc.data();\r\n      itemData.workOrders.forEach((workOrder) => {\r\n        const workOrderDate = new Date(workOrder.date);\r\n        if (workOrderDate >= oneYearAgo && workOrderDate <= currentDate) {\r\n          usagePastYear++;\r\n        }\r\n      });\r\n    });\r\n    setUsagePastYear(usagePastYear);\r\n  };\r\n\r\n  const fetchMachine = async (machineId) => {\r\n    const db = firebase.firestore();\r\n    const doc = await db.collection(\"Machine\").doc(machineId).get();\r\n    if (doc.exists) {\r\n      const machineData = doc.data();\r\n      setTheMachine(machineData);\r\n      // re-merge all three sources with correct priority:\r\n      const merged = updateMachineFields(\n        machineData,\n        selectedCurrentMachine,\n        selectedMachine\n      );\n      applyMergedMachineFields(merged);\n      const machinesSnapshot = await db\r\n        .collection(\"Machine\")\r\n        .where(\"Model\", \"==\", machineData.Model || machineData.model)\r\n        .get();\r\n      setMachineFrequency(machinesSnapshot.size);\r\n    } else {\r\n      console.error(\"Machine not found\");\r\n    }\r\n  };\r\n\r\n  const fetchPhotos = async (docID) => {\r\n    const storageRef = firebase.storage().ref();\r\n    const listRef = storageRef.child(`Parts/${docID}`);\r\n    try {\r\n      const res = await listRef.listAll();\r\n      const urls = await Promise.all(\n        res.items.map((item) => item.getDownloadURL())\n      );\n      setPhotos(urls.map((url) => ({ url, file: null })));\n    } catch (error) {\r\n      console.error(\"Error fetching photos: \", error);\r\n    }\r\n  };\r\n\r\n  const checkIfAddedToWebsite = async (docID) => {\r\n    const db = firebase.firestore();\r\n    const partsDoc = await db.collection(\"Parts\").doc(docID).get();\r\n    if (partsDoc.exists) {\r\n      setAddToWebsite(true);\r\n    }\r\n  };\r\n\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n  const handleCloseErr = () => setShowErr(false);\r\n  const handleShowErr = () => setShowErr(true);\r\n  const handleCloseSaveModal = () => setShowSaveModal(false);\r\n  const handleClosePrintModal = () => setShowPrintModal(false);\r\n  const handleShowSaveModal = () => setShowSaveModal(true);\r\n  const handleShowPrintModal = () => setShowPrintModal(true);\r\n  const handleMachineSelectionModal = () => setMachineSelectionModal(false);\r\n  const handleCloseDescModal = () => setShowDescModal(false);\r\n  const handleShowDescModal = () => setShowDescModal(true);\r\n  const handleCloseWoModal = () => setShowWoModal(false);\r\n  const handleShowWoModal = () => setShowWoModal(true);\r\n  const handleCloseClientModal = () => setShowClientModal(false);\n  const handleShowClientModal = async () => {\n    await loadClients();\n    setShowClientModal(true);\n  };\n  const handleCloseMachineModal = () => setShowMachineModal(false);\r\n  const handleShowMachineModal = () => {\r\n    setShowMachineModal(true);\r\n    setShowClientModal(false);\r\n  };\r\n  const handleCloseParentModal = () => setShowParentModal(false);\r\n  const handleShowParentModal = () => setShowParentModal(true);\r\n\r\n  // When a client is selected from the client table.\r\n  const handleClientInfo = async (clientId) => {\r\n    // Clear any previously selected machine and local loc info for this branch.\r\n    if (machinePick) {\r\n      setSelectedMachine(null);\r\n      setShowLocalLocFrom(false);\r\n    } else {\r\n      setSelectedCurrentMachine(null);\r\n      setShowLocalLocCurrent(false);\r\n    }\r\n\r\n    const db = firebase.firestore();\r\n    const clientDoc = await db.collection(\"Client\").doc(clientId).get();\r\n    if (clientDoc.exists) {\r\n      const clientData = { id: clientDoc.id, ...clientDoc.data() };\r\n      if (machinePick) {\r\n        setSelectedClientFrom(clientData);\r\n      } else {\r\n        setSelectedClientCurrent(clientData);\r\n      }\r\n      // after setting selectedClientFrom/Current:\r\n      if (clientData.name === \"SoCalWarehouse\") {\r\n        if (machinePick) setShowLocalLocFrom(true);\r\n        else setShowLocalLocCurrent(true);\r\n      }\r\n      // Fetch machines for this client:\r\n      const machinePromises = clientData.machines.map((machineRef) =>\r\n        machineRef.get()\r\n      );\r\n      const machineDocs = await Promise.all(machinePromises);\r\n      const machines = machineDocs.map((machineDoc) => ({\r\n        id: machineDoc.id,\r\n        ...machineDoc.data(),\r\n      }));\r\n      setMachineOptions(machines);\r\n      // Close the client modal\r\n      handleCloseClientModal();\r\n    }\r\n  };\r\n\r\n  // Reordering function for dropdowns.\r\n  const reorderArray = (arr, selectedValue) => {\r\n    const newArr = arr.filter((val) => val !== selectedValue);\r\n    return [selectedValue, ...newArr];\r\n  };\r\n\r\n  const [addingNewPn, setAddingNewPn] = useState(false);\r\n  const [newPn, setNewPn] = useState(\"\");\r\n  const [addingNewSn, setAddingNewSn] = useState(false);\r\n  const [newSn, setNewSn] = useState(\"\");\r\n\r\n  const handlePnSelect = (e) => {\r\n    const selected = e.target.value;\r\n    setItems((prev) => {\r\n      let updatedPn = Array.isArray(prev.pn) ? [...prev.pn] : [];\r\n      updatedPn[0] = selected;\r\n      return { ...prev, pn: updatedPn };\r\n    });\r\n  };\r\n\r\n  const handleSnSelect = (e) => {\r\n    const selected = e.target.value;\r\n    setItems((prev) => {\r\n      let updatedSn = Array.isArray(prev.sn) ? [...prev.sn] : [];\r\n      updatedSn[0] = selected;\r\n      return { ...prev, sn: updatedSn };\r\n    });\r\n  };\r\n\r\n  const handleAddNewPn = () => {\r\n    if (newPn.trim() !== \"\") {\r\n      setItems((prev) => ({\r\n        ...prev,\r\n        pn: [...prev.pn, newPn.trim()],\r\n      }));\r\n    }\r\n    setNewPn(\"\");\r\n    setAddingNewPn(false);\r\n  };\r\n\r\n  const handleAddNewSn = () => {\r\n    if (newSn.trim() !== \"\") {\r\n      setItems((prev) => ({\r\n        ...prev,\r\n        sn: [...prev.sn, newSn.trim()],\r\n      }));\r\n    }\r\n    setNewSn(\"\");\r\n    setAddingNewSn(false);\r\n  };\r\n\r\n  // Generate custom document ID if needed.\r\n  const generateCustomID = () => {\r\n    const randomNum = Math.floor(10000 + Math.random() * 90000);\r\n    return `AIS${randomNum}`;\r\n  };\r\n\r\n  function shallowClean(obj) {\r\n    const newObj = {};\r\n    for (const key in obj) {\r\n      console.log(key, obj[key]);\r\n      if (obj.hasOwnProperty(key)) {\r\n        newObj[key] = obj[key] === undefined ? \"\" : obj[key];\r\n      }\r\n    }\r\n    return newObj;\r\n  }\r\n\r\n  async function toSend() {\n    const db = firebase.firestore();\n    const currentUser = firebase.auth().currentUser;\n    const userEmail = currentUser ? currentUser.email : \"unknown\";\n\n    // Always use the current state values for OEM, modality, and model.\n    const storedOem = selectionToStoredValue(selectedOems);\n    const storedModality = selectionToStoredValue(selectedModalities);\n    const storedModel = selectionToStoredValue(selectedModels);\n    const machineData = {\n      ...(TheMachine || {}),\n      oem: storedOem,\n      OEM: storedOem,\n      modality: storedModality,\n      Modality: storedModality,\n      model: storedModel,\n      Model: storedModel,\n    };\n\r\n    const formattedItems = { ...items, descriptions, workOrders };\n    // Remove any unused fields.\n    formattedItems.status = items.status || \"\";\n    formattedItems.nameLower = (items.name || \"\").toLowerCase();\n    formattedItems.nameTokens = buildNameTokens(items.name);\n    formattedItems.DOM = DOM; // Date of Manufacture\r\n    formattedItems.localLocFrom = localLocFrom || \"\";\r\n    formattedItems.localLocCurrent = localLocCurrent || \"\";\r\n    formattedItems.date = items.date || \"\";\r\n    formattedItems.arrival_date = items.arrival_date || \"\"; // NEW: Arrival Date\r\n    formattedItems.poNumber = items.poNumber || \"\";\r\n    formattedItems.trackingNumber = items.trackingNumber || \"\";\r\n    formattedItems.TheMachine = machineData || {};\r\n    formattedItems.addedToWebsite = addToWebsite;\r\n\r\n    // NEW: Add the user's email under the field \"user\"\r\n    formattedItems.lastEdited = userEmail;\r\n\r\n    // Clean pn and sn arrays to replace undefined values with an empty string.\r\n    formattedItems.pn = (items.pn || []).map((value) =>\r\n      value === undefined ? \"\" : value\r\n    );\r\n    formattedItems.sn = (items.sn || []).map((value) =>\r\n      value === undefined ? \"\" : value\r\n    );\r\n\r\n    const fromDetails = buildLocalLocObject(newLocalFrom);\r\n    const currentDetails = buildLocalLocObject(newLocalCurrent);\r\n\r\n    console.log(\r\n      \"From Details: \" +\r\n        fromDetails.region +\r\n        \" \" +\r\n        fromDetails.section?.letter +\r\n        fromDetails.section?.number +\r\n        \" \" +\r\n        fromDetails.bin +\r\n        \" \" +\r\n        fromDetails.pallet\r\n    );\r\n    console.log(\r\n      \"Current Details: \" +\r\n        currentDetails.region +\r\n        \" \" +\r\n        currentDetails.section?.letter +\r\n        currentDetails.section?.number +\r\n        \" \" +\r\n        currentDetails.bin +\r\n        \" \" +\r\n        currentDetails.pallet\r\n    );\r\n\r\n    if (Object.keys(fromDetails).length) {\r\n      formattedItems.newLocalFrom = fromDetails;\r\n      formattedItems.localLocFrom = formatLoc(newLocalFrom) || \"\";\r\n    } else {\r\n      // all fields empty — force an empty string and remove any stray map\r\n      console.log(\"entered empty fromDetails else\");\r\n      formattedItems.localLocFrom = \"\";\r\n      formattedItems.newLocalFrom = {};\r\n    }\r\n\r\n    if (Object.keys(currentDetails).length) {\r\n      formattedItems.newLocalCurrent = currentDetails;\r\n      formattedItems.localLocCurrent = formatLoc(newLocalCurrent) || \"\";\r\n    } else {\r\n      // all fields empty — force an empty string and remove any stray map\r\n      formattedItems.localLocCurrent = \"\";\r\n      formattedItems.newLocalCurrent = {};\r\n    }\r\n\r\n    if (selectedMachine && selectedMachine.id) {\r\n      formattedItems.MachineFrom = db\r\n        .collection(\"Machine\")\r\n        .doc(selectedMachine.id);\r\n    }\r\n\r\n    if (selectedCurrentMachine && selectedCurrentMachine.id) {\r\n      formattedItems.MachineCurrent = db\r\n        .collection(\"Machine\")\r\n        .doc(selectedCurrentMachine.id);\r\n    }\r\n\r\n    if (selectedParent && selectedParent.id) {\r\n      formattedItems.Parent = db.collection(\"Test\").doc(selectedParent.id);\r\n    }\r\n\r\n    // NEW: Set separate client references.\r\n    if (selectedClientFrom && selectedClientFrom.id) {\r\n      formattedItems.ClientFrom = db\r\n        .collection(\"Client\")\r\n        .doc(selectedClientFrom.id);\r\n    }\r\n    if (selectedClientCurrent && selectedClientCurrent.id) {\r\n      formattedItems.ClientCurrent = db\r\n        .collection(\"Client\")\r\n        .doc(selectedClientCurrent.id);\r\n    }\r\n\r\n    // Only attach the richer “newLocal” map when the user actually filled something in\r\n    if (Object.keys(fromDetails).length) {\r\n      formattedItems.newLocalFrom = fromDetails;\r\n    }\r\n    if (Object.keys(currentDetails).length) {\r\n      formattedItems.newLocalCurrent = currentDetails;\r\n    }\r\n\r\n    let docId = id;\r\n    try {\r\n      if (docId) {\r\n        // Check if a localSN is provided and if it differs from the current docId.\r\n        const newDocId =\r\n          items.localSN && items.localSN.trim() !== \"\"\r\n            ? items.localSN.trim()\r\n            : docId;\r\n        if (docId !== newDocId) {\r\n          // Migrate: Create a new document with the newDocId.\r\n          await db.collection(\"Test\").doc(newDocId).set(formattedItems);\r\n\r\n          if (selectedMachine && selectedMachine.id) {\r\n            const machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\r\n            const machineDoc = await machineRef.get();\r\n            if (machineDoc.exists) {\r\n              await machineRef.update({\r\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(\r\n                  db.collection(\"Test\").doc(newDocId)\r\n                ),\r\n              });\r\n            }\r\n          }\r\n\r\n          if (selectedCurrentMachine && selectedCurrentMachine.id) {\r\n            const currentMachineRef = db\r\n              .collection(\"Machine\")\r\n              .doc(selectedCurrentMachine.id);\r\n            const currentMachineDoc = await currentMachineRef.get();\r\n            if (currentMachineDoc.exists) {\r\n              await currentMachineRef.update({\r\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(\r\n                  db.collection(\"Test\").doc(newDocId)\r\n                ),\r\n              });\r\n            }\r\n          }\r\n          // Delete the old document.\r\n          await db.collection(\"Test\").doc(docId).delete();\r\n          // Set docId to the new document ID.\r\n          docId = newDocId;\r\n        } else {\r\n          // Deep-clean the formattedItems to remove any undefined nested values.\r\n          const cleanFormattedItems = shallowClean(formattedItems);\r\n          await db.collection(\"Test\").doc(docId).update(cleanFormattedItems);\r\n\r\n          if (selectedMachine && selectedMachine.id) {\r\n            const machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\r\n            const machineDoc = await machineRef.get();\r\n            if (machineDoc.exists) {\r\n              await machineRef.update({\r\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(\r\n                  db.collection(\"Test\").doc(docId)\r\n                ),\r\n              });\r\n            }\r\n          }\r\n\r\n          if (selectedCurrentMachine && selectedCurrentMachine.id) {\r\n            const currentMachineRef = db\r\n              .collection(\"Machine\")\r\n              .doc(selectedCurrentMachine.id);\r\n            const currentMachineDoc = await currentMachineRef.get();\r\n            if (currentMachineDoc.exists) {\r\n              await currentMachineRef.update({\r\n                associatedParts: firebase.firestore.FieldValue.arrayUnion(\r\n                  db.collection(\"Test\").doc(docId)\r\n                ),\r\n              });\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        // For a new item, if localSN is provided, use it; otherwise, generate a custom ID.\r\n        docId =\r\n          items.localSN && items.localSN.trim() !== \"\"\r\n            ? items.localSN.trim()\r\n            : generateCustomID();\r\n        await db.collection(\"Test\").doc(docId).set(formattedItems);\r\n\r\n        if (selectedMachine && selectedMachine.id) {\r\n          const machineRef = db.collection(\"Machine\").doc(selectedMachine.id);\r\n          const machineDoc = await machineRef.get();\r\n          if (machineDoc.exists) {\r\n            await machineRef.update({\r\n              associatedParts: firebase.firestore.FieldValue.arrayUnion(\r\n                db.collection(\"Test\").doc(docId)\r\n              ),\r\n            });\r\n          }\r\n        }\r\n\r\n        if (selectedCurrentMachine && selectedCurrentMachine.id) {\r\n          const currentMachineRef = db\r\n            .collection(\"Machine\")\r\n            .doc(selectedCurrentMachine.id);\r\n          const currentMachineDoc = await currentMachineRef.get();\r\n          if (currentMachineDoc.exists) {\r\n            await currentMachineRef.update({\r\n              associatedParts: firebase.firestore.FieldValue.arrayUnion(\r\n                db.collection(\"Test\").doc(docId)\r\n              ),\r\n            });\r\n          }\r\n        }\r\n      }\r\n      // Upload any new photos to Firebase Storage.\n      await uploadPhotos(docId);\n      console.log(\"Item saved and associatedParts updated!\");\n\n      setSavedName(items.name || \"\");\n\n      // Redirect to the new URL using the new document id.\n      router.push(`/NewSearch/item/${docId}`);\n\r\n      // Optionally, you can also show a save confirmation modal:\r\n      handleShowSaveModal();\r\n    } catch (error) {\r\n      console.error(\"Error saving data:\", error);\r\n    }\r\n  }\r\n\r\n  // Additional state for local warehouse location inputs.\r\n  const [showLocalLocFrom, setShowLocalLocFrom] = useState(false);\r\n  const [showLocalLocCurrent, setShowLocalLocCurrent] = useState(false);\r\n\r\n  // When a machine is selected from the modal.\r\n  const handleSetSelectedMachine = (machine) => {\r\n    // const condition = (name) => name && name.toLowerCase() === \"interior socal\";\r\n    const isSocalInterior = machine.name?.toLowerCase() === \"interior socal\";\r\n\r\n    if (machinePick) {\r\n      setSelectedMachine({ id: machine.id, name: machine.name });\r\n      setShowLocalLocFrom(\r\n        isSocalInterior ||\r\n          selectedClientFrom?.name?.toLowerCase() === \"socalwarehouse\"\r\n      );\r\n    } else {\r\n      setSelectedCurrentMachine({ id: machine.id, name: machine.name });\r\n      setShowLocalLocCurrent(\r\n        isSocalInterior ||\r\n          selectedClientCurrent?.name?.toLowerCase() === \"socalwarehouse\"\r\n      );\r\n    }\r\n    fetchMachine(machine.id);\r\n    // Close the machine modal (assuming you're using showMachineModal to control it)\r\n    setShowMachineModal(false);\r\n  };\r\n\r\n  const uploadPhotos = async (docID) => {\r\n    const storageRef = firebase.storage().ref();\r\n    for (let i = 0; i < photos.length; i++) {\r\n      if (photos[i].file) {\r\n        const photoRef = storageRef.child(\r\n          `Parts/${docID}/${docID}${i === 0 ? \".jpg\" : `.${i + 1}.jpg`}`\r\n        );\r\n        const metadata = {\r\n          contentType: \"image/png\",\r\n        };\r\n        await photoRef.put(photos[i].file, metadata);\r\n        const url = await photoRef.getDownloadURL();\r\n        photos[i].url = url;\r\n      }\r\n    }\r\n  };\r\n\r\n  // Function to handle printing the label.\r\n  const handlePrint = async () => {\r\n    if (!items.name) {\r\n      alert(\"Missing name\");\r\n      return;\r\n    }\r\n\r\n    let clientName = \"\";\r\n\r\n    // Attempt to fetch client name from the Machine document reference.\r\n    if (items.Machine && typeof items.Machine.get === \"function\") {\r\n      try {\r\n        const machineDoc = await items.Machine.get();\r\n        if (machineDoc.exists) {\r\n          const machineData = machineDoc.data();\r\n          if (\r\n            machineData.client &&\r\n            typeof machineData.client.get === \"function\"\r\n          ) {\r\n            const clientDoc = await machineData.client.get();\r\n            if (clientDoc.exists) {\r\n              clientName = clientDoc.data().name || \"\";\r\n            }\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Error fetching machine or client:\", error);\r\n      }\r\n    } else {\r\n      console.warn(\"No Machine reference available in the item\");\r\n    }\r\n    console.log(clientName, \":\", items.client);\r\n    // Fallback: if no client name was found, check items.client.\r\n    if (!clientName && items.client) {\r\n      if (typeof items.client.get === \"function\") {\r\n        try {\r\n          const clientDoc = await items.client.get();\r\n          if (clientDoc.exists) {\r\n            clientName = clientDoc.data().name || \"\";\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Error fetching client from items.client:\", error);\r\n        }\r\n      } else {\r\n        clientName = items.client;\r\n      }\r\n    }\r\n    console.log(\"descriptions:\", descriptions[selectedDesc]);\r\n    const payload = {\r\n      name: items.name,\r\n      pn: items.pn,\r\n      sn: items.sn,\r\n      wo: workOrders && workOrders.length > 0 ? workOrders[0].workOrder : \"\",\r\n      client: clientName,\r\n      status: items.status,\r\n      local_sn: id,\r\n      descriptions: [\n        descriptions[selectedDesc] || { description: \"\", date: \"\" },\n      ],\n      date: items.dateCreated || \"\",\n      DOM: DOM,\n      oem: selectionToPrintValue(selectedOems),\n      modality: selectionToPrintValue(selectedModalities),\n      model: selectionToPrintValue(selectedModels),\n      poNumber: items.poNumber,\n      arrival_date: items.arrival_date, // NEW: Include arrival_date\n    };\n\r\n    console.log(\"Payload for printing:\", payload);\r\n    try {\r\n      const response = await fetch(\r\n        \"https://9d70-174-76-22-138.ngrok-free.app/print-label\",\r\n        {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(payload),\r\n        }\r\n      );\r\n      const result = await response.json();\r\n      console.log(\"Print result:\", result.status);\r\n\r\n      if (result.status.includes(\"successfully.\")) {\r\n        handleShowPrintModal();\r\n      } else {\r\n        console.error(\"Error printing label:\", result.error);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error printing label:\", error);\r\n    }\r\n  };\r\n\r\n  async function handleSubmit(event) {\r\n    event.preventDefault();\r\n    // Only check that the Name field is filled out.\r\n    if (!items.name) {\r\n      handleShow(); // This shows the \"missing field\" modal.\r\n    } else {\r\n      toSend();\r\n    }\r\n  }\r\n\r\n  // Handlers for input changes.\r\n  const handleChange = (field) => (event) => {\r\n    const value = event.target ? event.target.value : event.value;\r\n    setItems((prevItems) => ({ ...prevItems, [field]: value }));\r\n  };\r\n\r\n  const addDescription = () => {\r\n    setDescriptions([...descriptions, { description: \"\", date: \"\" }]);\r\n  };\r\n\r\n  const removeDescription = (index) => {\r\n    setDescriptions(descriptions.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handleDescriptionChange = (index, field, value) => {\r\n    const newDescriptions = descriptions.map((desc, i) =>\r\n      i === index ? { ...desc, [field]: value } : desc\r\n    );\r\n    setDescriptions(newDescriptions);\r\n  };\r\n\r\n  const addWorkOrder = () => {\r\n    setWorkOrders([...workOrders, { workOrder: \"\", date: \"\" }]);\r\n  };\r\n\r\n  const removeWorkOrder = (index) => {\r\n    setWorkOrders(workOrders.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handleWorkOrderChange = (index, field, value) => {\r\n    const newWorkOrders = workOrders.map((wo, i) =>\r\n      i === index ? { ...wo, [field]: value } : wo\r\n    );\r\n    setWorkOrders(newWorkOrders);\r\n  };\r\n\r\n  const listDescriptions = () => {\r\n    setShowDescModal(true);\r\n  };\r\n\r\n  const selectDescription = (index) => {\r\n    setSelectedDesc(index);\r\n    setShowDescModal(false);\r\n  };\r\n\r\n  const handleShowCameraModal = () => {\r\n    setShowCameraModal(true);\r\n  };\r\n\r\n  const handleCloseCameraModal = () => {\r\n    setShowCameraModal(false);\r\n    setCapturedPhoto(null);\r\n  };\r\n\r\n  const handleCapture = (err, result) => {\r\n    if (result) {\r\n      setCapturedPhoto(result);\r\n    }\r\n  };\r\n\r\n  const savePhoto = () => {\r\n    setPhotos((prevPhotos) => [\r\n      ...prevPhotos,\r\n      { file: capturedPhoto, url: URL.createObjectURL(capturedPhoto) },\r\n    ]);\r\n    setCapturedPhoto(null);\r\n    handleCloseCameraModal();\r\n  };\r\n\r\n  const removePhoto = (index) => {\r\n    setPhotos(photos.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const mostRecentWorkOrder =\r\n    workOrders && workOrders.length > 0\r\n      ? workOrders.reduce((latest, current) => {\r\n          const latestDate = new Date(latest.date);\r\n          const currentDate = new Date(current.date);\r\n          return currentDate > latestDate ? current : latest;\r\n        }, workOrders[0])\r\n      : {};\r\n\r\n  const capturePhoto = () => {\r\n    const video = document.querySelector(\"video\");\r\n    const canvas = document.createElement(\"canvas\");\r\n    canvas.width = video.videoWidth;\r\n    canvas.height = video.videoHeight;\r\n    const context = canvas.getContext(\"2d\");\r\n    context.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n    canvas.toBlob((blob) => {\r\n      setCapturedPhoto(blob);\r\n    }, \"image/png\");\r\n  };\r\n\r\n  const handleShowInfoModal = async () => {\r\n    const db = firebase.firestore();\r\n    try {\r\n      const doc = await db.collection(\"Test\").doc(id).get();\r\n      if (doc.exists) {\r\n        const data = doc.data();\r\n        setItemName(data.name || \"N/A\");\r\n        setShowInfoModal(true);\r\n      } else {\r\n        console.error(\"Item not found\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching item info:\", error);\r\n    }\r\n  };\r\n\r\n  const handleCloseInfoModal = () => setShowInfoModal(false);\n  const handleCloneToNewItem = () => {\n    if (!id) {\n      setErr(\"Item ID not ready yet.\");\n      setShowErr(true);\n      return;\n    }\n    router.push(`/NewSearch/AddItem/NewItem?cloneFrom=${encodeURIComponent(id)}`);\n  };\n\r\n  const handlePnChange = (index, value) => {\r\n    setItems((prev) => {\r\n      const newPn = [...prev.pn];\r\n      newPn[index] = value;\r\n      return { ...prev, pn: newPn };\r\n    });\r\n  };\r\n\r\n  const addPn = () => {\r\n    setItems((prev) => ({\r\n      ...prev,\r\n      pn: [...prev.pn, \"\"],\r\n    }));\r\n  };\r\n\r\n  const handleSnChange = (index, value) => {\r\n    setItems((prev) => {\r\n      const newSn = [...prev.sn];\r\n      newSn[index] = value;\r\n      return { ...prev, sn: newSn };\r\n    });\r\n  };\r\n\r\n  const addSn = () => {\r\n    setItems((prev) => ({\r\n      ...prev,\r\n      sn: [...prev.sn, \"\"],\r\n    }));\r\n  };\r\n\r\n  const browseInputRef = useRef(null);\r\n\r\n  const handleBrowsePhotos = () => {\r\n    if (browseInputRef.current) {\r\n      browseInputRef.current.click();\r\n    }\r\n  };\r\n\r\n  const handleFilesSelected = (e) => {\r\n    const files = e.target.files;\r\n    if (files.length) {\r\n      const newPhotos = [];\r\n      for (let i = 0; i < files.length; i++) {\r\n        newPhotos.push({\r\n          file: files[i],\r\n          url: URL.createObjectURL(files[i]),\r\n        });\r\n      }\r\n      setPhotos((prevPhotos) => [...prevPhotos, ...newPhotos]);\r\n    }\r\n    e.target.value = \"\";\r\n  };\r\n\r\n  const [currentPnIndex, setCurrentPnIndex] = useState(0);\n  const [showDropdown, setShowDropdown] = useState(false);\n  const [currentSnIndex, setCurrentSnIndex] = useState(0);\n  const [showSnDropdown, setShowSnDropdown] = useState(false);\n\n  useEffect(() => {\n    if (showDropdown || showSnDropdown) {\n      loadPnSnOptions();\n    }\n  }, [showDropdown, showSnDropdown]);\n\r\n  const handleAddNewClient = () => {\r\n    const randomNum = Math.floor(10000 + Math.random() * 90000);\r\n    router.push(\r\n      `../client/AIS${randomNum}/addClient?from=item&itemId=${id || \"\"}`\r\n    );\r\n  };\r\n\r\n  const handleBluefolderButton = async () => {\r\n    // Check that the work order field is filled out (using workOrders[0].workOrder as current)\r\n    const currentWorkOrder =\r\n      workOrders && workOrders.length > 0 ? workOrders[0].workOrder : \"\";\r\n    if (!currentWorkOrder) {\r\n      alert(\r\n        \"Please fill out the work order field before adding to BlueFolder.\"\r\n      );\r\n      return;\r\n    }\r\n\r\n    // Build the payload to send to your proxy endpoint.\r\n    const payload = {\r\n      name: items.name,\r\n      pn: items.pn[0] || \"\",\r\n      sn: items.sn[0] || \"\",\r\n      status: items.status,\r\n      description: descriptions[selectedDesc]?.description || \"\",\r\n      workOrder: currentWorkOrder,\r\n      localsn: items.localSN || \"\",\r\n    };\r\n\r\n    try {\r\n      // Replace with your ngrok URL and appropriate endpoint path (e.g., /api/bluefolder)\r\n      const response = await fetch(\r\n        \"https://9d70-174-76-22-138.ngrok-free.app/bluefolder\",\r\n        {\r\n          method: \"POST\",\r\n          headers: { \"Content-Type\": \"application/json\" },\r\n          body: JSON.stringify(payload),\r\n        }\r\n      );\r\n      const result = await response.json();\r\n      alert(\"BlueFolder service item added successfully!\");\r\n      console.log(\"BlueFolder result:\", result);\r\n    } catch (error) {\r\n      console.error(\"BlueFolder error:\", error);\r\n      alert(\"Error adding data to BlueFolder.\");\r\n    }\r\n  };\r\n\r\n// // Slack integration handler.\r\n// const handleAddToSlack = async (which) => {\r\n//   try {\r\n//     const pn0 = Array.isArray(items.pn) ? items.pn[0] : items.pn;\r\n//     const sn0 = Array.isArray(items.sn) ? items.sn[0] : items.sn;\r\n\r\n//     const linkUrl = typeof window !== \"undefined\" ? window.location.href : \"\";\r\n//     const safeName = (items?.name || id || \"Untitled\").trim();\r\n//     const title = `${safeName}${id ? ` (${id})` : \"\"}`;\r\n\r\n//     console.log(\"[SLACK][handleAddToSlack] which:\", which);\r\n//     console.log(\"[SLACK] title:\", title);\r\n//     console.log(\"[SLACK] PN:\", items.pn, \"SN:\", items.sn);\r\n\r\n//     const resp = await fetch(\"/api/slack/add-to-list\", {\r\n//       method: \"POST\",\r\n//       headers: { \"Content-Type\": \"application/json\" },\r\n//       body: JSON.stringify({\r\n//         listKey: which,      // \"shipping\" | \"receiving\" | \"tasks\"\r\n//         title,\r\n//         pn: items.pn,\r\n//         sn: items.sn,\r\n//         // keeping it minimal by design while we stabilize PN/SN\r\n//         linkUrl,\r\n//       }),\r\n//     });\r\n// Slack integration handler (drop-in replacement)\r\n// Slack integration handler (drop-in replacement)\r\n\r\n\r\n// Slack integration handler (client) — replace your existing handleAddToSlack with this\r\nconst handleAddToSlack = async (which = \"shipping\") => {\r\n  try {\r\n    const safeName = (items?.name || id || \"Untitled\").trim();\r\n    const title = `${safeName}${id ? ` (${id})` : \"\"}`;\r\n\r\n    const pn0 = Array.isArray(items?.pn) ? items.pn[0] : items?.pn;\r\n    const sn0 = Array.isArray(items?.sn) ? items.sn[0] : items?.sn;\r\n    const pn_sn = [pn0 && `PN: ${pn0}`, sn0 && `SN: ${sn0}`]\r\n      .filter(Boolean)\r\n      .join(\"  \");\r\n\r\n    const mostRecentWO =\r\n      (workOrders && workOrders.length)\r\n        ? [...workOrders].sort((a,b) => new Date(b?.date||0) - new Date(a?.date||0))[0]?.workOrder\r\n        : \"\";\r\n\r\n    const description =\r\n      (selectedDesc != null && descriptions?.[selectedDesc])\r\n        ? (descriptions[selectedDesc].description || \"\")\r\n        : (items?.description || \"\");\r\n\r\n    const tracking = items?.trackingNumber ?? items?.tracking ?? \"\";\r\n    const local_sn = id || items?.localSN || \"\";\r\n\r\n    const photoUrls = Array.isArray(photos)\r\n      ? photos.map(p => p?.url).filter(Boolean)\r\n      : [];\r\n\r\n    const resp = await fetch(\"/api/slack/add-to-list\", {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify({\r\n        listKey: which,\r\n        title,\r\n        pn_sn,                 // <— server expects this\r\n        work_order: mostRecentWO || \"\",\r\n        local_sn,\r\n        tracking,\r\n        description: (description || \"\").trim(),\r\n        photoUrls,             // array of https URLs\r\n      }),\r\n    });\r\n\r\n    const json = await resp.json();\r\n    console.log(\"[SLACK][handleAddToSlack] response:\", json);\r\n    if (json?.debug?.steps) console.table(json.debug.steps);\r\n    if (json?.debug?.photos) console.table(json.debug.photos);\r\n\r\n    if (!resp.ok || !json?.ok) {\r\n      setErr(`Slack add failed: ${json?.error || \"unknown error\"}`);\r\n      setShowErr(true);\r\n      return;\r\n    }\r\n\r\n    alert(\r\n      `Added to Slack ${which === \"shipping\" ? \"Shipping\" : which === \"receiving\" ? \"Receiving\" : \"Tasks\"} list.`\r\n    );\r\n  } catch (e) {\r\n    console.error(e);\r\n    setErr(\"Error adding to Slack\");\r\n    setShowErr(true);\r\n  }\r\n};\r\n\r\n\r\n  return (\n    <LoggedIn>\n      {isLoading && (\n        <div className={styles.loadingOverlay}>\n          <img\n            src=\"/magmo-logo.png\"\n            alt=\"Loading Magmo\"\n            className={styles.loadingLogo}\n          />\n        </div>\n      )}\n      <div>\n        <Modal show={show} onHide={handleClose}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Error</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>Missing field</Modal.Body>\r\n          <Modal.Footer>\r\n            <Button variant=\"primary\" onClick={handleClose}>\r\n              Ok\r\n            </Button>\r\n          </Modal.Footer>\r\n        </Modal>\r\n        <Modal show={showErr} onHide={handleCloseErr}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Error</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>{Err}</Modal.Body>\r\n          <Modal.Footer>\r\n            <Button variant=\"primary\" onClick={handleCloseErr}>\r\n              Ok\r\n            </Button>\r\n          </Modal.Footer>\r\n        </Modal>\r\n        <Modal show={showSaveModal} onHide={handleCloseSaveModal}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Save Confirmation</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>Data has been saved successfully.</Modal.Body>\r\n          <Modal.Footer>\r\n            <Button variant=\"primary\" onClick={handleCloseSaveModal}>\r\n              Ok\r\n            </Button>\r\n          </Modal.Footer>\r\n        </Modal>\r\n        <Modal show={showPrintModal} onHide={handleClosePrintModal}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Print Confirmation</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>Info has been sent to print.</Modal.Body>\r\n          <Modal.Footer>\r\n            <Button variant=\"primary\" onClick={handleClosePrintModal}>\r\n              Ok\r\n            </Button>\r\n          </Modal.Footer>\r\n        </Modal>\r\n\r\n        <Modal show={showDescModal} onHide={handleCloseDescModal}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Descriptions</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n            <Button variant=\"primary\" className=\"mb-3\" onClick={addDescription}>\r\n              Add Description\r\n            </Button>\r\n            {descriptions.map((desc, index) => (\r\n              <Row key={index} className=\"mb-3\">\r\n                <Button\r\n                  variant=\"outline-secondary\"\r\n                  className=\"w-100\"\r\n                  onClick={() => selectDescription(index)}\r\n                  style={{ cursor: \"pointer\" }}\r\n                >\r\n                  <div className=\"d-flex justify-content-between\">\r\n                    <span>{desc.description || \"Description\"}</span>\r\n                    <span\r\n                      style={{\r\n                        borderLeft: \"1px solid #ccc\",\r\n                        paddingLeft: \"10px\",\r\n                      }}\r\n                    >\r\n                      {desc.date || \"Date\"}\r\n                    </span>\r\n                  </div>\r\n                </Button>\r\n              </Row>\r\n            ))}\r\n            <Button variant=\"primary\" onClick={handleCloseDescModal}>\r\n              OK\r\n            </Button>\r\n          </Modal.Body>\r\n        </Modal>\r\n\r\n        <Modal show={showWoModal} onHide={handleCloseWoModal}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Work Orders</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n            <Button\r\n              variant=\"primary\"\r\n              className=\"mb-3\"\r\n              onClick={addWorkOrder}\r\n              style={{ marginBottom: \"1rem\" }}\r\n            >\r\n              Add Work Order\r\n            </Button>\r\n            {workOrders.map((wo, index) => (\r\n              <Row key={index} className=\"mb-3\">\r\n                <Col>\r\n                  <Form.Control\r\n                    type=\"text\"\r\n                    placeholder=\"Work Order\"\r\n                    value={wo.workOrder}\r\n                    onChange={(e) =>\r\n                      handleWorkOrderChange(index, \"workOrder\", e.target.value)\r\n                    }\r\n                    style={{ marginBottom: \"0.5rem\" }}\r\n                  />\r\n                </Col>\r\n                <Col>\r\n                  <Form.Control\r\n                    type=\"date\"\r\n                    placeholder=\"Date\"\r\n                    value={wo.date}\r\n                    onChange={(e) =>\r\n                      handleWorkOrderChange(index, \"date\", e.target.value)\r\n                    }\r\n                  />\r\n                </Col>\r\n                <Col>\r\n                  <Button\r\n                    variant=\"danger\"\r\n                    onClick={() => removeWorkOrder(index)}\r\n                  >\r\n                    Remove\r\n                  </Button>\r\n                </Col>\r\n              </Row>\r\n            ))}\r\n            <Button variant=\"primary\" onClick={handleCloseWoModal}>\r\n              OK\r\n            </Button>\r\n          </Modal.Body>\r\n        </Modal>\r\n\r\n        <ClientInfoModal\r\n          show={showMachineModal}\r\n          handleClose={handleCloseMachineModal}\r\n          selectedClient={selectedClient}\r\n          machineOptions={machineOptions}\r\n          setSelectedMachine={handleSetSelectedMachine}\r\n        />\r\n\r\n        <Modal show={showClientModal} onHide={handleCloseClientModal}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Select Client</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n            <FormControl\r\n              type=\"text\"\r\n              placeholder=\"Search by name\"\r\n              className=\"mb-3\"\r\n              value={search}\r\n              onChange={(e) => setSearch(e.target.value)}\r\n            />\r\n            <ClientTable\r\n              clients={clients.filter((client) =>\r\n                (client.name || \"\").toLowerCase().includes(search.toLowerCase())\r\n              )}\r\n              onSelectClient={handleClientInfo}\r\n              onInfoClick={handleClientInfo}\r\n              clearSelection={() => handleClientInfo(null)}\r\n              onAddClient={handleAddNewClient}\r\n            />\r\n          </Modal.Body>\r\n        </Modal>\r\n\r\n        <ParentModal\r\n          show={showParentModal}\r\n          handleClose={handleCloseParentModal}\r\n          setSelectedParent={setSelectedParent}\r\n        />\r\n\r\n        <MachineSelectionModal\r\n          show={machineSelectionModal}\r\n          handleClose={() => setMachineSelectionModal(false)}\r\n          setMachine={setTheMachine}\r\n        />\r\n\r\n        <Modal show={showCameraModal} onHide={handleCloseCameraModal}>\r\n          <Modal.Header closeButton>\r\n            <Modal.Title>Take a Photo</Modal.Title>\r\n          </Modal.Header>\r\n          <Modal.Body>\r\n            <div className=\"camera\">\r\n              {!capturedPhoto && (\r\n                <BarcodeScannerComponent\r\n                  width=\"100%\"\r\n                  height={300}\r\n                  onUpdate={handleCapture}\r\n                  facingMode={cameraFacing}\r\n                />\r\n              )}\r\n              {capturedPhoto && (\r\n                <div className=\"photo-preview\">\r\n                  <img\r\n                    src={URL.createObjectURL(capturedPhoto)}\r\n                    alt=\"captured\"\r\n                    style={{ width: \"100%\" }}\r\n                  />\r\n                </div>\r\n              )}\r\n            </div>\r\n          </Modal.Body>\r\n          <Modal.Footer>\r\n            {!capturedPhoto ? (\r\n              <>\r\n                <Button\r\n                  onClick={capturePhoto}\r\n                  style={{\r\n                    borderRadius: \"50%\",\r\n                    width: \"60px\",\r\n                    height: \"60px\",\r\n                    position: \"absolute\",\r\n                    left: \"50%\",\r\n                    transform: \"translateX(-50%)\",\r\n                    bottom: \"10px\",\r\n                  }}\r\n                >\r\n                  📷\r\n                </Button>\r\n                <Button\r\n                  onClick={() =>\r\n                    setCameraFacing((prev) =>\r\n                      prev === \"environment\" ? \"user\" : \"environment\"\r\n                    )\r\n                  }\r\n                >\r\n                  Flip Camera\r\n                </Button>\r\n                <Button variant=\"secondary\" onClick={handleCloseCameraModal}>\r\n                  Cancel\r\n                </Button>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Button\r\n                  variant=\"secondary\"\r\n                  onClick={() => setCapturedPhoto(null)}\r\n                >\r\n                  Retake\r\n                </Button>\r\n                <Button variant=\"primary\" onClick={savePhoto}>\r\n                  OK\r\n                </Button>\r\n              </>\r\n            )}\r\n          </Modal.Footer>\r\n        </Modal>\r\n\r\n        <InfoModal\r\n          show={showInfoModal}\r\n          handleClose={handleCloseInfoModal}\r\n          itemName={items.name}\r\n          dimensions={items.length + \",\" + items.width + \",\" + items.height}\r\n          price={items.price}\r\n          freqI={freqItem}\r\n          freqM={machineFrequency}\r\n          usage={usagePastYear}\r\n        />\r\n\r\n        <Container fluid className={styles.page}>\n          <div className={styles.shell}>\n            <Card className={styles.card}>\n              <Card.Body className={styles.cardBody}>\n                <div className={styles.header}>\n                  <div className={styles.kicker}>Item</div>\n                  <h2 className={styles.title}>\n                    {savedName || \"Item Details\"}\n                  </h2>\n                  <div className={styles.subtitle}>\n                    Review and update fields, photos, and routing information.\n                  </div>\n                </div>\n                <Form onSubmit={handleSubmit}>\n                  {/* Row for Name and PN */}\r\n                  <Row className=\"mb-3\">\r\n                    <Col>\r\n                      <Form.Group controlId=\"name\">\r\n                        <Form.Label>Name</Form.Label>\r\n                        <Form.Control\r\n                          type=\"text\"\r\n                          value={items.name}\r\n                          onChange={handleChange(\"name\")}\r\n                        />\r\n                      </Form.Group>\r\n                    </Col>\r\n                    <Col>\r\n                      <Form.Group controlId=\"pn\">\r\n                        <Form.Label>Product Number</Form.Label>\r\n                        <div style={{ position: \"relative\" }}>\r\n                          <InputGroup>\r\n                            <Form.Control\r\n                              type=\"text\"\r\n                              value={items.pn[currentPnIndex] || \"\"}\r\n                              onChange={(e) =>\r\n                                handlePnChange(currentPnIndex, e.target.value)\r\n                              }\r\n                            />\r\n                            <Button\r\n                              variant=\"outline-secondary\"\r\n                              onClick={() => setShowDropdown(!showDropdown)}\r\n                            >\r\n                              &#9662;\r\n                            </Button>\r\n                            <InputGroup.Text>\r\n                              <Button\r\n                                variant=\"outline-secondary\"\r\n                                onClick={() => setAddingNewPn(true)}\r\n                              >\r\n                                +\r\n                              </Button>\r\n                            </InputGroup.Text>\r\n                          </InputGroup>\r\n                          {showDropdown && (\r\n                            <div\r\n                              style={{\r\n                                position: \"absolute\",\r\n                                top: \"100%\",\r\n                                left: 0,\r\n                                right: 0,\r\n                                backgroundColor: \"white\",\r\n                                border: \"1px solid #ccc\",\r\n                                zIndex: 1000,\r\n                                maxHeight: \"150px\",\r\n                                overflowY: \"auto\",\r\n                              }}\r\n                            >\r\n                              {pnOptions.map((pnOption, idx) => (\r\n                                <div\r\n                                  key={idx}\r\n                                  style={{ padding: \"8px\", cursor: \"pointer\" }}\r\n                                  onClick={() => {\r\n                                    setCurrentPnIndex(idx);\r\n                                    setShowDropdown(false);\r\n                                  }}\r\n                                >\r\n                                  {pnOption}\r\n                                </div>\r\n                              ))}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                        {addingNewPn && (\r\n                          <Form.Control\r\n                            type=\"text\"\r\n                            placeholder=\"Enter new PN\"\r\n                            value={newPn}\r\n                            onChange={(e) => setNewPn(e.target.value)}\r\n                            onBlur={handleAddNewPn}\r\n                            onKeyDown={(e) =>\r\n                              e.key === \"Enter\" && handleAddNewPn()\r\n                            }\r\n                          />\r\n                        )}\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n                  {/* Row for SN and Status */}\r\n                  <Row className=\"mb-3\">\r\n                    <Col>\r\n                      <Form.Group controlId=\"sn\">\r\n                        <Form.Label>Serial Number</Form.Label>\r\n                        <div style={{ position: \"relative\" }}>\r\n                          <InputGroup>\r\n                            <Form.Control\r\n                              type=\"text\"\r\n                              value={items.sn[currentSnIndex] || \"\"}\r\n                              onChange={(e) =>\r\n                                handleSnChange(currentSnIndex, e.target.value)\r\n                              }\r\n                            />\r\n                            <Button\r\n                              variant=\"outline-secondary\"\r\n                              onClick={() => setShowSnDropdown(!showSnDropdown)}\r\n                            >\r\n                              &#9662;\r\n                            </Button>\r\n                            <InputGroup.Text>\r\n                              <Button\r\n                                variant=\"outline-secondary\"\r\n                                onClick={() => setAddingNewSn(true)}\r\n                              >\r\n                                +\r\n                              </Button>\r\n                            </InputGroup.Text>\r\n                          </InputGroup>\r\n                          {showSnDropdown && (\r\n                            <div\r\n                              style={{\r\n                                position: \"absolute\",\r\n                                top: \"100%\",\r\n                                left: 0,\r\n                                right: 0,\r\n                                backgroundColor: \"white\",\r\n                                border: \"1px solid #ccc\",\r\n                                zIndex: 1000,\r\n                                maxHeight: \"150px\",\r\n                                overflowY: \"auto\",\r\n                              }}\r\n                            >\r\n                              {snOptions.map((snOption, idx) => (\r\n                                <div\r\n                                  key={idx}\r\n                                  style={{ padding: \"8px\", cursor: \"pointer\" }}\r\n                                  onClick={() => {\r\n                                    setCurrentSnIndex(idx);\r\n                                    setShowSnDropdown(false);\r\n                                  }}\r\n                                >\r\n                                  {snOption}\r\n                                </div>\r\n                              ))}\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                        {addingNewSn && (\r\n                          <Form.Control\r\n                            type=\"text\"\r\n                            placeholder=\"Enter new SN\"\r\n                            value={newSn}\r\n                            onChange={(e) => setNewSn(e.target.value)}\r\n                            onBlur={handleAddNewSn}\r\n                            onKeyDown={(e) =>\r\n                              e.key === \"Enter\" && handleAddNewSn()\r\n                            }\r\n                          />\r\n                        )}\r\n                      </Form.Group>\r\n                    </Col>\r\n                    <Col>\r\n                      <Form.Group controlId=\"status\">\r\n                        <Form.Label>Status</Form.Label>\r\n                        <Form.Select\r\n                          value={items.status || \"\"}\r\n                          onChange={handleChange(\"status\")}\r\n                        >\r\n                          <option value=\"\">Select status</option>\r\n                          <option value=\"Good\">Good</option>\r\n                          <option value=\"Bad\">Bad</option>\r\n                          <option value=\"Unknown\">Unknown</option>\r\n                        </Form.Select>\r\n                      </Form.Group>\r\n                    </Col>\r\n                  </Row>\r\n                  {/* Row for Local SN, Arrival Date, Tracking */}\n                  <Row className=\"mb-3\">\n                    <Col>\n                      <Form.Group controlId=\"localSN\">\n                        <Form.Label>Local SN</Form.Label>\n                        <Form.Control\n                          type=\"text\"\n                          placeholder=\"Enter Local SN\"\n                          value={items.localSN || \"\"}\n                          onChange={handleChange(\"localSN\")}\n                        />\n                      </Form.Group>\n                    </Col>\n                    <Col>\n                      <Form.Group controlId=\"arrivalDate\">\n                        <Form.Label>Arrival Date</Form.Label>\n                        <Form.Control\n                          placeholder=\"Enter Arrival Date\"\n                          type=\"date\"\n                          value={items.arrival_date}\n                          onChange={(e) => {\n                            const value = e.target.value;\n                            setItems((prev) => ({\n                              ...prev,\n                              arrival_date: value,\n                            }));\n                          }}\n                        />\n                      </Form.Group>\n                    </Col>\n                    <Col>\n                      <Form.Group controlId=\"trackingNumber\">\n                        <Form.Label>Tracking Number</Form.Label>\n                        <Form.Control\n                          placeholder=\"Tracking Number\"\n                          type=\"text\"\n                          value={items.trackingNumber}\n                          onChange={handleChange(\"trackingNumber\")}\n                        />\n                      </Form.Group>\n                    </Col>\n                  </Row>\n                  {/* Row for OEM, Modality, Model */}\n                  <Row className=\"mb-3\">\n                    <Col>\n                      <MultiSelectDropdown\n                        label=\"OEM\"\n                        placeholder={trackerLoading ? \"Loading...\" : \"Select OEM\"}\n                        options={allOemOptions}\n                        selected={selectedOems}\n                        onChange={setSelectedOems}\n                        enableDelete\n                        onDeleteOption={handleDeleteOemOption}\n                        disabled={trackerLoading}\n                      />\n                    </Col>\n                    <Col>\n                      <MultiSelectDropdown\n                        label=\"Modality\"\n                        placeholder={trackerLoading ? \"Loading...\" : \"Select Modality\"}\n                        options={trackerCatalog.modalities}\n                        selected={selectedModalities}\n                        onChange={setSelectedModalities}\n                        disabled={trackerLoading}\n                      />\n                    </Col>\n                    <Col>\n                      <MultiSelectDropdown\n                        label=\"Model\"\n                        placeholder={\n                          selectedModalities.length && selectedOems.length\n                            ? \"Select Model\"\n                            : \"Select Modality + OEM\"\n                        }\n                        options={modelOptions}\n                        selected={selectedModels}\n                        onChange={setSelectedModels}\n                        enableDelete\n                        onDeleteOption={handleDeleteModelOption}\n                        disabled={\n                          trackerLoading ||\n                          !selectedModalities.length ||\n                          !selectedOems.length\n                        }\n                      />\n                    </Col>\n                  </Row>\n                  {/* Work Orders and Inline Description Section */}\r\n                  <div style={{ marginBottom: \"1rem\", marginTop: \"1rem\" }}>\r\n                    <div className=\"d-flex align-items-center\">\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        onClick={handleShowWoModal}\r\n                        className=\"me-2\"\r\n                      >\r\n                        Manage Work Orders\r\n                      </Button>\r\n                      {workOrders.length > 0 && (\r\n                        <div className=\"d-flex flex-column align-items-start\">\r\n                          <Form.Label>Work Order</Form.Label>\r\n                          <Form.Control\r\n                            type=\"text\"\r\n                            placeholder=\"Most Recent Work Order\"\r\n                            value={mostRecentWorkOrder.workOrder}\r\n                            onChange={(e) =>\r\n                              handleWorkOrderChange(\r\n                                workOrders.indexOf(mostRecentWorkOrder),\r\n                                \"workOrder\",\r\n                                e.target.value\r\n                              )\r\n                            }\r\n                            style={{ marginBottom: \"0.5rem\" }}\r\n                          />\r\n                          <Form.Label>Date</Form.Label>\r\n                          <Form.Control\r\n                            type=\"date\"\r\n                            placeholder=\"Work Order Date\"\r\n                            value={mostRecentWorkOrder.date}\r\n                            onChange={(e) =>\r\n                              handleWorkOrderChange(\r\n                                workOrders.indexOf(mostRecentWorkOrder),\r\n                                \"date\",\r\n                                e.target.value\r\n                              )\r\n                            }\r\n                            style={{ marginBottom: \"0.5rem\" }}\r\n                          />\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    <div style={{ marginBottom: \"1rem\" }}>\r\n                      <Form.Group controlId=\"desc\">\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          onClick={listDescriptions}\r\n                          className=\"mb-2 me-2\"\r\n                        >\r\n                          List Descriptions\r\n                        </Button>\r\n                        <Form.Control\r\n                          as=\"textarea\"\r\n                          rows={3}\r\n                          placeholder=\"Enter description\"\r\n                          value={descriptions[selectedDesc]?.description || \"\"}\r\n                          onChange={(e) =>\r\n                            handleDescriptionChange(\r\n                              selectedDesc,\r\n                              \"description\",\r\n                              e.target.value\r\n                            )\r\n                          }\r\n                          style={{ marginBottom: \"0.5rem\" }}\r\n                        />\r\n                        <Form.Control\r\n                          type=\"date\"\r\n                          value={descriptions[selectedDesc]?.date || \"\"}\r\n                          onChange={(e) =>\r\n                            handleDescriptionChange(\r\n                              selectedDesc,\r\n                              \"date\",\r\n                              e.target.value\r\n                            )\r\n                          }\r\n                          style={{\r\n                            marginTop: \"0.5rem\",\r\n                            marginBottom: \"0.5rem\",\r\n                          }}\r\n                        />\r\n                      </Form.Group>\r\n                    </div>\r\n                  </div>\r\n                  {/* Machine Selection Row */}\r\n                  <div style={{ marginBottom: \"1rem\" }}>\r\n                    <Row className=\"mb-3\">\r\n                      <Col>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          onClick={() => {\r\n                            setMachinePick(true);\r\n                            handleShowClientModal();\r\n                          }}\r\n                          className=\"me-2\"\r\n                        >\r\n                          Select From\r\n                        </Button>\r\n                        {selectedClientFrom && (\r\n                          <div\r\n                            style={{\r\n                              border: \"1px solid #ccc\",\r\n                              padding: \"0.75rem\",\r\n                              borderRadius: \"4px\",\r\n                              marginBottom: \"1rem\",\r\n                            }}\r\n                          >\r\n                            <p>\r\n                              <strong>Selected Client (From):</strong>{\" \"}\r\n                              {selectedClientFrom.name}\r\n                            </p>\r\n                            <div style={{ marginTop: \"0.5rem\" }}>\r\n                              <Button\r\n                                variant=\"outline-secondary\"\r\n                                onClick={() => setShowMachineModal(true)}\r\n                              >\r\n                                Select Machine for {selectedClientFrom.name}\r\n                              </Button>\r\n                              {selectedMachine && (\r\n                                <>\r\n                                  <p style={{ marginTop: \"0.5rem\" }}>\r\n                                    <strong>Selected Machine (From):</strong>{\" \"}\r\n                                    {selectedMachine.name}\r\n                                  </p>\r\n                                  {showLocalLocFrom && (\r\n                                    <>\r\n                                      <Button\r\n                                        variant=\"outline-secondary\"\r\n                                        onClick={() =>\r\n                                          setShowNewLocalModalFrom(true)\r\n                                        }\r\n                                        className=\"w-100 mb-2\"\r\n                                      >\r\n                                        {/* build a little helper inline: region-section-bin-pallet */}\r\n                                        {[\r\n                                          newLocalFrom.region,\r\n                                          newLocalFrom.section?.letter +\r\n                                            newLocalFrom.section?.number,\r\n                                          newLocalFrom.bin &&\r\n                                            `B${newLocalFrom.bin}`,\r\n                                          newLocalFrom.pallet &&\r\n                                            `P${newLocalFrom.pallet}`,\r\n                                        ]\r\n                                          .filter(Boolean)\r\n                                          .join(\"-\")}\r\n                                        {/* e.g. “E-A7-B3-P2” */}\r\n                                      </Button>\r\n\r\n                                      <Modal\r\n                                        show={showNewLocalModalFrom}\r\n                                        onHide={() =>\r\n                                          setShowNewLocalModalFrom(false)\r\n                                        }\r\n                                        centered\r\n                                      >\r\n                                        <Modal.Header>\r\n                                          <Modal.Title>\r\n                                            Edit Local Loc (From)\r\n                                          </Modal.Title>\r\n                                        </Modal.Header>\r\n                                        <Modal.Body>\r\n                                          <NewLocal\r\n                                            selectedClient={selectedClientFrom}\r\n                                            showLocalLoc={showNewLocalModalFrom}\r\n                                            value={newLocalFrom}\r\n                                            onChange={setNewLocalFrom}\r\n                                            onSave={(p) => {\r\n                                              setNewLocalFrom(p);\r\n                                              setShowNewLocalModalFrom(false);\r\n                                            }}\r\n                                            onCancel={() =>\r\n                                              setShowNewLocalModalFrom(false)\r\n                                            }\r\n                                          />\r\n                                        </Modal.Body>\r\n                                        {/* <Modal.Footer>\r\n                                          <Button\r\n                                            variant=\"secondary\"\r\n                                            onClick={() => setShowNewLocalModalFrom(false)}\r\n                                          >\r\n                                            Close\r\n                                          </Button>\r\n                                        </Modal.Footer> */}\r\n                                      </Modal>\r\n                                    </>\r\n                                  )}\r\n                                </>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </Col>\r\n                      <Col>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          onClick={() => {\r\n                            setMachinePick(false);\r\n                            handleShowClientModal();\r\n                          }}\r\n                          className=\"me-2\"\r\n                        >\r\n                          Select Current\r\n                        </Button>\r\n                        {selectedClientCurrent && (\r\n                          <div\r\n                            style={{\r\n                              border: \"1px solid #ccc\",\r\n                              padding: \"0.75rem\",\r\n                              borderRadius: \"4px\",\r\n                              marginBottom: \"1rem\",\r\n                            }}\r\n                          >\r\n                            <p>\r\n                              <strong>Selected Client (Current):</strong>{\" \"}\r\n                              {selectedClientCurrent.name}\r\n                            </p>\r\n                            <div style={{ marginTop: \"0.5rem\" }}>\r\n                              <Button\r\n                                variant=\"outline-secondary\"\r\n                                onClick={() => setShowMachineModal(true)}\r\n                              >\r\n                                Select Machine for {selectedClientCurrent.name}\r\n                              </Button>\r\n                              {selectedCurrentMachine && (\r\n                                <>\r\n                                  <p style={{ marginTop: \"0.5rem\" }}>\r\n                                    <strong>Selected Machine (Current):</strong>{\" \"}\r\n                                    {selectedCurrentMachine.name}\r\n                                  </p>\r\n                                  {showLocalLocCurrent && (\r\n                                    <>\r\n                                      <Button\r\n                                        variant=\"outline-secondary\"\r\n                                        onClick={() =>\r\n                                          setShowNewLocalModalCurrent(true)\r\n                                        }\r\n                                        className=\"w-100 mb-2\"\r\n                                      >\r\n                                        {[\r\n                                          newLocalCurrent.region,\r\n                                          newLocalCurrent.section?.letter +\r\n                                            newLocalCurrent.section?.number,\r\n                                          newLocalCurrent.bin &&\r\n                                            `B${newLocalCurrent.bin}`,\r\n                                          newLocalCurrent.pallet &&\r\n                                            `P${newLocalCurrent.pallet}`,\r\n                                        ]\r\n                                          .filter(Boolean)\r\n                                          .join(\"-\")}\r\n                                      </Button>\r\n                                      <Modal\r\n                                        show={showNewLocalModalCurrent}\r\n                                        onHide={() =>\r\n                                          setShowNewLocalModalCurrent(false)\r\n                                        }\r\n                                        centered\r\n                                      >\r\n                                        <Modal.Header>\r\n                                          <Modal.Title>\r\n                                            Edit Local Loc (Current)\r\n                                          </Modal.Title>\r\n                                        </Modal.Header>\r\n                                        <Modal.Body>\r\n                                          <NewLocal\r\n                                            selectedClient={\r\n                                              selectedClientCurrent\r\n                                            }\r\n                                            showLocalLoc={\r\n                                              showNewLocalModalCurrent\r\n                                            }\r\n                                            value={newLocalCurrent}\r\n                                            onChange={setNewLocalCurrent}\r\n                                            onSave={(p) => {\r\n                                              setNewLocalCurrent(p);\r\n                                              setShowNewLocalModalCurrent(\r\n                                                false\r\n                                              );\r\n                                            }}\r\n                                            onCancel={() =>\r\n                                              setShowNewLocalModalCurrent(false)\r\n                                            }\r\n                                          />\r\n                                        </Modal.Body>\r\n                                        {/* <Modal.Footer>\r\n                                          <Button\r\n                                            variant=\"secondary\"\r\n                                            onClick={() => setShowNewLocalModalCurrent(false)}\r\n                                          >\r\n                                            Close\r\n                                          </Button>\r\n                                        </Modal.Footer> */}\r\n                                      </Modal>\r\n                                    </>\r\n                                  )}\r\n                                </>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </Col>\r\n                      <Col>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          onClick={handleShowParentModal}\r\n                          className=\"me-2\"\r\n                        >\r\n                          Select Parent\r\n                        </Button>\r\n                        {selectedParent && (\r\n                          <Form.Control\r\n                            type=\"text\"\r\n                            placeholder=\"Selected Parent\"\r\n                            value={selectedParent.name}\r\n                            readOnly\r\n                            style={{ marginTop: \"0.5rem\" }}\r\n                          />\r\n                        )}\r\n                      </Col>\r\n                    </Row>\r\n                  </div>\r\n                  {/* Photo and Website Options */}\r\n                  <div style={{ marginBottom: \"1rem\" }}>\n                    <Row className={`mb-3 ${styles.photoActionsRow}`}>\n                      <Col xs={12} md={6}>\n                        <ButtonGroup>\n                          <Button\n                            variant=\"outline-secondary\"\n                            onClick={handleShowCameraModal}\n                          >\n                            Take Photo\n                          </Button>\n                          <Button\n                            variant=\"outline-secondary\"\n                            onClick={handleBrowsePhotos}\n                          >\n                            Browse\n                          </Button>\n                        </ButtonGroup>\n                      </Col>\n                      <Col xs={12} md={6} className={styles.photoActionsRight}>\n                        <Button\n                          variant=\"success\"\n                          onClick={handleSendToInflow}\n                          style={{ marginLeft: \"auto\" }}\n                        >\n                          Send to inFlow\n                        </Button>\r\n                        <Button\r\n                          variant=\"secondary\"\r\n                          onClick={handleBluefolderButton}\r\n                          style={{ marginLeft: \"0.5rem\", marginRight: \".5rem\" }}\r\n                        >\r\n                          BlueFolder\r\n                        </Button>\r\n                        \r\n\r\n                        <Button\r\n                          variant={addToWebsite ? \"primary\" : \"outline-primary\"}\r\n                          onClick={() => setAddToWebsite((prev) => !prev)}\r\n                        >\r\n                          {addToWebsite ? \"✓ Add to Website\" : \"Add to Website\"}\r\n                        </Button>\r\n\r\n                        <Form.Check\r\n                          type=\"checkbox\"\r\n                          id=\"hide-checkbox\"\r\n                          label=\"Hide\"\r\n                          // box is checked when we want visible = false\r\n                          checked={!items.visible}\r\n                          onChange={(e) => {\r\n                            // grab checked immediately\r\n                            const isHidden = e.currentTarget.checked;\r\n                            setItems((prev) => ({\r\n                              ...prev,\r\n                              visible: !isHidden,\r\n                            }));\r\n                          }}\r\n                          className=\"ms-3\"\r\n                        />\r\n                      </Col>\r\n                    </Row>\r\n                    <input\r\n                      type=\"file\"\r\n                      accept=\"image/*\"\r\n                      multiple\r\n                      ref={browseInputRef}\r\n                      style={{ display: \"none\" }}\r\n                      onChange={handleFilesSelected}\r\n                    />\r\n                  </div>\r\n                  {/* Photo Gallery */}\r\n                  {photos && photos.length > 0 && (\r\n                    <div\r\n                      className=\"photo-gallery\"\r\n                      style={{\r\n                        display: \"flex\",\r\n                        flexWrap: \"wrap\",\r\n                        gap: \"10px\",\r\n                        marginBottom: \"1rem\",\r\n                      }}\r\n                    >\r\n                      {photos.map((photo, index) => (\r\n                        <div\r\n                          key={index}\r\n                          style={{\r\n                            position: \"relative\",\r\n                            width: \"100px\",\r\n                            height: \"100px\",\r\n                          }}\r\n                        >\r\n                          <img\r\n                            src={photo.url}\r\n                            alt={`Photo ${index + 1}`}\r\n                            style={{\r\n                              width: \"100%\",\r\n                              height: \"100%\",\r\n                              objectFit: \"cover\",\r\n                            }}\r\n                          />\r\n                          {photo.file && (\r\n                            <Button\r\n                              variant=\"danger\"\r\n                              size=\"sm\"\r\n                              style={{\r\n                                position: \"absolute\",\r\n                                top: 0,\r\n                                right: 0,\r\n                                padding: \"0 5px\",\r\n                              }}\r\n                              onClick={() => removePhoto(index)}\r\n                            >\r\n                              x\r\n                            </Button>\r\n                          )}\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  )}\r\n                  {/* Action Buttons */}\r\n                  <div className={`mt-3 d-flex flex-wrap align-items-center ${styles.actionRow}`}>\n                    <Button\n                      variant=\"primary\"\n                      type=\"submit\"\n                      style={{ marginRight: \"1rem\" }}\n                    >\n                      Save\n                    </Button>\n                    <Button\n                      variant=\"secondary\"\n                      onClick={handleCloneToNewItem}\n                      style={{ marginRight: \"1rem\" }}\n                    >\n                      Clone\n                    </Button>\n                    <LoadingButton\n                      type=\"primary\"\n                      name=\"Back\"\n                      route=\"NewSearch/mainSearch\"\n                    />\r\n                    {SHOW_SLACK_BUTTONS && (\r\n                      <div style={{ display: \"flex\", flexDirection: \"column\", marginLeft: \".5rem\" }}>\r\n                        <span style={{ fontSize: 12, lineHeight: \"12px\", textAlign: \"center\" }}>Slack</span>\r\n                        <div style={{ display: \"flex\", border: \"1px solid #ced4da\", borderRadius: 6, overflow: \"hidden\" }}>\r\n                          <Button\r\n                            variant=\"outline-primary\"\r\n                            onClick={() => handleAddToSlack(\"receiving\")}\r\n                            style={{ border: \"none\", borderRight: \"1px solid #ced4da\" }}\r\n                          >\r\n                            Receiving\r\n                          </Button>\r\n                          <Button\r\n                            variant=\"outline-primary\"\r\n                            onClick={() => handleAddToSlack(\"shipping\")}\r\n                            style={{ border: \"none\" }}\r\n                          >\r\n                            Shipping\r\n                          </Button>\r\n                          {/* <Button\r\n                            variant=\"outline-primary\"\r\n                            onClick={() => handleAddToSlack(\"tasks\")}\r\n                          >\r\n                            Tasks\r\n                          </Button> */}\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    <Button\r\n                      variant=\"info\"\r\n                      onClick={handlePrint}\r\n                      style={{ marginLeft: \"auto\" }}\r\n                    >\r\n                      Print Label\r\n                    </Button>\r\n                  </div>\r\n                  <div style={{ textAlign: \"center\", margin: \"1rem 0\" }}>\r\n                    <Button\r\n                      variant=\"link\"\r\n                      style={{\r\n                        textDecoration: \"none\",\r\n                        color: \"black\",\r\n                        fontSize: \"24px\",\r\n                      }}\r\n                      onClick={() => setShowExtra(!showExtra)}\r\n                    >\r\n                      ▼\r\n                    </Button>\r\n                  </div>\r\n                  <Collapse in={showExtra}>\n                    <div id=\"extra-collapse\" className=\"mt-3\">\n                      <div className=\"d-flex justify-content-end mb-3\">\n                        <Button variant=\"secondary\" onClick={handleShowInfoModal}>\n                          More Info\n                        </Button>\n                      </div>\n                      <Row>\n                        <Form.Group as={Col} controlId=\"dimensions\">\n                          <Form.Label>Dimensions</Form.Label>\n                          <div\r\n                            style={{ display: \"flex\", alignItems: \"center\" }}\r\n                          >\r\n                            <Form.Control\r\n                              placeholder=\"Length\"\r\n                              type=\"text\"\r\n                              value={items.length}\r\n                              onChange={handleChange(\"length\")}\r\n                            />\r\n                            <span style={{ padding: \"0 5px\" }}>x</span>\r\n                            <Form.Control\r\n                              placeholder=\"Width\"\r\n                              type=\"text\"\r\n                              value={items.width}\r\n                              onChange={handleChange(\"width\")}\r\n                            />\r\n                            <span style={{ padding: \"0 5px\" }}>x</span>\r\n                            <Form.Control\r\n                              placeholder=\"Height\"\r\n                              type=\"text\"\r\n                              value={items.height}\r\n                              onChange={handleChange(\"height\")}\r\n                            />\r\n                          </div>\r\n                        </Form.Group>\r\n                      </Row>\r\n\r\n                      <Row className=\"mt-3\">\r\n                        <Form.Group as={Col} controlId=\"Price\">\r\n                          <Form.Label>Price</Form.Label>\r\n                          <Form.Control\r\n                            placeholder=\"Price\"\r\n                            type=\"text\"\r\n                            value={items.price}\r\n                            onChange={handleChange(\"price\")}\r\n                          />\r\n                        </Form.Group>\r\n                        <Form.Group as={Col} controlId=\"DOM\">\r\n                          <Form.Label>DOM</Form.Label>\r\n                          <Form.Control\r\n                            placeholder=\"Date of Manufacture\"\r\n                            type=\"date\"\r\n                            value={DOM}\r\n                            onChange={(e) => setDOM(e.target.value)}\r\n                          />\r\n                        </Form.Group>\r\n                        <Form.Group as={Col} controlId=\"poNumber\">\r\n                          <Form.Label>PO Number</Form.Label>\r\n                          <Form.Control\r\n                            type=\"text\"\r\n                            placeholder=\"PO Number\"\r\n                            value={items.poNumber || \"\"}\r\n                            onChange={handleChange(\"poNumber\")}\r\n                          />\r\n                        </Form.Group>\r\n                      </Row></div>\r\n                  </Collapse>\r\n                </Form>\r\n              </Card.Body>\r\n            </Card>\r\n          </div>\r\n        </Container>\r\n      </div>\r\n      {/* Camera Modal */}\r\n      <Modal show={showCameraModal} onHide={handleCloseCameraModal}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Take a Photo</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <div className=\"camera\">\r\n            {!capturedPhoto ? (\r\n              <BarcodeScannerComponent\r\n                width=\"100%\"\r\n                height={300}\r\n                onUpdate={handleCapture}\r\n                facingMode={cameraFacing}\r\n              />\r\n            ) : (\r\n              <div className=\"photo-preview\">\r\n                <img\r\n                  src={URL.createObjectURL(capturedPhoto)}\r\n                  alt=\"captured\"\r\n                  style={{ width: \"100%\" }}\r\n                />\r\n              </div>\r\n            )}\r\n          </div>\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          {!capturedPhoto ? (\r\n            <>\r\n              <Button\r\n                onClick={capturePhoto}\r\n                style={{\r\n                  borderRadius: \"50%\",\r\n                  width: \"60px\",\r\n                  height: \"60px\",\r\n                  position: \"absolute\",\r\n                  left: \"50%\",\r\n                  transform: \"translateX(-50%)\",\r\n                  bottom: \"10px\",\r\n                }}\r\n              >\r\n                📷\r\n              </Button>\r\n              <Button\r\n                onClick={() =>\r\n                  setCameraFacing((prev) =>\r\n                    prev === \"environment\" ? \"user\" : \"environment\"\r\n                  )\r\n                }\r\n              >\r\n                Flip Camera\r\n              </Button>\r\n              <Button variant=\"secondary\" onClick={handleCloseCameraModal}>\r\n                Cancel\r\n              </Button>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <Button\r\n                variant=\"secondary\"\r\n                onClick={() => setCapturedPhoto(null)}\r\n              >\r\n                Retake\r\n              </Button>\r\n              <Button variant=\"primary\" onClick={savePhoto}>\r\n                OK\r\n              </Button>\r\n            </>\r\n          )}\r\n        </Modal.Footer>\r\n      </Modal>\r\n    </LoggedIn>\r\n  );\r\n}\n\nexport default function DisplayItemPage(props) {\n  const router = useRouter();\n  const idFromRouter = router.query?.id;\n  const key = props?.initialItem?.id || idFromRouter || \"new-item\";\n  return <DisplayItemInner {...props} key={key} />;\n}\n\r\n// Server-side rendering function\r\nexport async function getServerSideProps(context) {\r\n  const { id } = context.params;\r\n\r\n  try {\r\n    const itemDoc = await adminDb.collection(\"Test\").doc(id).get();\r\n    if (!itemDoc.exists) return { notFound: true };\r\n\r\n    const itemData = itemDoc.data();\r\n\r\n    // normalize to arrays for consistent client-side handling\r\n    const pnArray = Array.isArray(itemData.pn)\r\n      ? itemData.pn\r\n      : (itemData.pn ? [itemData.pn] : []);\r\n    const snArray = Array.isArray(itemData.sn)\r\n      ? itemData.sn\r\n      : (itemData.sn ? [itemData.sn] : []);\r\n\r\n    // fetch machineData (optional; you already had this)\r\n    let machineData = {};\r\n    if (itemData.Machine && itemData.Machine.path) {\r\n      try {\r\n        const machineDoc = await adminDb.doc(itemData.Machine.path).get();\r\n        if (machineDoc.exists) {\r\n          machineData = machineDoc.data();\r\n          if (machineData.client && machineData.client.path) {\r\n            const clientDoc = await adminDb.doc(machineData.client.path).get();\r\n            if (clientDoc.exists) machineData.Client = clientDoc.data().name;\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.error(\"Error fetching machine data:\", e);\r\n      }\r\n    }\r\n\r\n    const serializedItem = {\r\n      id,\r\n      name: itemData.name || \"\",\r\n      pn: pnArray,\r\n      sn: snArray,\r\n      price: itemData.price || \"\",\r\n      status: itemData.status || \"\",\r\n      length: itemData.length || \"\",\r\n      width: itemData.width || \"\",\r\n      height: itemData.height || \"\",\r\n      poNumber: itemData.poNumber || \"\",\r\n      trackingNumber: itemData.trackingNumber || \"\",\r\n      localSN: itemData.localSN || \"\",\r\n      arrival_date: itemData.arrival_date || \"\",\r\n      visible: itemData.visible !== undefined ? itemData.visible : true,\r\n\r\n      // add the pieces the UI reads directly\r\n      descriptions: itemData.descriptions || [],\r\n      workOrders: itemData.workOrders || [],\r\n      DOM: itemData.DOM || \"\",\r\n    };\r\n\r\n    return {\r\n      props: {\r\n        initialItem: serializedItem,\r\n        initialMachineData: machineData,\r\n      },\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Error in getServerSideProps:\", error);\r\n    return { props: { error: \"Failed to load item data\" } };\r\n  }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}