{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\NewSearch\\\\item\\\\[id]\\\\NewLocal.js\";\nvar __jsx = React.createElement;\n// NewLocal.js\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { Form, Row, Col, Button, Stack, Modal, Spinner } from \"react-bootstrap\";\nimport { useRouter } from \"next/router\";\nimport firebase from \"../../../../context/Firebase\";\nimport styles from \"./NewLocal.module.css\";\nexport default function NewLocal({\n  onSave = () => {},\n  onCancel = () => {},\n  selectedClient,\n  showLocalLoc,\n  value = {},\n  onChange\n}) {\n  const router = useRouter();\n  const {\n    0: regionOptions,\n    1: setRegionOptions\n  } = useState([]);\n  const {\n    0: sectionMap,\n    1: setSectionMap\n  } = useState({});\n  const {\n    0: binCount,\n    1: setBinCount\n  } = useState(0);\n  const {\n    0: palletCount,\n    1: setPalletCount\n  } = useState(0);\n  const {\n    0: region,\n    1: setRegion\n  } = useState(\"\");\n  const {\n    0: sectionLetter,\n    1: setSectionLetter\n  } = useState(\"\");\n  const {\n    0: sectionNumber,\n    1: setSectionNumber\n  } = useState(\"\");\n  const {\n    0: binSelected,\n    1: setBinSelected\n  } = useState(\"\");\n  const {\n    0: palletSelected,\n    1: setPalletSelected\n  } = useState(\"\");\n  const {\n    0: showMap,\n    1: setShowMap\n  } = useState(false);\n  const {\n    0: mapStep,\n    1: setMapStep\n  } = useState(\"regions\");\n  const {\n    0: mapRegion,\n    1: setMapRegion\n  } = useState(\"\");\n  const {\n    0: mapRow,\n    1: setMapRow\n  } = useState(\"\");\n  const {\n    0: mapCol,\n    1: setMapCol\n  } = useState(\"\");\n  const {\n    0: mapPallet,\n    1: setMapPallet\n  } = useState(\"\");\n  const {\n    0: mapCellPallets,\n    1: setMapCellPallets\n  } = useState({});\n  const {\n    0: mapPalletBins,\n    1: setMapPalletBins\n  } = useState({});\n  const {\n    0: mapLoading,\n    1: setMapLoading\n  } = useState(false);\n  const {\n    0: mapError,\n    1: setMapError\n  } = useState(\"\"); // 1) load directory exactly as before\n\n  useEffect(() => {\n    if (!showLocalLoc) return;\n    const db = firebase.firestore();\n    db.collection(\"Warehouse\").doc(\"directory\").get().then(doc => {\n      const d = doc.data() || {};\n      setRegionOptions(d.Region || []);\n      setSectionMap(d.Section || {});\n      setBinCount(d.Bin || 0);\n      setPalletCount(d.Pallet || 0);\n    });\n  }, [showLocalLoc]); // 2) when we open the modal (or value changes), initialize from value\n\n  useEffect(() => {\n    var _value$section, _value$section2, _value$bin, _value$pallet;\n\n    if (!showLocalLoc) return;\n    setRegion(value.region || \"\");\n    setSectionLetter(((_value$section = value.section) === null || _value$section === void 0 ? void 0 : _value$section.letter) || \"\");\n    setSectionNumber(((_value$section2 = value.section) === null || _value$section2 === void 0 ? void 0 : _value$section2.number) || \"\");\n    setBinSelected(((_value$bin = value.bin) === null || _value$bin === void 0 ? void 0 : _value$bin.toString()) || \"\");\n    setPalletSelected(((_value$pallet = value.pallet) === null || _value$pallet === void 0 ? void 0 : _value$pallet.toString()) || \"\");\n  }, [showLocalLoc]); // 3) notify parent on any change\n\n  useEffect(() => {\n    const p = {};\n    if (region) p.region = region;\n    if (sectionLetter && sectionNumber) p.section = {\n      letter: sectionLetter,\n      number: sectionNumber\n    };\n    if (binSelected) p.bin = parseInt(binSelected, 10);\n    if (palletSelected) p.pallet = parseInt(palletSelected, 10);\n    onChange(p);\n  }, [region, sectionLetter, sectionNumber, binSelected, palletSelected]); // helpers:\n\n  const letters = Array.from({\n    length: 26\n  }, (_, i) => String.fromCharCode(65 + i));\n  const numbers = Array.from({\n    length: 50\n  }, (_, i) => i + 1);\n  const binOptions = Array.from({\n    length: binCount\n  }, (_, i) => i + 1);\n  const palletOptions = Array.from({\n    length: palletCount\n  }, (_, i) => i + 1);\n  const regionLetters = useMemo(() => Array.isArray(regionOptions) && regionOptions.length ? regionOptions : [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\"], [regionOptions]);\n\n  const getRegionDimensions = regionId => {\n    const entry = sectionMap === null || sectionMap === void 0 ? void 0 : sectionMap[regionId];\n\n    if (Array.isArray(entry) && entry.length >= 2) {\n      const cols = parseInt(entry[0], 10);\n      const rows = parseInt(entry[1], 10);\n      return {\n        cols: Number.isFinite(cols) ? cols : 0,\n        rows: Number.isFinite(rows) ? rows : 0\n      };\n    }\n\n    return {\n      cols: 0,\n      rows: 0\n    };\n  };\n\n  const loadRegionInventory = async regionId => {\n    if (!regionId) return;\n    setMapLoading(true);\n    setMapError(\"\");\n\n    try {\n      const snap = await firebase.firestore().collection(\"Test\").where(\"newLocalCurrent.region\", \"==\", regionId).get();\n      const cellPallets = {};\n      const palletBins = {};\n      snap.forEach(doc => {\n        var _doc$data, _loc$section, _loc$section2;\n\n        const loc = ((_doc$data = doc.data()) === null || _doc$data === void 0 ? void 0 : _doc$data.newLocalCurrent) || {};\n        let row = (_loc$section = loc.section) === null || _loc$section === void 0 ? void 0 : _loc$section.letter;\n        let col = (_loc$section2 = loc.section) === null || _loc$section2 === void 0 ? void 0 : _loc$section2.number;\n\n        if ((!row || !col) && typeof loc.section === \"string\") {\n          const trimmed = loc.section.trim();\n          row = trimmed.slice(0, 1);\n          col = trimmed.slice(1);\n        }\n\n        if (col !== undefined && col !== null) {\n          col = String(col);\n        }\n\n        const pallet = loc.pallet;\n        const bin = loc.bin;\n        if (!row || !col) return;\n        const cellKey = `${row}-${col}`;\n\n        if (pallet !== undefined && pallet !== null && `${pallet}` !== \"\") {\n          if (!cellPallets[cellKey]) cellPallets[cellKey] = new Set();\n          cellPallets[cellKey].add(String(pallet));\n\n          if (bin !== undefined && bin !== null && `${bin}` !== \"\") {\n            const palletKey = `${cellKey}-P${pallet}`;\n            if (!palletBins[palletKey]) palletBins[palletKey] = new Set();\n            palletBins[palletKey].add(String(bin));\n          }\n        }\n      });\n      const cellObj = {};\n      Object.keys(cellPallets).forEach(key => {\n        cellObj[key] = Array.from(cellPallets[key]).sort((a, b) => Number(a) - Number(b));\n      });\n      const palletObj = {};\n      Object.keys(palletBins).forEach(key => {\n        palletObj[key] = Array.from(palletBins[key]).sort((a, b) => Number(a) - Number(b));\n      });\n      setMapCellPallets(cellObj);\n      setMapPalletBins(palletObj);\n    } catch (error) {\n      console.error(\"Failed to load map inventory\", error);\n      setMapError(\"Failed to load map inventory.\");\n    } finally {\n      setMapLoading(false);\n    }\n  }; // bump and persist bin count\n\n\n  const handleAddBin = async () => {\n    const next = binCount + 1;\n    await firebase.firestore().collection(\"Warehouse\").doc(\"directory\").update({\n      Bin: next\n    });\n    setBinCount(next);\n    setBinSelected(next.toString());\n  }; // bump and persist pallet count\n\n\n  const handleAddPallet = async () => {\n    const next = palletCount + 1;\n    await firebase.firestore().collection(\"Warehouse\").doc(\"directory\").update({\n      Pallet: next\n    });\n    setPalletCount(next);\n    setPalletSelected(next.toString());\n  }; // only fire parent when they click OK\n\n\n  const handleOk = () => {\n    const p = {};\n    if (region) p.region = region;\n    if (sectionLetter && sectionNumber) p.section = {\n      letter: sectionLetter,\n      number: sectionNumber\n    };\n    if (binSelected) p.bin = parseInt(binSelected, 10);\n    if (palletSelected) p.pallet = parseInt(palletSelected, 10);\n    onSave(p);\n  };\n\n  const openMap = () => {\n    setMapError(\"\");\n\n    if (region) {\n      setMapRegion(region);\n      setMapStep(\"grid\");\n      loadRegionInventory(region);\n    } else {\n      setMapRegion(\"\");\n      setMapStep(\"regions\");\n    }\n\n    setShowMap(true);\n  };\n\n  const handleSelectRegion = regionId => {\n    setMapRegion(regionId);\n    setRegion(regionId);\n    setMapRow(\"\");\n    setMapCol(\"\");\n    setMapPallet(\"\");\n    setPalletSelected(\"\");\n    setBinSelected(\"\");\n    setMapStep(\"grid\");\n    loadRegionInventory(regionId);\n  };\n\n  const handleSelectCell = (rowLetter, colNumber) => {\n    setMapRow(rowLetter);\n    setMapCol(colNumber);\n    setSectionLetter(rowLetter);\n    setSectionNumber(String(colNumber));\n    setMapPallet(\"\");\n    setPalletSelected(\"\");\n    setBinSelected(\"\");\n    setMapStep(\"pallets\");\n  };\n\n  const handleSelectPallet = palletId => {\n    setMapPallet(palletId);\n    setPalletSelected(String(palletId));\n    setBinSelected(\"\");\n    setMapStep(\"bins\");\n  };\n\n  const handleSelectBin = binId => {\n    setBinSelected(String(binId));\n  };\n\n  const handleMapBack = () => {\n    if (mapStep === \"bins\") setMapStep(\"pallets\");else if (mapStep === \"pallets\") setMapStep(\"grid\");else if (mapStep === \"grid\") setMapStep(\"regions\");\n  };\n\n  const handleViewInventory = (overrides = {}) => {\n    var _ref, _overrides$region, _ref2, _overrides$sectionLet, _ref3, _overrides$sectionNum, _ref4, _overrides$pallet, _overrides$bin;\n\n    const params = new URLSearchParams();\n    const regionValue = (_ref = (_overrides$region = overrides.region) !== null && _overrides$region !== void 0 ? _overrides$region : mapRegion) !== null && _ref !== void 0 ? _ref : region;\n    const letterValue = (_ref2 = (_overrides$sectionLet = overrides.sectionLetter) !== null && _overrides$sectionLet !== void 0 ? _overrides$sectionLet : mapRow) !== null && _ref2 !== void 0 ? _ref2 : sectionLetter;\n    const numberValue = (_ref3 = (_overrides$sectionNum = overrides.sectionNumber) !== null && _overrides$sectionNum !== void 0 ? _overrides$sectionNum : mapCol) !== null && _ref3 !== void 0 ? _ref3 : sectionNumber;\n    const palletValue = (_ref4 = (_overrides$pallet = overrides.pallet) !== null && _overrides$pallet !== void 0 ? _overrides$pallet : mapPallet) !== null && _ref4 !== void 0 ? _ref4 : palletSelected;\n    const binValue = (_overrides$bin = overrides.bin) !== null && _overrides$bin !== void 0 ? _overrides$bin : binSelected;\n    if (regionValue) params.set(\"region\", regionValue);\n    if (letterValue) params.set(\"sectionLetter\", letterValue);\n    if (numberValue) params.set(\"sectionNumber\", numberValue);\n    if (palletValue) params.set(\"pallet\", palletValue);\n    if (binValue) params.set(\"bin\", binValue);\n    const query = params.toString();\n    router.push(`/NewSearch/inventory/inventoryManage${query ? `?${query}` : \"\"}`);\n  };\n\n  return __jsx(\"div\", {\n    className: styles.wrapper,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 262,\n      columnNumber: 5\n    }\n  }, __jsx(Row, {\n    className: styles.formRow,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 263,\n      columnNumber: 7\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    className: styles.formGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 13\n    }\n  }, \"Region\"), __jsx(Form.Select, {\n    value: region,\n    onChange: e => setRegion(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 270,\n      columnNumber: 15\n    }\n  }, \"Select region\"), regionOptions.map(r => __jsx(\"option\", {\n    key: r,\n    value: r,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 271,\n      columnNumber: 38\n    }\n  }, r))))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    className: styles.formGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 13\n    }\n  }, \"Section Letter\"), __jsx(Form.Select, {\n    value: sectionLetter,\n    onChange: e => setSectionLetter(e.target.value) // disabled={!region}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 278,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 15\n    }\n  }, \"Letter\"), letters.map(l => __jsx(\"option\", {\n    key: l,\n    value: l,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 32\n    }\n  }, l))))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 288,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    className: styles.formGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 289,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 290,\n      columnNumber: 13\n    }\n  }, \"Section Number\"), __jsx(Form.Select, {\n    value: sectionNumber,\n    onChange: e => setSectionNumber(e.target.value) // disabled={!region}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 291,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 15\n    }\n  }, \"Number\"), numbers.map(n => __jsx(\"option\", {\n    key: n,\n    value: n,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 32\n    }\n  }, n)))))), __jsx(Row, {\n    className: \"mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 7\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    className: styles.formGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 13\n    }\n  }, \"Bin\"), __jsx(Stack, {\n    direction: \"horizontal\",\n    gap: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 306,\n      columnNumber: 13\n    }\n  }, __jsx(Form.Select, {\n    value: binSelected,\n    onChange: e => setBinSelected(e.target.value) // disabled={!region}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 15\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 17\n    }\n  }, \"Select bin\"), binOptions.map(b => __jsx(\"option\", {\n    key: b,\n    value: b,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 38\n    }\n  }, b))), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleAddBin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 15\n    }\n  }, \"+ Bin\")))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    className: styles.formGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 323,\n      columnNumber: 11\n    }\n  }, \"Pallet\"), __jsx(Stack, {\n    direction: \"horizontal\",\n    gap: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 324,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Select, {\n    value: palletSelected,\n    onChange: e => setPalletSelected(e.target.value) // disabled={!region}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 11\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 15\n    }\n  }, \"Select pallet\"), palletOptions.map(p => __jsx(\"option\", {\n    key: p,\n    value: p,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 41\n    }\n  }, p))), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleAddPallet,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 15\n    }\n  }, \"+ Pallet\"))))), __jsx(\"div\", {\n    className: styles.actionRow,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 7\n    }\n  }, __jsx(Button, {\n    variant: \"outline-primary\",\n    onClick: openMap,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 9\n    }\n  }, \"Map\"), __jsx(\"div\", {\n    className: styles.actionSpacer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 9\n    }\n  }), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: onCancel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 9\n    }\n  }, \"Cancel\"), __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleOk,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 9\n    }\n  }, \"OK\")), __jsx(Modal, {\n    show: showMap,\n    onHide: () => setShowMap(false),\n    centered: true,\n    size: \"lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 11\n    }\n  }, \"Warehouse Map\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 9\n    }\n  }, mapLoading && __jsx(\"div\", {\n    className: styles.mapLoading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 13\n    }\n  }, __jsx(Spinner, {\n    animation: \"border\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 15\n    }\n  }), __jsx(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 15\n    }\n  }, \"Loading map data\\u2026\")), mapError && __jsx(\"div\", {\n    className: styles.mapError,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 370,\n      columnNumber: 24\n    }\n  }, mapError), !mapLoading && mapStep === \"regions\" && __jsx(\"div\", {\n    className: styles.mapStage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 373,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: styles.mapHint,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 15\n    }\n  }, \"Select a region\"), __jsx(\"div\", {\n    className: styles.mapCanvas,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 15\n    }\n  }, [\"E\", \"F\", \"G\", \"A\", \"D\", \"C\", \"B\"].map(regionId => __jsx(\"button\", {\n    key: regionId,\n    type: \"button\",\n    className: `${styles.regionBlock} ${styles[`region${regionId}`]}`,\n    onClick: () => handleSelectRegion(regionId),\n    disabled: !regionLetters.includes(regionId),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 19\n    }\n  }, regionId)))), !mapLoading && mapStep === \"grid\" && __jsx(\"div\", {\n    className: styles.mapStage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 392,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: styles.mapHint,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 15\n    }\n  }, \"Region \", mapRegion, \": choose a row and column\"), (() => {\n    const dims = getRegionDimensions(mapRegion);\n    const rows = letters.slice(0, dims.rows || 0);\n    const cols = numbers.slice(0, dims.cols || 0);\n\n    if (!rows.length || !cols.length) {\n      return __jsx(\"div\", {\n        className: styles.mapEmpty,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 21\n        }\n      }, \"No grid data for this region.\");\n    }\n\n    return __jsx(\"div\", {\n      className: styles.gridWrapper,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 19\n      }\n    }, __jsx(\"div\", {\n      className: styles.grid,\n      style: {\n        \"--grid-cols\": cols.length\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 409,\n        columnNumber: 21\n      }\n    }, rows.map(row => cols.map(col => {\n      var _mapCellPallets$cellK;\n\n      const cellKey = `${row}-${col}`;\n      const hasPallets = Boolean((_mapCellPallets$cellK = mapCellPallets[cellKey]) === null || _mapCellPallets$cellK === void 0 ? void 0 : _mapCellPallets$cellK.length);\n      return __jsx(\"button\", {\n        key: cellKey,\n        type: \"button\",\n        className: `${styles.gridCell} ${hasPallets ? \"\" : styles.gridCellDisabled}`,\n        onClick: () => hasPallets && handleSelectCell(row, col),\n        disabled: !hasPallets,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 420,\n          columnNumber: 29\n        }\n      }, __jsx(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 431,\n          columnNumber: 31\n        }\n      }, row, col));\n    }))));\n  })()), !mapLoading && mapStep === \"pallets\" && __jsx(\"div\", {\n    className: styles.mapStage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 444,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: styles.mapHint,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 15\n    }\n  }, \"Region \", mapRegion, \" \\xB7 Section \", mapRow, mapCol, \": select a pallet\"), __jsx(\"div\", {\n    className: styles.palletGrid,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 15\n    }\n  }, (mapCellPallets[`${mapRow}-${mapCol}`] || []).map(pallet => {\n    const palletKey = `${mapRow}-${mapCol}-P${pallet}`;\n    const bins = mapPalletBins[palletKey] || [];\n    return __jsx(\"button\", {\n      key: pallet,\n      type: \"button\",\n      className: styles.palletButton,\n      onClick: () => {\n        if (bins.length === 0) {\n          handleViewInventory({\n            region: mapRegion,\n            sectionLetter: mapRow,\n            sectionNumber: mapCol,\n            pallet,\n            bin: \"\"\n          });\n          setShowMap(false);\n          return;\n        }\n\n        handleSelectPallet(pallet);\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 453,\n        columnNumber: 21\n      }\n    }, \"Pallet \", pallet);\n  }), !(mapCellPallets[`${mapRow}-${mapCol}`] || []).length && __jsx(\"div\", {\n    className: styles.mapEmpty,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 477,\n      columnNumber: 19\n    }\n  }, \"No pallets available here.\"))), !mapLoading && mapStep === \"bins\" && __jsx(\"div\", {\n    className: styles.mapStage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 486,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    className: styles.mapHint,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 487,\n      columnNumber: 15\n    }\n  }, \"Region \", mapRegion, \" \\xB7 Section \", mapRow, mapCol, \" \\xB7 Pallet \", mapPallet), __jsx(\"div\", {\n    className: styles.palletGrid,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 490,\n      columnNumber: 15\n    }\n  }, (mapPalletBins[`${mapRow}-${mapCol}-P${mapPallet}`] || []).map(bin => __jsx(\"button\", {\n    key: bin,\n    type: \"button\",\n    className: `${styles.palletButton} ${styles.binButton}`,\n    onClick: () => handleSelectBin(bin),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 493,\n      columnNumber: 21\n    }\n  }, \"Bin \", bin)), !(mapPalletBins[`${mapRow}-${mapCol}-P${mapPallet}`] || []).length && __jsx(\"div\", {\n    className: styles.mapEmpty,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 505,\n      columnNumber: 19\n    }\n  }, \"No bins available on this pallet.\")))), __jsx(Modal.Footer, {\n    className: styles.mapFooter,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 513,\n      columnNumber: 9\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleMapBack,\n    disabled: mapStep === \"regions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 514,\n      columnNumber: 11\n    }\n  }, \"Back\"), __jsx(Button, {\n    variant: \"outline-primary\",\n    onClick: handleViewInventory,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 11\n    }\n  }, \"View\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: () => setShowMap(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 524,\n      columnNumber: 11\n    }\n  }, \"Close\"))));\n}","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/NewSearch/item/[id]/NewLocal.js"],"names":["React","useState","useEffect","useMemo","Form","Row","Col","Button","Stack","Modal","Spinner","useRouter","firebase","styles","NewLocal","onSave","onCancel","selectedClient","showLocalLoc","value","onChange","router","regionOptions","setRegionOptions","sectionMap","setSectionMap","binCount","setBinCount","palletCount","setPalletCount","region","setRegion","sectionLetter","setSectionLetter","sectionNumber","setSectionNumber","binSelected","setBinSelected","palletSelected","setPalletSelected","showMap","setShowMap","mapStep","setMapStep","mapRegion","setMapRegion","mapRow","setMapRow","mapCol","setMapCol","mapPallet","setMapPallet","mapCellPallets","setMapCellPallets","mapPalletBins","setMapPalletBins","mapLoading","setMapLoading","mapError","setMapError","db","firestore","collection","doc","get","then","d","data","Region","Section","Bin","Pallet","section","letter","number","bin","toString","pallet","p","parseInt","letters","Array","from","length","_","i","String","fromCharCode","numbers","binOptions","palletOptions","regionLetters","isArray","getRegionDimensions","regionId","entry","cols","rows","Number","isFinite","loadRegionInventory","snap","where","cellPallets","palletBins","forEach","loc","newLocalCurrent","row","col","trimmed","trim","slice","undefined","cellKey","Set","add","palletKey","cellObj","Object","keys","key","sort","a","b","palletObj","error","console","handleAddBin","next","update","handleAddPallet","handleOk","openMap","handleSelectRegion","handleSelectCell","rowLetter","colNumber","handleSelectPallet","palletId","handleSelectBin","binId","handleMapBack","handleViewInventory","overrides","params","URLSearchParams","regionValue","letterValue","numberValue","palletValue","binValue","set","query","push","wrapper","formRow","formGroup","e","target","map","r","l","n","actionRow","actionSpacer","mapStage","mapHint","mapCanvas","regionBlock","includes","dims","mapEmpty","gridWrapper","grid","hasPallets","Boolean","gridCell","gridCellDisabled","palletGrid","bins","palletButton","binButton","mapFooter"],"mappings":"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","sourcesContent":["// NewLocal.js\nimport React, { useState, useEffect, useMemo } from \"react\";\nimport { Form, Row, Col, Button, Stack, Modal, Spinner } from \"react-bootstrap\";\nimport { useRouter } from \"next/router\";\nimport firebase from \"../../../../context/Firebase\";\nimport styles from \"./NewLocal.module.css\";\n\nexport default function NewLocal({\n  onSave = () => {},\n  onCancel = () => {},\n  selectedClient,\n  showLocalLoc,\n  value = {},\n  onChange,\n}) {\n  const router = useRouter();\n  const [regionOptions, setRegionOptions] = useState([]);\n  const [sectionMap, setSectionMap]     = useState({});\n  const [binCount, setBinCount]         = useState(0);\n  const [palletCount, setPalletCount]   = useState(0);\n\n  const [region, setRegion] = useState(\"\");\n  const [sectionLetter, setSectionLetter] = useState(\"\");\n  const [sectionNumber, setSectionNumber] = useState(\"\");\n  const [binSelected, setBinSelected]     = useState(\"\");\n  const [palletSelected, setPalletSelected] = useState(\"\");\n  const [showMap, setShowMap] = useState(false);\n  const [mapStep, setMapStep] = useState(\"regions\");\n  const [mapRegion, setMapRegion] = useState(\"\");\n  const [mapRow, setMapRow] = useState(\"\");\n  const [mapCol, setMapCol] = useState(\"\");\n  const [mapPallet, setMapPallet] = useState(\"\");\n  const [mapCellPallets, setMapCellPallets] = useState({});\n  const [mapPalletBins, setMapPalletBins] = useState({});\n  const [mapLoading, setMapLoading] = useState(false);\n  const [mapError, setMapError] = useState(\"\");\n\n  // 1) load directory exactly as before\n  useEffect(() => {\n    if (!showLocalLoc) return;\n    const db = firebase.firestore();\n    db.collection(\"Warehouse\").doc(\"directory\").get().then(doc => {\n      const d = doc.data() || {};\n      setRegionOptions(d.Region   || []);\n      setSectionMap   (d.Section  || {});\n      setBinCount     (d.Bin      || 0);\n      setPalletCount  (d.Pallet   || 0);\n    });\n  }, [showLocalLoc]);\n\n  // 2) when we open the modal (or value changes), initialize from value\n  useEffect(() => {\n    if (!showLocalLoc) return;\n    setRegion        (value.region             || \"\");\n    setSectionLetter(value.section?.letter    || \"\");\n    setSectionNumber(value.section?.number    || \"\");\n    setBinSelected   (value.bin?.toString()    || \"\");\n    setPalletSelected(value.pallet?.toString()|| \"\");\n  }, [showLocalLoc]);\n\n  // 3) notify parent on any change\n  useEffect(() => {\n    const p = {};\n    if (region)         p.region  = region;\n    if (sectionLetter && sectionNumber) p.section = { letter: sectionLetter, number: sectionNumber };\n    if (binSelected)    p.bin     = parseInt(binSelected,10);\n    if (palletSelected) p.pallet  = parseInt(palletSelected,10);\n    onChange(p);\n  }, [region, sectionLetter, sectionNumber, binSelected, palletSelected]);\n\n  // helpers:\nconst letters = Array.from({ length: 26 }, (_, i) => String.fromCharCode(65 + i));\nconst numbers = Array.from({ length: 50 }, (_, i) => i + 1);\n  const binOptions = Array.from({ length: binCount }, (_, i) => i + 1);\n  const palletOptions = Array.from({ length: palletCount }, (_, i) => i + 1);\n  const regionLetters = useMemo(\n    () => (Array.isArray(regionOptions) && regionOptions.length ? regionOptions : [\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\"]),\n    [regionOptions]\n  );\n  const getRegionDimensions = (regionId) => {\n    const entry = sectionMap?.[regionId];\n    if (Array.isArray(entry) && entry.length >= 2) {\n      const cols = parseInt(entry[0], 10);\n      const rows = parseInt(entry[1], 10);\n      return {\n        cols: Number.isFinite(cols) ? cols : 0,\n        rows: Number.isFinite(rows) ? rows : 0,\n      };\n    }\n    return { cols: 0, rows: 0 };\n  };\n\n  const loadRegionInventory = async (regionId) => {\n    if (!regionId) return;\n    setMapLoading(true);\n    setMapError(\"\");\n    try {\n      const snap = await firebase\n        .firestore()\n        .collection(\"Test\")\n        .where(\"newLocalCurrent.region\", \"==\", regionId)\n        .get();\n\n      const cellPallets = {};\n      const palletBins = {};\n      snap.forEach((doc) => {\n        const loc = doc.data()?.newLocalCurrent || {};\n        let row = loc.section?.letter;\n        let col = loc.section?.number;\n        if ((!row || !col) && typeof loc.section === \"string\") {\n          const trimmed = loc.section.trim();\n          row = trimmed.slice(0, 1);\n          col = trimmed.slice(1);\n        }\n        if (col !== undefined && col !== null) {\n          col = String(col);\n        }\n        const pallet = loc.pallet;\n        const bin = loc.bin;\n        if (!row || !col) return;\n        const cellKey = `${row}-${col}`;\n        if (pallet !== undefined && pallet !== null && `${pallet}` !== \"\") {\n          if (!cellPallets[cellKey]) cellPallets[cellKey] = new Set();\n          cellPallets[cellKey].add(String(pallet));\n          if (bin !== undefined && bin !== null && `${bin}` !== \"\") {\n            const palletKey = `${cellKey}-P${pallet}`;\n            if (!palletBins[palletKey]) palletBins[palletKey] = new Set();\n            palletBins[palletKey].add(String(bin));\n          }\n        }\n      });\n\n      const cellObj = {};\n      Object.keys(cellPallets).forEach((key) => {\n        cellObj[key] = Array.from(cellPallets[key]).sort(\n          (a, b) => Number(a) - Number(b)\n        );\n      });\n\n      const palletObj = {};\n      Object.keys(palletBins).forEach((key) => {\n        palletObj[key] = Array.from(palletBins[key]).sort(\n          (a, b) => Number(a) - Number(b)\n        );\n      });\n\n      setMapCellPallets(cellObj);\n      setMapPalletBins(palletObj);\n    } catch (error) {\n      console.error(\"Failed to load map inventory\", error);\n      setMapError(\"Failed to load map inventory.\");\n    } finally {\n      setMapLoading(false);\n    }\n  };\n\n  // bump and persist bin count\n  const handleAddBin = async () => {\n    const next = binCount + 1;\n    await firebase.firestore()\n      .collection(\"Warehouse\").doc(\"directory\")\n      .update({ Bin: next });\n    setBinCount(next);\n    setBinSelected(next.toString());\n  };\n\n  // bump and persist pallet count\n  const handleAddPallet = async () => {\n    const next = palletCount + 1;\n    await firebase.firestore()\n      .collection(\"Warehouse\").doc(\"directory\")\n      .update({ Pallet: next });\n    setPalletCount(next);\n    setPalletSelected(next.toString());\n  };\n\n  // only fire parent when they click OK\n  const handleOk = () => {\n    const p = {};\n    if (region) p.region = region;\n    if (sectionLetter && sectionNumber)\n      p.section = { letter: sectionLetter, number: sectionNumber };\n    if (binSelected) p.bin = parseInt(binSelected, 10);\n    if (palletSelected) p.pallet = parseInt(palletSelected, 10);\n    onSave(p);\n  };\n\n  const openMap = () => {\n    setMapError(\"\");\n    if (region) {\n      setMapRegion(region);\n      setMapStep(\"grid\");\n      loadRegionInventory(region);\n    } else {\n      setMapRegion(\"\");\n      setMapStep(\"regions\");\n    }\n    setShowMap(true);\n  };\n\n  const handleSelectRegion = (regionId) => {\n    setMapRegion(regionId);\n    setRegion(regionId);\n    setMapRow(\"\");\n    setMapCol(\"\");\n    setMapPallet(\"\");\n    setPalletSelected(\"\");\n    setBinSelected(\"\");\n    setMapStep(\"grid\");\n    loadRegionInventory(regionId);\n  };\n\n  const handleSelectCell = (rowLetter, colNumber) => {\n    setMapRow(rowLetter);\n    setMapCol(colNumber);\n    setSectionLetter(rowLetter);\n    setSectionNumber(String(colNumber));\n    setMapPallet(\"\");\n    setPalletSelected(\"\");\n    setBinSelected(\"\");\n    setMapStep(\"pallets\");\n  };\n\n  const handleSelectPallet = (palletId) => {\n    setMapPallet(palletId);\n    setPalletSelected(String(palletId));\n    setBinSelected(\"\");\n    setMapStep(\"bins\");\n  };\n\n  const handleSelectBin = (binId) => {\n    setBinSelected(String(binId));\n  };\n\n  const handleMapBack = () => {\n    if (mapStep === \"bins\") setMapStep(\"pallets\");\n    else if (mapStep === \"pallets\") setMapStep(\"grid\");\n    else if (mapStep === \"grid\") setMapStep(\"regions\");\n  };\n\n  const handleViewInventory = (overrides = {}) => {\n    const params = new URLSearchParams();\n    const regionValue = overrides.region ?? mapRegion ?? region;\n    const letterValue = overrides.sectionLetter ?? mapRow ?? sectionLetter;\n    const numberValue = overrides.sectionNumber ?? mapCol ?? sectionNumber;\n    const palletValue = overrides.pallet ?? mapPallet ?? palletSelected;\n    const binValue = overrides.bin ?? binSelected;\n\n    if (regionValue) params.set(\"region\", regionValue);\n    if (letterValue) params.set(\"sectionLetter\", letterValue);\n    if (numberValue) params.set(\"sectionNumber\", numberValue);\n    if (palletValue) params.set(\"pallet\", palletValue);\n    if (binValue) params.set(\"bin\", binValue);\n\n    const query = params.toString();\n    router.push(\n      `/NewSearch/inventory/inventoryManage${query ? `?${query}` : \"\"}`\n    );\n  };\n\n  return (\n    <div className={styles.wrapper}>\n      <Row className={styles.formRow}>\n        <Col>\n          <Form.Group className={styles.formGroup}>\n            <Form.Label>Region</Form.Label>\n            <Form.Select\n              value={region} onChange={e=>setRegion(e.target.value)}\n            >\n              <option value=\"\">Select region</option>\n              {regionOptions.map(r=> <option key={r} value={r}>{r}</option>)}\n            </Form.Select>\n          </Form.Group>\n        </Col>\n        <Col>\n          <Form.Group className={styles.formGroup}>\n            <Form.Label>Section Letter</Form.Label>\n            <Form.Select\n              value={sectionLetter}\n              onChange={e=>setSectionLetter(e.target.value)}\n              // disabled={!region}\n            >\n              <option value=\"\">Letter</option>\n              {letters.map(l=> <option key={l} value={l}>{l}</option>)}\n            </Form.Select>\n          </Form.Group>\n        </Col>\n        <Col>\n          <Form.Group className={styles.formGroup}>\n            <Form.Label>Section Number</Form.Label>\n            <Form.Select\n              value={sectionNumber}\n              onChange={e=>setSectionNumber(e.target.value)}\n              // disabled={!region}\n            >\n              <option value=\"\">Number</option>\n              {numbers.map(n=> <option key={n} value={n}>{n}</option>)}\n            </Form.Select>\n          </Form.Group>\n        </Col>\n      </Row>\n      <Row className=\"mt-3\">\n        <Col>\n          <Form.Group className={styles.formGroup}>\n            <Form.Label>Bin</Form.Label>\n            <Stack direction=\"horizontal\" gap={2}>\n              <Form.Select\n                value={binSelected}\n                onChange={e => setBinSelected(e.target.value)}\n                // disabled={!region}\n              >\n                <option value=\"\">Select bin</option>\n                {binOptions.map(b => <option key={b} value={b}>{b}</option>)}\n              </Form.Select>\n              <Button variant=\"outline-secondary\" onClick={handleAddBin} >\n                + Bin\n              </Button>\n            </Stack>\n          </Form.Group>\n        </Col>\n        <Col>\n          <Form.Group className={styles.formGroup}>\n          <Form.Label>Pallet</Form.Label>\n          <Stack direction=\"horizontal\" gap={2}>\n          <Form.Select\n            value={palletSelected}\n            onChange={e =>setPalletSelected(e.target.value)}\n              // disabled={!region}\n            >\n              <option value=\"\">Select pallet</option>\n                {palletOptions.map(p => <option key={p} value={p}>{p}</option>)}\n              </Form.Select>\n              <Button variant=\"outline-secondary\" onClick={handleAddPallet} >\n                + Pallet\n              </Button>\n            </Stack>\n          </Form.Group>\n        </Col>\n      </Row>\n      {/* OK / Cancel footer */}\n      <div className={styles.actionRow}>\n        <Button variant=\"outline-primary\" onClick={openMap}>\n          Map\n        </Button>\n        <div className={styles.actionSpacer} />\n        <Button variant=\"secondary\" onClick={onCancel}>\n          Cancel\n        </Button>\n        <Button variant=\"primary\" onClick={handleOk}>\n          OK\n        </Button>\n      </div>\n\n      <Modal\n        show={showMap}\n        onHide={() => setShowMap(false)}\n        centered\n        size=\"lg\"\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>Warehouse Map</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          {mapLoading && (\n            <div className={styles.mapLoading}>\n              <Spinner animation=\"border\" />\n              <span>Loading map data</span>\n            </div>\n          )}\n          {mapError && <div className={styles.mapError}>{mapError}</div>}\n\n          {!mapLoading && mapStep === \"regions\" && (\n            <div className={styles.mapStage}>\n              <div className={styles.mapHint}>Select a region</div>\n              <div className={styles.mapCanvas}>\n                {[\"E\", \"F\", \"G\", \"A\", \"D\", \"C\", \"B\"].map((regionId) => (\n                  <button\n                    key={regionId}\n                    type=\"button\"\n                    className={`${styles.regionBlock} ${styles[`region${regionId}`]}`}\n                    onClick={() => handleSelectRegion(regionId)}\n                    disabled={!regionLetters.includes(regionId)}\n                  >\n                    {regionId}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {!mapLoading && mapStep === \"grid\" && (\n            <div className={styles.mapStage}>\n              <div className={styles.mapHint}>\n                Region {mapRegion}: choose a row and column\n              </div>\n              {(() => {\n                const dims = getRegionDimensions(mapRegion);\n                const rows = letters.slice(0, dims.rows || 0);\n                const cols = numbers.slice(0, dims.cols || 0);\n                if (!rows.length || !cols.length) {\n                  return (\n                    <div className={styles.mapEmpty}>\n                      No grid data for this region.\n                    </div>\n                  );\n                }\n                return (\n                  <div className={styles.gridWrapper}>\n                    <div\n                      className={styles.grid}\n                      style={{ \"--grid-cols\": cols.length }}\n                    >\n                      {rows.map((row) =>\n                        cols.map((col) => {\n                          const cellKey = `${row}-${col}`;\n                          const hasPallets = Boolean(\n                            mapCellPallets[cellKey]?.length\n                          );\n                          return (\n                            <button\n                              key={cellKey}\n                              type=\"button\"\n                              className={`${styles.gridCell} ${\n                                hasPallets ? \"\" : styles.gridCellDisabled\n                              }`}\n                              onClick={() =>\n                                hasPallets && handleSelectCell(row, col)\n                              }\n                              disabled={!hasPallets}\n                            >\n                              <span>{row}{col}</span>\n                            </button>\n                          );\n                        })\n                      )}\n                    </div>\n                  </div>\n                );\n              })()}\n            </div>\n          )}\n\n          {!mapLoading && mapStep === \"pallets\" && (\n            <div className={styles.mapStage}>\n              <div className={styles.mapHint}>\n                Region {mapRegion}  Section {mapRow}{mapCol}: select a pallet\n              </div>\n              <div className={styles.palletGrid}>\n                {(mapCellPallets[`${mapRow}-${mapCol}`] || []).map((pallet) => {\n                  const palletKey = `${mapRow}-${mapCol}-P${pallet}`;\n                  const bins = mapPalletBins[palletKey] || [];\n                  return (\n                    <button\n                      key={pallet}\n                      type=\"button\"\n                      className={styles.palletButton}\n                      onClick={() => {\n                        if (bins.length === 0) {\n                          handleViewInventory({\n                            region: mapRegion,\n                            sectionLetter: mapRow,\n                            sectionNumber: mapCol,\n                            pallet,\n                            bin: \"\",\n                          });\n                          setShowMap(false);\n                          return;\n                        }\n                        handleSelectPallet(pallet);\n                      }}\n                    >\n                      Pallet {pallet}\n                    </button>\n                  );\n                })}\n                {!(mapCellPallets[`${mapRow}-${mapCol}`] || []).length && (\n                  <div className={styles.mapEmpty}>\n                    No pallets available here.\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n\n          {!mapLoading && mapStep === \"bins\" && (\n            <div className={styles.mapStage}>\n              <div className={styles.mapHint}>\n                Region {mapRegion}  Section {mapRow}{mapCol}  Pallet {mapPallet}\n              </div>\n              <div className={styles.palletGrid}>\n                {(mapPalletBins[`${mapRow}-${mapCol}-P${mapPallet}`] || []).map(\n                  (bin) => (\n                    <button\n                      key={bin}\n                      type=\"button\"\n                      className={`${styles.palletButton} ${styles.binButton}`}\n                      onClick={() => handleSelectBin(bin)}\n                    >\n                      Bin {bin}\n                    </button>\n                  )\n                )}\n                {!(mapPalletBins[`${mapRow}-${mapCol}-P${mapPallet}`] || [])\n                  .length && (\n                  <div className={styles.mapEmpty}>\n                    No bins available on this pallet.\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </Modal.Body>\n        <Modal.Footer className={styles.mapFooter}>\n          <Button\n            variant=\"outline-secondary\"\n            onClick={handleMapBack}\n            disabled={mapStep === \"regions\"}\n          >\n            Back\n          </Button>\n          <Button variant=\"outline-primary\" onClick={handleViewInventory}>\n            View\n          </Button>\n          <Button variant=\"secondary\" onClick={() => setShowMap(false)}>\n            Close\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}