{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect } from \"react\";\nimport { FormControl, Button, Spinner, Alert } from \"react-bootstrap\";\nimport { useRouter } from \"next/router\";\nimport { fetchClients } from \"../../utils/fetchAssociations\";\nimport ClientTable from \"../../utils/ClientTable\";\nimport styles from \"../../styles/ClientSearch.module.css\"; // import styles from \"../../styles/ClientPage.module.css\";\n\nconst ClientPage = () => {\n  const {\n    0: clients,\n    1: setClients\n  } = useState([]);\n  const {\n    0: clientSearchTerm,\n    1: setClientSearchTerm\n  } = useState(\"\");\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n  const {\n    0: loadError,\n    1: setLoadError\n  } = useState(null);\n  const router = useRouter(); // Fetch clients when the component mounts\n\n  useEffect(() => {\n    const fetchClientData = async () => {\n      try {\n        const clientsData = await fetchClients();\n        setClients(clientsData);\n        setLoadError(null);\n      } catch (error) {\n        console.error(\"Error fetching clients: \", error);\n        setLoadError(\"Failed to load clients. Please try again.\");\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchClientData();\n  }, []); // Handle search input changes\n\n  const handleSearchChange = event => {\n    setClientSearchTerm(event.target.value);\n  }; // Handle client selection\n\n\n  const handleSelectClient = clientId => {\n    console.log(\"Selected client ID:\", clientId); // Redirect to client-specific page\n\n    router.push(`client/${clientId}`);\n  }; // Handle client info button click\n\n\n  const handleClientInfo = clientId => {\n    router.push(`client/${clientId}/addClient`);\n  }; // Clear search input\n\n\n  const clearSelection = () => {\n    setClientSearchTerm(\"\");\n  };\n\n  const addClient = () => {\n    const randomNumber = Math.floor(10000 + Math.random() * 90000); // Navigate to the new route with the random number\n\n    router.push(`client/AIS${randomNumber}/addClient`);\n  };\n\n  const normalizedSearch = clientSearchTerm.trim().toLowerCase();\n  const filteredClients = (Array.isArray(clients) ? clients : []).filter(client => ((client === null || client === void 0 ? void 0 : client.name) || \"\").toLowerCase().includes(normalizedSearch));\n  return __jsx(\"div\", {\n    className: styles.page\n  }, __jsx(\"div\", {\n    className: styles.shell\n  }, __jsx(\"header\", {\n    className: styles.header\n  }, __jsx(\"div\", {\n    className: styles.brand\n  }, __jsx(\"img\", {\n    src: \"/magmo-logo.png\",\n    alt: \"Magmo\",\n    className: styles.brandLogo\n  }), __jsx(\"div\", null, __jsx(\"div\", {\n    className: styles.brandName\n  }, \"Magmo\"), __jsx(\"div\", {\n    className: styles.brandSub\n  }, \"Client Search\"))), __jsx(\"div\", {\n    className: styles.headerActions\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.backButton,\n    onClick: () => router.push(\"../Warehousedb/WarehouseSelect\")\n  }, \"Back\"))), __jsx(\"section\", {\n    className: styles.card\n  }, __jsx(\"div\", {\n    className: styles.cardHeader\n  }, __jsx(\"div\", null, __jsx(\"div\", {\n    className: styles.cardTitle\n  }, \"Clients\"), __jsx(\"div\", {\n    className: styles.cardSubtitle\n  }, \"Search by name and manage client records.\")), __jsx(\"div\", {\n    className: styles.cardBadge\n  }, filteredClients.length, \" clients\")), __jsx(\"div\", {\n    className: styles.cardBody\n  }, loadError && __jsx(Alert, {\n    variant: \"danger\"\n  }, loadError), isLoading ? __jsx(\"div\", {\n    className: styles.loadingWrap\n  }, __jsx(Spinner, {\n    animation: \"border\",\n    role: \"status\"\n  }, __jsx(\"span\", {\n    className: \"sr-only\"\n  }, \"Loading...\"))) : __jsx(React.Fragment, null, __jsx(\"div\", {\n    className: styles.searchRow\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    value: clientSearchTerm,\n    onChange: handleSearchChange,\n    className: styles.searchInput\n  }), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.clearButton,\n    onClick: clearSelection,\n    disabled: !clientSearchTerm\n  }, \"Clear\")), __jsx(\"div\", {\n    className: styles.actionRow\n  }, __jsx(Button, {\n    variant: \"primary\",\n    className: styles.primaryButton,\n    onClick: addClient\n  }, \"Add New Client\")), __jsx(\"div\", {\n    className: styles.tableWrap\n  }, __jsx(ClientTable, {\n    clients: filteredClients,\n    onSelectClient: handleSelectClient,\n    onInfoClick: handleClientInfo,\n    isClientSearch: true\n  })))))));\n};\n\nexport default ClientPage;","map":null,"metadata":{},"sourceType":"module"}