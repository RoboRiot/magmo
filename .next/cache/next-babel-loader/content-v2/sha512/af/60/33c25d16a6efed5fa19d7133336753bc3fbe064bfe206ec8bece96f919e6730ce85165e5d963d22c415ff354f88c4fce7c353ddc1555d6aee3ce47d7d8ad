{"ast":null,"code":"import _defineProperty from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\NewSearch\\\\mainSearch.js\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport React, { useEffect, useState, useRef, useCallback } from \"react\";\nimport { Container, Card, Row, Col, InputGroup, Dropdown, FormControl, Button, NavDropdown, Form, Modal, Spinner, Pagination } from \"react-bootstrap\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { fetchPartsWithMachineDataPage, fetchClients, fetchModels, formatDate } from \"../../utils/fetchAssociations\";\nimport { useAuth } from \"../../context/AuthUserContext\";\nimport LoggedIn from \"../LoggedIn\";\nimport ClientTable from \"../../utils/ClientTable\";\nimport ModelTable from \"../../utils/ModelTable\";\nimport PartTable from \"../../utils/PartTable\";\nimport styles from \"../../styles/MainSearch.module.css\";\nimport firebase from \"../../context/Firebase\"; // Predefined warehouse client IDs and display names\n\nvar SOCAL_CLIENT_ID = \"AIS17182\";\nvar NORCAL_CLIENT_ID = \"AIS25097\";\nvar UNASSIGNED_CLIENT_ID = \"AIS00404\";\nvar PAGE_SIZE = 25; // Simulates a network request delay\n\nfunction simulateNetworkRequest() {\n  return new Promise(function (resolve) {\n    return setTimeout(resolve, 2000);\n  });\n} // Custom LoadingButton component\n\n\nfunction LoadingButton(_ref) {\n  _s();\n\n  var type = _ref.type,\n      name = _ref.name,\n      route = _ref.route;\n\n  var _useState = useState(false),\n      isLoading = _useState[0],\n      setLoading = _useState[1];\n\n  useEffect(function () {\n    if (isLoading) {\n      var cancelled = false;\n      simulateNetworkRequest().then(function () {\n        if (!cancelled) setLoading(false);\n      });\n      return function () {\n        cancelled = true;\n      };\n    }\n  }, [isLoading]);\n  return __jsx(Link, {\n    href: \"/\".concat(route),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", {\n    className: \"btn btn-\".concat(type),\n    disabled: isLoading,\n    onClick: function onClick() {\n      return !isLoading && setLoading(true);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }\n  }, isLoading ? \"Loading…\" : name));\n} // ---- DATE HELPERS (top-level scope) ----\n// Convert anything date-ish into a timestamp (ms since epoch).\n\n\n_s(LoadingButton, \"LHJkidtbt8bk0SOCXf2Y2viet6g=\");\n\n_c = LoadingButton;\n\nfunction toTime(value) {\n  if (!value) return null; // Firestore Timestamp { seconds, nanoseconds }\n\n  if (typeof value === \"object\" && value !== null && value.seconds != null) {\n    try {\n      return value.seconds * 1000;\n    } catch (_unused) {\n      /* ignore */\n    }\n  } // Native Date\n\n\n  if (value instanceof Date) {\n    var _t = value.getTime();\n\n    return isNaN(_t) ? null : _t;\n  } // Strings\n\n\n  if (typeof value === \"string\") {\n    // ISO / yyyy-mm-dd\n    var iso = Date.parse(value);\n    if (!isNaN(iso)) return iso; // mm/dd/yyyy\n\n    var parts = value.split(\"/\");\n\n    if (parts.length === 3) {\n      var _parts = _slicedToArray(parts, 3),\n          mm = _parts[0],\n          dd = _parts[1],\n          yyyy = _parts[2];\n\n      var alt = Date.parse(\"\".concat(yyyy, \"-\").concat(mm, \"-\").concat(dd));\n      if (!isNaN(alt)) return alt;\n    }\n  } // Last resort\n\n\n  var t = Date.parse(value);\n  return isNaN(t) ? null : t;\n} // Canonicalize to 'yyyy-mm-dd' (matches <input type=\"date\">)\n\n\nfunction toYMD(value) {\n  var t = toTime(value);\n  if (t == null) return null;\n  var d = new Date(t);\n  var yyyy = d.getFullYear();\n  var mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  var dd = String(d.getDate()).padStart(2, \"0\");\n  return \"\".concat(yyyy, \"-\").concat(mm, \"-\").concat(dd);\n}\n\nexport default function MainSearch() {\n  _s2();\n\n  var _this = this;\n\n  var _useAuth = useAuth(),\n      signOut = _useAuth.signOut;\n\n  var _useState2 = useState([]),\n      info = _useState2[0],\n      setInfo = _useState2[1];\n\n  var _useState3 = useState([]),\n      backupInfo = _useState3[0],\n      setBackupInfo = _useState3[1];\n\n  var _useState4 = useState([]),\n      augmentedInfo = _useState4[0],\n      setAugmentedInfo = _useState4[1]; // items with clientFromId/currentId added\n\n\n  var _useState5 = useState(true),\n      isLoading = _useState5[0],\n      setIsLoading = _useState5[1];\n\n  var _useState6 = useState([]),\n      ids = _useState6[0],\n      setID = _useState6[1];\n\n  var _useState7 = useState(false),\n      show = _useState7[0],\n      setShow = _useState7[1];\n\n  var _useState8 = useState(),\n      dItem = _useState8[0],\n      setDItem = _useState8[1];\n\n  var _useState9 = useState(\"Name\"),\n      select = _useState9[0],\n      setSelect = _useState9[1];\n\n  var _useState10 = useState(false),\n      showList = _useState10[0],\n      setShowList = _useState10[1];\n\n  var _useState11 = useState(\"text\"),\n      showListSearch = _useState11[0],\n      setShowListSearch = _useState11[1];\n\n  var _useState12 = useState(\"\"),\n      search = _useState12[0],\n      setSearch = _useState12[1];\n\n  var _useState13 = useState(null),\n      selectedOEM = _useState13[0],\n      setSelectedOEM = _useState13[1];\n\n  var _useState14 = useState(null),\n      selectedModality = _useState14[0],\n      setSelectedModality = _useState14[1]; // Replace the old single client state with two sets:\n\n\n  var _useState15 = useState(null),\n      selectedClientFrom = _useState15[0],\n      setSelectedClientFrom = _useState15[1];\n\n  var _useState16 = useState(\"Select Option\"),\n      clientFromButtonText = _useState16[0],\n      setClientFromButtonText = _useState16[1];\n\n  var _useState17 = useState(null),\n      selectedClientCurrent = _useState17[0],\n      setSelectedClientCurrent = _useState17[1];\n\n  var _useState18 = useState(\"Select Option\"),\n      clientCurrentButtonText = _useState18[0],\n      setClientCurrentButtonText = _useState18[1];\n\n  var _useState19 = useState([]),\n      clients = _useState19[0],\n      setClients = _useState19[1];\n\n  var _useState20 = useState(false),\n      showClientModal = _useState20[0],\n      setShowClientModal = _useState20[1]; // This state tells the modal which client box is being updated: \"from\" or \"current\"\n\n\n  var _useState21 = useState(null),\n      clientSelectionType = _useState21[0],\n      setClientSelectionType = _useState21[1];\n\n  var router = useRouter();\n  var labelBase = [\"name\", \"date\", \"w/o\", \"p/n\", \"s/n\"];\n  var labelBaseNames = [\"name\", \"date\", \"wo\", \"pn\", \"sn\"];\n  var sortCheckBase = [false, false, false, false, false, false];\n\n  function withSortIcon(baseLabels, activeIndex, isDesc) {\n    return baseLabels.map(function (text, i) {\n      if (i !== activeIndex) return text; // untouched\n\n      var arrow = isDesc ? \" ▼\" : \" ▲\";\n      return \"\".concat(text).concat(arrow);\n    });\n  }\n\n  var _useState22 = useState(labelBase),\n      labels = _useState22[0],\n      setLabels = _useState22[1];\n\n  var _useState23 = useState(sortCheckBase),\n      sortCheck = _useState23[0],\n      setSortCheck = _useState23[1];\n\n  var _useState24 = useState(null),\n      hoverIndex = _useState24[0],\n      setHoverIndex = _useState24[1];\n\n  var _useState25 = useState(null),\n      selectedModel = _useState25[0],\n      setSelectedModel = _useState25[1];\n\n  var _useState26 = useState(null),\n      gPos = _useState26[0],\n      setGPos = _useState26[1];\n\n  var _useState27 = useState(null),\n      gIde = _useState27[0],\n      setGIde = _useState27[1];\n\n  var _useState28 = useState(false),\n      isDeleting = _useState28[0],\n      setIsDeleting = _useState28[1];\n\n  var _useState29 = useState(1),\n      page = _useState29[0],\n      setPage = _useState29[1];\n\n  var _useState30 = useState([]),\n      pageCursors = _useState30[0],\n      setPageCursors = _useState30[1];\n\n  var _useState31 = useState(false),\n      hasNextPage = _useState31[0],\n      setHasNextPage = _useState31[1];\n\n  var fetchSeq = useRef(0);\n  var searchLower = (search || \"\").toLowerCase().trim();\n  var hasActiveFilters = Boolean(selectedOEM) || Boolean(selectedModality) || Boolean(selectedModel) || Boolean(selectedClientFrom) || Boolean(selectedClientCurrent) || Boolean(searchLower);\n\n  var valueMatches = function valueMatches(value, s) {\n    if (!value) return false;\n\n    if (Array.isArray(value)) {\n      return value.some(function (v) {\n        return valueMatches(v, s);\n      });\n    }\n\n    return String(value).toLowerCase().includes(s);\n  };\n\n  var matchesFilters = useCallback(function (item) {\n    var _ref2, _ref3, _ref4, _ref5, _item$machineData$OEM, _item$machineData, _item$machineData2, _item$theMachineData, _item$theMachineData2, _item$TheMachine, _item$TheMachine2, _ref6, _ref7, _ref8, _ref9, _item$machineData$Mod, _item$machineData3, _item$machineData4, _item$theMachineData3, _item$theMachineData4, _item$TheMachine3, _item$TheMachine4, _ref10, _ref11, _ref12, _ref13, _item$machineData$Mod2, _item$machineData5, _item$machineData6, _item$theMachineData5, _item$theMachineData6, _item$TheMachine5, _item$TheMachine6;\n\n    // hide explicitly hidden items\n    if ((item === null || item === void 0 ? void 0 : item.visible) === false) return false; // OEM / Modality / Model filtering\n\n    var OEM = (_ref2 = (_ref3 = (_ref4 = (_ref5 = (_item$machineData$OEM = item === null || item === void 0 ? void 0 : (_item$machineData = item.machineData) === null || _item$machineData === void 0 ? void 0 : _item$machineData.OEM) !== null && _item$machineData$OEM !== void 0 ? _item$machineData$OEM : item === null || item === void 0 ? void 0 : (_item$machineData2 = item.machineData) === null || _item$machineData2 === void 0 ? void 0 : _item$machineData2.oem) !== null && _ref5 !== void 0 ? _ref5 : item === null || item === void 0 ? void 0 : (_item$theMachineData = item.theMachineData) === null || _item$theMachineData === void 0 ? void 0 : _item$theMachineData.OEM) !== null && _ref4 !== void 0 ? _ref4 : item === null || item === void 0 ? void 0 : (_item$theMachineData2 = item.theMachineData) === null || _item$theMachineData2 === void 0 ? void 0 : _item$theMachineData2.oem) !== null && _ref3 !== void 0 ? _ref3 : item === null || item === void 0 ? void 0 : (_item$TheMachine = item.TheMachine) === null || _item$TheMachine === void 0 ? void 0 : _item$TheMachine.OEM) !== null && _ref2 !== void 0 ? _ref2 : item === null || item === void 0 ? void 0 : (_item$TheMachine2 = item.TheMachine) === null || _item$TheMachine2 === void 0 ? void 0 : _item$TheMachine2.oem;\n    var Modality = (_ref6 = (_ref7 = (_ref8 = (_ref9 = (_item$machineData$Mod = item === null || item === void 0 ? void 0 : (_item$machineData3 = item.machineData) === null || _item$machineData3 === void 0 ? void 0 : _item$machineData3.Modality) !== null && _item$machineData$Mod !== void 0 ? _item$machineData$Mod : item === null || item === void 0 ? void 0 : (_item$machineData4 = item.machineData) === null || _item$machineData4 === void 0 ? void 0 : _item$machineData4.modality) !== null && _ref9 !== void 0 ? _ref9 : item === null || item === void 0 ? void 0 : (_item$theMachineData3 = item.theMachineData) === null || _item$theMachineData3 === void 0 ? void 0 : _item$theMachineData3.Modality) !== null && _ref8 !== void 0 ? _ref8 : item === null || item === void 0 ? void 0 : (_item$theMachineData4 = item.theMachineData) === null || _item$theMachineData4 === void 0 ? void 0 : _item$theMachineData4.modality) !== null && _ref7 !== void 0 ? _ref7 : item === null || item === void 0 ? void 0 : (_item$TheMachine3 = item.TheMachine) === null || _item$TheMachine3 === void 0 ? void 0 : _item$TheMachine3.Modality) !== null && _ref6 !== void 0 ? _ref6 : item === null || item === void 0 ? void 0 : (_item$TheMachine4 = item.TheMachine) === null || _item$TheMachine4 === void 0 ? void 0 : _item$TheMachine4.modality;\n    var Model = (_ref10 = (_ref11 = (_ref12 = (_ref13 = (_item$machineData$Mod2 = item === null || item === void 0 ? void 0 : (_item$machineData5 = item.machineData) === null || _item$machineData5 === void 0 ? void 0 : _item$machineData5.Model) !== null && _item$machineData$Mod2 !== void 0 ? _item$machineData$Mod2 : item === null || item === void 0 ? void 0 : (_item$machineData6 = item.machineData) === null || _item$machineData6 === void 0 ? void 0 : _item$machineData6.model) !== null && _ref13 !== void 0 ? _ref13 : item === null || item === void 0 ? void 0 : (_item$theMachineData5 = item.theMachineData) === null || _item$theMachineData5 === void 0 ? void 0 : _item$theMachineData5.Model) !== null && _ref12 !== void 0 ? _ref12 : item === null || item === void 0 ? void 0 : (_item$theMachineData6 = item.theMachineData) === null || _item$theMachineData6 === void 0 ? void 0 : _item$theMachineData6.model) !== null && _ref11 !== void 0 ? _ref11 : item === null || item === void 0 ? void 0 : (_item$TheMachine5 = item.TheMachine) === null || _item$TheMachine5 === void 0 ? void 0 : _item$TheMachine5.Model) !== null && _ref10 !== void 0 ? _ref10 : item === null || item === void 0 ? void 0 : (_item$TheMachine6 = item.TheMachine) === null || _item$TheMachine6 === void 0 ? void 0 : _item$TheMachine6.model;\n    if (selectedOEM && OEM !== selectedOEM) return false;\n    if (selectedModality && Modality !== selectedModality) return false;\n    if (selectedModel && Model !== selectedModel) return false; // Client filters\n\n    if (selectedClientFrom && (item === null || item === void 0 ? void 0 : item.clientFromId) !== selectedClientFrom) {\n      return false;\n    }\n\n    if (selectedClientCurrent && (item === null || item === void 0 ? void 0 : item.clientCurrentId) !== selectedClientCurrent) {\n      return false;\n    } // Search\n\n\n    if (searchLower) {\n      if (select === \"Name\") {\n        return valueMatches(item === null || item === void 0 ? void 0 : item.name, searchLower);\n      }\n\n      if (select === \"Date\") {\n        var wantedDay = searchLower; // yyyy-mm-dd from input\n\n        var itemYMD = toYMD(item === null || item === void 0 ? void 0 : item.date);\n        if (itemYMD && itemYMD === wantedDay) return true;\n\n        if (Array.isArray(item === null || item === void 0 ? void 0 : item.descriptions)) {\n          if (item.descriptions.some(function (d) {\n            return toYMD(d === null || d === void 0 ? void 0 : d.date) === wantedDay;\n          })) {\n            return true;\n          }\n        }\n\n        if (Array.isArray(item === null || item === void 0 ? void 0 : item.workOrders)) {\n          if (item.workOrders.some(function (w) {\n            return toYMD(w === null || w === void 0 ? void 0 : w.date) === wantedDay;\n          })) {\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      if (select === \"Work Order\") {\n        return Array.isArray(item === null || item === void 0 ? void 0 : item.workOrders) && item.workOrders.some(function (wo) {\n          return valueMatches(wo === null || wo === void 0 ? void 0 : wo.workOrder, searchLower);\n        });\n      }\n\n      if (select === \"Product Number\") {\n        return valueMatches(item === null || item === void 0 ? void 0 : item.pn, searchLower);\n      }\n\n      if (select === \"Serial Number\") {\n        return valueMatches(item === null || item === void 0 ? void 0 : item.sn, searchLower);\n      }\n\n      if (select === \"Description\") {\n        if (valueMatches(item === null || item === void 0 ? void 0 : item.desc, searchLower)) return true;\n        if (valueMatches(item === null || item === void 0 ? void 0 : item.description, searchLower)) return true;\n\n        if (Array.isArray(item === null || item === void 0 ? void 0 : item.descriptions)) {\n          return item.descriptions.some(function (d) {\n            return valueMatches(d === null || d === void 0 ? void 0 : d.description, searchLower);\n          });\n        }\n\n        return false;\n      }\n\n      if (select === \"SKU\") {\n        return valueMatches(item === null || item === void 0 ? void 0 : item.id, searchLower);\n      }\n    }\n\n    return true;\n  }, [selectedOEM, selectedModality, selectedModel, selectedClientFrom, selectedClientCurrent, searchLower, select]);\n\n  var resetPagination = function resetPagination() {\n    setPage(1);\n    setPageCursors([]);\n    setHasNextPage(false);\n  }; // Reset pagination on route/query change (prevents stale pages like “starting at 6”)\n\n\n  useEffect(function () {\n    resetPagination();\n  }, [router.asPath]); // Fetch data on component mount and route change\n\n  useEffect(function () {\n    fetchData(page);\n  }, [router.route, page]); // If filters/search change while on a later page, jump back to page 1\n\n  useEffect(function () {\n    if (page !== 1) setPage(1);\n  }, [selectedOEM, selectedModality, selectedModel, selectedClientFrom, selectedClientCurrent, search, select]);\n\n  function fetchData() {\n    return _fetchData.apply(this, arguments);\n  }\n\n  function _fetchData() {\n    _fetchData = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n      var requestedPage,\n          seq,\n          startAfterDoc,\n          load,\n          _yield$load,\n          data,\n          lastDoc,\n          nextPage,\n          db,\n          machineIds,\n          curMachineIds,\n          theMachineIds,\n          _iterator2,\n          _step2,\n          _item$Machine,\n          _item$CurrentMachine,\n          _item$TheMachine7,\n          item,\n          uniq,\n          mIds,\n          cIds,\n          fetchMachineClients,\n          fetchMachinesData,\n          _yield$Promise$all,\n          _yield$Promise$all2,\n          fromMap,\n          curMap,\n          theMap,\n          augmented,\n          _args10 = arguments;\n\n      return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n        while (1) {\n          switch (_context10.prev = _context10.next) {\n            case 0:\n              requestedPage = _args10.length > 0 && _args10[0] !== undefined ? _args10[0] : 1;\n              seq = ++fetchSeq.current;\n              setIsLoading(true);\n              _context10.prev = 3;\n\n              if (router.query.inputText && router.query.selectedType) {\n                setSelect(router.query.selectedType);\n                setSearch(router.query.inputText);\n              }\n\n              startAfterDoc = requestedPage > 1 ? pageCursors[requestedPage - 2] : null;\n\n              if (!(requestedPage > 1 && !startAfterDoc)) {\n                _context10.next = 10;\n                break;\n              }\n\n              setPage(1);\n              if (seq === fetchSeq.current) setIsLoading(false);\n              return _context10.abrupt(\"return\");\n\n            case 10:\n              // light retry for transient Firestore hiccups\n              load = /*#__PURE__*/function () {\n                var _ref20 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n                  var attempt,\n                      _args7 = arguments;\n                  return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                    while (1) {\n                      switch (_context7.prev = _context7.next) {\n                        case 0:\n                          attempt = _args7.length > 0 && _args7[0] !== undefined ? _args7[0] : 1;\n                          _context7.prev = 1;\n                          _context7.next = 4;\n                          return fetchPartsWithMachineDataPage({\n                            pageSize: PAGE_SIZE,\n                            startAfterDoc: startAfterDoc,\n                            visibleOnly: true\n                          });\n\n                        case 4:\n                          return _context7.abrupt(\"return\", _context7.sent);\n\n                        case 7:\n                          _context7.prev = 7;\n                          _context7.t0 = _context7[\"catch\"](1);\n\n                          if (!(attempt >= 3)) {\n                            _context7.next = 11;\n                            break;\n                          }\n\n                          throw _context7.t0;\n\n                        case 11:\n                          _context7.next = 13;\n                          return new Promise(function (r) {\n                            return setTimeout(r, 250 * Math.pow(2, attempt - 1));\n                          });\n\n                        case 13:\n                          return _context7.abrupt(\"return\", load(attempt + 1));\n\n                        case 14:\n                        case \"end\":\n                          return _context7.stop();\n                      }\n                    }\n                  }, _callee7, null, [[1, 7]]);\n                }));\n\n                return function load() {\n                  return _ref20.apply(this, arguments);\n                };\n              }();\n\n              _context10.next = 13;\n              return load();\n\n            case 13:\n              _yield$load = _context10.sent;\n              data = _yield$load.parts;\n              lastDoc = _yield$load.lastDoc;\n              nextPage = _yield$load.hasNextPage;\n\n              if (!(seq !== fetchSeq.current)) {\n                _context10.next = 19;\n                break;\n              }\n\n              return _context10.abrupt(\"return\");\n\n            case 19:\n              if (requestedPage === 1 && data.length === 0) {\n                setPageCursors([]);\n                setHasNextPage(false);\n              }\n\n              setBackupInfo(data);\n              setLabels(labelBase); // <-- add this line after setBackupInfo(data)\n\n              setID(data.map(function (item) {\n                return item.id;\n              }));\n\n              if (!(requestedPage > 1 && data.length === 0)) {\n                _context10.next = 27;\n                break;\n              }\n\n              setHasNextPage(false);\n              setPage(1);\n              return _context10.abrupt(\"return\");\n\n            case 27:\n              setHasNextPage(nextPage);\n              setPageCursors(function (prev) {\n                var next = requestedPage === 1 ? [] : _toConsumableArray(prev);\n\n                if (lastDoc) {\n                  next[requestedPage - 1] = lastDoc;\n                }\n\n                return next;\n              });\n              setSelectedItems([]); // --- Pre-augment: resolve client ids of Machine / CurrentMachine once ---\n\n              db = firebase.firestore();\n              machineIds = [];\n              curMachineIds = [];\n              theMachineIds = []; // <-- ADD\n\n              _iterator2 = _createForOfIteratorHelper(data);\n\n              try {\n                for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                  item = _step2.value;\n                  if (item !== null && item !== void 0 && (_item$Machine = item.Machine) !== null && _item$Machine !== void 0 && _item$Machine.id) machineIds.push(item.Machine.id);\n                  if (item !== null && item !== void 0 && (_item$CurrentMachine = item.CurrentMachine) !== null && _item$CurrentMachine !== void 0 && _item$CurrentMachine.id) curMachineIds.push(item.CurrentMachine.id);\n                  if (item !== null && item !== void 0 && (_item$TheMachine7 = item.TheMachine) !== null && _item$TheMachine7 !== void 0 && _item$TheMachine7.id) theMachineIds.push(item.TheMachine.id); // <-- ADD\n                }\n              } catch (err) {\n                _iterator2.e(err);\n              } finally {\n                _iterator2.f();\n              }\n\n              uniq = function uniq(arr) {\n                return _toConsumableArray(new Set(arr));\n              };\n\n              mIds = uniq(machineIds);\n              cIds = uniq(curMachineIds);\n\n              fetchMachineClients = /*#__PURE__*/function () {\n                var _ref21 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee8(ids) {\n                  var out, chunks, _i, _i2, _chunks, chunk, snap;\n\n                  return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                    while (1) {\n                      switch (_context8.prev = _context8.next) {\n                        case 0:\n                          if (ids.length) {\n                            _context8.next = 2;\n                            break;\n                          }\n\n                          return _context8.abrupt(\"return\", {});\n\n                        case 2:\n                          out = {}; // Firestore \"in\" supports up to 10 document IDs per query\n\n                          chunks = [];\n\n                          for (_i = 0; _i < ids.length; _i += 10) {\n                            chunks.push(ids.slice(_i, _i + 10));\n                          }\n\n                          _i2 = 0, _chunks = chunks;\n\n                        case 6:\n                          if (!(_i2 < _chunks.length)) {\n                            _context8.next = 15;\n                            break;\n                          }\n\n                          chunk = _chunks[_i2];\n                          _context8.next = 10;\n                          return db.collection(\"Machine\").where(firebase.firestore.FieldPath.documentId(), \"in\", chunk).get();\n\n                        case 10:\n                          snap = _context8.sent;\n                          snap.forEach(function (doc) {\n                            var _md$client;\n\n                            var md = doc.data() || {};\n                            out[doc.id] = ((_md$client = md.client) === null || _md$client === void 0 ? void 0 : _md$client.id) || null;\n                          });\n\n                        case 12:\n                          _i2++;\n                          _context8.next = 6;\n                          break;\n\n                        case 15:\n                          return _context8.abrupt(\"return\", out);\n\n                        case 16:\n                        case \"end\":\n                          return _context8.stop();\n                      }\n                    }\n                  }, _callee8);\n                }));\n\n                return function fetchMachineClients(_x5) {\n                  return _ref21.apply(this, arguments);\n                };\n              }(); // Fetch full machine docs (OEM/Modality/Model/Client/etc.) for a set of ids\n\n\n              fetchMachinesData = /*#__PURE__*/function () {\n                var _ref22 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee9(ids) {\n                  var out, chunks, _i3, _i4, _chunks2, chunk, snap;\n\n                  return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n                    while (1) {\n                      switch (_context9.prev = _context9.next) {\n                        case 0:\n                          if (ids.length) {\n                            _context9.next = 2;\n                            break;\n                          }\n\n                          return _context9.abrupt(\"return\", {});\n\n                        case 2:\n                          out = {};\n                          chunks = [];\n\n                          for (_i3 = 0; _i3 < ids.length; _i3 += 10) {\n                            chunks.push(ids.slice(_i3, _i3 + 10));\n                          }\n\n                          _i4 = 0, _chunks2 = chunks;\n\n                        case 6:\n                          if (!(_i4 < _chunks2.length)) {\n                            _context9.next = 15;\n                            break;\n                          }\n\n                          chunk = _chunks2[_i4];\n                          _context9.next = 10;\n                          return db.collection(\"Machine\").where(firebase.firestore.FieldPath.documentId(), \"in\", chunk).get();\n\n                        case 10:\n                          snap = _context9.sent;\n                          snap.forEach(function (doc) {\n                            out[doc.id] = _objectSpread({\n                              id: doc.id\n                            }, doc.data() || {});\n                          });\n\n                        case 12:\n                          _i4++;\n                          _context9.next = 6;\n                          break;\n\n                        case 15:\n                          return _context9.abrupt(\"return\", out);\n\n                        case 16:\n                        case \"end\":\n                          return _context9.stop();\n                      }\n                    }\n                  }, _callee9);\n                }));\n\n                return function fetchMachinesData(_x6) {\n                  return _ref22.apply(this, arguments);\n                };\n              }();\n\n              _context10.next = 43;\n              return Promise.all([fetchMachineClients(mIds), fetchMachineClients(cIds), fetchMachinesData(uniq(theMachineIds)) // <-- now captured as theMap\n              ]);\n\n            case 43:\n              _yield$Promise$all = _context10.sent;\n              _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 3);\n              fromMap = _yield$Promise$all2[0];\n              curMap = _yield$Promise$all2[1];\n              theMap = _yield$Promise$all2[2];\n              // New-style only: take client ids straight from item refs\n              augmented = data.map(function (item) {\n                var _item$ClientFrom$id, _item$ClientFrom, _item$ClientCurrent$i, _item$ClientCurrent;\n\n                return _objectSpread(_objectSpread({}, item), {}, {\n                  clientFromId: (_item$ClientFrom$id = item === null || item === void 0 ? void 0 : (_item$ClientFrom = item.ClientFrom) === null || _item$ClientFrom === void 0 ? void 0 : _item$ClientFrom.id) !== null && _item$ClientFrom$id !== void 0 ? _item$ClientFrom$id : null,\n                  clientCurrentId: (_item$ClientCurrent$i = item === null || item === void 0 ? void 0 : (_item$ClientCurrent = item.ClientCurrent) === null || _item$ClientCurrent === void 0 ? void 0 : _item$ClientCurrent.id) !== null && _item$ClientCurrent$i !== void 0 ? _item$ClientCurrent$i : null\n                });\n              });\n              setAugmentedInfo(augmented); // default view = everything not explicitly hidden\n\n              setInfo(augmented.filter(function (it) {\n                return it.visible !== false;\n              }));\n              _context10.next = 60;\n              break;\n\n            case 53:\n              _context10.prev = 53;\n              _context10.t0 = _context10[\"catch\"](3);\n\n              if (!(seq !== fetchSeq.current)) {\n                _context10.next = 57;\n                break;\n              }\n\n              return _context10.abrupt(\"return\");\n\n            case 57:\n              console.error(\"Error fetching data:\", _context10.t0);\n              setInfo([]);\n              setAugmentedInfo([]);\n\n            case 60:\n              _context10.prev = 60;\n              if (seq === fetchSeq.current) setIsLoading(false);\n              return _context10.finish(60);\n\n            case 63:\n            case \"end\":\n              return _context10.stop();\n          }\n        }\n      }, _callee10, null, [[3, 53, 60, 63]]);\n    }));\n    return _fetchData.apply(this, arguments);\n  }\n\n  var searchChangeHandler = function searchChangeHandler(event) {\n    return setSearch(event.target.value);\n  }; // Filter the currently loaded items (now consistent with paged filtering)\n\n\n  useEffect(function () {\n    var base = augmentedInfo || [];\n    setInfo(base.filter(matchesFilters));\n  }, [augmentedInfo, matchesFilters]);\n\n  function sortCheckAll(pos) {\n    // Determine next direction: toggle the clicked column only\n    var nextSortCheck = sortCheck.map(function (v, i) {\n      return i === pos ? !v : v;\n    });\n    var isDesc = nextSortCheck[pos]; // true means descending\n\n    var sortedInfo = _toConsumableArray(info).sort(function (a, b) {\n      var key = labelBaseNames[pos];\n\n      if (pos === 1) {\n        // DATE column\n        var ta = toTime(a[key]);\n        var tb = toTime(b[key]); // Put missing dates at the end for ascending, at the start for descending\n\n        if (ta === null && tb === null) return 0;\n        if (ta === null) return isDesc ? -1 : 1;\n        if (tb === null) return isDesc ? 1 : -1;\n        return isDesc ? tb - ta : ta - tb;\n      } // NAME or SKU (string-y columns): indexes 0 or 5 in your original logic\n\n\n      if (pos === 0 || pos === 5) {\n        var _a$key, _b$key;\n\n        var av = ((_a$key = a[key]) !== null && _a$key !== void 0 ? _a$key : \"\").toString();\n        var bv = ((_b$key = b[key]) !== null && _b$key !== void 0 ? _b$key : \"\").toString();\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\n      } // Numeric-ish columns (wo, pn, sn) — fall back to string compare if NaN\n\n\n      var an = Number(a[key]);\n      var bn = Number(b[key]);\n\n      if (!isNaN(an) && !isNaN(bn)) {\n        return isDesc ? bn - an : an - bn;\n      } else {\n        var _a$key2, _b$key2;\n\n        var _av = ((_a$key2 = a[key]) !== null && _a$key2 !== void 0 ? _a$key2 : \"\").toString();\n\n        var _bv = ((_b$key2 = b[key]) !== null && _b$key2 !== void 0 ? _b$key2 : \"\").toString();\n\n        return isDesc ? _bv.localeCompare(_av) : _av.localeCompare(_bv);\n      }\n    });\n\n    setInfo(sortedInfo);\n    setSortCheck(nextSortCheck); // Update header labels to show the little arrow on the active column\n\n    setLabels(withSortIcon(labelBase, pos, isDesc));\n  }\n\n  var rowSelect = function rowSelect(item) {\n    if (item && item.id) {\n      console.log(\"Selected item:\", item);\n      router.push(\"./item/\" + item.id);\n    } else {\n      console.error(\"Unable to determine the selected item’s ID: \", item);\n    }\n  };\n\n  var _useState32 = useState([]),\n      selectedItems = _useState32[0],\n      setSelectedItems = _useState32[1];\n\n  var _useState33 = useState(false),\n      showDeleteModal = _useState33[0],\n      setShowDeleteModal = _useState33[1];\n\n  var handleSelectItem = function handleSelectItem(id) {\n    setSelectedItems(function (prev) {\n      return prev.includes(id) ? prev.filter(function (x) {\n        return x !== id;\n      }) : [].concat(_toConsumableArray(prev), [id]);\n    });\n  }; // setSelectedItems((prev) => {\n  //   const newSelection = prev.includes(id)\n  //     ? prev.filter((itemId) => itemId !== id)\n  //     : [...prev, id];\n  //   console.log(\"Selected items:\", newSelection);\n  //   return newSelection; // <- important\n  // });\n\n\n  var handleShowDeleteModal = function handleShowDeleteModal() {\n    return setShowDeleteModal(true);\n  };\n\n  var handleCloseDeleteModal = function handleCloseDeleteModal() {\n    return setShowDeleteModal(false);\n  };\n\n  var handleDeleteSelected = /*#__PURE__*/function () {\n    var _ref14 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var db, _iterator, _step, itemId;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setIsDeleting(true);\n              db = firebase.firestore();\n              _context.prev = 2;\n              // Loop over each selected item one at a time\n              _iterator = _createForOfIteratorHelper(selectedItems);\n              _context.prev = 4;\n\n              _iterator.s();\n\n            case 6:\n              if ((_step = _iterator.n()).done) {\n                _context.next = 35;\n                break;\n              }\n\n              itemId = _step.value;\n              console.log(itemId);\n              _context.prev = 9;\n              _context.next = 12;\n              return db.collection(\"Test\").doc(itemId)[\"delete\"]();\n\n            case 12:\n              _context.next = 17;\n              break;\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](9);\n              console.error(\"Error deleting document \".concat(itemId, \" from Test:\"), _context.t0);\n\n            case 17:\n              _context.prev = 17;\n              _context.next = 20;\n              return db.collection(\"Parts\").doc(itemId)[\"delete\"]();\n\n            case 20:\n              _context.next = 25;\n              break;\n\n            case 22:\n              _context.prev = 22;\n              _context.t1 = _context[\"catch\"](17);\n              console.error(\"Error deleting document \".concat(itemId, \" from Parts:\"), _context.t1);\n\n            case 25:\n              _context.prev = 25;\n              _context.next = 28;\n              return deleteFromStorage(itemId);\n\n            case 28:\n              _context.next = 33;\n              break;\n\n            case 30:\n              _context.prev = 30;\n              _context.t2 = _context[\"catch\"](25);\n              console.error(\"Error deleting storage for \".concat(itemId, \":\"), _context.t2);\n\n            case 33:\n              _context.next = 6;\n              break;\n\n            case 35:\n              _context.next = 40;\n              break;\n\n            case 37:\n              _context.prev = 37;\n              _context.t3 = _context[\"catch\"](4);\n\n              _iterator.e(_context.t3);\n\n            case 40:\n              _context.prev = 40;\n\n              _iterator.f();\n\n              return _context.finish(40);\n\n            case 43:\n              // Update local state by filtering out the deleted items\n              setInfo(info.filter(function (item) {\n                return !selectedItems.includes(item.id);\n              }));\n              setSelectedItems([]);\n              _context.next = 50;\n              break;\n\n            case 47:\n              _context.prev = 47;\n              _context.t4 = _context[\"catch\"](2);\n              console.error(\"Error deleting items:\", _context.t4);\n\n            case 50:\n              _context.prev = 50;\n              setIsDeleting(false);\n              handleCloseDeleteModal(); // Optionally, reload the page\n              // router.reload();\n\n              return _context.finish(50);\n\n            case 54:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 47, 50, 54], [4, 37, 40, 43], [9, 14], [17, 22], [25, 30]]);\n    }));\n\n    return function handleDeleteSelected() {\n      return _ref14.apply(this, arguments);\n    };\n  }();\n\n  var handleClose = function handleClose() {\n    return setShow(false);\n  };\n\n  var handleShow = function handleShow() {\n    return setShow(true);\n  };\n\n  var checkDelete = function checkDelete(event, pos, idsToDelete, name) {\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n\n    console.log(\"Selected IDs to delete:\", idsToDelete);\n    setSelectedItems(idsToDelete);\n    setDItem(name);\n    setShowDeleteModal(true);\n  }; // const handleDelete = async () => {\n  //   let itemId = gIde;\n  //   try {\n  //     setIsDeleting(true);\n  //     const db = firebase.firestore();\n  //     await db.collection(\"Test\").doc(itemId).delete();\n  //     await deleteFromPartsCollection(itemId);\n  //     await deleteFromStorage(itemId);\n  //     setInfo(info.filter((_, i) => gPos !== i));\n  //     console.log(`Deleted item: ${itemId}`);\n  //   } catch (error) {\n  //     console.error(\"Error deleting item:\", error);\n  //   } finally {\n  //     setIsDeleting(false);\n  //   }\n  //   handleClose();\n  // };\n\n\n  var hoverStyle = function hoverStyle(index) {\n    return {\n      backgroundColor: hoverIndex === index ? \"#ddd\" : \"transparent\",\n      textAlign: \"center\",\n      cursor: \"default\"\n    };\n  };\n\n  var _useState34 = useState(\"Select Option\"),\n      dropdown1Text = _useState34[0],\n      setDropdown1Text = _useState34[1];\n\n  var _useState35 = useState(\"Select Option\"),\n      dropdown2Text = _useState35[0],\n      setDropdown2Text = _useState35[1];\n\n  var handleSelect1 = function handleSelect1(eventKey, event) {\n    if (eventKey === \"unassigned\") {\n      setDropdown1Text(\"Select Option\");\n      setSelectedOEM(null);\n    } else {\n      setDropdown1Text(event.target.textContent);\n      setSelectedOEM(event.target.textContent);\n    }\n  };\n\n  var handleSelect2 = function handleSelect2(eventKey, event) {\n    if (eventKey === \"unassigned\") {\n      setDropdown2Text(\"Select Option\");\n      setSelectedModality(null);\n    } else {\n      setDropdown2Text(event.target.textContent);\n      setSelectedModality(event.target.textContent);\n    }\n  }; // Build a unique list of clients from the items currently loaded, filtered by OEM/Modality.\n  // `type` is \"from\" or \"current\" to decide which client ref to read.\n\n\n  function buildClientsFromItems(_x) {\n    return _buildClientsFromItems.apply(this, arguments);\n  } // --------------------\n  // CLIENT SELECTION HANDLING\n  // --------------------\n  // This function fetches clients and opens the client modal.\n\n\n  function _buildClientsFromItems() {\n    _buildClientsFromItems = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee11(type) {\n      var db, ids, filtered, _iterator3, _step3, it, id, out, idArray, _i5, chunk, snap;\n\n      return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n        while (1) {\n          switch (_context11.prev = _context11.next) {\n            case 0:\n              db = firebase.firestore();\n              ids = new Set(); // Respect current OEM / Modality filters when deriving client options\n\n              filtered = augmentedInfo.filter(function (item) {\n                var _ref23, _item$machineData$OEM2, _item$machineData7, _ref24, _item$machineData$Mod3, _item$machineData8;\n\n                var OEM = (_ref23 = (_item$machineData$OEM2 = item === null || item === void 0 ? void 0 : (_item$machineData7 = item.machineData) === null || _item$machineData7 === void 0 ? void 0 : _item$machineData7.OEM) !== null && _item$machineData$OEM2 !== void 0 ? _item$machineData$OEM2 : item === null || item === void 0 ? void 0 : item.OEM) !== null && _ref23 !== void 0 ? _ref23 : null;\n                var Modality = (_ref24 = (_item$machineData$Mod3 = item === null || item === void 0 ? void 0 : (_item$machineData8 = item.machineData) === null || _item$machineData8 === void 0 ? void 0 : _item$machineData8.Modality) !== null && _item$machineData$Mod3 !== void 0 ? _item$machineData$Mod3 : item === null || item === void 0 ? void 0 : item.Modality) !== null && _ref24 !== void 0 ? _ref24 : null;\n                if (selectedOEM && OEM !== selectedOEM) return false;\n                if (selectedModality && Modality !== selectedModality) return false;\n                return true;\n              });\n              _iterator3 = _createForOfIteratorHelper(filtered);\n\n              try {\n                for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n                  it = _step3.value;\n                  id = type === \"from\" ? it.clientFromId : it.clientCurrentId;\n                  if (id) ids.add(id);\n                }\n              } catch (err) {\n                _iterator3.e(err);\n              } finally {\n                _iterator3.f();\n              }\n\n              out = [];\n              idArray = _toConsumableArray(ids);\n              _i5 = 0;\n\n            case 8:\n              if (!(_i5 < idArray.length)) {\n                _context11.next = 17;\n                break;\n              }\n\n              chunk = idArray.slice(_i5, _i5 + 10);\n              _context11.next = 12;\n              return db.collection(\"Client\").where(firebase.firestore.FieldPath.documentId(), \"in\", chunk).get();\n\n            case 12:\n              snap = _context11.sent;\n              snap.forEach(function (doc) {\n                var d = doc.data() || {};\n                out.push({\n                  id: doc.id,\n                  name: d.name || doc.id\n                });\n              });\n\n            case 14:\n              _i5 += 10;\n              _context11.next = 8;\n              break;\n\n            case 17:\n              // sort by name for nicer UX\n              out.sort(function (a, b) {\n                return (a.name || \"\").localeCompare(b.name || \"\");\n              });\n              return _context11.abrupt(\"return\", out);\n\n            case 19:\n            case \"end\":\n              return _context11.stop();\n          }\n        }\n      }, _callee11);\n    }));\n    return _buildClientsFromItems.apply(this, arguments);\n  }\n\n  var handleClientClick = /*#__PURE__*/function () {\n    var _ref15 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var safeClients, clientsData, derived;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              safeClients = [];\n              _context2.prev = 1;\n              _context2.next = 4;\n              return fetchClients(selectedOEM, selectedModality);\n\n            case 4:\n              clientsData = _context2.sent;\n              safeClients = Array.isArray(clientsData) ? clientsData : [];\n              _context2.next = 11;\n              break;\n\n            case 8:\n              _context2.prev = 8;\n              _context2.t0 = _context2[\"catch\"](1);\n              console.error(\"fetchClients failed:\", _context2.t0);\n\n            case 11:\n              if (!(safeClients.length === 0)) {\n                _context2.next = 24;\n                break;\n              }\n\n              _context2.prev = 12;\n\n              if (!clientSelectionType) {\n                // if somehow not set yet, default to \"from\"\n                setClientSelectionType(\"from\");\n              }\n\n              _context2.next = 16;\n              return buildClientsFromItems(clientSelectionType || \"from\");\n\n            case 16:\n              derived = _context2.sent;\n              safeClients = derived;\n              _context2.next = 24;\n              break;\n\n            case 20:\n              _context2.prev = 20;\n              _context2.t1 = _context2[\"catch\"](12);\n              console.error(\"Fallback buildClientsFromItems failed:\", _context2.t1);\n              safeClients = [];\n\n            case 24:\n              setClients(safeClients);\n              setClientSearchTerm(\"\");\n              setShowClientModal(true);\n\n            case 27:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[1, 8], [12, 20]]);\n    }));\n\n    return function handleClientClick() {\n      return _ref15.apply(this, arguments);\n    };\n  }(); // When a client is selected in the modal, we now assume the parameter is a client ID.\n  // If the passed value is null, we clear the selection.\n\n\n  var handleClientSelect = /*#__PURE__*/function () {\n    var _ref16 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(clientId) {\n      var clientSnap, clientData;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              console.log(\"User selected client id:\", clientId);\n\n              if (clientId) {\n                _context3.next = 5;\n                break;\n              }\n\n              if (clientSelectionType === \"from\") {\n                setClientFromButtonText(\"Select Option\");\n                setSelectedClientFrom(null);\n              } else if (clientSelectionType === \"current\") {\n                setClientCurrentButtonText(\"Select Option\");\n                setSelectedClientCurrent(null);\n              }\n\n              setShowClientModal(false);\n              return _context3.abrupt(\"return\");\n\n            case 5:\n              _context3.prev = 5;\n              _context3.next = 8;\n              return firebase.firestore().collection(\"Client\").doc(clientId).get();\n\n            case 8:\n              clientSnap = _context3.sent;\n\n              if (clientSnap.exists) {\n                clientData = clientSnap.data();\n\n                if (clientSelectionType === \"from\") {\n                  setClientFromButtonText(clientData.name);\n                  setSelectedClientFrom(clientId);\n                } else if (clientSelectionType === \"current\") {\n                  setClientCurrentButtonText(clientData.name);\n                  setSelectedClientCurrent(clientId);\n                }\n              } else {\n                console.error(\"No client document found for id:\", clientId);\n              }\n\n              _context3.next = 15;\n              break;\n\n            case 12:\n              _context3.prev = 12;\n              _context3.t0 = _context3[\"catch\"](5);\n              console.error(\"Error fetching client data:\", _context3.t0);\n\n            case 15:\n              setShowClientModal(false);\n\n            case 16:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[5, 12]]);\n    }));\n\n    return function handleClientSelect(_x2) {\n      return _ref16.apply(this, arguments);\n    };\n  }();\n\n  var handleClientInfo = function handleClientInfo(clientId, clientName) {\n    console.log(\"Client ID: \".concat(clientId, \", Client Name: \").concat(clientName));\n    router.push(\"client/\" + clientId);\n  };\n\n  var handleClearClientSelection = function handleClearClientSelection() {\n    if (clientSelectionType === \"from\") {\n      setClientFromButtonText(\"Select Option\");\n      setSelectedClientFrom(null);\n    } else if (clientSelectionType === \"current\") {\n      setClientCurrentButtonText(\"Select Option\");\n      setSelectedClientCurrent(null);\n    }\n\n    setShowClientModal(false);\n  }; // --------------------\n  // MODEL SELECTION HANDLING\n  // --------------------\n\n\n  var _useState36 = useState([]),\n      models = _useState36[0],\n      setModels = _useState36[1];\n\n  var _useState37 = useState(false),\n      showModelModal = _useState37[0],\n      setShowModelModal = _useState37[1];\n\n  var _useState38 = useState(\"Select Option\"),\n      modelButtonText = _useState38[0],\n      setModelButtonText = _useState38[1];\n\n  var handleModelClick = /*#__PURE__*/function () {\n    var _ref17 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n      var modelsData;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return fetchModels(selectedOEM, selectedModality, selectedClientFrom);\n\n            case 2:\n              modelsData = _context4.sent;\n              setModels(modelsData);\n              setModelSearchTerm(\"\");\n              setShowModelModal(true);\n\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function handleModelClick() {\n      return _ref17.apply(this, arguments);\n    };\n  }();\n\n  var handleModelSelect = function handleModelSelect(modelName) {\n    setModelButtonText(modelName || \"Select Option\");\n    setSelectedModel(modelName || null);\n    setShowModelModal(false);\n  };\n\n  var handleClearModelSelection = function handleClearModelSelection() {\n    setModelButtonText(\"Select Option\");\n    setSelectedModel(null);\n    setShowModelModal(false);\n  }; // --------------------\n  // WAREHOUSE BUTTONS (for Client Current)\n  // --------------------\n\n\n  var handleSoCalWarehouseClick = function handleSoCalWarehouseClick() {\n    setClientCurrentButtonText(\"SoCal Warehouse\");\n    setSelectedClientCurrent(SOCAL_CLIENT_ID);\n    console.log(\"Warehouse button clicked: setting Client Current to\", SOCAL_CLIENT_ID);\n  };\n\n  var handleNorCalWarehouseClick = function handleNorCalWarehouseClick() {\n    setClientCurrentButtonText(\"NorCal Warehouse\");\n    setSelectedClientCurrent(NORCAL_CLIENT_ID);\n    console.log(\"Warehouse button clicked: setting Client Current to\", NORCAL_CLIENT_ID);\n  };\n\n  var handleWarehouseUnassignedClick = function handleWarehouseUnassignedClick() {\n    setClientCurrentButtonText(\"Unassigned\");\n    setSelectedClientCurrent(UNASSIGNED_CLIENT_ID);\n    console.log(\"Warehouse button clicked: setting Client Current to\", UNASSIGNED_CLIENT_ID);\n  };\n\n  var _useState39 = useState(\"\"),\n      clientSearchTerm = _useState39[0],\n      setClientSearchTerm = _useState39[1];\n\n  var _useState40 = useState(\"\"),\n      modelSearchTerm = _useState40[0],\n      setModelSearchTerm = _useState40[1];\n\n  var deleteFromStorage = /*#__PURE__*/function () {\n    var _ref18 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee5(itemId) {\n      var storageRef, folderRef, listResult, deletePromises;\n      return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              storageRef = firebase.storage().ref();\n              folderRef = storageRef.child(\"Parts/\".concat(itemId, \"/\"));\n              _context5.prev = 2;\n              _context5.next = 5;\n              return folderRef.listAll();\n\n            case 5:\n              listResult = _context5.sent;\n              deletePromises = listResult.items.map(function (item) {\n                return item[\"delete\"]();\n              });\n              _context5.next = 9;\n              return Promise.all(deletePromises);\n\n            case 9:\n              _context5.next = 14;\n              break;\n\n            case 11:\n              _context5.prev = 11;\n              _context5.t0 = _context5[\"catch\"](2);\n              console.error(\"Error deleting from storage:\", _context5.t0);\n\n            case 14:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[2, 11]]);\n    }));\n\n    return function deleteFromStorage(_x3) {\n      return _ref18.apply(this, arguments);\n    };\n  }();\n\n  var deleteFromPartsCollection = /*#__PURE__*/function () {\n    var _ref19 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee6(itemId) {\n      var db;\n      return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n        while (1) {\n          switch (_context6.prev = _context6.next) {\n            case 0:\n              db = firebase.firestore();\n              _context6.prev = 1;\n              _context6.next = 4;\n              return db.collection(\"Parts\").doc(itemId)[\"delete\"]();\n\n            case 4:\n              console.log(\"Deleted item from Parts collection: \".concat(itemId));\n              _context6.next = 10;\n              break;\n\n            case 7:\n              _context6.prev = 7;\n              _context6.t0 = _context6[\"catch\"](1);\n              console.error(\"Error deleting from Parts collection:\", _context6.t0);\n\n            case 10:\n            case \"end\":\n              return _context6.stop();\n          }\n        }\n      }, _callee6, null, [[1, 7]]);\n    }));\n\n    return function deleteFromPartsCollection(_x4) {\n      return _ref19.apply(this, arguments);\n    };\n  }(); //   // Safely convert any date-ish value into a comparable timestamp (ms since epoch).\n  // function toTime(value) {\n  //   if (!value) return null;\n  //   // Firestore Timestamp: { seconds, nanoseconds }\n  //   if (typeof value === \"object\" && value.seconds) {\n  //     try {\n  //       return value.seconds * 1000;\n  //     } catch { /* fallthrough */ }\n  //   }\n  //   // If already a Date\n  //   if (value instanceof Date) return isNaN(value.getTime()) ? null : value.getTime();\n  //   // If string: try ISO first\n  //   if (typeof value === \"string\") {\n  //     // yyyy-mm-dd (from your form inputs)\n  //     const iso = Date.parse(value);\n  //     if (!isNaN(iso)) return iso;\n  //     // mm/dd/yyyy fallback (older items)\n  //     const parts = value.split(\"/\");\n  //     if (parts.length === 3) {\n  //       const [mm, dd, yyyy] = parts;\n  //       const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\n  //       if (!isNaN(alt)) return alt;\n  //     }\n  //   }\n  //   // Canonicalize any date-ish value to 'yyyy-mm-dd' so it matches <input type=\"date\"> values\n  //   function toYMD(value) {\n  //     const t = toTime(value);\n  //     if (t == null) return null;\n  //     const d = new Date(t);\n  //     const yyyy = d.getFullYear();\n  //     const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  //     const dd = String(d.getDate()).padStart(2, \"0\");\n  //     return `${yyyy}-${mm}-${dd}`;\n  //   }\n  //   // Last resort\n  //   const t = Date.parse(value);\n  //   return isNaN(t) ? null : t;\n  // }\n\n\n  var totalKnownPages = Math.max(1, pageCursors.filter(Boolean).length + (hasNextPage ? 1 : 0));\n  var pageButtons = [];\n\n  var _loop = function _loop(i) {\n    pageButtons.push(__jsx(Pagination.Item, {\n      key: i,\n      active: i === page,\n      onClick: function onClick() {\n        return setPage(i);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 902,\n        columnNumber: 7\n      }\n    }, i));\n  };\n\n  for (var i = 1; i <= totalKnownPages; i++) {\n    _loop(i);\n  }\n\n  return __jsx(LoggedIn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 914,\n      columnNumber: 5\n    }\n  }, isDeleting && __jsx(\"div\", {\n    className: \"loading-overlay\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 916,\n      columnNumber: 9\n    }\n  }, __jsx(Spinner, {\n    animation: \"border\",\n    role: \"status\",\n    className: \"spinner-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 917,\n      columnNumber: 11\n    }\n  }, __jsx(\"span\", {\n    className: \"sr-only\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 918,\n      columnNumber: 13\n    }\n  }, \"Loading...\"))), __jsx(Modal, {\n    show: showDeleteModal,\n    onHide: handleCloseDeleteModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 922,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 923,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 924,\n      columnNumber: 11\n    }\n  }, \"Confirm Deletion\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 926,\n      columnNumber: 9\n    }\n  }, \"Are you sure you want to delete \", selectedItems.length, \" item\", selectedItems.length > 1 ? \"s\" : \"\", \"?\"), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 930,\n      columnNumber: 9\n    }\n  }, __jsx(Button, {\n    variant: \"danger\",\n    onClick: handleDeleteSelected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 931,\n      columnNumber: 11\n    }\n  }, \"Yes, delete\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseDeleteModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 934,\n      columnNumber: 11\n    }\n  }, \"Cancel\"))), __jsx(Modal, {\n    show: showClientModal,\n    onHide: function onHide() {\n      return setShowClientModal(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 940,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 941,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 942,\n      columnNumber: 11\n    }\n  }, \"Select \", clientSelectionType === \"from\" ? \"Client From\" : \"Client Current\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 946,\n      columnNumber: 9\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: clientSearchTerm,\n    onChange: function onChange(e) {\n      return setClientSearchTerm(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 947,\n      columnNumber: 11\n    }\n  }), __jsx(ClientTable, {\n    clients: (Array.isArray(clients) ? clients : []).filter(function (client) {\n      var _client$name;\n\n      return ((_client$name = client === null || client === void 0 ? void 0 : client.name) !== null && _client$name !== void 0 ? _client$name : \"\").toLowerCase().includes(clientSearchTerm.toLowerCase());\n    }),\n    onSelectClient: handleClientSelect,\n    onInfoClick: handleClientInfo,\n    isClientSearch: false,\n    clearSelection: function clearSelection() {\n      return handleClientSelect(null);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 954,\n      columnNumber: 11\n    }\n  }))), __jsx(Modal, {\n    show: showModelModal,\n    onHide: function onHide() {\n      return setShowModelModal(false);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 966,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 967,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 968,\n      columnNumber: 11\n    }\n  }, \"Select Model\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 970,\n      columnNumber: 9\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: modelSearchTerm,\n    onChange: function onChange(e) {\n      return setModelSearchTerm(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 971,\n      columnNumber: 11\n    }\n  }), __jsx(ModelTable, {\n    models: models.filter(function (model) {\n      return typeof model === \"string\" ? model.toLowerCase().includes(modelSearchTerm.toLowerCase()) : false;\n    }),\n    onSelectModel: handleModelSelect,\n    clearSelection: function clearSelection() {\n      return handleModelSelect(null);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 978,\n      columnNumber: 11\n    }\n  }))), __jsx(Container, {\n    className: \"d-flex align-items-center justify-content-center\",\n    style: {\n      minHeight: \"100vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 990,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"w-100\",\n    style: {\n      maxWidth: \"1200px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 994,\n      columnNumber: 9\n    }\n  }, __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 995,\n      columnNumber: 11\n    }\n  }, __jsx(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 996,\n      columnNumber: 13\n    }\n  }, __jsx(\"h2\", {\n    className: \"text-center mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 997,\n      columnNumber: 15\n    }\n  }, \"Magmo\"), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 998,\n      columnNumber: 15\n    }\n  }, __jsx(Col, {\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 999,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1001,\n      columnNumber: 19\n    }\n  }, __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1002,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1003,\n      columnNumber: 23\n    }\n  }, \"OEM\"), __jsx(Dropdown, {\n    onSelect: handleSelect1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1004,\n      columnNumber: 23\n    }\n  }, __jsx(Dropdown.Toggle, {\n    variant: \"outline-secondary\",\n    id: \"dropdown-button-1\",\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1005,\n      columnNumber: 25\n    }\n  }, dropdown1Text), __jsx(Dropdown.Menu, {\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1012,\n      columnNumber: 25\n    }\n  }, __jsx(Dropdown.Item, {\n    eventKey: \"unassigned\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1013,\n      columnNumber: 27\n    }\n  }, \"Select Option\"), __jsx(Dropdown.Item, {\n    eventKey: \"GE\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1016,\n      columnNumber: 27\n    }\n  }, \"GE\"), __jsx(Dropdown.Item, {\n    eventKey: \"Toshiba\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1017,\n      columnNumber: 27\n    }\n  }, \"Toshiba\"), __jsx(Dropdown.Item, {\n    eventKey: \"Siemens\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1020,\n      columnNumber: 27\n    }\n  }, \"Siemens\"), __jsx(Dropdown.Item, {\n    eventKey: \"Philips\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1023,\n      columnNumber: 27\n    }\n  }, \"Philips\")))), __jsx(InputGroup, {\n    className: \"mb-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1030,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1031,\n      columnNumber: 23\n    }\n  }, \"Modality\"), __jsx(Dropdown, {\n    onSelect: handleSelect2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1032,\n      columnNumber: 23\n    }\n  }, __jsx(Dropdown.Toggle, {\n    variant: \"outline-secondary\",\n    id: \"dropdown-button-2\",\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1033,\n      columnNumber: 25\n    }\n  }, dropdown2Text), __jsx(Dropdown.Menu, {\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1040,\n      columnNumber: 25\n    }\n  }, __jsx(Dropdown.Item, {\n    eventKey: \"unassigned\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1041,\n      columnNumber: 27\n    }\n  }, \"Select Option\"), __jsx(Dropdown.Item, {\n    eventKey: \"CT\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1044,\n      columnNumber: 27\n    }\n  }, \"CT\"), __jsx(Dropdown.Item, {\n    eventKey: \"MRI\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1045,\n      columnNumber: 27\n    }\n  }, \"MRI\"))))), __jsx(\"div\", {\n    className: styles.divider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1051,\n      columnNumber: 19\n    }\n  }), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1054,\n      columnNumber: 19\n    }\n  }, __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1055,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1056,\n      columnNumber: 23\n    }\n  }, \"Client From\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: function onClick() {\n      return handleClientClick(\"from\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1057,\n      columnNumber: 23\n    }\n  }, clientFromButtonText)), __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1066,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1067,\n      columnNumber: 23\n    }\n  }, \"Client Current\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: function onClick() {\n      return handleClientClick(\"current\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1068,\n      columnNumber: 23\n    }\n  }, clientCurrentButtonText)), __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1078,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1079,\n      columnNumber: 23\n    }\n  }, \"Model\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: handleModelClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1080,\n      columnNumber: 23\n    }\n  }, modelButtonText)), __jsx(\"div\", {\n    className: styles.divider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1089,\n      columnNumber: 21\n    }\n  }), __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1092,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1093,\n      columnNumber: 23\n    }\n  }, \"Warehouse\"), __jsx(\"div\", {\n    className: styles.buttonGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1094,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.flexButton,\n    onClick: handleSoCalWarehouseClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1095,\n      columnNumber: 25\n    }\n  }, \"SoCal Warehouse\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.flexButton,\n    onClick: handleNorCalWarehouseClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1102,\n      columnNumber: 25\n    }\n  }, \"NorCal Warehouse\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.flexButton,\n    onClick: handleWarehouseUnassignedClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1109,\n      columnNumber: 25\n    }\n  }, \"Unassigned\"))))), __jsx(Col, {\n    md: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1121,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: styles.tableContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1122,\n      columnNumber: 19\n    }\n  }, isLoading ? __jsx(\"div\", {\n    className: \"jsx-1682384643\" + \" \" + \"d-flex justify-content-center align-items-center p-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1124,\n      columnNumber: 23\n    }\n  }, __jsx(\"img\", {\n    src: \"/magmo-logo.png\" // make sure it's in /public\n    ,\n    alt: \"Loading Magmo\",\n    style: {\n      width: 64,\n      height: 64,\n      animation: \"magmo-spin 1s linear infinite\",\n      transformOrigin: \"50% 50%\",\n      display: \"block\"\n    },\n    className: \"jsx-1682384643\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1125,\n      columnNumber: 25\n    }\n  }), __jsx(_JSXStyle, {\n    id: \"1682384643\",\n    __self: this,\n    __source: void 0\n  }, \"@-webkit-keyframes magmo-spin{from{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}to{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}@keyframes magmo-spin{from{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}to{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFjazJcXERlc2t0b3BcXGNvZGVcXHBhZ2VzXFxOZXdTZWFyY2hcXG1haW5TZWFyY2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBaW5DMkMsQUFJa0MsQUFHRSxpRkFGM0IsTUFHQSIsImZpbGUiOiJDOlxcVXNlcnNcXG1hY2syXFxEZXNrdG9wXFxjb2RlXFxwYWdlc1xcTmV3U2VhcmNoXFxtYWluU2VhcmNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUsIHVzZVJlZiwgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7XHJcbiAgQ29udGFpbmVyLFxuICBDYXJkLFxuICBSb3csXG4gIENvbCxcbiAgSW5wdXRHcm91cCxcbiAgRHJvcGRvd24sXG4gIEZvcm1Db250cm9sLFxuICBCdXR0b24sXG4gIE5hdkRyb3Bkb3duLFxuICBGb3JtLFxuICBNb2RhbCxcbiAgU3Bpbm5lcixcbiAgUGFnaW5hdGlvbixcbn0gZnJvbSBcInJlYWN0LWJvb3RzdHJhcFwiO1xuaW1wb3J0IExpbmsgZnJvbSBcIm5leHQvbGlua1wiO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSBcIm5leHQvcm91dGVyXCI7XG5pbXBvcnQge1xuICBmZXRjaFBhcnRzV2l0aE1hY2hpbmVEYXRhUGFnZSxcbiAgZmV0Y2hDbGllbnRzLFxuICBmZXRjaE1vZGVscyxcbiAgZm9ybWF0RGF0ZSxcbn0gZnJvbSBcIi4uLy4uL3V0aWxzL2ZldGNoQXNzb2NpYXRpb25zXCI7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSBcIi4uLy4uL2NvbnRleHQvQXV0aFVzZXJDb250ZXh0XCI7XHJcbmltcG9ydCBMb2dnZWRJbiBmcm9tIFwiLi4vTG9nZ2VkSW5cIjtcclxuaW1wb3J0IENsaWVudFRhYmxlIGZyb20gXCIuLi8uLi91dGlscy9DbGllbnRUYWJsZVwiO1xyXG5pbXBvcnQgTW9kZWxUYWJsZSBmcm9tIFwiLi4vLi4vdXRpbHMvTW9kZWxUYWJsZVwiO1xyXG5pbXBvcnQgUGFydFRhYmxlIGZyb20gXCIuLi8uLi91dGlscy9QYXJ0VGFibGVcIjtcclxuaW1wb3J0IHN0eWxlcyBmcm9tIFwiLi4vLi4vc3R5bGVzL01haW5TZWFyY2gubW9kdWxlLmNzc1wiO1xyXG5pbXBvcnQgZmlyZWJhc2UgZnJvbSBcIi4uLy4uL2NvbnRleHQvRmlyZWJhc2VcIjtcclxuXHJcbi8vIFByZWRlZmluZWQgd2FyZWhvdXNlIGNsaWVudCBJRHMgYW5kIGRpc3BsYXkgbmFtZXNcclxuY29uc3QgU09DQUxfQ0xJRU5UX0lEID0gXCJBSVMxNzE4MlwiO1xyXG5jb25zdCBOT1JDQUxfQ0xJRU5UX0lEID0gXCJBSVMyNTA5N1wiO1xuY29uc3QgVU5BU1NJR05FRF9DTElFTlRfSUQgPSBcIkFJUzAwNDA0XCI7XG5jb25zdCBQQUdFX1NJWkUgPSAyNTtcblxyXG5cclxuLy8gU2ltdWxhdGVzIGEgbmV0d29yayByZXF1ZXN0IGRlbGF5XHJcbmZ1bmN0aW9uIHNpbXVsYXRlTmV0d29ya1JlcXVlc3QoKSB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMDApKTtcclxufVxyXG5cclxuLy8gQ3VzdG9tIExvYWRpbmdCdXR0b24gY29tcG9uZW50XHJcbmZ1bmN0aW9uIExvYWRpbmdCdXR0b24oeyB0eXBlLCBuYW1lLCByb3V0ZSB9KSB7XG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgbGV0IGNhbmNlbGxlZCA9IGZhbHNlO1xuICAgICAgc2ltdWxhdGVOZXR3b3JrUmVxdWVzdCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICBpZiAoIWNhbmNlbGxlZCkgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGNhbmNlbGxlZCA9IHRydWU7XG4gICAgICB9O1xuICAgIH1cbiAgfSwgW2lzTG9hZGluZ10pO1xuXHJcbiAgcmV0dXJuIChcclxuICAgIDxMaW5rIGhyZWY9e2AvJHtyb3V0ZX1gfT5cclxuICAgICAgPGFcclxuICAgICAgICBjbGFzc05hbWU9e2BidG4gYnRuLSR7dHlwZX1gfVxyXG4gICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmd9XHJcbiAgICAgICAgb25DbGljaz17KCkgPT4gIWlzTG9hZGluZyAmJiBzZXRMb2FkaW5nKHRydWUpfVxyXG4gICAgICA+XHJcbiAgICAgICAge2lzTG9hZGluZyA/IFwiTG9hZGluZ+KAplwiIDogbmFtZX1cclxuICAgICAgPC9hPlxyXG4gICAgPC9MaW5rPlxyXG4gICk7XHJcbn1cclxuXHJcbi8vIC0tLS0gREFURSBIRUxQRVJTICh0b3AtbGV2ZWwgc2NvcGUpIC0tLS1cclxuXHJcbi8vIENvbnZlcnQgYW55dGhpbmcgZGF0ZS1pc2ggaW50byBhIHRpbWVzdGFtcCAobXMgc2luY2UgZXBvY2gpLlxyXG5mdW5jdGlvbiB0b1RpbWUodmFsdWUpIHtcclxuICBpZiAoIXZhbHVlKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgLy8gRmlyZXN0b3JlIFRpbWVzdGFtcCB7IHNlY29uZHMsIG5hbm9zZWNvbmRzIH1cclxuICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlICE9PSBudWxsICYmIHZhbHVlLnNlY29uZHMgIT0gbnVsbCkge1xyXG4gICAgdHJ5IHsgcmV0dXJuIHZhbHVlLnNlY29uZHMgKiAxMDAwOyB9IGNhdGNoIHsgLyogaWdub3JlICovIH1cclxuICB9XHJcblxyXG4gIC8vIE5hdGl2ZSBEYXRlXHJcbiAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgY29uc3QgdCA9IHZhbHVlLmdldFRpbWUoKTtcclxuICAgIHJldHVybiBpc05hTih0KSA/IG51bGwgOiB0O1xyXG4gIH1cclxuXHJcbiAgLy8gU3RyaW5nc1xyXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcclxuICAgIC8vIElTTyAvIHl5eXktbW0tZGRcclxuICAgIGNvbnN0IGlzbyA9IERhdGUucGFyc2UodmFsdWUpO1xyXG4gICAgaWYgKCFpc05hTihpc28pKSByZXR1cm4gaXNvO1xyXG5cclxuICAgIC8vIG1tL2RkL3l5eXlcclxuICAgIGNvbnN0IHBhcnRzID0gdmFsdWUuc3BsaXQoXCIvXCIpO1xyXG4gICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMykge1xyXG4gICAgICBjb25zdCBbbW0sIGRkLCB5eXl5XSA9IHBhcnRzO1xyXG4gICAgICBjb25zdCBhbHQgPSBEYXRlLnBhcnNlKGAke3l5eXl9LSR7bW19LSR7ZGR9YCk7XHJcbiAgICAgIGlmICghaXNOYU4oYWx0KSkgcmV0dXJuIGFsdDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIExhc3QgcmVzb3J0XHJcbiAgY29uc3QgdCA9IERhdGUucGFyc2UodmFsdWUpO1xyXG4gIHJldHVybiBpc05hTih0KSA/IG51bGwgOiB0O1xyXG59XHJcblxyXG4vLyBDYW5vbmljYWxpemUgdG8gJ3l5eXktbW0tZGQnIChtYXRjaGVzIDxpbnB1dCB0eXBlPVwiZGF0ZVwiPilcclxuZnVuY3Rpb24gdG9ZTUQodmFsdWUpIHtcclxuICBjb25zdCB0ID0gdG9UaW1lKHZhbHVlKTtcclxuICBpZiAodCA9PSBudWxsKSByZXR1cm4gbnVsbDtcclxuICBjb25zdCBkID0gbmV3IERhdGUodCk7XHJcbiAgY29uc3QgeXl5eSA9IGQuZ2V0RnVsbFllYXIoKTtcclxuICBjb25zdCBtbSA9IFN0cmluZyhkLmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCBcIjBcIik7XHJcbiAgY29uc3QgZGQgPSBTdHJpbmcoZC5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcclxuICByZXR1cm4gYCR7eXl5eX0tJHttbX0tJHtkZH1gO1xyXG59XHJcblxyXG5cclxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gTWFpblNlYXJjaCgpIHtcclxuICBjb25zdCB7IHNpZ25PdXQgfSA9IHVzZUF1dGgoKTtcclxuICBjb25zdCBbaW5mbywgc2V0SW5mb10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW2JhY2t1cEluZm8sIHNldEJhY2t1cEluZm9dID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFthdWdtZW50ZWRJbmZvLCBzZXRBdWdtZW50ZWRJbmZvXSA9IHVzZVN0YXRlKFtdKTsgLy8gaXRlbXMgd2l0aCBjbGllbnRGcm9tSWQvY3VycmVudElkIGFkZGVkXHJcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKHRydWUpO1xyXG4gIGNvbnN0IFtpZHMsIHNldElEXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCBbc2hvdywgc2V0U2hvd10gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW2RJdGVtLCBzZXRESXRlbV0gPSB1c2VTdGF0ZSgpO1xyXG4gIGNvbnN0IFtzZWxlY3QsIHNldFNlbGVjdF0gPSB1c2VTdGF0ZShcIk5hbWVcIik7XHJcbiAgY29uc3QgW3Nob3dMaXN0LCBzZXRTaG93TGlzdF0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgY29uc3QgW3Nob3dMaXN0U2VhcmNoLCBzZXRTaG93TGlzdFNlYXJjaF0gPSB1c2VTdGF0ZShcInRleHRcIik7XHJcbiAgY29uc3QgW3NlYXJjaCwgc2V0U2VhcmNoXSA9IHVzZVN0YXRlKFwiXCIpO1xyXG4gIGNvbnN0IFtzZWxlY3RlZE9FTSwgc2V0U2VsZWN0ZWRPRU1dID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgY29uc3QgW3NlbGVjdGVkTW9kYWxpdHksIHNldFNlbGVjdGVkTW9kYWxpdHldID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgLy8gUmVwbGFjZSB0aGUgb2xkIHNpbmdsZSBjbGllbnQgc3RhdGUgd2l0aCB0d28gc2V0czpcclxuICBjb25zdCBbc2VsZWN0ZWRDbGllbnRGcm9tLCBzZXRTZWxlY3RlZENsaWVudEZyb21dID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgY29uc3QgW2NsaWVudEZyb21CdXR0b25UZXh0LCBzZXRDbGllbnRGcm9tQnV0dG9uVGV4dF0gPSB1c2VTdGF0ZShcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgY29uc3QgW3NlbGVjdGVkQ2xpZW50Q3VycmVudCwgc2V0U2VsZWN0ZWRDbGllbnRDdXJyZW50XSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtjbGllbnRDdXJyZW50QnV0dG9uVGV4dCwgc2V0Q2xpZW50Q3VycmVudEJ1dHRvblRleHRdID0gdXNlU3RhdGUoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG5cclxuICBjb25zdCBbY2xpZW50cywgc2V0Q2xpZW50c10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW3Nob3dDbGllbnRNb2RhbCwgc2V0U2hvd0NsaWVudE1vZGFsXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICAvLyBUaGlzIHN0YXRlIHRlbGxzIHRoZSBtb2RhbCB3aGljaCBjbGllbnQgYm94IGlzIGJlaW5nIHVwZGF0ZWQ6IFwiZnJvbVwiIG9yIFwiY3VycmVudFwiXHJcbiAgY29uc3QgW2NsaWVudFNlbGVjdGlvblR5cGUsIHNldENsaWVudFNlbGVjdGlvblR5cGVdID0gdXNlU3RhdGUobnVsbCk7XHJcblxyXG4gIGNvbnN0IHJvdXRlciA9IHVzZVJvdXRlcigpO1xyXG4gIGNvbnN0IGxhYmVsQmFzZSA9IFtcIm5hbWVcIiwgXCJkYXRlXCIsIFwidy9vXCIsIFwicC9uXCIsIFwicy9uXCJdO1xyXG4gIGNvbnN0IGxhYmVsQmFzZU5hbWVzID0gW1wibmFtZVwiLCBcImRhdGVcIiwgXCJ3b1wiLCBcInBuXCIsIFwic25cIl07XHJcbiAgY29uc3Qgc29ydENoZWNrQmFzZSA9IFtmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlXTtcclxuXHJcbiAgZnVuY3Rpb24gd2l0aFNvcnRJY29uKGJhc2VMYWJlbHMsIGFjdGl2ZUluZGV4LCBpc0Rlc2MpIHtcclxuICAgIHJldHVybiBiYXNlTGFiZWxzLm1hcCgodGV4dCwgaSkgPT4ge1xyXG4gICAgICBpZiAoaSAhPT0gYWN0aXZlSW5kZXgpIHJldHVybiB0ZXh0OyAvLyB1bnRvdWNoZWRcclxuICAgICAgY29uc3QgYXJyb3cgPSBpc0Rlc2MgPyBcIiDilrxcIiA6IFwiIOKWslwiO1xyXG4gICAgICByZXR1cm4gYCR7dGV4dH0ke2Fycm93fWA7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG5cclxuICBjb25zdCBbbGFiZWxzLCBzZXRMYWJlbHNdID0gdXNlU3RhdGUobGFiZWxCYXNlKTtcclxuICBjb25zdCBbc29ydENoZWNrLCBzZXRTb3J0Q2hlY2tdID0gdXNlU3RhdGUoc29ydENoZWNrQmFzZSk7XHJcbiAgY29uc3QgW2hvdmVySW5kZXgsIHNldEhvdmVySW5kZXhdID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgY29uc3QgW3NlbGVjdGVkTW9kZWwsIHNldFNlbGVjdGVkTW9kZWxdID0gdXNlU3RhdGUobnVsbCk7XHJcbiAgY29uc3QgW2dQb3MsIHNldEdQb3NdID0gdXNlU3RhdGUobnVsbCk7XG4gIGNvbnN0IFtnSWRlLCBzZXRHSWRlXSA9IHVzZVN0YXRlKG51bGwpO1xuICBjb25zdCBbaXNEZWxldGluZywgc2V0SXNEZWxldGluZ10gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IFtwYWdlLCBzZXRQYWdlXSA9IHVzZVN0YXRlKDEpO1xuICBjb25zdCBbcGFnZUN1cnNvcnMsIHNldFBhZ2VDdXJzb3JzXSA9IHVzZVN0YXRlKFtdKTtcbiAgY29uc3QgW2hhc05leHRQYWdlLCBzZXRIYXNOZXh0UGFnZV0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIGNvbnN0IGZldGNoU2VxID0gdXNlUmVmKDApO1xuXG4gIGNvbnN0IHNlYXJjaExvd2VyID0gKHNlYXJjaCB8fCBcIlwiKS50b0xvd2VyQ2FzZSgpLnRyaW0oKTtcbiAgY29uc3QgaGFzQWN0aXZlRmlsdGVycyA9XG4gICAgQm9vbGVhbihzZWxlY3RlZE9FTSkgfHxcbiAgICBCb29sZWFuKHNlbGVjdGVkTW9kYWxpdHkpIHx8XG4gICAgQm9vbGVhbihzZWxlY3RlZE1vZGVsKSB8fFxuICAgIEJvb2xlYW4oc2VsZWN0ZWRDbGllbnRGcm9tKSB8fFxuICAgIEJvb2xlYW4oc2VsZWN0ZWRDbGllbnRDdXJyZW50KSB8fFxuICAgIEJvb2xlYW4oc2VhcmNoTG93ZXIpO1xuXG4gIGNvbnN0IHZhbHVlTWF0Y2hlcyA9ICh2YWx1ZSwgcykgPT4ge1xuICAgIGlmICghdmFsdWUpIHJldHVybiBmYWxzZTtcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgIHJldHVybiB2YWx1ZS5zb21lKCh2KSA9PiB2YWx1ZU1hdGNoZXModiwgcykpO1xuICAgIH1cbiAgICByZXR1cm4gU3RyaW5nKHZhbHVlKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHMpO1xuICB9O1xuXG4gIGNvbnN0IG1hdGNoZXNGaWx0ZXJzID0gdXNlQ2FsbGJhY2soXG4gICAgKGl0ZW0pID0+IHtcbiAgICAgIC8vIGhpZGUgZXhwbGljaXRseSBoaWRkZW4gaXRlbXNcbiAgICAgIGlmIChpdGVtPy52aXNpYmxlID09PSBmYWxzZSkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAvLyBPRU0gLyBNb2RhbGl0eSAvIE1vZGVsIGZpbHRlcmluZ1xuICAgICAgY29uc3QgT0VNID1cbiAgICAgICAgaXRlbT8ubWFjaGluZURhdGE/Lk9FTSA/P1xuICAgICAgICBpdGVtPy5tYWNoaW5lRGF0YT8ub2VtID8/XG4gICAgICAgIGl0ZW0/LnRoZU1hY2hpbmVEYXRhPy5PRU0gPz9cbiAgICAgICAgaXRlbT8udGhlTWFjaGluZURhdGE/Lm9lbSA/P1xuICAgICAgICBpdGVtPy5UaGVNYWNoaW5lPy5PRU0gPz9cbiAgICAgICAgaXRlbT8uVGhlTWFjaGluZT8ub2VtO1xuICAgICAgY29uc3QgTW9kYWxpdHkgPVxuICAgICAgICBpdGVtPy5tYWNoaW5lRGF0YT8uTW9kYWxpdHkgPz9cbiAgICAgICAgaXRlbT8ubWFjaGluZURhdGE/Lm1vZGFsaXR5ID8/XG4gICAgICAgIGl0ZW0/LnRoZU1hY2hpbmVEYXRhPy5Nb2RhbGl0eSA/P1xuICAgICAgICBpdGVtPy50aGVNYWNoaW5lRGF0YT8ubW9kYWxpdHkgPz9cbiAgICAgICAgaXRlbT8uVGhlTWFjaGluZT8uTW9kYWxpdHkgPz9cbiAgICAgICAgaXRlbT8uVGhlTWFjaGluZT8ubW9kYWxpdHk7XG4gICAgICBjb25zdCBNb2RlbCA9XG4gICAgICAgIGl0ZW0/Lm1hY2hpbmVEYXRhPy5Nb2RlbCA/P1xuICAgICAgICBpdGVtPy5tYWNoaW5lRGF0YT8ubW9kZWwgPz9cbiAgICAgICAgaXRlbT8udGhlTWFjaGluZURhdGE/Lk1vZGVsID8/XG4gICAgICAgIGl0ZW0/LnRoZU1hY2hpbmVEYXRhPy5tb2RlbCA/P1xuICAgICAgICBpdGVtPy5UaGVNYWNoaW5lPy5Nb2RlbCA/P1xuICAgICAgICBpdGVtPy5UaGVNYWNoaW5lPy5tb2RlbDtcblxuICAgICAgaWYgKHNlbGVjdGVkT0VNICYmIE9FTSAhPT0gc2VsZWN0ZWRPRU0pIHJldHVybiBmYWxzZTtcbiAgICAgIGlmIChzZWxlY3RlZE1vZGFsaXR5ICYmIE1vZGFsaXR5ICE9PSBzZWxlY3RlZE1vZGFsaXR5KSByZXR1cm4gZmFsc2U7XG4gICAgICBpZiAoc2VsZWN0ZWRNb2RlbCAmJiBNb2RlbCAhPT0gc2VsZWN0ZWRNb2RlbCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAvLyBDbGllbnQgZmlsdGVyc1xuICAgICAgaWYgKHNlbGVjdGVkQ2xpZW50RnJvbSAmJiBpdGVtPy5jbGllbnRGcm9tSWQgIT09IHNlbGVjdGVkQ2xpZW50RnJvbSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoXG4gICAgICAgIHNlbGVjdGVkQ2xpZW50Q3VycmVudCAmJlxuICAgICAgICBpdGVtPy5jbGllbnRDdXJyZW50SWQgIT09IHNlbGVjdGVkQ2xpZW50Q3VycmVudFxuICAgICAgKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gU2VhcmNoXG4gICAgICBpZiAoc2VhcmNoTG93ZXIpIHtcbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJOYW1lXCIpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWVNYXRjaGVzKGl0ZW0/Lm5hbWUsIHNlYXJjaExvd2VyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0ID09PSBcIkRhdGVcIikge1xuICAgICAgICAgIGNvbnN0IHdhbnRlZERheSA9IHNlYXJjaExvd2VyOyAvLyB5eXl5LW1tLWRkIGZyb20gaW5wdXRcbiAgICAgICAgICBjb25zdCBpdGVtWU1EID0gdG9ZTUQoaXRlbT8uZGF0ZSk7XG4gICAgICAgICAgaWYgKGl0ZW1ZTUQgJiYgaXRlbVlNRCA9PT0gd2FudGVkRGF5KSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVtPy5kZXNjcmlwdGlvbnMpKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5kZXNjcmlwdGlvbnMuc29tZSgoZCkgPT4gdG9ZTUQoZD8uZGF0ZSkgPT09IHdhbnRlZERheSkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGl0ZW0/LndvcmtPcmRlcnMpKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS53b3JrT3JkZXJzLnNvbWUoKHcpID0+IHRvWU1EKHc/LmRhdGUpID09PSB3YW50ZWREYXkpKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJXb3JrIE9yZGVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgQXJyYXkuaXNBcnJheShpdGVtPy53b3JrT3JkZXJzKSAmJlxuICAgICAgICAgICAgaXRlbS53b3JrT3JkZXJzLnNvbWUoKHdvKSA9PlxuICAgICAgICAgICAgICB2YWx1ZU1hdGNoZXMod28/LndvcmtPcmRlciwgc2VhcmNoTG93ZXIpXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0ID09PSBcIlByb2R1Y3QgTnVtYmVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWVNYXRjaGVzKGl0ZW0/LnBuLCBzZWFyY2hMb3dlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJTZXJpYWwgTnVtYmVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWVNYXRjaGVzKGl0ZW0/LnNuLCBzZWFyY2hMb3dlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJEZXNjcmlwdGlvblwiKSB7XG4gICAgICAgICAgaWYgKHZhbHVlTWF0Y2hlcyhpdGVtPy5kZXNjLCBzZWFyY2hMb3dlcikpIHJldHVybiB0cnVlO1xuICAgICAgICAgIGlmICh2YWx1ZU1hdGNoZXMoaXRlbT8uZGVzY3JpcHRpb24sIHNlYXJjaExvd2VyKSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbT8uZGVzY3JpcHRpb25zKSkge1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZGVzY3JpcHRpb25zLnNvbWUoKGQpID0+XG4gICAgICAgICAgICAgIHZhbHVlTWF0Y2hlcyhkPy5kZXNjcmlwdGlvbiwgc2VhcmNoTG93ZXIpXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJTS1VcIikge1xuICAgICAgICAgIHJldHVybiB2YWx1ZU1hdGNoZXMoaXRlbT8uaWQsIHNlYXJjaExvd2VyKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIFtcbiAgICAgIHNlbGVjdGVkT0VNLFxuICAgICAgc2VsZWN0ZWRNb2RhbGl0eSxcbiAgICAgIHNlbGVjdGVkTW9kZWwsXG4gICAgICBzZWxlY3RlZENsaWVudEZyb20sXG4gICAgICBzZWxlY3RlZENsaWVudEN1cnJlbnQsXG4gICAgICBzZWFyY2hMb3dlcixcbiAgICAgIHNlbGVjdCxcbiAgICBdXG4gICk7XG5cbiAgY29uc3QgcmVzZXRQYWdpbmF0aW9uID0gKCkgPT4ge1xuICAgIHNldFBhZ2UoMSk7XG4gICAgc2V0UGFnZUN1cnNvcnMoW10pO1xuICAgIHNldEhhc05leHRQYWdlKGZhbHNlKTtcbiAgfTtcblxuICAvLyBSZXNldCBwYWdpbmF0aW9uIG9uIHJvdXRlL3F1ZXJ5IGNoYW5nZSAocHJldmVudHMgc3RhbGUgcGFnZXMgbGlrZSDigJxzdGFydGluZyBhdCA24oCdKVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIHJlc2V0UGFnaW5hdGlvbigpO1xuICB9LCBbcm91dGVyLmFzUGF0aF0pO1xuXG4gIC8vIEZldGNoIGRhdGEgb24gY29tcG9uZW50IG1vdW50IGFuZCByb3V0ZSBjaGFuZ2VcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBmZXRjaERhdGEocGFnZSk7XG4gIH0sIFtyb3V0ZXIucm91dGUsIHBhZ2VdKTtcblxuICAvLyBJZiBmaWx0ZXJzL3NlYXJjaCBjaGFuZ2Ugd2hpbGUgb24gYSBsYXRlciBwYWdlLCBqdW1wIGJhY2sgdG8gcGFnZSAxXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKHBhZ2UgIT09IDEpIHNldFBhZ2UoMSk7XG4gIH0sIFtcbiAgICBzZWxlY3RlZE9FTSxcbiAgICBzZWxlY3RlZE1vZGFsaXR5LFxuICAgIHNlbGVjdGVkTW9kZWwsXG4gICAgc2VsZWN0ZWRDbGllbnRGcm9tLFxuICAgIHNlbGVjdGVkQ2xpZW50Q3VycmVudCxcbiAgICBzZWFyY2gsXG4gICAgc2VsZWN0LFxuICBdKTtcblxuICBhc3luYyBmdW5jdGlvbiBmZXRjaERhdGEocmVxdWVzdGVkUGFnZSA9IDEpIHtcbiAgICBjb25zdCBzZXEgPSArK2ZldGNoU2VxLmN1cnJlbnQ7XG4gICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgIHRyeSB7XG4gICAgICBpZiAocm91dGVyLnF1ZXJ5LmlucHV0VGV4dCAmJiByb3V0ZXIucXVlcnkuc2VsZWN0ZWRUeXBlKSB7XG4gICAgICAgIHNldFNlbGVjdChyb3V0ZXIucXVlcnkuc2VsZWN0ZWRUeXBlKTtcbiAgICAgICAgc2V0U2VhcmNoKHJvdXRlci5xdWVyeS5pbnB1dFRleHQpO1xuICAgICAgfVxuICAgICAgY29uc3Qgc3RhcnRBZnRlckRvYyA9XG4gICAgICAgIHJlcXVlc3RlZFBhZ2UgPiAxID8gcGFnZUN1cnNvcnNbcmVxdWVzdGVkUGFnZSAtIDJdIDogbnVsbDtcbiAgICAgIGlmIChyZXF1ZXN0ZWRQYWdlID4gMSAmJiAhc3RhcnRBZnRlckRvYykge1xuICAgICAgICBzZXRQYWdlKDEpO1xuICAgICAgICBpZiAoc2VxID09PSBmZXRjaFNlcS5jdXJyZW50KSBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyBsaWdodCByZXRyeSBmb3IgdHJhbnNpZW50IEZpcmVzdG9yZSBoaWNjdXBzXG4gICAgICBjb25zdCBsb2FkID0gYXN5bmMgKGF0dGVtcHQgPSAxKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IGZldGNoUGFydHNXaXRoTWFjaGluZURhdGFQYWdlKHtcbiAgICAgICAgICAgIHBhZ2VTaXplOiBQQUdFX1NJWkUsXG4gICAgICAgICAgICBzdGFydEFmdGVyRG9jLFxuICAgICAgICAgICAgdmlzaWJsZU9ubHk6IHRydWUsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBpZiAoYXR0ZW1wdCA+PSAzKSB0aHJvdyBlO1xuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHIgPT4gc2V0VGltZW91dChyLCAyNTAgKiBNYXRoLnBvdygyLCBhdHRlbXB0IC0gMSkpKTtcbiAgICAgICAgICByZXR1cm4gbG9hZChhdHRlbXB0ICsgMSk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgICBjb25zdCB7IHBhcnRzOiBkYXRhLCBsYXN0RG9jLCBoYXNOZXh0UGFnZTogbmV4dFBhZ2UgfSA9IGF3YWl0IGxvYWQoKTtcbiAgICAgIGlmIChzZXEgIT09IGZldGNoU2VxLmN1cnJlbnQpIHJldHVybjtcbiAgICAgIGlmIChyZXF1ZXN0ZWRQYWdlID09PSAxICYmIGRhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNldFBhZ2VDdXJzb3JzKFtdKTtcbiAgICAgICAgc2V0SGFzTmV4dFBhZ2UoZmFsc2UpO1xuICAgICAgfVxuICAgICAgc2V0QmFja3VwSW5mbyhkYXRhKTtcbiAgICAgIHNldExhYmVscyhsYWJlbEJhc2UpOyAvLyA8LS0gYWRkIHRoaXMgbGluZSBhZnRlciBzZXRCYWNrdXBJbmZvKGRhdGEpXG4gICAgICBzZXRJRChkYXRhLm1hcCgoaXRlbSkgPT4gaXRlbS5pZCkpO1xuICAgICAgaWYgKHJlcXVlc3RlZFBhZ2UgPiAxICYmIGRhdGEubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHNldEhhc05leHRQYWdlKGZhbHNlKTtcbiAgICAgICAgc2V0UGFnZSgxKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgc2V0SGFzTmV4dFBhZ2UobmV4dFBhZ2UpO1xuICAgICAgc2V0UGFnZUN1cnNvcnMoKHByZXYpID0+IHtcbiAgICAgICAgY29uc3QgbmV4dCA9IHJlcXVlc3RlZFBhZ2UgPT09IDEgPyBbXSA6IFsuLi5wcmV2XTtcbiAgICAgICAgaWYgKGxhc3REb2MpIHtcbiAgICAgICAgICBuZXh0W3JlcXVlc3RlZFBhZ2UgLSAxXSA9IGxhc3REb2M7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5leHQ7XG4gICAgICB9KTtcbiAgICAgIHNldFNlbGVjdGVkSXRlbXMoW10pO1xuXG4gICAgICAvLyAtLS0gUHJlLWF1Z21lbnQ6IHJlc29sdmUgY2xpZW50IGlkcyBvZiBNYWNoaW5lIC8gQ3VycmVudE1hY2hpbmUgb25jZSAtLS1cbiAgICAgIGNvbnN0IGRiID0gZmlyZWJhc2UuZmlyZXN0b3JlKCk7XG4gICAgICBjb25zdCBtYWNoaW5lSWRzID0gW107XHJcbiAgICAgIGNvbnN0IGN1ck1hY2hpbmVJZHMgPSBbXTtcclxuICAgICAgY29uc3QgdGhlTWFjaGluZUlkcyA9IFtdOyAvLyA8LS0gQUREXHJcblxyXG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgZGF0YSkge1xyXG4gICAgICAgIGlmIChpdGVtPy5NYWNoaW5lPy5pZCkgbWFjaGluZUlkcy5wdXNoKGl0ZW0uTWFjaGluZS5pZCk7XHJcbiAgICAgICAgaWYgKGl0ZW0/LkN1cnJlbnRNYWNoaW5lPy5pZCkgY3VyTWFjaGluZUlkcy5wdXNoKGl0ZW0uQ3VycmVudE1hY2hpbmUuaWQpO1xyXG4gICAgICAgIGlmIChpdGVtPy5UaGVNYWNoaW5lPy5pZCkgdGhlTWFjaGluZUlkcy5wdXNoKGl0ZW0uVGhlTWFjaGluZS5pZCk7IC8vIDwtLSBBRERcclxuICAgICAgfVxyXG4gICAgICBjb25zdCB1bmlxID0gKGFycikgPT4gWy4uLm5ldyBTZXQoYXJyKV07XHJcbiAgICAgIGNvbnN0IG1JZHMgPSB1bmlxKG1hY2hpbmVJZHMpO1xyXG4gICAgICBjb25zdCBjSWRzID0gdW5pcShjdXJNYWNoaW5lSWRzKTtcclxuXHJcbiAgICAgIGNvbnN0IGZldGNoTWFjaGluZUNsaWVudHMgPSBhc3luYyAoaWRzKSA9PiB7XHJcbiAgICAgICAgaWYgKCFpZHMubGVuZ3RoKSByZXR1cm4ge307XHJcbiAgICAgICAgY29uc3Qgb3V0ID0ge307XHJcbiAgICAgICAgLy8gRmlyZXN0b3JlIFwiaW5cIiBzdXBwb3J0cyB1cCB0byAxMCBkb2N1bWVudCBJRHMgcGVyIHF1ZXJ5XHJcbiAgICAgICAgY29uc3QgY2h1bmtzID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyBpICs9IDEwKSBjaHVua3MucHVzaChpZHMuc2xpY2UoaSwgaSArIDEwKSk7XHJcbiAgICAgICAgZm9yIChjb25zdCBjaHVuayBvZiBjaHVua3MpIHtcclxuICAgICAgICAgIGNvbnN0IHNuYXAgPSBhd2FpdCBkYlxyXG4gICAgICAgICAgICAuY29sbGVjdGlvbihcIk1hY2hpbmVcIilcclxuICAgICAgICAgICAgLndoZXJlKGZpcmViYXNlLmZpcmVzdG9yZS5GaWVsZFBhdGguZG9jdW1lbnRJZCgpLCBcImluXCIsIGNodW5rKVxyXG4gICAgICAgICAgICAuZ2V0KCk7XHJcbiAgICAgICAgICBzbmFwLmZvckVhY2goKGRvYykgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBtZCA9IGRvYy5kYXRhKCkgfHwge307XHJcbiAgICAgICAgICAgIG91dFtkb2MuaWRdID0gbWQuY2xpZW50Py5pZCB8fCBudWxsO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvdXQ7XHJcbiAgICAgIH07XHJcblxyXG4gICAgICAvLyBGZXRjaCBmdWxsIG1hY2hpbmUgZG9jcyAoT0VNL01vZGFsaXR5L01vZGVsL0NsaWVudC9ldGMuKSBmb3IgYSBzZXQgb2YgaWRzXHJcbiAgICAgIGNvbnN0IGZldGNoTWFjaGluZXNEYXRhID0gYXN5bmMgKGlkcykgPT4ge1xyXG4gICAgICAgIGlmICghaWRzLmxlbmd0aCkgcmV0dXJuIHt9O1xyXG4gICAgICAgIGNvbnN0IG91dCA9IHt9O1xyXG4gICAgICAgIGNvbnN0IGNodW5rcyA9IFtdO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWRzLmxlbmd0aDsgaSArPSAxMCkgY2h1bmtzLnB1c2goaWRzLnNsaWNlKGksIGkgKyAxMCkpO1xyXG4gICAgICAgIGZvciAoY29uc3QgY2h1bmsgb2YgY2h1bmtzKSB7XHJcbiAgICAgICAgICBjb25zdCBzbmFwID0gYXdhaXQgZGJcclxuICAgICAgICAgICAgLmNvbGxlY3Rpb24oXCJNYWNoaW5lXCIpXHJcbiAgICAgICAgICAgIC53aGVyZShmaXJlYmFzZS5maXJlc3RvcmUuRmllbGRQYXRoLmRvY3VtZW50SWQoKSwgXCJpblwiLCBjaHVuaylcclxuICAgICAgICAgICAgLmdldCgpO1xyXG4gICAgICAgICAgc25hcC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgICAgICAgb3V0W2RvYy5pZF0gPSB7IGlkOiBkb2MuaWQsIC4uLihkb2MuZGF0YSgpIHx8IHt9KSB9O1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBvdXQ7XHJcbiAgICAgIH07XHJcblxyXG5cclxuICAgICAgY29uc3QgW2Zyb21NYXAsIGN1ck1hcCwgdGhlTWFwXSA9IGF3YWl0IFByb21pc2UuYWxsKFtcclxuICAgICAgICBmZXRjaE1hY2hpbmVDbGllbnRzKG1JZHMpLFxyXG4gICAgICAgIGZldGNoTWFjaGluZUNsaWVudHMoY0lkcyksXHJcbiAgICAgICAgZmV0Y2hNYWNoaW5lc0RhdGEodW5pcSh0aGVNYWNoaW5lSWRzKSksIC8vIDwtLSBub3cgY2FwdHVyZWQgYXMgdGhlTWFwXHJcbiAgICAgIF0pO1xyXG5cclxuICAgICAgLy8gTmV3LXN0eWxlIG9ubHk6IHRha2UgY2xpZW50IGlkcyBzdHJhaWdodCBmcm9tIGl0ZW0gcmVmc1xyXG4gICAgICBjb25zdCBhdWdtZW50ZWQgPSBkYXRhLm1hcCgoaXRlbSkgPT4gKHtcclxuICAgICAgICAuLi5pdGVtLFxyXG4gICAgICAgIGNsaWVudEZyb21JZDogaXRlbT8uQ2xpZW50RnJvbT8uaWQgPz8gbnVsbCxcclxuICAgICAgICBjbGllbnRDdXJyZW50SWQ6IGl0ZW0/LkNsaWVudEN1cnJlbnQ/LmlkID8/IG51bGwsXHJcbiAgICAgIH0pKTtcclxuXHJcbiAgICAgIHNldEF1Z21lbnRlZEluZm8oYXVnbWVudGVkKTtcbiAgICAgIC8vIGRlZmF1bHQgdmlldyA9IGV2ZXJ5dGhpbmcgbm90IGV4cGxpY2l0bHkgaGlkZGVuXG4gICAgICBzZXRJbmZvKGF1Z21lbnRlZC5maWx0ZXIoKGl0KSA9PiBpdC52aXNpYmxlICE9PSBmYWxzZSkpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKHNlcSAhPT0gZmV0Y2hTZXEuY3VycmVudCkgcmV0dXJuO1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGRhdGE6XCIsIGVycik7XG4gICAgICBzZXRJbmZvKFtdKTtcbiAgICAgIHNldEF1Z21lbnRlZEluZm8oW10pO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBpZiAoc2VxID09PSBmZXRjaFNlcS5jdXJyZW50KSBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfVxuXHJcbiAgY29uc3Qgc2VhcmNoQ2hhbmdlSGFuZGxlciA9IChldmVudCkgPT4gc2V0U2VhcmNoKGV2ZW50LnRhcmdldC52YWx1ZSk7XHJcblxyXG4gIC8vIEZpbHRlciB0aGUgY3VycmVudGx5IGxvYWRlZCBpdGVtcyAobm93IGNvbnNpc3RlbnQgd2l0aCBwYWdlZCBmaWx0ZXJpbmcpXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgYmFzZSA9IGF1Z21lbnRlZEluZm8gfHwgW107XG4gICAgc2V0SW5mbyhiYXNlLmZpbHRlcihtYXRjaGVzRmlsdGVycykpO1xuICB9LCBbYXVnbWVudGVkSW5mbywgbWF0Y2hlc0ZpbHRlcnNdKTtcblxyXG4gIGZ1bmN0aW9uIHNvcnRDaGVja0FsbChwb3MpIHtcclxuICAgIC8vIERldGVybWluZSBuZXh0IGRpcmVjdGlvbjogdG9nZ2xlIHRoZSBjbGlja2VkIGNvbHVtbiBvbmx5XHJcbiAgICBjb25zdCBuZXh0U29ydENoZWNrID0gc29ydENoZWNrLm1hcCgodiwgaSkgPT4gKGkgPT09IHBvcyA/ICF2IDogdikpO1xyXG4gICAgY29uc3QgaXNEZXNjID0gbmV4dFNvcnRDaGVja1twb3NdOyAvLyB0cnVlIG1lYW5zIGRlc2NlbmRpbmdcclxuXHJcbiAgICBjb25zdCBzb3J0ZWRJbmZvID0gWy4uLmluZm9dLnNvcnQoKGEsIGIpID0+IHtcclxuICAgICAgY29uc3Qga2V5ID0gbGFiZWxCYXNlTmFtZXNbcG9zXTtcclxuXHJcbiAgICAgIGlmIChwb3MgPT09IDEpIHtcclxuICAgICAgICAvLyBEQVRFIGNvbHVtblxyXG4gICAgICAgIGNvbnN0IHRhID0gdG9UaW1lKGFba2V5XSk7XHJcbiAgICAgICAgY29uc3QgdGIgPSB0b1RpbWUoYltrZXldKTtcclxuXHJcbiAgICAgICAgLy8gUHV0IG1pc3NpbmcgZGF0ZXMgYXQgdGhlIGVuZCBmb3IgYXNjZW5kaW5nLCBhdCB0aGUgc3RhcnQgZm9yIGRlc2NlbmRpbmdcclxuICAgICAgICBpZiAodGEgPT09IG51bGwgJiYgdGIgPT09IG51bGwpIHJldHVybiAwO1xyXG4gICAgICAgIGlmICh0YSA9PT0gbnVsbCkgcmV0dXJuIGlzRGVzYyA/IC0xIDogMTtcclxuICAgICAgICBpZiAodGIgPT09IG51bGwpIHJldHVybiBpc0Rlc2MgPyAxIDogLTE7XHJcblxyXG4gICAgICAgIHJldHVybiBpc0Rlc2MgPyAodGIgLSB0YSkgOiAodGEgLSB0Yik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIE5BTUUgb3IgU0tVIChzdHJpbmcteSBjb2x1bW5zKTogaW5kZXhlcyAwIG9yIDUgaW4geW91ciBvcmlnaW5hbCBsb2dpY1xyXG4gICAgICBpZiAocG9zID09PSAwIHx8IHBvcyA9PT0gNSkge1xyXG4gICAgICAgIGNvbnN0IGF2ID0gKGFba2V5XSA/PyBcIlwiKS50b1N0cmluZygpO1xyXG4gICAgICAgIGNvbnN0IGJ2ID0gKGJba2V5XSA/PyBcIlwiKS50b1N0cmluZygpO1xyXG4gICAgICAgIHJldHVybiBpc0Rlc2MgPyBidi5sb2NhbGVDb21wYXJlKGF2KSA6IGF2LmxvY2FsZUNvbXBhcmUoYnYpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBOdW1lcmljLWlzaCBjb2x1bW5zICh3bywgcG4sIHNuKSDigJQgZmFsbCBiYWNrIHRvIHN0cmluZyBjb21wYXJlIGlmIE5hTlxyXG4gICAgICBjb25zdCBhbiA9IE51bWJlcihhW2tleV0pO1xyXG4gICAgICBjb25zdCBibiA9IE51bWJlcihiW2tleV0pO1xyXG5cclxuICAgICAgaWYgKCFpc05hTihhbikgJiYgIWlzTmFOKGJuKSkge1xyXG4gICAgICAgIHJldHVybiBpc0Rlc2MgPyAoYm4gLSBhbikgOiAoYW4gLSBibik7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgYXYgPSAoYVtrZXldID8/IFwiXCIpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgY29uc3QgYnYgPSAoYltrZXldID8/IFwiXCIpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgcmV0dXJuIGlzRGVzYyA/IGJ2LmxvY2FsZUNvbXBhcmUoYXYpIDogYXYubG9jYWxlQ29tcGFyZShidik7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgIHNldEluZm8oc29ydGVkSW5mbyk7XHJcbiAgICBzZXRTb3J0Q2hlY2sobmV4dFNvcnRDaGVjayk7XHJcblxyXG4gICAgLy8gVXBkYXRlIGhlYWRlciBsYWJlbHMgdG8gc2hvdyB0aGUgbGl0dGxlIGFycm93IG9uIHRoZSBhY3RpdmUgY29sdW1uXHJcbiAgICBzZXRMYWJlbHMod2l0aFNvcnRJY29uKGxhYmVsQmFzZSwgcG9zLCBpc0Rlc2MpKTtcclxuICB9XHJcblxyXG5cclxuICBjb25zdCByb3dTZWxlY3QgPSAoaXRlbSkgPT4ge1xyXG4gICAgaWYgKGl0ZW0gJiYgaXRlbS5pZCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIlNlbGVjdGVkIGl0ZW06XCIsIGl0ZW0pO1xyXG4gICAgICByb3V0ZXIucHVzaChcIi4vaXRlbS9cIiArIGl0ZW0uaWQpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIlVuYWJsZSB0byBkZXRlcm1pbmUgdGhlIHNlbGVjdGVkIGl0ZW3igJlzIElEOiBcIiwgaXRlbSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgW3NlbGVjdGVkSXRlbXMsIHNldFNlbGVjdGVkSXRlbXNdID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFtzaG93RGVsZXRlTW9kYWwsIHNldFNob3dEZWxldGVNb2RhbF0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVNlbGVjdEl0ZW0gPSAoaWQpID0+IHtcclxuICAgIHNldFNlbGVjdGVkSXRlbXMocHJldiA9PlxyXG4gICAgICBwcmV2LmluY2x1ZGVzKGlkKSA/IHByZXYuZmlsdGVyKHggPT4geCAhPT0gaWQpIDogWy4uLnByZXYsIGlkXVxyXG4gICAgKTtcclxuICB9O1xyXG5cclxuXHJcbiAgLy8gc2V0U2VsZWN0ZWRJdGVtcygocHJldikgPT4ge1xyXG4gIC8vICAgY29uc3QgbmV3U2VsZWN0aW9uID0gcHJldi5pbmNsdWRlcyhpZClcclxuICAvLyAgICAgPyBwcmV2LmZpbHRlcigoaXRlbUlkKSA9PiBpdGVtSWQgIT09IGlkKVxyXG4gIC8vICAgICA6IFsuLi5wcmV2LCBpZF07XHJcbiAgLy8gICBjb25zb2xlLmxvZyhcIlNlbGVjdGVkIGl0ZW1zOlwiLCBuZXdTZWxlY3Rpb24pO1xyXG4gIC8vICAgcmV0dXJuIG5ld1NlbGVjdGlvbjsgLy8gPC0gaW1wb3J0YW50XHJcbiAgLy8gfSk7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVNob3dEZWxldGVNb2RhbCA9ICgpID0+IHNldFNob3dEZWxldGVNb2RhbCh0cnVlKTtcclxuICBjb25zdCBoYW5kbGVDbG9zZURlbGV0ZU1vZGFsID0gKCkgPT4gc2V0U2hvd0RlbGV0ZU1vZGFsKGZhbHNlKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlRGVsZXRlU2VsZWN0ZWQgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBzZXRJc0RlbGV0aW5nKHRydWUpO1xyXG4gICAgY29uc3QgZGIgPSBmaXJlYmFzZS5maXJlc3RvcmUoKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIExvb3Agb3ZlciBlYWNoIHNlbGVjdGVkIGl0ZW0gb25lIGF0IGEgdGltZVxyXG4gICAgICBmb3IgKGNvbnN0IGl0ZW1JZCBvZiBzZWxlY3RlZEl0ZW1zKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coaXRlbUlkKVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBEZWxldGUgZnJvbSBcIlRlc3RcIiBjb2xsZWN0aW9uXHJcbiAgICAgICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKFwiVGVzdFwiKS5kb2MoaXRlbUlkKS5kZWxldGUoKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGRlbGV0aW5nIGRvY3VtZW50ICR7aXRlbUlkfSBmcm9tIFRlc3Q6YCwgZXJyKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIC8vIERlbGV0ZSBmcm9tIFwiUGFydHNcIiBjb2xsZWN0aW9uXHJcbiAgICAgICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKFwiUGFydHNcIikuZG9jKGl0ZW1JZCkuZGVsZXRlKCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBkZWxldGluZyBkb2N1bWVudCAke2l0ZW1JZH0gZnJvbSBQYXJ0czpgLCBlcnIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgLy8gRGVsZXRlIGFzc29jaWF0ZWQgcGhvdG9zIGZyb20gc3RvcmFnZVxyXG4gICAgICAgICAgYXdhaXQgZGVsZXRlRnJvbVN0b3JhZ2UoaXRlbUlkKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGRlbGV0aW5nIHN0b3JhZ2UgZm9yICR7aXRlbUlkfTpgLCBlcnIpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICAvLyBVcGRhdGUgbG9jYWwgc3RhdGUgYnkgZmlsdGVyaW5nIG91dCB0aGUgZGVsZXRlZCBpdGVtc1xyXG4gICAgICBzZXRJbmZvKGluZm8uZmlsdGVyKChpdGVtKSA9PiAhc2VsZWN0ZWRJdGVtcy5pbmNsdWRlcyhpdGVtLmlkKSkpO1xyXG4gICAgICBzZXRTZWxlY3RlZEl0ZW1zKFtdKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBpdGVtczpcIiwgZXJyb3IpO1xyXG4gICAgfSBmaW5hbGx5IHtcclxuICAgICAgc2V0SXNEZWxldGluZyhmYWxzZSk7XHJcbiAgICAgIGhhbmRsZUNsb3NlRGVsZXRlTW9kYWwoKTtcclxuICAgICAgLy8gT3B0aW9uYWxseSwgcmVsb2FkIHRoZSBwYWdlXHJcbiAgICAgIC8vIHJvdXRlci5yZWxvYWQoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuXHJcbiAgY29uc3QgaGFuZGxlQ2xvc2UgPSAoKSA9PiBzZXRTaG93KGZhbHNlKTtcclxuICBjb25zdCBoYW5kbGVTaG93ID0gKCkgPT4gc2V0U2hvdyh0cnVlKTtcclxuXHJcbiAgY29uc3QgY2hlY2tEZWxldGUgPSAoZXZlbnQsIHBvcywgaWRzVG9EZWxldGUsIG5hbWUpID0+IHtcclxuICAgIGlmIChldmVudCkge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKFwiU2VsZWN0ZWQgSURzIHRvIGRlbGV0ZTpcIiwgaWRzVG9EZWxldGUpO1xyXG4gICAgc2V0U2VsZWN0ZWRJdGVtcyhpZHNUb0RlbGV0ZSk7XHJcbiAgICBzZXRESXRlbShuYW1lKTtcclxuICAgIHNldFNob3dEZWxldGVNb2RhbCh0cnVlKTtcclxuICB9O1xyXG5cclxuICAvLyBjb25zdCBoYW5kbGVEZWxldGUgPSBhc3luYyAoKSA9PiB7XHJcbiAgLy8gICBsZXQgaXRlbUlkID0gZ0lkZTtcclxuICAvLyAgIHRyeSB7XHJcbiAgLy8gICAgIHNldElzRGVsZXRpbmcodHJ1ZSk7XHJcbiAgLy8gICAgIGNvbnN0IGRiID0gZmlyZWJhc2UuZmlyZXN0b3JlKCk7XHJcbiAgLy8gICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oXCJUZXN0XCIpLmRvYyhpdGVtSWQpLmRlbGV0ZSgpO1xyXG4gIC8vICAgICBhd2FpdCBkZWxldGVGcm9tUGFydHNDb2xsZWN0aW9uKGl0ZW1JZCk7XHJcbiAgLy8gICAgIGF3YWl0IGRlbGV0ZUZyb21TdG9yYWdlKGl0ZW1JZCk7XHJcbiAgLy8gICAgIHNldEluZm8oaW5mby5maWx0ZXIoKF8sIGkpID0+IGdQb3MgIT09IGkpKTtcclxuICAvLyAgICAgY29uc29sZS5sb2coYERlbGV0ZWQgaXRlbTogJHtpdGVtSWR9YCk7XHJcbiAgLy8gICB9IGNhdGNoIChlcnJvcikge1xyXG4gIC8vICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgaXRlbTpcIiwgZXJyb3IpO1xyXG4gIC8vICAgfSBmaW5hbGx5IHtcclxuICAvLyAgICAgc2V0SXNEZWxldGluZyhmYWxzZSk7XHJcbiAgLy8gICB9XHJcbiAgLy8gICBoYW5kbGVDbG9zZSgpO1xyXG4gIC8vIH07XHJcblxyXG4gIGNvbnN0IGhvdmVyU3R5bGUgPSAoaW5kZXgpID0+ICh7XHJcbiAgICBiYWNrZ3JvdW5kQ29sb3I6IGhvdmVySW5kZXggPT09IGluZGV4ID8gXCIjZGRkXCIgOiBcInRyYW5zcGFyZW50XCIsXHJcbiAgICB0ZXh0QWxpZ246IFwiY2VudGVyXCIsXHJcbiAgICBjdXJzb3I6IFwiZGVmYXVsdFwiLFxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBbZHJvcGRvd24xVGV4dCwgc2V0RHJvcGRvd24xVGV4dF0gPSB1c2VTdGF0ZShcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgY29uc3QgW2Ryb3Bkb3duMlRleHQsIHNldERyb3Bkb3duMlRleHRdID0gdXNlU3RhdGUoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG5cclxuICBjb25zdCBoYW5kbGVTZWxlY3QxID0gKGV2ZW50S2V5LCBldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50S2V5ID09PSBcInVuYXNzaWduZWRcIikge1xyXG4gICAgICBzZXREcm9wZG93bjFUZXh0KFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICAgICAgc2V0U2VsZWN0ZWRPRU0obnVsbCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZXREcm9wZG93bjFUZXh0KGV2ZW50LnRhcmdldC50ZXh0Q29udGVudCk7XHJcbiAgICAgIHNldFNlbGVjdGVkT0VNKGV2ZW50LnRhcmdldC50ZXh0Q29udGVudCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlU2VsZWN0MiA9IChldmVudEtleSwgZXZlbnQpID0+IHtcclxuICAgIGlmIChldmVudEtleSA9PT0gXCJ1bmFzc2lnbmVkXCIpIHtcclxuICAgICAgc2V0RHJvcGRvd24yVGV4dChcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgICAgIHNldFNlbGVjdGVkTW9kYWxpdHkobnVsbCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZXREcm9wZG93bjJUZXh0KGV2ZW50LnRhcmdldC50ZXh0Q29udGVudCk7XHJcbiAgICAgIHNldFNlbGVjdGVkTW9kYWxpdHkoZXZlbnQudGFyZ2V0LnRleHRDb250ZW50KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyBCdWlsZCBhIHVuaXF1ZSBsaXN0IG9mIGNsaWVudHMgZnJvbSB0aGUgaXRlbXMgY3VycmVudGx5IGxvYWRlZCwgZmlsdGVyZWQgYnkgT0VNL01vZGFsaXR5LlxyXG4gIC8vIGB0eXBlYCBpcyBcImZyb21cIiBvciBcImN1cnJlbnRcIiB0byBkZWNpZGUgd2hpY2ggY2xpZW50IHJlZiB0byByZWFkLlxyXG4gIGFzeW5jIGZ1bmN0aW9uIGJ1aWxkQ2xpZW50c0Zyb21JdGVtcyh0eXBlKSB7XHJcbiAgICBjb25zdCBkYiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpO1xyXG4gICAgY29uc3QgaWRzID0gbmV3IFNldCgpO1xyXG5cclxuICAgIC8vIFJlc3BlY3QgY3VycmVudCBPRU0gLyBNb2RhbGl0eSBmaWx0ZXJzIHdoZW4gZGVyaXZpbmcgY2xpZW50IG9wdGlvbnNcclxuICAgIGNvbnN0IGZpbHRlcmVkID0gYXVnbWVudGVkSW5mby5maWx0ZXIoKGl0ZW0pID0+IHtcclxuICAgICAgY29uc3QgT0VNID0gaXRlbT8ubWFjaGluZURhdGE/Lk9FTSA/PyBpdGVtPy5PRU0gPz8gbnVsbDtcclxuICAgICAgY29uc3QgTW9kYWxpdHkgPSBpdGVtPy5tYWNoaW5lRGF0YT8uTW9kYWxpdHkgPz8gaXRlbT8uTW9kYWxpdHkgPz8gbnVsbDtcclxuICAgICAgaWYgKHNlbGVjdGVkT0VNICYmIE9FTSAhPT0gc2VsZWN0ZWRPRU0pIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKHNlbGVjdGVkTW9kYWxpdHkgJiYgTW9kYWxpdHkgIT09IHNlbGVjdGVkTW9kYWxpdHkpIHJldHVybiBmYWxzZTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IGl0IG9mIGZpbHRlcmVkKSB7XHJcbiAgICAgIGNvbnN0IGlkID0gdHlwZSA9PT0gXCJmcm9tXCIgPyBpdC5jbGllbnRGcm9tSWQgOiBpdC5jbGllbnRDdXJyZW50SWQ7XHJcbiAgICAgIGlmIChpZCkgaWRzLmFkZChpZCk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgb3V0ID0gW107XHJcbiAgICBjb25zdCBpZEFycmF5ID0gWy4uLmlkc107XHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlkQXJyYXkubGVuZ3RoOyBpICs9IDEwKSB7XHJcbiAgICAgIGNvbnN0IGNodW5rID0gaWRBcnJheS5zbGljZShpLCBpICsgMTApO1xyXG4gICAgICBjb25zdCBzbmFwID0gYXdhaXQgZGJcclxuICAgICAgICAuY29sbGVjdGlvbihcIkNsaWVudFwiKVxyXG4gICAgICAgIC53aGVyZShmaXJlYmFzZS5maXJlc3RvcmUuRmllbGRQYXRoLmRvY3VtZW50SWQoKSwgXCJpblwiLCBjaHVuaylcclxuICAgICAgICAuZ2V0KCk7XHJcbiAgICAgIHNuYXAuZm9yRWFjaCgoZG9jKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZCA9IGRvYy5kYXRhKCkgfHwge307XHJcbiAgICAgICAgb3V0LnB1c2goeyBpZDogZG9jLmlkLCBuYW1lOiBkLm5hbWUgfHwgZG9jLmlkIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBzb3J0IGJ5IG5hbWUgZm9yIG5pY2VyIFVYXHJcbiAgICBvdXQuc29ydCgoYSwgYikgPT4gKGEubmFtZSB8fCBcIlwiKS5sb2NhbGVDb21wYXJlKGIubmFtZSB8fCBcIlwiKSk7XHJcbiAgICByZXR1cm4gb3V0O1xyXG4gIH1cclxuXHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gQ0xJRU5UIFNFTEVDVElPTiBIQU5ETElOR1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gVGhpcyBmdW5jdGlvbiBmZXRjaGVzIGNsaWVudHMgYW5kIG9wZW5zIHRoZSBjbGllbnQgbW9kYWwuXHJcbiAgY29uc3QgaGFuZGxlQ2xpZW50Q2xpY2sgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBsZXQgc2FmZUNsaWVudHMgPSBbXTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGNsaWVudHNEYXRhID0gYXdhaXQgZmV0Y2hDbGllbnRzKHNlbGVjdGVkT0VNLCBzZWxlY3RlZE1vZGFsaXR5KTtcclxuICAgICAgc2FmZUNsaWVudHMgPSBBcnJheS5pc0FycmF5KGNsaWVudHNEYXRhKSA/IGNsaWVudHNEYXRhIDogW107XHJcbiAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJmZXRjaENsaWVudHMgZmFpbGVkOlwiLCBlKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBGYWxsYmFjayB0byBidWlsZGluZyBmcm9tIGxvYWRlZCBpdGVtcyBpZiBBUEkgZ2F2ZSB1cyBub3RoaW5nXHJcbiAgICBpZiAoc2FmZUNsaWVudHMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgaWYgKCFjbGllbnRTZWxlY3Rpb25UeXBlKSB7XHJcbiAgICAgICAgICAvLyBpZiBzb21laG93IG5vdCBzZXQgeWV0LCBkZWZhdWx0IHRvIFwiZnJvbVwiXHJcbiAgICAgICAgICBzZXRDbGllbnRTZWxlY3Rpb25UeXBlKFwiZnJvbVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGVyaXZlZCA9IGF3YWl0IGJ1aWxkQ2xpZW50c0Zyb21JdGVtcyhjbGllbnRTZWxlY3Rpb25UeXBlIHx8IFwiZnJvbVwiKTtcclxuICAgICAgICBzYWZlQ2xpZW50cyA9IGRlcml2ZWQ7XHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFsbGJhY2sgYnVpbGRDbGllbnRzRnJvbUl0ZW1zIGZhaWxlZDpcIiwgZSk7XHJcbiAgICAgICAgc2FmZUNsaWVudHMgPSBbXTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldENsaWVudHMoc2FmZUNsaWVudHMpO1xyXG4gICAgc2V0Q2xpZW50U2VhcmNoVGVybShcIlwiKTtcclxuICAgIHNldFNob3dDbGllbnRNb2RhbCh0cnVlKTtcclxuICB9O1xyXG5cclxuXHJcblxyXG4gIC8vIFdoZW4gYSBjbGllbnQgaXMgc2VsZWN0ZWQgaW4gdGhlIG1vZGFsLCB3ZSBub3cgYXNzdW1lIHRoZSBwYXJhbWV0ZXIgaXMgYSBjbGllbnQgSUQuXHJcbiAgLy8gSWYgdGhlIHBhc3NlZCB2YWx1ZSBpcyBudWxsLCB3ZSBjbGVhciB0aGUgc2VsZWN0aW9uLlxyXG4gIGNvbnN0IGhhbmRsZUNsaWVudFNlbGVjdCA9IGFzeW5jIChjbGllbnRJZCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coXCJVc2VyIHNlbGVjdGVkIGNsaWVudCBpZDpcIiwgY2xpZW50SWQpO1xyXG4gICAgaWYgKCFjbGllbnRJZCkge1xyXG4gICAgICBpZiAoY2xpZW50U2VsZWN0aW9uVHlwZSA9PT0gXCJmcm9tXCIpIHtcclxuICAgICAgICBzZXRDbGllbnRGcm9tQnV0dG9uVGV4dChcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgICAgICAgc2V0U2VsZWN0ZWRDbGllbnRGcm9tKG51bGwpO1xyXG4gICAgICB9IGVsc2UgaWYgKGNsaWVudFNlbGVjdGlvblR5cGUgPT09IFwiY3VycmVudFwiKSB7XHJcbiAgICAgICAgc2V0Q2xpZW50Q3VycmVudEJ1dHRvblRleHQoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gICAgICAgIHNldFNlbGVjdGVkQ2xpZW50Q3VycmVudChudWxsKTtcclxuICAgICAgfVxyXG4gICAgICBzZXRTaG93Q2xpZW50TW9kYWwoZmFsc2UpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBjbGllbnRTbmFwID0gYXdhaXQgZmlyZWJhc2UuZmlyZXN0b3JlKCkuY29sbGVjdGlvbihcIkNsaWVudFwiKS5kb2MoY2xpZW50SWQpLmdldCgpO1xyXG4gICAgICBpZiAoY2xpZW50U25hcC5leGlzdHMpIHtcclxuICAgICAgICBjb25zdCBjbGllbnREYXRhID0gY2xpZW50U25hcC5kYXRhKCk7XHJcbiAgICAgICAgaWYgKGNsaWVudFNlbGVjdGlvblR5cGUgPT09IFwiZnJvbVwiKSB7XHJcbiAgICAgICAgICBzZXRDbGllbnRGcm9tQnV0dG9uVGV4dChjbGllbnREYXRhLm5hbWUpO1xyXG4gICAgICAgICAgc2V0U2VsZWN0ZWRDbGllbnRGcm9tKGNsaWVudElkKTtcclxuICAgICAgICB9IGVsc2UgaWYgKGNsaWVudFNlbGVjdGlvblR5cGUgPT09IFwiY3VycmVudFwiKSB7XHJcbiAgICAgICAgICBzZXRDbGllbnRDdXJyZW50QnV0dG9uVGV4dChjbGllbnREYXRhLm5hbWUpO1xyXG4gICAgICAgICAgc2V0U2VsZWN0ZWRDbGllbnRDdXJyZW50KGNsaWVudElkKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIk5vIGNsaWVudCBkb2N1bWVudCBmb3VuZCBmb3IgaWQ6XCIsIGNsaWVudElkKTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGNsaWVudCBkYXRhOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgICBzZXRTaG93Q2xpZW50TW9kYWwoZmFsc2UpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZUNsaWVudEluZm8gPSAoY2xpZW50SWQsIGNsaWVudE5hbWUpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKGBDbGllbnQgSUQ6ICR7Y2xpZW50SWR9LCBDbGllbnQgTmFtZTogJHtjbGllbnROYW1lfWApO1xyXG4gICAgcm91dGVyLnB1c2goXCJjbGllbnQvXCIgKyBjbGllbnRJZCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlQ2xlYXJDbGllbnRTZWxlY3Rpb24gPSAoKSA9PiB7XHJcbiAgICBpZiAoY2xpZW50U2VsZWN0aW9uVHlwZSA9PT0gXCJmcm9tXCIpIHtcclxuICAgICAgc2V0Q2xpZW50RnJvbUJ1dHRvblRleHQoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gICAgICBzZXRTZWxlY3RlZENsaWVudEZyb20obnVsbCk7XHJcbiAgICB9IGVsc2UgaWYgKGNsaWVudFNlbGVjdGlvblR5cGUgPT09IFwiY3VycmVudFwiKSB7XHJcbiAgICAgIHNldENsaWVudEN1cnJlbnRCdXR0b25UZXh0KFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICAgICAgc2V0U2VsZWN0ZWRDbGllbnRDdXJyZW50KG51bGwpO1xyXG4gICAgfVxyXG4gICAgc2V0U2hvd0NsaWVudE1vZGFsKGZhbHNlKTtcclxuICB9O1xyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIE1PREVMIFNFTEVDVElPTiBIQU5ETElOR1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgY29uc3QgW21vZGVscywgc2V0TW9kZWxzXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCBbc2hvd01vZGVsTW9kYWwsIHNldFNob3dNb2RlbE1vZGFsXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuICBjb25zdCBbbW9kZWxCdXR0b25UZXh0LCBzZXRNb2RlbEJ1dHRvblRleHRdID0gdXNlU3RhdGUoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG5cclxuICBjb25zdCBoYW5kbGVNb2RlbENsaWNrID0gYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgbW9kZWxzRGF0YSA9IGF3YWl0IGZldGNoTW9kZWxzKFxyXG4gICAgICBzZWxlY3RlZE9FTSxcclxuICAgICAgc2VsZWN0ZWRNb2RhbGl0eSxcclxuICAgICAgc2VsZWN0ZWRDbGllbnRGcm9tXHJcbiAgICApO1xyXG4gICAgc2V0TW9kZWxzKG1vZGVsc0RhdGEpO1xyXG4gICAgc2V0TW9kZWxTZWFyY2hUZXJtKFwiXCIpO1xyXG4gICAgc2V0U2hvd01vZGVsTW9kYWwodHJ1ZSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlTW9kZWxTZWxlY3QgPSAobW9kZWxOYW1lKSA9PiB7XHJcbiAgICBzZXRNb2RlbEJ1dHRvblRleHQobW9kZWxOYW1lIHx8IFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICAgIHNldFNlbGVjdGVkTW9kZWwobW9kZWxOYW1lIHx8IG51bGwpO1xyXG4gICAgc2V0U2hvd01vZGVsTW9kYWwoZmFsc2UpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZUNsZWFyTW9kZWxTZWxlY3Rpb24gPSAoKSA9PiB7XHJcbiAgICBzZXRNb2RlbEJ1dHRvblRleHQoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gICAgc2V0U2VsZWN0ZWRNb2RlbChudWxsKTtcclxuICAgIHNldFNob3dNb2RlbE1vZGFsKGZhbHNlKTtcclxuICB9O1xyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vIFdBUkVIT1VTRSBCVVRUT05TIChmb3IgQ2xpZW50IEN1cnJlbnQpXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICBjb25zdCBoYW5kbGVTb0NhbFdhcmVob3VzZUNsaWNrID0gKCkgPT4ge1xyXG4gICAgc2V0Q2xpZW50Q3VycmVudEJ1dHRvblRleHQoXCJTb0NhbCBXYXJlaG91c2VcIik7XHJcbiAgICBzZXRTZWxlY3RlZENsaWVudEN1cnJlbnQoU09DQUxfQ0xJRU5UX0lEKTtcclxuICAgIGNvbnNvbGUubG9nKFwiV2FyZWhvdXNlIGJ1dHRvbiBjbGlja2VkOiBzZXR0aW5nIENsaWVudCBDdXJyZW50IHRvXCIsIFNPQ0FMX0NMSUVOVF9JRCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlTm9yQ2FsV2FyZWhvdXNlQ2xpY2sgPSAoKSA9PiB7XHJcbiAgICBzZXRDbGllbnRDdXJyZW50QnV0dG9uVGV4dChcIk5vckNhbCBXYXJlaG91c2VcIik7XHJcbiAgICBzZXRTZWxlY3RlZENsaWVudEN1cnJlbnQoTk9SQ0FMX0NMSUVOVF9JRCk7XHJcbiAgICBjb25zb2xlLmxvZyhcIldhcmVob3VzZSBidXR0b24gY2xpY2tlZDogc2V0dGluZyBDbGllbnQgQ3VycmVudCB0b1wiLCBOT1JDQUxfQ0xJRU5UX0lEKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVXYXJlaG91c2VVbmFzc2lnbmVkQ2xpY2sgPSAoKSA9PiB7XHJcbiAgICBzZXRDbGllbnRDdXJyZW50QnV0dG9uVGV4dChcIlVuYXNzaWduZWRcIik7XHJcbiAgICBzZXRTZWxlY3RlZENsaWVudEN1cnJlbnQoVU5BU1NJR05FRF9DTElFTlRfSUQpO1xyXG4gICAgY29uc29sZS5sb2coXCJXYXJlaG91c2UgYnV0dG9uIGNsaWNrZWQ6IHNldHRpbmcgQ2xpZW50IEN1cnJlbnQgdG9cIiwgVU5BU1NJR05FRF9DTElFTlRfSUQpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IFtjbGllbnRTZWFyY2hUZXJtLCBzZXRDbGllbnRTZWFyY2hUZXJtXSA9IHVzZVN0YXRlKFwiXCIpO1xyXG4gIGNvbnN0IFttb2RlbFNlYXJjaFRlcm0sIHNldE1vZGVsU2VhcmNoVGVybV0gPSB1c2VTdGF0ZShcIlwiKTtcclxuXHJcbiAgY29uc3QgZGVsZXRlRnJvbVN0b3JhZ2UgPSBhc3luYyAoaXRlbUlkKSA9PiB7XHJcbiAgICBjb25zdCBzdG9yYWdlUmVmID0gZmlyZWJhc2Uuc3RvcmFnZSgpLnJlZigpO1xyXG4gICAgY29uc3QgZm9sZGVyUmVmID0gc3RvcmFnZVJlZi5jaGlsZChgUGFydHMvJHtpdGVtSWR9L2ApO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgbGlzdFJlc3VsdCA9IGF3YWl0IGZvbGRlclJlZi5saXN0QWxsKCk7XHJcbiAgICAgIGNvbnN0IGRlbGV0ZVByb21pc2VzID0gbGlzdFJlc3VsdC5pdGVtcy5tYXAoKGl0ZW0pID0+IGl0ZW0uZGVsZXRlKCkpO1xyXG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChkZWxldGVQcm9taXNlcyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZGVsZXRpbmcgZnJvbSBzdG9yYWdlOlwiLCBlcnJvcik7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZGVsZXRlRnJvbVBhcnRzQ29sbGVjdGlvbiA9IGFzeW5jIChpdGVtSWQpID0+IHtcclxuICAgIGNvbnN0IGRiID0gZmlyZWJhc2UuZmlyZXN0b3JlKCk7XHJcbiAgICB0cnkge1xyXG4gICAgICBhd2FpdCBkYi5jb2xsZWN0aW9uKFwiUGFydHNcIikuZG9jKGl0ZW1JZCkuZGVsZXRlKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGBEZWxldGVkIGl0ZW0gZnJvbSBQYXJ0cyBjb2xsZWN0aW9uOiAke2l0ZW1JZH1gKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBmcm9tIFBhcnRzIGNvbGxlY3Rpb246XCIsIGVycm9yKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyAgIC8vIFNhZmVseSBjb252ZXJ0IGFueSBkYXRlLWlzaCB2YWx1ZSBpbnRvIGEgY29tcGFyYWJsZSB0aW1lc3RhbXAgKG1zIHNpbmNlIGVwb2NoKS5cclxuICAvLyBmdW5jdGlvbiB0b1RpbWUodmFsdWUpIHtcclxuICAvLyAgIGlmICghdmFsdWUpIHJldHVybiBudWxsO1xyXG5cclxuICAvLyAgIC8vIEZpcmVzdG9yZSBUaW1lc3RhbXA6IHsgc2Vjb25kcywgbmFub3NlY29uZHMgfVxyXG4gIC8vICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJvYmplY3RcIiAmJiB2YWx1ZS5zZWNvbmRzKSB7XHJcbiAgLy8gICAgIHRyeSB7XHJcbiAgLy8gICAgICAgcmV0dXJuIHZhbHVlLnNlY29uZHMgKiAxMDAwO1xyXG4gIC8vICAgICB9IGNhdGNoIHsgLyogZmFsbHRocm91Z2ggKi8gfVxyXG4gIC8vICAgfVxyXG5cclxuICAvLyAgIC8vIElmIGFscmVhZHkgYSBEYXRlXHJcbiAgLy8gICBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSByZXR1cm4gaXNOYU4odmFsdWUuZ2V0VGltZSgpKSA/IG51bGwgOiB2YWx1ZS5nZXRUaW1lKCk7XHJcblxyXG4gIC8vICAgLy8gSWYgc3RyaW5nOiB0cnkgSVNPIGZpcnN0XHJcbiAgLy8gICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XHJcbiAgLy8gICAgIC8vIHl5eXktbW0tZGQgKGZyb20geW91ciBmb3JtIGlucHV0cylcclxuICAvLyAgICAgY29uc3QgaXNvID0gRGF0ZS5wYXJzZSh2YWx1ZSk7XHJcbiAgLy8gICAgIGlmICghaXNOYU4oaXNvKSkgcmV0dXJuIGlzbztcclxuXHJcbiAgLy8gICAgIC8vIG1tL2RkL3l5eXkgZmFsbGJhY2sgKG9sZGVyIGl0ZW1zKVxyXG4gIC8vICAgICBjb25zdCBwYXJ0cyA9IHZhbHVlLnNwbGl0KFwiL1wiKTtcclxuICAvLyAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMykge1xyXG4gIC8vICAgICAgIGNvbnN0IFttbSwgZGQsIHl5eXldID0gcGFydHM7XHJcbiAgLy8gICAgICAgY29uc3QgYWx0ID0gRGF0ZS5wYXJzZShgJHt5eXl5fS0ke21tfS0ke2RkfWApO1xyXG4gIC8vICAgICAgIGlmICghaXNOYU4oYWx0KSkgcmV0dXJuIGFsdDtcclxuICAvLyAgICAgfVxyXG4gIC8vICAgfVxyXG5cclxuICAvLyAgIC8vIENhbm9uaWNhbGl6ZSBhbnkgZGF0ZS1pc2ggdmFsdWUgdG8gJ3l5eXktbW0tZGQnIHNvIGl0IG1hdGNoZXMgPGlucHV0IHR5cGU9XCJkYXRlXCI+IHZhbHVlc1xyXG4gIC8vICAgZnVuY3Rpb24gdG9ZTUQodmFsdWUpIHtcclxuICAvLyAgICAgY29uc3QgdCA9IHRvVGltZSh2YWx1ZSk7XHJcbiAgLy8gICAgIGlmICh0ID09IG51bGwpIHJldHVybiBudWxsO1xyXG4gIC8vICAgICBjb25zdCBkID0gbmV3IERhdGUodCk7XHJcbiAgLy8gICAgIGNvbnN0IHl5eXkgPSBkLmdldEZ1bGxZZWFyKCk7XHJcbiAgLy8gICAgIGNvbnN0IG1tID0gU3RyaW5nKGQuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcclxuICAvLyAgICAgY29uc3QgZGQgPSBTdHJpbmcoZC5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcclxuICAvLyAgICAgcmV0dXJuIGAke3l5eXl9LSR7bW19LSR7ZGR9YDtcclxuICAvLyAgIH1cclxuXHJcblxyXG4gIC8vICAgLy8gTGFzdCByZXNvcnRcbiAgLy8gICBjb25zdCB0ID0gRGF0ZS5wYXJzZSh2YWx1ZSk7XG4gIC8vICAgcmV0dXJuIGlzTmFOKHQpID8gbnVsbCA6IHQ7XG4gIC8vIH1cblxuICBjb25zdCB0b3RhbEtub3duUGFnZXMgPSBNYXRoLm1heChcbiAgICAxLFxuICAgIHBhZ2VDdXJzb3JzLmZpbHRlcihCb29sZWFuKS5sZW5ndGggKyAoaGFzTmV4dFBhZ2UgPyAxIDogMClcbiAgKTtcbiAgY29uc3QgcGFnZUJ1dHRvbnMgPSBbXTtcbiAgZm9yIChsZXQgaSA9IDE7IGkgPD0gdG90YWxLbm93blBhZ2VzOyBpKyspIHtcbiAgICBwYWdlQnV0dG9ucy5wdXNoKFxuICAgICAgPFBhZ2luYXRpb24uSXRlbVxuICAgICAgICBrZXk9e2l9XG4gICAgICAgIGFjdGl2ZT17aSA9PT0gcGFnZX1cbiAgICAgICAgb25DbGljaz17KCkgPT4gc2V0UGFnZShpKX1cbiAgICAgID5cbiAgICAgICAge2l9XG4gICAgICA8L1BhZ2luYXRpb24uSXRlbT5cbiAgICApO1xuICB9XG5cblxuICByZXR1cm4gKFxuICAgIDxMb2dnZWRJbj5cbiAgICAgIHtpc0RlbGV0aW5nICYmIChcclxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImxvYWRpbmctb3ZlcmxheVwiPlxyXG4gICAgICAgICAgPFNwaW5uZXIgYW5pbWF0aW9uPVwiYm9yZGVyXCIgcm9sZT1cInN0YXR1c1wiIGNsYXNzTmFtZT1cInNwaW5uZXItY2VudGVyXCI+XHJcbiAgICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cInNyLW9ubHlcIj5Mb2FkaW5nLi4uPC9zcGFuPlxyXG4gICAgICAgICAgPC9TcGlubmVyPlxyXG4gICAgICAgIDwvZGl2PlxyXG4gICAgICApfVxyXG4gICAgICA8TW9kYWwgc2hvdz17c2hvd0RlbGV0ZU1vZGFsfSBvbkhpZGU9e2hhbmRsZUNsb3NlRGVsZXRlTW9kYWx9PlxyXG4gICAgICAgIDxNb2RhbC5IZWFkZXIgY2xvc2VCdXR0b24+XHJcbiAgICAgICAgICA8TW9kYWwuVGl0bGU+Q29uZmlybSBEZWxldGlvbjwvTW9kYWwuVGl0bGU+XHJcbiAgICAgICAgPC9Nb2RhbC5IZWFkZXI+XHJcbiAgICAgICAgPE1vZGFsLkJvZHk+XHJcbiAgICAgICAgICBBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHtzZWxlY3RlZEl0ZW1zLmxlbmd0aH0gaXRlbVxyXG4gICAgICAgICAge3NlbGVjdGVkSXRlbXMubGVuZ3RoID4gMSA/IFwic1wiIDogXCJcIn0/XHJcbiAgICAgICAgPC9Nb2RhbC5Cb2R5PlxyXG4gICAgICAgIDxNb2RhbC5Gb290ZXI+XHJcbiAgICAgICAgICA8QnV0dG9uIHZhcmlhbnQ9XCJkYW5nZXJcIiBvbkNsaWNrPXtoYW5kbGVEZWxldGVTZWxlY3RlZH0+XHJcbiAgICAgICAgICAgIFllcywgZGVsZXRlXHJcbiAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgIDxCdXR0b24gdmFyaWFudD1cInNlY29uZGFyeVwiIG9uQ2xpY2s9e2hhbmRsZUNsb3NlRGVsZXRlTW9kYWx9PlxyXG4gICAgICAgICAgICBDYW5jZWxcclxuICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgIDwvTW9kYWwuRm9vdGVyPlxyXG4gICAgICA8L01vZGFsPlxyXG5cclxuICAgICAgPE1vZGFsIHNob3c9e3Nob3dDbGllbnRNb2RhbH0gb25IaWRlPXsoKSA9PiBzZXRTaG93Q2xpZW50TW9kYWwoZmFsc2UpfT5cclxuICAgICAgICA8TW9kYWwuSGVhZGVyIGNsb3NlQnV0dG9uPlxyXG4gICAgICAgICAgPE1vZGFsLlRpdGxlPlxyXG4gICAgICAgICAgICBTZWxlY3Qge2NsaWVudFNlbGVjdGlvblR5cGUgPT09IFwiZnJvbVwiID8gXCJDbGllbnQgRnJvbVwiIDogXCJDbGllbnQgQ3VycmVudFwifVxyXG4gICAgICAgICAgPC9Nb2RhbC5UaXRsZT5cclxuICAgICAgICA8L01vZGFsLkhlYWRlcj5cclxuICAgICAgICA8TW9kYWwuQm9keT5cclxuICAgICAgICAgIDxGb3JtQ29udHJvbFxyXG4gICAgICAgICAgICB0eXBlPVwidGV4dFwiXHJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiU2VhcmNoIGJ5IG5hbWVcIlxyXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJtYi0zXCJcclxuICAgICAgICAgICAgdmFsdWU9e2NsaWVudFNlYXJjaFRlcm19XHJcbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0Q2xpZW50U2VhcmNoVGVybShlLnRhcmdldC52YWx1ZSl9XHJcbiAgICAgICAgICAvPlxyXG4gICAgICAgICAgPENsaWVudFRhYmxlXHJcbiAgICAgICAgICAgIGNsaWVudHM9eyhBcnJheS5pc0FycmF5KGNsaWVudHMpID8gY2xpZW50cyA6IFtdKS5maWx0ZXIoXHJcbiAgICAgICAgICAgICAgKGNsaWVudCkgPT4gKGNsaWVudD8ubmFtZSA/PyBcIlwiKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGNsaWVudFNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgb25TZWxlY3RDbGllbnQ9e2hhbmRsZUNsaWVudFNlbGVjdH1cclxuICAgICAgICAgICAgb25JbmZvQ2xpY2s9e2hhbmRsZUNsaWVudEluZm99XHJcbiAgICAgICAgICAgIGlzQ2xpZW50U2VhcmNoPXtmYWxzZX1cclxuICAgICAgICAgICAgY2xlYXJTZWxlY3Rpb249eygpID0+IGhhbmRsZUNsaWVudFNlbGVjdChudWxsKX1cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgPC9Nb2RhbC5Cb2R5PlxyXG4gICAgICA8L01vZGFsPlxyXG5cclxuICAgICAgPE1vZGFsIHNob3c9e3Nob3dNb2RlbE1vZGFsfSBvbkhpZGU9eygpID0+IHNldFNob3dNb2RlbE1vZGFsKGZhbHNlKX0+XHJcbiAgICAgICAgPE1vZGFsLkhlYWRlciBjbG9zZUJ1dHRvbj5cclxuICAgICAgICAgIDxNb2RhbC5UaXRsZT5TZWxlY3QgTW9kZWw8L01vZGFsLlRpdGxlPlxyXG4gICAgICAgIDwvTW9kYWwuSGVhZGVyPlxyXG4gICAgICAgIDxNb2RhbC5Cb2R5PlxyXG4gICAgICAgICAgPEZvcm1Db250cm9sXHJcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJTZWFyY2ggYnkgbmFtZVwiXHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cIm1iLTNcIlxyXG4gICAgICAgICAgICB2YWx1ZT17bW9kZWxTZWFyY2hUZXJtfVxyXG4gICAgICAgICAgICBvbkNoYW5nZT17KGUpID0+IHNldE1vZGVsU2VhcmNoVGVybShlLnRhcmdldC52YWx1ZSl9XHJcbiAgICAgICAgICAvPlxyXG4gICAgICAgICAgPE1vZGVsVGFibGVcclxuICAgICAgICAgICAgbW9kZWxzPXttb2RlbHMuZmlsdGVyKChtb2RlbCkgPT5cclxuICAgICAgICAgICAgICB0eXBlb2YgbW9kZWwgPT09IFwic3RyaW5nXCJcclxuICAgICAgICAgICAgICAgID8gbW9kZWwudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhtb2RlbFNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSlcclxuICAgICAgICAgICAgICAgIDogZmFsc2VcclxuICAgICAgICAgICAgKX1cclxuICAgICAgICAgICAgb25TZWxlY3RNb2RlbD17aGFuZGxlTW9kZWxTZWxlY3R9XHJcbiAgICAgICAgICAgIGNsZWFyU2VsZWN0aW9uPXsoKSA9PiBoYW5kbGVNb2RlbFNlbGVjdChudWxsKX1cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgPC9Nb2RhbC5Cb2R5PlxyXG4gICAgICA8L01vZGFsPlxyXG5cclxuICAgICAgPENvbnRhaW5lclxyXG4gICAgICAgIGNsYXNzTmFtZT1cImQtZmxleCBhbGlnbi1pdGVtcy1jZW50ZXIganVzdGlmeS1jb250ZW50LWNlbnRlclwiXHJcbiAgICAgICAgc3R5bGU9e3sgbWluSGVpZ2h0OiBcIjEwMHZoXCIgfX1cclxuICAgICAgPlxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwidy0xMDBcIiBzdHlsZT17eyBtYXhXaWR0aDogXCIxMjAwcHhcIiB9fT5cclxuICAgICAgICAgIDxDYXJkPlxyXG4gICAgICAgICAgICA8Q2FyZC5Cb2R5PlxyXG4gICAgICAgICAgICAgIDxoMiBjbGFzc05hbWU9XCJ0ZXh0LWNlbnRlciBtYi00XCI+TWFnbW88L2gyPlxyXG4gICAgICAgICAgICAgIDxSb3c+XHJcbiAgICAgICAgICAgICAgICA8Q29sIG1kPXs0fT5cclxuICAgICAgICAgICAgICAgICAgey8qIERyb3Bkb3ducyAqL31cclxuICAgICAgICAgICAgICAgICAgPGRpdj5cclxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cCBjbGFzc05hbWU9XCJtYi0zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cC5UZXh0Pk9FTTwvSW5wdXRHcm91cC5UZXh0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duIG9uU2VsZWN0PXtoYW5kbGVTZWxlY3QxfT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLlRvZ2dsZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lLXNlY29uZGFyeVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9XCJkcm9wZG93bi1idXR0b24tMVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0xMDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAge2Ryb3Bkb3duMVRleHR9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24uVG9nZ2xlPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uTWVudSBjbGFzc05hbWU9XCJ3LTEwMFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5JdGVtIGV2ZW50S2V5PVwidW5hc3NpZ25lZFwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2VsZWN0IE9wdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uSXRlbSBldmVudEtleT1cIkdFXCI+R0U8L0Ryb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLkl0ZW0gZXZlbnRLZXk9XCJUb3NoaWJhXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBUb3NoaWJhXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5JdGVtIGV2ZW50S2V5PVwiU2llbWVuc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgU2llbWVuc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uSXRlbSBldmVudEtleT1cIlBoaWxpcHNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFBoaWxpcHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24uTWVudT5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9JbnB1dEdyb3VwPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cCBjbGFzc05hbWU9XCJtYi01XCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cC5UZXh0Pk1vZGFsaXR5PC9JbnB1dEdyb3VwLlRleHQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24gb25TZWxlY3Q9e2hhbmRsZVNlbGVjdDJ9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uVG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmUtc2Vjb25kYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cImRyb3Bkb3duLWJ1dHRvbi0yXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEwMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB7ZHJvcGRvd24yVGV4dH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5Ub2dnbGU+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5NZW51IGNsYXNzTmFtZT1cInctMTAwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLkl0ZW0gZXZlbnRLZXk9XCJ1bmFzc2lnbmVkXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZWxlY3QgT3B0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5JdGVtIGV2ZW50S2V5PVwiQ1RcIj5DVDwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uSXRlbSBldmVudEtleT1cIk1SSVwiPk1SSTwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5NZW51PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bj5cclxuICAgICAgICAgICAgICAgICAgICA8L0lucHV0R3JvdXA+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e3N0eWxlcy5kaXZpZGVyfT48L2Rpdj5cclxuXHJcbiAgICAgICAgICAgICAgICAgIHsvKiBDbGllbnQgc2VsZWN0aW9uIGJveGVzICovfVxyXG4gICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxJbnB1dEdyb3VwIGNsYXNzTmFtZT1cIm1iLTNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxJbnB1dEdyb3VwLlRleHQ+Q2xpZW50IEZyb208L0lucHV0R3JvdXAuVGV4dD5cclxuICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmUtc2Vjb25kYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwidy0xMDBcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVDbGllbnRDbGljayhcImZyb21cIil9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7Y2xpZW50RnJvbUJ1dHRvblRleHR9XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICA8L0lucHV0R3JvdXA+XHJcbiAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAgY2xhc3NOYW1lPVwibWItM1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAuVGV4dD5DbGllbnQgQ3VycmVudDwvSW5wdXRHcm91cC5UZXh0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEwMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUNsaWVudENsaWNrKFwiY3VycmVudFwiKX1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtjbGllbnRDdXJyZW50QnV0dG9uVGV4dH1cclxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvSW5wdXRHcm91cD5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAgY2xhc3NOYW1lPVwibWItM1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAuVGV4dD5Nb2RlbDwvSW5wdXRHcm91cC5UZXh0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEwMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZU1vZGVsQ2xpY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHttb2RlbEJ1dHRvblRleHR9XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICA8L0lucHV0R3JvdXA+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZXMuZGl2aWRlcn0+PC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHsvKiBXYXJlaG91c2UgYnV0dG9ucyBmb3IgQ2xpZW50IEN1cnJlbnQgKi99XHJcbiAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAgY2xhc3NOYW1lPVwibWItM1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAuVGV4dD5XYXJlaG91c2U8L0lucHV0R3JvdXAuVGV4dD5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZXMuYnV0dG9uR3JvdXB9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmUtc2Vjb25kYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3N0eWxlcy5mbGV4QnV0dG9ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVNvQ2FsV2FyZWhvdXNlQ2xpY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBTb0NhbCBXYXJlaG91c2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17c3R5bGVzLmZsZXhCdXR0b259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlTm9yQ2FsV2FyZWhvdXNlQ2xpY2t9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBOb3JDYWwgV2FyZWhvdXNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmUtc2Vjb25kYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9e3N0eWxlcy5mbGV4QnV0dG9ufVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVdhcmVob3VzZVVuYXNzaWduZWRDbGlja31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFVuYXNzaWduZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L0lucHV0R3JvdXA+XHJcbiAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgPC9Db2w+XHJcblxyXG4gICAgICAgICAgICAgICAgPENvbCBtZD17OH0+XHJcbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZXMudGFibGVDb250YWluZXJ9PlxyXG4gICAgICAgICAgICAgICAgICAgIHtpc0xvYWRpbmcgPyAoXHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyIGFsaWduLWl0ZW1zLWNlbnRlciBwLTVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPGltZ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNyYz1cIi9tYWdtby1sb2dvLnBuZ1wiIC8vIG1ha2Ugc3VyZSBpdCdzIGluIC9wdWJsaWNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBhbHQ9XCJMb2FkaW5nIE1hZ21vXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17e1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDY0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA2NCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hdGlvbjogXCJtYWdtby1zcGluIDFzIGxpbmVhciBpbmZpbml0ZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJhbnNmb3JtT3JpZ2luOiBcIjUwJSA1MCVcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXk6IFwiYmxvY2tcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgey8qIGdsb2JhbCBzbyBzdHlsZWQtanN4IGRvZXNuJ3QgaGFzaCB0aGUgbmFtZSAqL31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPHN0eWxlIGpzeCBnbG9iYWw+e2BcclxuICAgICAgQGtleWZyYW1lcyBtYWdtby1zcGluIHtcclxuICAgICAgICBmcm9tIHtcclxuICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDBkZWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0byB7XHJcbiAgICAgICAgICB0cmFuc2Zvcm06IHJvdGF0ZSgzNjBkZWcpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgYH08L3N0eWxlPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgKSA6IChcclxuICAgICAgICAgICAgICAgICAgICAgIDxQYXJ0VGFibGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5mbz17aW5mb31cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzPXtsYWJlbHN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkcz17aWRzfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBob3ZlclN0eWxlPXtob3ZlclN0eWxlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzb3J0Q2hlY2tBbGw9e3NvcnRDaGVja0FsbH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2tEZWxldGU9e2NoZWNrRGVsZXRlfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpc0RlbGV0aW5nPXtpc0RlbGV0aW5nfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByb3dTZWxlY3Q9e3Jvd1NlbGVjdH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0SG92ZXJJbmRleD17c2V0SG92ZXJJbmRleH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaG92ZXJJbmRleD17aG92ZXJJbmRleH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRJdGVtcz17c2VsZWN0ZWRJdGVtc31cclxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0U2VsZWN0ZWRJdGVtcz17c2V0U2VsZWN0ZWRJdGVtc31cclxuICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgKX1cblxuXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZXMuc2VhcmNoQ29udGFpbmVyfT5cbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17c3R5bGVzLnBhZ2luYXRpb25Sb3d9PlxuICAgICAgICAgICAgICAgICAgICAgICAgPFBhZ2luYXRpb24gc2l6ZT1cInNtXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxQYWdpbmF0aW9uLlByZXZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRQYWdlKChwKSA9PiBNYXRoLm1heCgxLCBwIC0gMSkpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXtwYWdlIDw9IDF9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtwYWdlQnV0dG9uc31cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPFBhZ2luYXRpb24uTmV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldFBhZ2UoKHApID0+IHAgKyAxKX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNhYmxlZD17IWhhc05leHRQYWdlfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgPC9QYWdpbmF0aW9uPlxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgICAgIDxGb3JtIGNsYXNzTmFtZT1cImQtZmxleCBwYi0yXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8Rm9ybUNvbnRyb2xcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZT17c2hvd0xpc3RTZWFyY2h9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyPVwiU2VhcmNoXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibWUtMiBmbGV4LWdyb3ctMVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgYXJpYS1sYWJlbD1cIlNlYXJjaFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU9e3NlYXJjaH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZT17c2VhcmNoQ2hhbmdlSGFuZGxlcn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBmbGV4OiBcIjFcIiB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8TmF2RHJvcGRvd25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZT17c2VsZWN0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwiY29sbGFzaWJsZS1uYXYtZHJvcGRvd25cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHNob3c9e3Nob3dMaXN0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uTW91c2VFbnRlcj17KCkgPT4gc2V0U2hvd0xpc3QodHJ1ZSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25Nb3VzZUxlYXZlPXsoKSA9PiBzZXRTaG93TGlzdChmYWxzZSl9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGU9e3sgbWFyZ2luVG9wOiBcIi01cHhcIiB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPE5hdkRyb3Bkb3duLkl0ZW0gb25DbGljaz17KCkgPT4geyBzZXRTZWxlY3QoXCJOYW1lXCIpOyBzZXRTaG93TGlzdFNlYXJjaChcInRleHRcIik7IH19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTmFtZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8TmF2RHJvcGRvd24uSXRlbSBvbkNsaWNrPXsoKSA9PiB7IHNldFNlbGVjdChcIkRhdGVcIik7IHNldFNob3dMaXN0U2VhcmNoKFwiZGF0ZVwiKTsgfX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9OYXZEcm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxOYXZEcm9wZG93bi5JdGVtIG9uQ2xpY2s9eygpID0+IHsgc2V0U2VsZWN0KFwiV29yayBPcmRlclwiKTsgc2V0U2hvd0xpc3RTZWFyY2goXCJudW1iZXJcIik7IH19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgV29yayBPcmRlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8TmF2RHJvcGRvd24uSXRlbSBvbkNsaWNrPXsoKSA9PiB7IHNldFNlbGVjdChcIlByb2R1Y3QgTnVtYmVyXCIpOyBzZXRTaG93TGlzdFNlYXJjaChcIm51bWJlclwiKTsgfX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQcm9kdWN0IE51bWJlclxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8TmF2RHJvcGRvd24uSXRlbSBvbkNsaWNrPXsoKSA9PiB7IHNldFNlbGVjdChcIkRlc2NyaXB0aW9uXCIpOyBzZXRTaG93TGlzdFNlYXJjaChcInRleHRcIik7IH19PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVzY3JpcHRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L05hdkRyb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPE5hdkRyb3Bkb3duLkl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0U2VsZWN0KFwiU0tVXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRTaG93TGlzdFNlYXJjaChcInRleHRcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNLVVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9OYXZEcm9wZG93bj5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvRm9ybT5cclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZC1mbGV4IGp1c3RpZnktY29udGVudC1iZXR3ZWVuXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxMb2FkaW5nQnV0dG9uIHR5cGU9XCJzZWNvbmRhcnlcIiBuYW1lPVwiQWRkIE5ldyBJdGVtXCIgcm91dGU9XCJOZXdTZWFyY2gvQWRkSXRlbS9OZXdJdGVtXCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPExvYWRpbmdCdXR0b24gdHlwZT1cInByaW1hcnlcIiBuYW1lPVwiQmFja1wiIHJvdXRlPVwiV2FyZWhvdXNlZGIvV2FyZWhvdXNlU2VsZWN0XCIgLz5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgIDwvQ29sPlxyXG4gICAgICAgICAgICAgIDwvUm93PlxyXG4gICAgICAgICAgICA8L0NhcmQuQm9keT5cclxuICAgICAgICAgIDwvQ2FyZD5cclxuICAgICAgICA8L2Rpdj5cclxuICAgICAgPC9Db250YWluZXI+XHJcbiAgICA8L0xvZ2dlZEluPlxyXG4gICk7XHJcblxyXG5cclxufVxyXG5cclxuIl19 */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\mack2\\\\\\\\Desktop\\\\\\\\code\\\\\\\\pages\\\\\\\\NewSearch\\\\\\\\mainSearch.js */\")) : __jsx(PartTable, {\n    info: info,\n    labels: labels,\n    ids: ids,\n    hoverStyle: hoverStyle,\n    sortCheckAll: sortCheckAll,\n    checkDelete: checkDelete,\n    isDeleting: isDeleting,\n    rowSelect: rowSelect,\n    setHoverIndex: setHoverIndex,\n    hoverIndex: hoverIndex,\n    selectedItems: selectedItems,\n    setSelectedItems: setSelectedItems,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1150,\n      columnNumber: 23\n    }\n  }), __jsx(\"div\", {\n    className: styles.searchContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1167,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: styles.paginationRow,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1168,\n      columnNumber: 23\n    }\n  }, __jsx(Pagination, {\n    size: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1169,\n      columnNumber: 25\n    }\n  }, __jsx(Pagination.Prev, {\n    onClick: function onClick() {\n      return setPage(function (p) {\n        return Math.max(1, p - 1);\n      });\n    },\n    disabled: page <= 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1170,\n      columnNumber: 27\n    }\n  }), pageButtons, __jsx(Pagination.Next, {\n    onClick: function onClick() {\n      return setPage(function (p) {\n        return p + 1;\n      });\n    },\n    disabled: !hasNextPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1175,\n      columnNumber: 27\n    }\n  }))), __jsx(Form, {\n    className: \"d-flex pb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1181,\n      columnNumber: 23\n    }\n  }, __jsx(FormControl, {\n    type: showListSearch,\n    placeholder: \"Search\",\n    className: \"me-2 flex-grow-1\",\n    \"aria-label\": \"Search\",\n    value: search,\n    onChange: searchChangeHandler,\n    style: {\n      flex: \"1\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1182,\n      columnNumber: 25\n    }\n  }), __jsx(NavDropdown, {\n    title: select,\n    id: \"collasible-nav-dropdown\",\n    show: showList,\n    onMouseEnter: function onMouseEnter() {\n      return setShowList(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setShowList(false);\n    },\n    style: {\n      marginTop: \"-5px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1191,\n      columnNumber: 25\n    }\n  }, __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Name\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1199,\n      columnNumber: 27\n    }\n  }, \"Name\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Date\");\n      setShowListSearch(\"date\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1202,\n      columnNumber: 27\n    }\n  }, \"Date\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Work Order\");\n      setShowListSearch(\"number\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1205,\n      columnNumber: 27\n    }\n  }, \"Work Order\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Product Number\");\n      setShowListSearch(\"number\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1208,\n      columnNumber: 27\n    }\n  }, \"Product Number\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Description\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1211,\n      columnNumber: 27\n    }\n  }, \"Description\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"SKU\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1214,\n      columnNumber: 27\n    }\n  }, \"SKU\"))), __jsx(\"div\", {\n    className: \"d-flex justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1224,\n      columnNumber: 23\n    }\n  }, __jsx(LoadingButton, {\n    type: \"secondary\",\n    name: \"Add New Item\",\n    route: \"NewSearch/AddItem/NewItem\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1225,\n      columnNumber: 25\n    }\n  }), __jsx(LoadingButton, {\n    type: \"primary\",\n    name: \"Back\",\n    route: \"Warehousedb/WarehouseSelect\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1226,\n      columnNumber: 25\n    }\n  })))))))))));\n}\n\n_s2(MainSearch, \"CFrMkZAuN5BB61NEInuipygyQnU=\", false, function () {\n  return [useAuth, useRouter];\n});\n\n_c2 = MainSearch;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"LoadingButton\");\n$RefreshReg$(_c2, \"MainSearch\");","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/NewSearch/mainSearch.js"],"names":["React","useEffect","useState","useRef","useCallback","Container","Card","Row","Col","InputGroup","Dropdown","FormControl","Button","NavDropdown","Form","Modal","Spinner","Pagination","Link","useRouter","fetchPartsWithMachineDataPage","fetchClients","fetchModels","formatDate","useAuth","LoggedIn","ClientTable","ModelTable","PartTable","styles","firebase","SOCAL_CLIENT_ID","NORCAL_CLIENT_ID","UNASSIGNED_CLIENT_ID","PAGE_SIZE","simulateNetworkRequest","Promise","resolve","setTimeout","LoadingButton","type","name","route","isLoading","setLoading","cancelled","then","toTime","value","seconds","Date","t","getTime","isNaN","iso","parse","parts","split","length","mm","dd","yyyy","alt","toYMD","d","getFullYear","String","getMonth","padStart","getDate","MainSearch","signOut","info","setInfo","backupInfo","setBackupInfo","augmentedInfo","setAugmentedInfo","setIsLoading","ids","setID","show","setShow","dItem","setDItem","select","setSelect","showList","setShowList","showListSearch","setShowListSearch","search","setSearch","selectedOEM","setSelectedOEM","selectedModality","setSelectedModality","selectedClientFrom","setSelectedClientFrom","clientFromButtonText","setClientFromButtonText","selectedClientCurrent","setSelectedClientCurrent","clientCurrentButtonText","setClientCurrentButtonText","clients","setClients","showClientModal","setShowClientModal","clientSelectionType","setClientSelectionType","router","labelBase","labelBaseNames","sortCheckBase","withSortIcon","baseLabels","activeIndex","isDesc","map","text","i","arrow","labels","setLabels","sortCheck","setSortCheck","hoverIndex","setHoverIndex","selectedModel","setSelectedModel","gPos","setGPos","gIde","setGIde","isDeleting","setIsDeleting","page","setPage","pageCursors","setPageCursors","hasNextPage","setHasNextPage","fetchSeq","searchLower","toLowerCase","trim","hasActiveFilters","Boolean","valueMatches","s","Array","isArray","some","v","includes","matchesFilters","item","visible","OEM","machineData","oem","theMachineData","TheMachine","Modality","modality","Model","model","clientFromId","clientCurrentId","wantedDay","itemYMD","date","descriptions","workOrders","w","wo","workOrder","pn","sn","desc","description","id","resetPagination","asPath","fetchData","requestedPage","seq","current","query","inputText","selectedType","startAfterDoc","load","attempt","pageSize","visibleOnly","r","Math","pow","data","lastDoc","nextPage","prev","next","setSelectedItems","db","firestore","machineIds","curMachineIds","theMachineIds","Machine","push","CurrentMachine","uniq","arr","Set","mIds","cIds","fetchMachineClients","out","chunks","slice","chunk","collection","where","FieldPath","documentId","get","snap","forEach","doc","md","client","fetchMachinesData","all","fromMap","curMap","theMap","augmented","ClientFrom","ClientCurrent","filter","it","console","error","searchChangeHandler","event","target","base","sortCheckAll","pos","nextSortCheck","sortedInfo","sort","a","b","key","ta","tb","av","toString","bv","localeCompare","an","Number","bn","rowSelect","log","selectedItems","showDeleteModal","setShowDeleteModal","handleSelectItem","x","handleShowDeleteModal","handleCloseDeleteModal","handleDeleteSelected","itemId","deleteFromStorage","handleClose","handleShow","checkDelete","idsToDelete","preventDefault","stopPropagation","hoverStyle","index","backgroundColor","textAlign","cursor","dropdown1Text","setDropdown1Text","dropdown2Text","setDropdown2Text","handleSelect1","eventKey","textContent","handleSelect2","buildClientsFromItems","filtered","add","idArray","handleClientClick","safeClients","clientsData","derived","setClientSearchTerm","handleClientSelect","clientId","clientSnap","exists","clientData","handleClientInfo","clientName","handleClearClientSelection","models","setModels","showModelModal","setShowModelModal","modelButtonText","setModelButtonText","handleModelClick","modelsData","setModelSearchTerm","handleModelSelect","modelName","handleClearModelSelection","handleSoCalWarehouseClick","handleNorCalWarehouseClick","handleWarehouseUnassignedClick","clientSearchTerm","modelSearchTerm","storageRef","storage","ref","folderRef","child","listAll","listResult","deletePromises","items","deleteFromPartsCollection","totalKnownPages","max","pageButtons","e","minHeight","maxWidth","divider","buttonGroup","flexButton","tableContainer","width","height","animation","transformOrigin","display","searchContainer","paginationRow","p","flex","marginTop"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from \"react\";\nimport {\r\n  Container,\n  Card,\n  Row,\n  Col,\n  InputGroup,\n  Dropdown,\n  FormControl,\n  Button,\n  NavDropdown,\n  Form,\n  Modal,\n  Spinner,\n  Pagination,\n} from \"react-bootstrap\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport {\n  fetchPartsWithMachineDataPage,\n  fetchClients,\n  fetchModels,\n  formatDate,\n} from \"../../utils/fetchAssociations\";\nimport { useAuth } from \"../../context/AuthUserContext\";\r\nimport LoggedIn from \"../LoggedIn\";\r\nimport ClientTable from \"../../utils/ClientTable\";\r\nimport ModelTable from \"../../utils/ModelTable\";\r\nimport PartTable from \"../../utils/PartTable\";\r\nimport styles from \"../../styles/MainSearch.module.css\";\r\nimport firebase from \"../../context/Firebase\";\r\n\r\n// Predefined warehouse client IDs and display names\r\nconst SOCAL_CLIENT_ID = \"AIS17182\";\r\nconst NORCAL_CLIENT_ID = \"AIS25097\";\nconst UNASSIGNED_CLIENT_ID = \"AIS00404\";\nconst PAGE_SIZE = 25;\n\r\n\r\n// Simulates a network request delay\r\nfunction simulateNetworkRequest() {\r\n  return new Promise((resolve) => setTimeout(resolve, 2000));\r\n}\r\n\r\n// Custom LoadingButton component\r\nfunction LoadingButton({ type, name, route }) {\n  const [isLoading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (isLoading) {\n      let cancelled = false;\n      simulateNetworkRequest().then(() => {\n        if (!cancelled) setLoading(false);\n      });\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [isLoading]);\n\r\n  return (\r\n    <Link href={`/${route}`}>\r\n      <a\r\n        className={`btn btn-${type}`}\r\n        disabled={isLoading}\r\n        onClick={() => !isLoading && setLoading(true)}\r\n      >\r\n        {isLoading ? \"Loading…\" : name}\r\n      </a>\r\n    </Link>\r\n  );\r\n}\r\n\r\n// ---- DATE HELPERS (top-level scope) ----\r\n\r\n// Convert anything date-ish into a timestamp (ms since epoch).\r\nfunction toTime(value) {\r\n  if (!value) return null;\r\n\r\n  // Firestore Timestamp { seconds, nanoseconds }\r\n  if (typeof value === \"object\" && value !== null && value.seconds != null) {\r\n    try { return value.seconds * 1000; } catch { /* ignore */ }\r\n  }\r\n\r\n  // Native Date\r\n  if (value instanceof Date) {\r\n    const t = value.getTime();\r\n    return isNaN(t) ? null : t;\r\n  }\r\n\r\n  // Strings\r\n  if (typeof value === \"string\") {\r\n    // ISO / yyyy-mm-dd\r\n    const iso = Date.parse(value);\r\n    if (!isNaN(iso)) return iso;\r\n\r\n    // mm/dd/yyyy\r\n    const parts = value.split(\"/\");\r\n    if (parts.length === 3) {\r\n      const [mm, dd, yyyy] = parts;\r\n      const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\r\n      if (!isNaN(alt)) return alt;\r\n    }\r\n  }\r\n\r\n  // Last resort\r\n  const t = Date.parse(value);\r\n  return isNaN(t) ? null : t;\r\n}\r\n\r\n// Canonicalize to 'yyyy-mm-dd' (matches <input type=\"date\">)\r\nfunction toYMD(value) {\r\n  const t = toTime(value);\r\n  if (t == null) return null;\r\n  const d = new Date(t);\r\n  const yyyy = d.getFullYear();\r\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  const dd = String(d.getDate()).padStart(2, \"0\");\r\n  return `${yyyy}-${mm}-${dd}`;\r\n}\r\n\r\n\r\nexport default function MainSearch() {\r\n  const { signOut } = useAuth();\r\n  const [info, setInfo] = useState([]);\r\n  const [backupInfo, setBackupInfo] = useState([]);\r\n  const [augmentedInfo, setAugmentedInfo] = useState([]); // items with clientFromId/currentId added\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [ids, setID] = useState([]);\r\n  const [show, setShow] = useState(false);\r\n  const [dItem, setDItem] = useState();\r\n  const [select, setSelect] = useState(\"Name\");\r\n  const [showList, setShowList] = useState(false);\r\n  const [showListSearch, setShowListSearch] = useState(\"text\");\r\n  const [search, setSearch] = useState(\"\");\r\n  const [selectedOEM, setSelectedOEM] = useState(null);\r\n  const [selectedModality, setSelectedModality] = useState(null);\r\n  // Replace the old single client state with two sets:\r\n  const [selectedClientFrom, setSelectedClientFrom] = useState(null);\r\n  const [clientFromButtonText, setClientFromButtonText] = useState(\"Select Option\");\r\n  const [selectedClientCurrent, setSelectedClientCurrent] = useState(null);\r\n  const [clientCurrentButtonText, setClientCurrentButtonText] = useState(\"Select Option\");\r\n\r\n  const [clients, setClients] = useState([]);\r\n  const [showClientModal, setShowClientModal] = useState(false);\r\n  // This state tells the modal which client box is being updated: \"from\" or \"current\"\r\n  const [clientSelectionType, setClientSelectionType] = useState(null);\r\n\r\n  const router = useRouter();\r\n  const labelBase = [\"name\", \"date\", \"w/o\", \"p/n\", \"s/n\"];\r\n  const labelBaseNames = [\"name\", \"date\", \"wo\", \"pn\", \"sn\"];\r\n  const sortCheckBase = [false, false, false, false, false, false];\r\n\r\n  function withSortIcon(baseLabels, activeIndex, isDesc) {\r\n    return baseLabels.map((text, i) => {\r\n      if (i !== activeIndex) return text; // untouched\r\n      const arrow = isDesc ? \" ▼\" : \" ▲\";\r\n      return `${text}${arrow}`;\r\n    });\r\n  }\r\n\r\n\r\n  const [labels, setLabels] = useState(labelBase);\r\n  const [sortCheck, setSortCheck] = useState(sortCheckBase);\r\n  const [hoverIndex, setHoverIndex] = useState(null);\r\n  const [selectedModel, setSelectedModel] = useState(null);\r\n  const [gPos, setGPos] = useState(null);\n  const [gIde, setGIde] = useState(null);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [page, setPage] = useState(1);\n  const [pageCursors, setPageCursors] = useState([]);\n  const [hasNextPage, setHasNextPage] = useState(false);\n  const fetchSeq = useRef(0);\n\n  const searchLower = (search || \"\").toLowerCase().trim();\n  const hasActiveFilters =\n    Boolean(selectedOEM) ||\n    Boolean(selectedModality) ||\n    Boolean(selectedModel) ||\n    Boolean(selectedClientFrom) ||\n    Boolean(selectedClientCurrent) ||\n    Boolean(searchLower);\n\n  const valueMatches = (value, s) => {\n    if (!value) return false;\n    if (Array.isArray(value)) {\n      return value.some((v) => valueMatches(v, s));\n    }\n    return String(value).toLowerCase().includes(s);\n  };\n\n  const matchesFilters = useCallback(\n    (item) => {\n      // hide explicitly hidden items\n      if (item?.visible === false) return false;\n\n      // OEM / Modality / Model filtering\n      const OEM =\n        item?.machineData?.OEM ??\n        item?.machineData?.oem ??\n        item?.theMachineData?.OEM ??\n        item?.theMachineData?.oem ??\n        item?.TheMachine?.OEM ??\n        item?.TheMachine?.oem;\n      const Modality =\n        item?.machineData?.Modality ??\n        item?.machineData?.modality ??\n        item?.theMachineData?.Modality ??\n        item?.theMachineData?.modality ??\n        item?.TheMachine?.Modality ??\n        item?.TheMachine?.modality;\n      const Model =\n        item?.machineData?.Model ??\n        item?.machineData?.model ??\n        item?.theMachineData?.Model ??\n        item?.theMachineData?.model ??\n        item?.TheMachine?.Model ??\n        item?.TheMachine?.model;\n\n      if (selectedOEM && OEM !== selectedOEM) return false;\n      if (selectedModality && Modality !== selectedModality) return false;\n      if (selectedModel && Model !== selectedModel) return false;\n\n      // Client filters\n      if (selectedClientFrom && item?.clientFromId !== selectedClientFrom) {\n        return false;\n      }\n      if (\n        selectedClientCurrent &&\n        item?.clientCurrentId !== selectedClientCurrent\n      ) {\n        return false;\n      }\n\n      // Search\n      if (searchLower) {\n        if (select === \"Name\") {\n          return valueMatches(item?.name, searchLower);\n        }\n        if (select === \"Date\") {\n          const wantedDay = searchLower; // yyyy-mm-dd from input\n          const itemYMD = toYMD(item?.date);\n          if (itemYMD && itemYMD === wantedDay) return true;\n          if (Array.isArray(item?.descriptions)) {\n            if (item.descriptions.some((d) => toYMD(d?.date) === wantedDay)) {\n              return true;\n            }\n          }\n          if (Array.isArray(item?.workOrders)) {\n            if (item.workOrders.some((w) => toYMD(w?.date) === wantedDay)) {\n              return true;\n            }\n          }\n          return false;\n        }\n        if (select === \"Work Order\") {\n          return (\n            Array.isArray(item?.workOrders) &&\n            item.workOrders.some((wo) =>\n              valueMatches(wo?.workOrder, searchLower)\n            )\n          );\n        }\n        if (select === \"Product Number\") {\n          return valueMatches(item?.pn, searchLower);\n        }\n        if (select === \"Serial Number\") {\n          return valueMatches(item?.sn, searchLower);\n        }\n        if (select === \"Description\") {\n          if (valueMatches(item?.desc, searchLower)) return true;\n          if (valueMatches(item?.description, searchLower)) return true;\n          if (Array.isArray(item?.descriptions)) {\n            return item.descriptions.some((d) =>\n              valueMatches(d?.description, searchLower)\n            );\n          }\n          return false;\n        }\n        if (select === \"SKU\") {\n          return valueMatches(item?.id, searchLower);\n        }\n      }\n\n      return true;\n    },\n    [\n      selectedOEM,\n      selectedModality,\n      selectedModel,\n      selectedClientFrom,\n      selectedClientCurrent,\n      searchLower,\n      select,\n    ]\n  );\n\n  const resetPagination = () => {\n    setPage(1);\n    setPageCursors([]);\n    setHasNextPage(false);\n  };\n\n  // Reset pagination on route/query change (prevents stale pages like “starting at 6”)\n  useEffect(() => {\n    resetPagination();\n  }, [router.asPath]);\n\n  // Fetch data on component mount and route change\n  useEffect(() => {\n    fetchData(page);\n  }, [router.route, page]);\n\n  // If filters/search change while on a later page, jump back to page 1\n  useEffect(() => {\n    if (page !== 1) setPage(1);\n  }, [\n    selectedOEM,\n    selectedModality,\n    selectedModel,\n    selectedClientFrom,\n    selectedClientCurrent,\n    search,\n    select,\n  ]);\n\n  async function fetchData(requestedPage = 1) {\n    const seq = ++fetchSeq.current;\n    setIsLoading(true);\n    try {\n      if (router.query.inputText && router.query.selectedType) {\n        setSelect(router.query.selectedType);\n        setSearch(router.query.inputText);\n      }\n      const startAfterDoc =\n        requestedPage > 1 ? pageCursors[requestedPage - 2] : null;\n      if (requestedPage > 1 && !startAfterDoc) {\n        setPage(1);\n        if (seq === fetchSeq.current) setIsLoading(false);\n        return;\n      }\n      // light retry for transient Firestore hiccups\n      const load = async (attempt = 1) => {\n        try {\n          return await fetchPartsWithMachineDataPage({\n            pageSize: PAGE_SIZE,\n            startAfterDoc,\n            visibleOnly: true,\n          });\n        } catch (e) {\n          if (attempt >= 3) throw e;\n          await new Promise(r => setTimeout(r, 250 * Math.pow(2, attempt - 1)));\n          return load(attempt + 1);\n        }\n      };\n      const { parts: data, lastDoc, hasNextPage: nextPage } = await load();\n      if (seq !== fetchSeq.current) return;\n      if (requestedPage === 1 && data.length === 0) {\n        setPageCursors([]);\n        setHasNextPage(false);\n      }\n      setBackupInfo(data);\n      setLabels(labelBase); // <-- add this line after setBackupInfo(data)\n      setID(data.map((item) => item.id));\n      if (requestedPage > 1 && data.length === 0) {\n        setHasNextPage(false);\n        setPage(1);\n        return;\n      }\n      setHasNextPage(nextPage);\n      setPageCursors((prev) => {\n        const next = requestedPage === 1 ? [] : [...prev];\n        if (lastDoc) {\n          next[requestedPage - 1] = lastDoc;\n        }\n        return next;\n      });\n      setSelectedItems([]);\n\n      // --- Pre-augment: resolve client ids of Machine / CurrentMachine once ---\n      const db = firebase.firestore();\n      const machineIds = [];\r\n      const curMachineIds = [];\r\n      const theMachineIds = []; // <-- ADD\r\n\r\n      for (const item of data) {\r\n        if (item?.Machine?.id) machineIds.push(item.Machine.id);\r\n        if (item?.CurrentMachine?.id) curMachineIds.push(item.CurrentMachine.id);\r\n        if (item?.TheMachine?.id) theMachineIds.push(item.TheMachine.id); // <-- ADD\r\n      }\r\n      const uniq = (arr) => [...new Set(arr)];\r\n      const mIds = uniq(machineIds);\r\n      const cIds = uniq(curMachineIds);\r\n\r\n      const fetchMachineClients = async (ids) => {\r\n        if (!ids.length) return {};\r\n        const out = {};\r\n        // Firestore \"in\" supports up to 10 document IDs per query\r\n        const chunks = [];\r\n        for (let i = 0; i < ids.length; i += 10) chunks.push(ids.slice(i, i + 10));\r\n        for (const chunk of chunks) {\r\n          const snap = await db\r\n            .collection(\"Machine\")\r\n            .where(firebase.firestore.FieldPath.documentId(), \"in\", chunk)\r\n            .get();\r\n          snap.forEach((doc) => {\r\n            const md = doc.data() || {};\r\n            out[doc.id] = md.client?.id || null;\r\n          });\r\n        }\r\n        return out;\r\n      };\r\n\r\n      // Fetch full machine docs (OEM/Modality/Model/Client/etc.) for a set of ids\r\n      const fetchMachinesData = async (ids) => {\r\n        if (!ids.length) return {};\r\n        const out = {};\r\n        const chunks = [];\r\n        for (let i = 0; i < ids.length; i += 10) chunks.push(ids.slice(i, i + 10));\r\n        for (const chunk of chunks) {\r\n          const snap = await db\r\n            .collection(\"Machine\")\r\n            .where(firebase.firestore.FieldPath.documentId(), \"in\", chunk)\r\n            .get();\r\n          snap.forEach((doc) => {\r\n            out[doc.id] = { id: doc.id, ...(doc.data() || {}) };\r\n          });\r\n        }\r\n        return out;\r\n      };\r\n\r\n\r\n      const [fromMap, curMap, theMap] = await Promise.all([\r\n        fetchMachineClients(mIds),\r\n        fetchMachineClients(cIds),\r\n        fetchMachinesData(uniq(theMachineIds)), // <-- now captured as theMap\r\n      ]);\r\n\r\n      // New-style only: take client ids straight from item refs\r\n      const augmented = data.map((item) => ({\r\n        ...item,\r\n        clientFromId: item?.ClientFrom?.id ?? null,\r\n        clientCurrentId: item?.ClientCurrent?.id ?? null,\r\n      }));\r\n\r\n      setAugmentedInfo(augmented);\n      // default view = everything not explicitly hidden\n      setInfo(augmented.filter((it) => it.visible !== false));\n    } catch (err) {\n      if (seq !== fetchSeq.current) return;\n      console.error(\"Error fetching data:\", err);\n      setInfo([]);\n      setAugmentedInfo([]);\n    } finally {\n      if (seq === fetchSeq.current) setIsLoading(false);\n    }\n  }\n\r\n  const searchChangeHandler = (event) => setSearch(event.target.value);\r\n\r\n  // Filter the currently loaded items (now consistent with paged filtering)\n  useEffect(() => {\n    const base = augmentedInfo || [];\n    setInfo(base.filter(matchesFilters));\n  }, [augmentedInfo, matchesFilters]);\n\r\n  function sortCheckAll(pos) {\r\n    // Determine next direction: toggle the clicked column only\r\n    const nextSortCheck = sortCheck.map((v, i) => (i === pos ? !v : v));\r\n    const isDesc = nextSortCheck[pos]; // true means descending\r\n\r\n    const sortedInfo = [...info].sort((a, b) => {\r\n      const key = labelBaseNames[pos];\r\n\r\n      if (pos === 1) {\r\n        // DATE column\r\n        const ta = toTime(a[key]);\r\n        const tb = toTime(b[key]);\r\n\r\n        // Put missing dates at the end for ascending, at the start for descending\r\n        if (ta === null && tb === null) return 0;\r\n        if (ta === null) return isDesc ? -1 : 1;\r\n        if (tb === null) return isDesc ? 1 : -1;\r\n\r\n        return isDesc ? (tb - ta) : (ta - tb);\r\n      }\r\n\r\n      // NAME or SKU (string-y columns): indexes 0 or 5 in your original logic\r\n      if (pos === 0 || pos === 5) {\r\n        const av = (a[key] ?? \"\").toString();\r\n        const bv = (b[key] ?? \"\").toString();\r\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\r\n      }\r\n\r\n      // Numeric-ish columns (wo, pn, sn) — fall back to string compare if NaN\r\n      const an = Number(a[key]);\r\n      const bn = Number(b[key]);\r\n\r\n      if (!isNaN(an) && !isNaN(bn)) {\r\n        return isDesc ? (bn - an) : (an - bn);\r\n      } else {\r\n        const av = (a[key] ?? \"\").toString();\r\n        const bv = (b[key] ?? \"\").toString();\r\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\r\n      }\r\n    });\r\n\r\n    setInfo(sortedInfo);\r\n    setSortCheck(nextSortCheck);\r\n\r\n    // Update header labels to show the little arrow on the active column\r\n    setLabels(withSortIcon(labelBase, pos, isDesc));\r\n  }\r\n\r\n\r\n  const rowSelect = (item) => {\r\n    if (item && item.id) {\r\n      console.log(\"Selected item:\", item);\r\n      router.push(\"./item/\" + item.id);\r\n    } else {\r\n      console.error(\"Unable to determine the selected item’s ID: \", item);\r\n    }\r\n  };\r\n\r\n  const [selectedItems, setSelectedItems] = useState([]);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n\r\n  const handleSelectItem = (id) => {\r\n    setSelectedItems(prev =>\r\n      prev.includes(id) ? prev.filter(x => x !== id) : [...prev, id]\r\n    );\r\n  };\r\n\r\n\r\n  // setSelectedItems((prev) => {\r\n  //   const newSelection = prev.includes(id)\r\n  //     ? prev.filter((itemId) => itemId !== id)\r\n  //     : [...prev, id];\r\n  //   console.log(\"Selected items:\", newSelection);\r\n  //   return newSelection; // <- important\r\n  // });\r\n\r\n  const handleShowDeleteModal = () => setShowDeleteModal(true);\r\n  const handleCloseDeleteModal = () => setShowDeleteModal(false);\r\n\r\n  const handleDeleteSelected = async () => {\r\n    setIsDeleting(true);\r\n    const db = firebase.firestore();\r\n    try {\r\n      // Loop over each selected item one at a time\r\n      for (const itemId of selectedItems) {\r\n        console.log(itemId)\r\n        try {\r\n          // Delete from \"Test\" collection\r\n          await db.collection(\"Test\").doc(itemId).delete();\r\n        } catch (err) {\r\n          console.error(`Error deleting document ${itemId} from Test:`, err);\r\n        }\r\n        try {\r\n          // Delete from \"Parts\" collection\r\n          await db.collection(\"Parts\").doc(itemId).delete();\r\n        } catch (err) {\r\n          console.error(`Error deleting document ${itemId} from Parts:`, err);\r\n        }\r\n        try {\r\n          // Delete associated photos from storage\r\n          await deleteFromStorage(itemId);\r\n        } catch (err) {\r\n          console.error(`Error deleting storage for ${itemId}:`, err);\r\n        }\r\n      }\r\n      // Update local state by filtering out the deleted items\r\n      setInfo(info.filter((item) => !selectedItems.includes(item.id)));\r\n      setSelectedItems([]);\r\n    } catch (error) {\r\n      console.error(\"Error deleting items:\", error);\r\n    } finally {\r\n      setIsDeleting(false);\r\n      handleCloseDeleteModal();\r\n      // Optionally, reload the page\r\n      // router.reload();\r\n    }\r\n  };\r\n\r\n\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n\r\n  const checkDelete = (event, pos, idsToDelete, name) => {\r\n    if (event) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }\r\n    console.log(\"Selected IDs to delete:\", idsToDelete);\r\n    setSelectedItems(idsToDelete);\r\n    setDItem(name);\r\n    setShowDeleteModal(true);\r\n  };\r\n\r\n  // const handleDelete = async () => {\r\n  //   let itemId = gIde;\r\n  //   try {\r\n  //     setIsDeleting(true);\r\n  //     const db = firebase.firestore();\r\n  //     await db.collection(\"Test\").doc(itemId).delete();\r\n  //     await deleteFromPartsCollection(itemId);\r\n  //     await deleteFromStorage(itemId);\r\n  //     setInfo(info.filter((_, i) => gPos !== i));\r\n  //     console.log(`Deleted item: ${itemId}`);\r\n  //   } catch (error) {\r\n  //     console.error(\"Error deleting item:\", error);\r\n  //   } finally {\r\n  //     setIsDeleting(false);\r\n  //   }\r\n  //   handleClose();\r\n  // };\r\n\r\n  const hoverStyle = (index) => ({\r\n    backgroundColor: hoverIndex === index ? \"#ddd\" : \"transparent\",\r\n    textAlign: \"center\",\r\n    cursor: \"default\",\r\n  });\r\n\r\n  const [dropdown1Text, setDropdown1Text] = useState(\"Select Option\");\r\n  const [dropdown2Text, setDropdown2Text] = useState(\"Select Option\");\r\n\r\n  const handleSelect1 = (eventKey, event) => {\r\n    if (eventKey === \"unassigned\") {\r\n      setDropdown1Text(\"Select Option\");\r\n      setSelectedOEM(null);\r\n    } else {\r\n      setDropdown1Text(event.target.textContent);\r\n      setSelectedOEM(event.target.textContent);\r\n    }\r\n  };\r\n\r\n  const handleSelect2 = (eventKey, event) => {\r\n    if (eventKey === \"unassigned\") {\r\n      setDropdown2Text(\"Select Option\");\r\n      setSelectedModality(null);\r\n    } else {\r\n      setDropdown2Text(event.target.textContent);\r\n      setSelectedModality(event.target.textContent);\r\n    }\r\n  };\r\n\r\n  // Build a unique list of clients from the items currently loaded, filtered by OEM/Modality.\r\n  // `type` is \"from\" or \"current\" to decide which client ref to read.\r\n  async function buildClientsFromItems(type) {\r\n    const db = firebase.firestore();\r\n    const ids = new Set();\r\n\r\n    // Respect current OEM / Modality filters when deriving client options\r\n    const filtered = augmentedInfo.filter((item) => {\r\n      const OEM = item?.machineData?.OEM ?? item?.OEM ?? null;\r\n      const Modality = item?.machineData?.Modality ?? item?.Modality ?? null;\r\n      if (selectedOEM && OEM !== selectedOEM) return false;\r\n      if (selectedModality && Modality !== selectedModality) return false;\r\n      return true;\r\n    });\r\n\r\n    for (const it of filtered) {\r\n      const id = type === \"from\" ? it.clientFromId : it.clientCurrentId;\r\n      if (id) ids.add(id);\r\n    }\r\n\r\n    const out = [];\r\n    const idArray = [...ids];\r\n    for (let i = 0; i < idArray.length; i += 10) {\r\n      const chunk = idArray.slice(i, i + 10);\r\n      const snap = await db\r\n        .collection(\"Client\")\r\n        .where(firebase.firestore.FieldPath.documentId(), \"in\", chunk)\r\n        .get();\r\n      snap.forEach((doc) => {\r\n        const d = doc.data() || {};\r\n        out.push({ id: doc.id, name: d.name || doc.id });\r\n      });\r\n    }\r\n\r\n    // sort by name for nicer UX\r\n    out.sort((a, b) => (a.name || \"\").localeCompare(b.name || \"\"));\r\n    return out;\r\n  }\r\n\r\n\r\n  // --------------------\r\n  // CLIENT SELECTION HANDLING\r\n  // --------------------\r\n  // This function fetches clients and opens the client modal.\r\n  const handleClientClick = async () => {\r\n    let safeClients = [];\r\n    try {\r\n      const clientsData = await fetchClients(selectedOEM, selectedModality);\r\n      safeClients = Array.isArray(clientsData) ? clientsData : [];\r\n    } catch (e) {\r\n      console.error(\"fetchClients failed:\", e);\r\n    }\r\n\r\n    // Fallback to building from loaded items if API gave us nothing\r\n    if (safeClients.length === 0) {\r\n      try {\r\n        if (!clientSelectionType) {\r\n          // if somehow not set yet, default to \"from\"\r\n          setClientSelectionType(\"from\");\r\n        }\r\n        const derived = await buildClientsFromItems(clientSelectionType || \"from\");\r\n        safeClients = derived;\r\n      } catch (e) {\r\n        console.error(\"Fallback buildClientsFromItems failed:\", e);\r\n        safeClients = [];\r\n      }\r\n    }\r\n\r\n    setClients(safeClients);\r\n    setClientSearchTerm(\"\");\r\n    setShowClientModal(true);\r\n  };\r\n\r\n\r\n\r\n  // When a client is selected in the modal, we now assume the parameter is a client ID.\r\n  // If the passed value is null, we clear the selection.\r\n  const handleClientSelect = async (clientId) => {\r\n    console.log(\"User selected client id:\", clientId);\r\n    if (!clientId) {\r\n      if (clientSelectionType === \"from\") {\r\n        setClientFromButtonText(\"Select Option\");\r\n        setSelectedClientFrom(null);\r\n      } else if (clientSelectionType === \"current\") {\r\n        setClientCurrentButtonText(\"Select Option\");\r\n        setSelectedClientCurrent(null);\r\n      }\r\n      setShowClientModal(false);\r\n      return;\r\n    }\r\n    try {\r\n      const clientSnap = await firebase.firestore().collection(\"Client\").doc(clientId).get();\r\n      if (clientSnap.exists) {\r\n        const clientData = clientSnap.data();\r\n        if (clientSelectionType === \"from\") {\r\n          setClientFromButtonText(clientData.name);\r\n          setSelectedClientFrom(clientId);\r\n        } else if (clientSelectionType === \"current\") {\r\n          setClientCurrentButtonText(clientData.name);\r\n          setSelectedClientCurrent(clientId);\r\n        }\r\n      } else {\r\n        console.error(\"No client document found for id:\", clientId);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching client data:\", error);\r\n    }\r\n    setShowClientModal(false);\r\n  };\r\n\r\n  const handleClientInfo = (clientId, clientName) => {\r\n    console.log(`Client ID: ${clientId}, Client Name: ${clientName}`);\r\n    router.push(\"client/\" + clientId);\r\n  };\r\n\r\n  const handleClearClientSelection = () => {\r\n    if (clientSelectionType === \"from\") {\r\n      setClientFromButtonText(\"Select Option\");\r\n      setSelectedClientFrom(null);\r\n    } else if (clientSelectionType === \"current\") {\r\n      setClientCurrentButtonText(\"Select Option\");\r\n      setSelectedClientCurrent(null);\r\n    }\r\n    setShowClientModal(false);\r\n  };\r\n\r\n  // --------------------\r\n  // MODEL SELECTION HANDLING\r\n  // --------------------\r\n  const [models, setModels] = useState([]);\r\n  const [showModelModal, setShowModelModal] = useState(false);\r\n  const [modelButtonText, setModelButtonText] = useState(\"Select Option\");\r\n\r\n  const handleModelClick = async () => {\r\n    const modelsData = await fetchModels(\r\n      selectedOEM,\r\n      selectedModality,\r\n      selectedClientFrom\r\n    );\r\n    setModels(modelsData);\r\n    setModelSearchTerm(\"\");\r\n    setShowModelModal(true);\r\n  };\r\n\r\n  const handleModelSelect = (modelName) => {\r\n    setModelButtonText(modelName || \"Select Option\");\r\n    setSelectedModel(modelName || null);\r\n    setShowModelModal(false);\r\n  };\r\n\r\n  const handleClearModelSelection = () => {\r\n    setModelButtonText(\"Select Option\");\r\n    setSelectedModel(null);\r\n    setShowModelModal(false);\r\n  };\r\n\r\n  // --------------------\r\n  // WAREHOUSE BUTTONS (for Client Current)\r\n  // --------------------\r\n  const handleSoCalWarehouseClick = () => {\r\n    setClientCurrentButtonText(\"SoCal Warehouse\");\r\n    setSelectedClientCurrent(SOCAL_CLIENT_ID);\r\n    console.log(\"Warehouse button clicked: setting Client Current to\", SOCAL_CLIENT_ID);\r\n  };\r\n\r\n  const handleNorCalWarehouseClick = () => {\r\n    setClientCurrentButtonText(\"NorCal Warehouse\");\r\n    setSelectedClientCurrent(NORCAL_CLIENT_ID);\r\n    console.log(\"Warehouse button clicked: setting Client Current to\", NORCAL_CLIENT_ID);\r\n  };\r\n\r\n  const handleWarehouseUnassignedClick = () => {\r\n    setClientCurrentButtonText(\"Unassigned\");\r\n    setSelectedClientCurrent(UNASSIGNED_CLIENT_ID);\r\n    console.log(\"Warehouse button clicked: setting Client Current to\", UNASSIGNED_CLIENT_ID);\r\n  };\r\n\r\n  const [clientSearchTerm, setClientSearchTerm] = useState(\"\");\r\n  const [modelSearchTerm, setModelSearchTerm] = useState(\"\");\r\n\r\n  const deleteFromStorage = async (itemId) => {\r\n    const storageRef = firebase.storage().ref();\r\n    const folderRef = storageRef.child(`Parts/${itemId}/`);\r\n    try {\r\n      const listResult = await folderRef.listAll();\r\n      const deletePromises = listResult.items.map((item) => item.delete());\r\n      await Promise.all(deletePromises);\r\n    } catch (error) {\r\n      console.error(\"Error deleting from storage:\", error);\r\n    }\r\n  };\r\n\r\n  const deleteFromPartsCollection = async (itemId) => {\r\n    const db = firebase.firestore();\r\n    try {\r\n      await db.collection(\"Parts\").doc(itemId).delete();\r\n      console.log(`Deleted item from Parts collection: ${itemId}`);\r\n    } catch (error) {\r\n      console.error(\"Error deleting from Parts collection:\", error);\r\n    }\r\n  };\r\n\r\n  //   // Safely convert any date-ish value into a comparable timestamp (ms since epoch).\r\n  // function toTime(value) {\r\n  //   if (!value) return null;\r\n\r\n  //   // Firestore Timestamp: { seconds, nanoseconds }\r\n  //   if (typeof value === \"object\" && value.seconds) {\r\n  //     try {\r\n  //       return value.seconds * 1000;\r\n  //     } catch { /* fallthrough */ }\r\n  //   }\r\n\r\n  //   // If already a Date\r\n  //   if (value instanceof Date) return isNaN(value.getTime()) ? null : value.getTime();\r\n\r\n  //   // If string: try ISO first\r\n  //   if (typeof value === \"string\") {\r\n  //     // yyyy-mm-dd (from your form inputs)\r\n  //     const iso = Date.parse(value);\r\n  //     if (!isNaN(iso)) return iso;\r\n\r\n  //     // mm/dd/yyyy fallback (older items)\r\n  //     const parts = value.split(\"/\");\r\n  //     if (parts.length === 3) {\r\n  //       const [mm, dd, yyyy] = parts;\r\n  //       const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\r\n  //       if (!isNaN(alt)) return alt;\r\n  //     }\r\n  //   }\r\n\r\n  //   // Canonicalize any date-ish value to 'yyyy-mm-dd' so it matches <input type=\"date\"> values\r\n  //   function toYMD(value) {\r\n  //     const t = toTime(value);\r\n  //     if (t == null) return null;\r\n  //     const d = new Date(t);\r\n  //     const yyyy = d.getFullYear();\r\n  //     const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  //     const dd = String(d.getDate()).padStart(2, \"0\");\r\n  //     return `${yyyy}-${mm}-${dd}`;\r\n  //   }\r\n\r\n\r\n  //   // Last resort\n  //   const t = Date.parse(value);\n  //   return isNaN(t) ? null : t;\n  // }\n\n  const totalKnownPages = Math.max(\n    1,\n    pageCursors.filter(Boolean).length + (hasNextPage ? 1 : 0)\n  );\n  const pageButtons = [];\n  for (let i = 1; i <= totalKnownPages; i++) {\n    pageButtons.push(\n      <Pagination.Item\n        key={i}\n        active={i === page}\n        onClick={() => setPage(i)}\n      >\n        {i}\n      </Pagination.Item>\n    );\n  }\n\n\n  return (\n    <LoggedIn>\n      {isDeleting && (\r\n        <div className=\"loading-overlay\">\r\n          <Spinner animation=\"border\" role=\"status\" className=\"spinner-center\">\r\n            <span className=\"sr-only\">Loading...</span>\r\n          </Spinner>\r\n        </div>\r\n      )}\r\n      <Modal show={showDeleteModal} onHide={handleCloseDeleteModal}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Confirm Deletion</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          Are you sure you want to delete {selectedItems.length} item\r\n          {selectedItems.length > 1 ? \"s\" : \"\"}?\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"danger\" onClick={handleDeleteSelected}>\r\n            Yes, delete\r\n          </Button>\r\n          <Button variant=\"secondary\" onClick={handleCloseDeleteModal}>\r\n            Cancel\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n\r\n      <Modal show={showClientModal} onHide={() => setShowClientModal(false)}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>\r\n            Select {clientSelectionType === \"from\" ? \"Client From\" : \"Client Current\"}\r\n          </Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <FormControl\r\n            type=\"text\"\r\n            placeholder=\"Search by name\"\r\n            className=\"mb-3\"\r\n            value={clientSearchTerm}\r\n            onChange={(e) => setClientSearchTerm(e.target.value)}\r\n          />\r\n          <ClientTable\r\n            clients={(Array.isArray(clients) ? clients : []).filter(\r\n              (client) => (client?.name ?? \"\").toLowerCase().includes(clientSearchTerm.toLowerCase())\r\n            )}\r\n            onSelectClient={handleClientSelect}\r\n            onInfoClick={handleClientInfo}\r\n            isClientSearch={false}\r\n            clearSelection={() => handleClientSelect(null)}\r\n          />\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      <Modal show={showModelModal} onHide={() => setShowModelModal(false)}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Select Model</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <FormControl\r\n            type=\"text\"\r\n            placeholder=\"Search by name\"\r\n            className=\"mb-3\"\r\n            value={modelSearchTerm}\r\n            onChange={(e) => setModelSearchTerm(e.target.value)}\r\n          />\r\n          <ModelTable\r\n            models={models.filter((model) =>\r\n              typeof model === \"string\"\r\n                ? model.toLowerCase().includes(modelSearchTerm.toLowerCase())\r\n                : false\r\n            )}\r\n            onSelectModel={handleModelSelect}\r\n            clearSelection={() => handleModelSelect(null)}\r\n          />\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      <Container\r\n        className=\"d-flex align-items-center justify-content-center\"\r\n        style={{ minHeight: \"100vh\" }}\r\n      >\r\n        <div className=\"w-100\" style={{ maxWidth: \"1200px\" }}>\r\n          <Card>\r\n            <Card.Body>\r\n              <h2 className=\"text-center mb-4\">Magmo</h2>\r\n              <Row>\r\n                <Col md={4}>\r\n                  {/* Dropdowns */}\r\n                  <div>\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>OEM</InputGroup.Text>\r\n                      <Dropdown onSelect={handleSelect1}>\r\n                        <Dropdown.Toggle\r\n                          variant=\"outline-secondary\"\r\n                          id=\"dropdown-button-1\"\r\n                          className=\"w-100\"\r\n                        >\r\n                          {dropdown1Text}\r\n                        </Dropdown.Toggle>\r\n                        <Dropdown.Menu className=\"w-100\">\r\n                          <Dropdown.Item eventKey=\"unassigned\">\r\n                            Select Option\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"GE\">GE</Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"Toshiba\">\r\n                            Toshiba\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"Siemens\">\r\n                            Siemens\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"Philips\">\r\n                            Philips\r\n                          </Dropdown.Item>\r\n                        </Dropdown.Menu>\r\n                      </Dropdown>\r\n                    </InputGroup>\r\n\r\n                    <InputGroup className=\"mb-5\">\r\n                      <InputGroup.Text>Modality</InputGroup.Text>\r\n                      <Dropdown onSelect={handleSelect2}>\r\n                        <Dropdown.Toggle\r\n                          variant=\"outline-secondary\"\r\n                          id=\"dropdown-button-2\"\r\n                          className=\"w-100\"\r\n                        >\r\n                          {dropdown2Text}\r\n                        </Dropdown.Toggle>\r\n                        <Dropdown.Menu className=\"w-100\">\r\n                          <Dropdown.Item eventKey=\"unassigned\">\r\n                            Select Option\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"CT\">CT</Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"MRI\">MRI</Dropdown.Item>\r\n                        </Dropdown.Menu>\r\n                      </Dropdown>\r\n                    </InputGroup>\r\n                  </div>\r\n\r\n                  <div className={styles.divider}></div>\r\n\r\n                  {/* Client selection boxes */}\r\n                  <div>\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Client From</InputGroup.Text>\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        className=\"w-100\"\r\n                        onClick={() => handleClientClick(\"from\")}\r\n\r\n                      >\r\n                        {clientFromButtonText}\r\n                      </Button>\r\n                    </InputGroup>\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Client Current</InputGroup.Text>\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        className=\"w-100\"\r\n                        onClick={() => handleClientClick(\"current\")}\r\n\r\n                      >\r\n                        {clientCurrentButtonText}\r\n                      </Button>\r\n                    </InputGroup>\r\n\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Model</InputGroup.Text>\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        className=\"w-100\"\r\n                        onClick={handleModelClick}\r\n                      >\r\n                        {modelButtonText}\r\n                      </Button>\r\n                    </InputGroup>\r\n\r\n                    <div className={styles.divider}></div>\r\n\r\n                    {/* Warehouse buttons for Client Current */}\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Warehouse</InputGroup.Text>\r\n                      <div className={styles.buttonGroup}>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          className={styles.flexButton}\r\n                          onClick={handleSoCalWarehouseClick}\r\n                        >\r\n                          SoCal Warehouse\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          className={styles.flexButton}\r\n                          onClick={handleNorCalWarehouseClick}\r\n                        >\r\n                          NorCal Warehouse\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          className={styles.flexButton}\r\n                          onClick={handleWarehouseUnassignedClick}\r\n                        >\r\n                          Unassigned\r\n                        </Button>\r\n                      </div>\r\n                    </InputGroup>\r\n                  </div>\r\n                </Col>\r\n\r\n                <Col md={8}>\r\n                  <div className={styles.tableContainer}>\r\n                    {isLoading ? (\r\n                      <div className=\"d-flex justify-content-center align-items-center p-5\">\r\n                        <img\r\n                          src=\"/magmo-logo.png\" // make sure it's in /public\r\n                          alt=\"Loading Magmo\"\r\n                          style={{\r\n                            width: 64,\r\n                            height: 64,\r\n                            animation: \"magmo-spin 1s linear infinite\",\r\n                            transformOrigin: \"50% 50%\",\r\n                            display: \"block\",\r\n                          }}\r\n                        />\r\n\r\n                        {/* global so styled-jsx doesn't hash the name */}\r\n                        <style jsx global>{`\r\n      @keyframes magmo-spin {\r\n        from {\r\n          transform: rotate(0deg);\r\n        }\r\n        to {\r\n          transform: rotate(360deg);\r\n        }\r\n      }\r\n    `}</style>\r\n                      </div>\r\n                    ) : (\r\n                      <PartTable\r\n                        info={info}\r\n                        labels={labels}\r\n                        ids={ids}\r\n                        hoverStyle={hoverStyle}\r\n                        sortCheckAll={sortCheckAll}\r\n                        checkDelete={checkDelete}\r\n                        isDeleting={isDeleting}\r\n                        rowSelect={rowSelect}\r\n                        setHoverIndex={setHoverIndex}\r\n                        hoverIndex={hoverIndex}\r\n                        selectedItems={selectedItems}\r\n                        setSelectedItems={setSelectedItems}\r\n                      />\r\n                    )}\n\n\n                    <div className={styles.searchContainer}>\n                      <div className={styles.paginationRow}>\n                        <Pagination size=\"sm\">\n                          <Pagination.Prev\n                            onClick={() => setPage((p) => Math.max(1, p - 1))}\n                            disabled={page <= 1}\n                          />\n                          {pageButtons}\n                          <Pagination.Next\n                            onClick={() => setPage((p) => p + 1)}\n                            disabled={!hasNextPage}\n                          />\n                        </Pagination>\n                      </div>\n                      <Form className=\"d-flex pb-2\">\n                        <FormControl\n                          type={showListSearch}\n                          placeholder=\"Search\"\n                          className=\"me-2 flex-grow-1\"\r\n                          aria-label=\"Search\"\r\n                          value={search}\r\n                          onChange={searchChangeHandler}\r\n                          style={{ flex: \"1\" }}\r\n                        />\r\n                        <NavDropdown\r\n                          title={select}\r\n                          id=\"collasible-nav-dropdown\"\r\n                          show={showList}\r\n                          onMouseEnter={() => setShowList(true)}\r\n                          onMouseLeave={() => setShowList(false)}\r\n                          style={{ marginTop: \"-5px\" }}\r\n                        >\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Name\"); setShowListSearch(\"text\"); }}>\r\n                            Name\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Date\"); setShowListSearch(\"date\"); }}>\r\n                            Date\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Work Order\"); setShowListSearch(\"number\"); }}>\r\n                            Work Order\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Product Number\"); setShowListSearch(\"number\"); }}>\r\n                            Product Number\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Description\"); setShowListSearch(\"text\"); }}>\r\n                            Description\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item\r\n                            onClick={() => {\r\n                              setSelect(\"SKU\");\r\n                              setShowListSearch(\"text\");\r\n                            }}\r\n                          >\r\n                            SKU\r\n                          </NavDropdown.Item>\r\n                        </NavDropdown>\r\n                      </Form>\r\n                      <div className=\"d-flex justify-content-between\">\r\n                        <LoadingButton type=\"secondary\" name=\"Add New Item\" route=\"NewSearch/AddItem/NewItem\" />\r\n                        <LoadingButton type=\"primary\" name=\"Back\" route=\"Warehousedb/WarehouseSelect\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n            </Card.Body>\r\n          </Card>\r\n        </div>\r\n      </Container>\r\n    </LoggedIn>\r\n  );\r\n\r\n\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}