{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\NewSearch\\\\item\\\\[id]\\\\NewLocal.js\";\nvar __jsx = React.createElement;\n// NewLocal.js\nimport React, { useState, useEffect } from \"react\";\nimport { Form, Row, Col, Button, Stack } from \"react-bootstrap\";\nimport firebase from \"../../../../context/Firebase\";\nexport default function NewLocal({\n  onSave = () => {},\n  onCancel = () => {},\n  selectedClient,\n  showLocalLoc,\n  value = {},\n  onChange\n}) {\n  const {\n    0: regionOptions,\n    1: setRegionOptions\n  } = useState([]);\n  const {\n    0: sectionMap,\n    1: setSectionMap\n  } = useState({});\n  const {\n    0: binCount,\n    1: setBinCount\n  } = useState(0);\n  const {\n    0: palletCount,\n    1: setPalletCount\n  } = useState(0);\n  const {\n    0: region,\n    1: setRegion\n  } = useState(\"\");\n  const {\n    0: sectionLetter,\n    1: setSectionLetter\n  } = useState(\"\");\n  const {\n    0: sectionNumber,\n    1: setSectionNumber\n  } = useState(\"\");\n  const {\n    0: binSelected,\n    1: setBinSelected\n  } = useState(\"\");\n  const {\n    0: palletSelected,\n    1: setPalletSelected\n  } = useState(\"\"); // 1) load directory exactly as before\n\n  useEffect(() => {\n    if (!showLocalLoc) return;\n    const db = firebase.firestore();\n    db.collection(\"Warehouse\").doc(\"directory\").get().then(doc => {\n      const d = doc.data() || {};\n      setRegionOptions(d.Region || []);\n      setSectionMap(d.Section || {});\n      setBinCount(d.Bin || 0);\n      setPalletCount(d.Pallet || 0);\n    });\n  }, [showLocalLoc]); // 2) when we open the modal (or value changes), initialize from value\n\n  useEffect(() => {\n    var _value$section, _value$section2, _value$bin, _value$pallet;\n\n    if (!showLocalLoc) return;\n    setRegion(value.region || \"\");\n    setSectionLetter(((_value$section = value.section) === null || _value$section === void 0 ? void 0 : _value$section.letter) || \"\");\n    setSectionNumber(((_value$section2 = value.section) === null || _value$section2 === void 0 ? void 0 : _value$section2.number) || \"\");\n    setBinSelected(((_value$bin = value.bin) === null || _value$bin === void 0 ? void 0 : _value$bin.toString()) || \"\");\n    setPalletSelected(((_value$pallet = value.pallet) === null || _value$pallet === void 0 ? void 0 : _value$pallet.toString()) || \"\");\n  }, [showLocalLoc]); // 3) notify parent on any change\n\n  useEffect(() => {\n    const p = {};\n    if (region) p.region = region;\n    if (sectionLetter && sectionNumber) p.section = {\n      letter: sectionLetter,\n      number: sectionNumber\n    };\n    if (binSelected) p.bin = parseInt(binSelected, 10);\n    if (palletSelected) p.pallet = parseInt(palletSelected, 10);\n    onChange(p);\n  }, [region, sectionLetter, sectionNumber, binSelected, palletSelected]); // helpers:\n\n  const letters = Array.from({\n    length: 26\n  }, (_, i) => String.fromCharCode(65 + i));\n  const numbers = Array.from({\n    length: 50\n  }, (_, i) => i + 1);\n  const binOptions = Array.from({\n    length: binCount\n  }, (_, i) => i + 1);\n  const palletOptions = Array.from({\n    length: palletCount\n  }, (_, i) => i + 1); // bump and persist bin count\n\n  const handleAddBin = async () => {\n    const next = binCount + 1;\n    await firebase.firestore().collection(\"Warehouse\").doc(\"directory\").update({\n      Bin: next\n    });\n    setBinCount(next);\n    setBinSelected(next.toString());\n  }; // bump and persist pallet count\n\n\n  const handleAddPallet = async () => {\n    const next = palletCount + 1;\n    await firebase.firestore().collection(\"Warehouse\").doc(\"directory\").update({\n      Pallet: next\n    });\n    setPalletCount(next);\n    setPalletSelected(next.toString());\n  }; // only fire parent when they click OK\n\n\n  const handleOk = () => {\n    const p = {};\n    if (region) p.region = region;\n    if (sectionLetter && sectionNumber) p.section = {\n      letter: sectionLetter,\n      number: sectionNumber\n    };\n    if (binSelected) p.bin = parseInt(binSelected, 10);\n    if (palletSelected) p.pallet = parseInt(palletSelected, 10);\n    onSave(p);\n  };\n\n  return __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 5\n    }\n  }, __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 7\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }\n  }, \"Region\"), __jsx(Form.Select, {\n    value: region,\n    onChange: e => setRegion(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 15\n    }\n  }, \"Select region\"), regionOptions.map(r => __jsx(\"option\", {\n    key: r,\n    value: r,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 38\n    }\n  }, r))))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }\n  }, \"Section Letter\"), __jsx(Form.Select, {\n    value: sectionLetter,\n    onChange: e => setSectionLetter(e.target.value) // disabled={!region}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 15\n    }\n  }, \"Letter\"), letters.map(l => __jsx(\"option\", {\n    key: l,\n    value: l,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 32\n    }\n  }, l))))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 13\n    }\n  }, \"Section Number\"), __jsx(Form.Select, {\n    value: sectionNumber,\n    onChange: e => setSectionNumber(e.target.value) // disabled={!region}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 15\n    }\n  }, \"Number\"), numbers.map(n => __jsx(\"option\", {\n    key: n,\n    value: n,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 32\n    }\n  }, n)))))), __jsx(Row, {\n    className: \"mt-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 7\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 13\n    }\n  }, \"Bin\"), __jsx(Stack, {\n    direction: \"horizontal\",\n    gap: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }, __jsx(Form.Select, {\n    value: binSelected,\n    onChange: e => setBinSelected(e.target.value) // disabled={!region}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 15\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 17\n    }\n  }, \"Select bin\"), binOptions.map(b => __jsx(\"option\", {\n    key: b,\n    value: b,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 38\n    }\n  }, b))), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleAddBin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 15\n    }\n  }, \"+ Bin\")))), __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 9\n    }\n  }, __jsx(Form.Group, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Label, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 11\n    }\n  }, \"Pallet\"), __jsx(Stack, {\n    direction: \"horizontal\",\n    gap: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 11\n    }\n  }, __jsx(Form.Select, {\n    value: palletSelected,\n    onChange: e => setPalletSelected(e.target.value) // disabled={!region}\n    ,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 11\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 15\n    }\n  }, \"Select pallet\"), palletOptions.map(p => __jsx(\"option\", {\n    key: p,\n    value: p,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 41\n    }\n  }, p))), __jsx(Button, {\n    variant: \"outline-secondary\",\n    onClick: handleAddPallet,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 15\n    }\n  }, \"+ Pallet\"))))), __jsx(Row, {\n    className: \"mt-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }\n  }, __jsx(Col, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"mt-3 text-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 11\n    }\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    onClick: onCancel,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 13\n    }\n  }, \"Cancel\"), __jsx(Button, {\n    variant: \"primary\",\n    onClick: handleOk,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 13\n    }\n  }, \"OK\")))));\n}","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/NewSearch/item/[id]/NewLocal.js"],"names":["React","useState","useEffect","Form","Row","Col","Button","Stack","firebase","NewLocal","onSave","onCancel","selectedClient","showLocalLoc","value","onChange","regionOptions","setRegionOptions","sectionMap","setSectionMap","binCount","setBinCount","palletCount","setPalletCount","region","setRegion","sectionLetter","setSectionLetter","sectionNumber","setSectionNumber","binSelected","setBinSelected","palletSelected","setPalletSelected","db","firestore","collection","doc","get","then","d","data","Region","Section","Bin","Pallet","section","letter","number","bin","toString","pallet","p","parseInt","letters","Array","from","length","_","i","String","fromCharCode","numbers","binOptions","palletOptions","handleAddBin","next","update","handleAddPallet","handleOk","e","target","map","r","l","n","b"],"mappings":"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","sourcesContent":["// NewLocal.js\nimport React, { useState, useEffect } from \"react\";\nimport { Form, Row, Col, Button, Stack } from \"react-bootstrap\";\nimport firebase from \"../../../../context/Firebase\";\n\nexport default function NewLocal({\n  onSave = () => {},\n  onCancel = () => {},\n  selectedClient,\n  showLocalLoc,\n  value = {},\n  onChange,\n}) {\n  const [regionOptions, setRegionOptions] = useState([]);\n  const [sectionMap, setSectionMap]     = useState({});\n  const [binCount, setBinCount]         = useState(0);\n  const [palletCount, setPalletCount]   = useState(0);\n\n  const [region, setRegion] = useState(\"\");\n  const [sectionLetter, setSectionLetter] = useState(\"\");\n  const [sectionNumber, setSectionNumber] = useState(\"\");\n  const [binSelected, setBinSelected]     = useState(\"\");\n  const [palletSelected, setPalletSelected] = useState(\"\");\n\n  // 1) load directory exactly as before\n  useEffect(() => {\n    if (!showLocalLoc) return;\n    const db = firebase.firestore();\n    db.collection(\"Warehouse\").doc(\"directory\").get().then(doc => {\n      const d = doc.data() || {};\n      setRegionOptions(d.Region   || []);\n      setSectionMap   (d.Section  || {});\n      setBinCount     (d.Bin      || 0);\n      setPalletCount  (d.Pallet   || 0);\n    });\n  }, [showLocalLoc]);\n\n  // 2) when we open the modal (or value changes), initialize from value\n  useEffect(() => {\n    if (!showLocalLoc) return;\n    setRegion        (value.region             || \"\");\n    setSectionLetter(value.section?.letter    || \"\");\n    setSectionNumber(value.section?.number    || \"\");\n    setBinSelected   (value.bin?.toString()    || \"\");\n    setPalletSelected(value.pallet?.toString()|| \"\");\n  }, [showLocalLoc]);\n\n  // 3) notify parent on any change\n  useEffect(() => {\n    const p = {};\n    if (region)         p.region  = region;\n    if (sectionLetter && sectionNumber) p.section = { letter: sectionLetter, number: sectionNumber };\n    if (binSelected)    p.bin     = parseInt(binSelected,10);\n    if (palletSelected) p.pallet  = parseInt(palletSelected,10);\n    onChange(p);\n  }, [region, sectionLetter, sectionNumber, binSelected, palletSelected]);\n\n  // helpers:\nconst letters = Array.from({ length: 26 }, (_, i) => String.fromCharCode(65 + i));\nconst numbers = Array.from({ length: 50 }, (_, i) => i + 1);\n  const binOptions = Array.from({ length: binCount }, (_, i) => i + 1);\n  const palletOptions = Array.from({ length: palletCount }, (_, i) => i + 1);\n\n  // bump and persist bin count\n  const handleAddBin = async () => {\n    const next = binCount + 1;\n    await firebase.firestore()\n      .collection(\"Warehouse\").doc(\"directory\")\n      .update({ Bin: next });\n    setBinCount(next);\n    setBinSelected(next.toString());\n  };\n\n  // bump and persist pallet count\n  const handleAddPallet = async () => {\n    const next = palletCount + 1;\n    await firebase.firestore()\n      .collection(\"Warehouse\").doc(\"directory\")\n      .update({ Pallet: next });\n    setPalletCount(next);\n    setPalletSelected(next.toString());\n  };\n\n  // only fire parent when they click OK\n  const handleOk = () => {\n    const p = {};\n    if (region) p.region = region;\n    if (sectionLetter && sectionNumber)\n      p.section = { letter: sectionLetter, number: sectionNumber };\n    if (binSelected) p.bin = parseInt(binSelected, 10);\n    if (palletSelected) p.pallet = parseInt(palletSelected, 10);\n    onSave(p);\n  };\n\n  return (\n    <div>\n      <Row>\n        <Col>\n          <Form.Group>\n            <Form.Label>Region</Form.Label>\n            <Form.Select\n              value={region} onChange={e=>setRegion(e.target.value)}\n            >\n              <option value=\"\">Select region</option>\n              {regionOptions.map(r=> <option key={r} value={r}>{r}</option>)}\n            </Form.Select>\n          </Form.Group>\n        </Col>\n        <Col>\n          <Form.Group>\n            <Form.Label>Section Letter</Form.Label>\n            <Form.Select\n              value={sectionLetter}\n              onChange={e=>setSectionLetter(e.target.value)}\n              // disabled={!region}\n            >\n              <option value=\"\">Letter</option>\n              {letters.map(l=> <option key={l} value={l}>{l}</option>)}\n            </Form.Select>\n          </Form.Group>\n        </Col>\n        <Col>\n          <Form.Group>\n            <Form.Label>Section Number</Form.Label>\n            <Form.Select\n              value={sectionNumber}\n              onChange={e=>setSectionNumber(e.target.value)}\n              // disabled={!region}\n            >\n              <option value=\"\">Number</option>\n              {numbers.map(n=> <option key={n} value={n}>{n}</option>)}\n            </Form.Select>\n          </Form.Group>\n        </Col>\n      </Row>\n      <Row className=\"mt-3\">\n        <Col>\n          <Form.Group>\n            <Form.Label>Bin</Form.Label>\n            <Stack direction=\"horizontal\" gap={2}>\n              <Form.Select\n                value={binSelected}\n                onChange={e => setBinSelected(e.target.value)}\n                // disabled={!region}\n              >\n                <option value=\"\">Select bin</option>\n                {binOptions.map(b => <option key={b} value={b}>{b}</option>)}\n              </Form.Select>\n              <Button variant=\"outline-secondary\" onClick={handleAddBin} >\n                + Bin\n              </Button>\n            </Stack>\n          </Form.Group>\n        </Col>\n        <Col>\n          <Form.Group>\n          <Form.Label>Pallet</Form.Label>\n          <Stack direction=\"horizontal\" gap={2}>\n          <Form.Select\n            value={palletSelected}\n            onChange={e =>setPalletSelected(e.target.value)}\n              // disabled={!region}\n            >\n              <option value=\"\">Select pallet</option>\n                {palletOptions.map(p => <option key={p} value={p}>{p}</option>)}\n              </Form.Select>\n              <Button variant=\"outline-secondary\" onClick={handleAddPallet} >\n                + Pallet\n              </Button>\n            </Stack>\n          </Form.Group>\n        </Col>\n      </Row>\n      {/* OK / Cancel footer */}\n      <Row className=\"mt-4\">\n        <Col>\n          <div className=\"mt-3 text-end\">\n            <Button variant=\"secondary\" onClick={onCancel}>\n              Cancel\n            </Button>\n            <Button variant=\"primary\" onClick={handleOk}>\n              OK\n            </Button>\n          </div>\n        </Col>\n      </Row>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}