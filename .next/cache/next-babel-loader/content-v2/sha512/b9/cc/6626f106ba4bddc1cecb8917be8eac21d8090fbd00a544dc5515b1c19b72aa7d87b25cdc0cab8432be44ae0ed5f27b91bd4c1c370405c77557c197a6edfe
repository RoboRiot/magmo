{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\index.js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport Head from \"next/head\";\nimport React, { useState, useEffect } from \"react\";\nimport { Button, Card, Container, Alert } from \"react-bootstrap\";\nimport styles from \"../styles/Home.module.css\";\nimport { useAuth } from \"../context/AuthUserContext\";\nimport { useRouter } from \"next/router\";\nimport firebase, { auth } from \"../context/Firebase\";\nexport default function Home() {\n  _s();\n\n  var _useState = useState(\"\"),\n      error = _useState[0],\n      setError = _useState[1]; // Prevent our main-useEffect from hijacking the test-login flow:\n\n\n  var _useState2 = useState(false),\n      isTestLogin = _useState2[0],\n      setIsTestLogin = _useState2[1];\n\n  var _useAuth = useAuth(),\n      authUser = _useAuth.authUser,\n      loading = _useAuth.loading,\n      signInWithGoogle = _useAuth.signInWithGoogle;\n\n  var router = useRouter();\n\n  var _useState3 = useState(false),\n      hasMounted = _useState3[0],\n      setHasMounted = _useState3[1]; // Ensure we are on the client side\n\n\n  useEffect(function () {\n    setHasMounted(true);\n  }, []); // Handle redirect result from Google Auth\n  // Handle redirect result from Google Auth (runs everywhere)\n\n  useEffect(function () {\n    if (hasMounted && !loading) {\n      auth.getRedirectResult().then(function (result) {\n        console.log(\"=== REDIRECT RESULT ===\");\n        console.log(\"Result:\", result);\n\n        if (result.credential) {\n          var destination = router.query.redirect || \"/NewSearch/mainSearch\";\n          console.log(\"User authenticated, redirecting to:\", destination);\n          router.replace(destination);\n        } else {\n          console.log(\"No credential found in redirect result\");\n        }\n      })[\"catch\"](function (error) {\n        console.error(\"Redirect result error:\", error);\n        setError(\"Authentication failed. Please try again.\");\n      });\n    }\n  }, [hasMounted, loading, router]); // If auth status is known and the user is already logged in, redirect them.\n\n  useEffect(function () {\n    if (isTestLogin) return; // ← skip for test login\n\n    if (hasMounted && !loading && authUser) {\n      var destination = router.query.redirect || \"/NewSearch/mainSearch\"; // use replace to avoid stacking multiple entries\n\n      router.replace(destination);\n    }\n  }, [isTestLogin, hasMounted, authUser, loading, router]);\n  if (!hasMounted) return null; // Prevent rendering until mounted\n  // Handle Google Sign-In\n\n  var handleGoogleSignIn = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              setError(\"\");\n              _context.prev = 1;\n              _context.next = 4;\n              return signInWithGoogle();\n\n            case 4:\n              _context.next = 9;\n              break;\n\n            case 6:\n              _context.prev = 6;\n              _context.t0 = _context[\"catch\"](1);\n              setError(\"Failed to log in with Google\");\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 6]]);\n    }));\n\n    return function handleGoogleSignIn() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleTestLogin = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var password;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setError(\"\");\n              setIsTestLogin(true);\n              password = prompt(\"Enter password:\");\n\n              if (password) {\n                _context2.next = 5;\n                break;\n              }\n\n              return _context2.abrupt(\"return\");\n\n            case 5:\n              _context2.prev = 5;\n              _context2.next = 8;\n              return firebase.auth().signInWithEmailAndPassword(\"test@test.com\", password);\n\n            case 8:\n              // now go to your custom test-search page:\n              router.replace(\"/NewSearch/searchTest\");\n              _context2.next = 14;\n              break;\n\n            case 11:\n              _context2.prev = 11;\n              _context2.t0 = _context2[\"catch\"](5);\n              setError(\"Test login failed: \" + _context2.t0.message);\n\n            case 14:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[5, 11]]);\n    }));\n\n    return function handleTestLogin() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 5\n    }\n  }, __jsx(Head, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }\n  }, __jsx(\"title\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }\n  }, \"magmo\"), __jsx(\"link\", {\n    rel: \"icon\",\n    href: \"/favicon.ico\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }), __jsx(\"meta\", {\n    name: \"viewport\",\n    content: \"width=device-width, initial-scale=1.0\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  })), __jsx(Container, {\n    className: \"d-flex align-items-center justify-content-center\",\n    style: {\n      minHeight: \"100vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"w-100\",\n    style: {\n      maxWidth: \"400px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 9\n    }\n  }, __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 11\n    }\n  }, __jsx(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }, __jsx(\"h2\", {\n    className: \"text-center mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 15\n    }\n  }, \"MAGMO\"), error && __jsx(Alert, {\n    variant: \"danger\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 25\n    }\n  }, error), __jsx(Button, {\n    variant: \"light\",\n    className: \"w-100 d-flex align-items-center justify-content-center\",\n    onClick: handleGoogleSignIn,\n    style: {\n      border: \"1px solid #dadce0\",\n      borderRadius: \"0.375rem\",\n      color: \"#757575\",\n      padding: \"0.5rem 1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 15\n    }\n  }, __jsx(\"img\", {\n    src: \"https://www.svgrepo.com/show/355037/google.svg\",\n    alt: \"Google logo\",\n    width: \"20\",\n    height: \"20\",\n    className: \"me-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 17\n    }\n  }), \"Sign in with Google\"), __jsx(Button, {\n    variant: \"secondary\",\n    className: \"w-100 mt-3\",\n    onClick: handleTestLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 15\n    }\n  }, \"Test Login\"))))));\n}\n\n_s(Home, \"HD9+8khGfUCcZTMlD/sUrCgzGew=\", false, function () {\n  return [useAuth, useRouter];\n});\n\n_c = Home;\n\nvar _c;\n\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/index.js"],"names":["Head","React","useState","useEffect","Button","Card","Container","Alert","styles","useAuth","useRouter","firebase","auth","Home","error","setError","isTestLogin","setIsTestLogin","authUser","loading","signInWithGoogle","router","hasMounted","setHasMounted","getRedirectResult","then","result","console","log","credential","destination","query","redirect","replace","handleGoogleSignIn","handleTestLogin","password","prompt","signInWithEmailAndPassword","message","container","minHeight","maxWidth","border","borderRadius","color","padding"],"mappings":";;;;;;;AAAA,OAAOA,IAAP,MAAiB,WAAjB;AACA,OAAOC,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,MAAT,EAAiBC,IAAjB,EAAuBC,SAAvB,EAAkCC,KAAlC,QAA+C,iBAA/C;AACA,OAAOC,MAAP,MAAmB,2BAAnB;AAEA,SAASC,OAAT,QAAwB,4BAAxB;AACA,SAASC,SAAT,QAA0B,aAA1B;AACA,OAAOC,QAAP,IAAmBC,IAAnB,QAA+B,qBAA/B;AAEA,eAAe,SAASC,IAAT,GAAgB;AAAA;;AAAA,kBACHX,QAAQ,CAAC,EAAD,CADL;AAAA,MACtBY,KADsB;AAAA,MACfC,QADe,iBAE7B;;;AAF6B,mBAGSb,QAAQ,CAAC,KAAD,CAHjB;AAAA,MAGtBc,WAHsB;AAAA,MAGTC,cAHS;;AAAA,iBAKmBR,OAAO,EAL1B;AAAA,MAKrBS,QALqB,YAKrBA,QALqB;AAAA,MAKXC,OALW,YAKXA,OALW;AAAA,MAKFC,gBALE,YAKFA,gBALE;;AAM7B,MAAMC,MAAM,GAAGX,SAAS,EAAxB;;AAN6B,mBAOOR,QAAQ,CAAC,KAAD,CAPf;AAAA,MAOtBoB,UAPsB;AAAA,MAOVC,aAPU,kBAS7B;;;AACApB,EAAAA,SAAS,CAAC,YAAM;AACdoB,IAAAA,aAAa,CAAC,IAAD,CAAb;AACD,GAFQ,EAEN,EAFM,CAAT,CAV6B,CAc7B;AACA;;AACApB,EAAAA,SAAS,CAAC,YAAM;AACd,QAAImB,UAAU,IAAI,CAACH,OAAnB,EAA4B;AAC1BP,MAAAA,IAAI,CACDY,iBADH,GAEGC,IAFH,CAEQ,UAACC,MAAD,EAAY;AAChBC,QAAAA,OAAO,CAACC,GAAR,CAAY,yBAAZ;AACAD,QAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ,EAAuBF,MAAvB;;AACA,YAAIA,MAAM,CAACG,UAAX,EAAuB;AACrB,cAAMC,WAAW,GAAGT,MAAM,CAACU,KAAP,CAAaC,QAAb,IAAyB,uBAA7C;AACAL,UAAAA,OAAO,CAACC,GAAR,CAAY,qCAAZ,EAAmDE,WAAnD;AACAT,UAAAA,MAAM,CAACY,OAAP,CAAeH,WAAf;AACD,SAJD,MAIO;AACLH,UAAAA,OAAO,CAACC,GAAR,CAAY,wCAAZ;AACD;AACF,OAZH,WAaS,UAACd,KAAD,EAAW;AAChBa,QAAAA,OAAO,CAACb,KAAR,CAAc,wBAAd,EAAwCA,KAAxC;AACAC,QAAAA,QAAQ,CAAC,0CAAD,CAAR;AACD,OAhBH;AAiBD;AACF,GApBQ,EAoBN,CAACO,UAAD,EAAaH,OAAb,EAAsBE,MAAtB,CApBM,CAAT,CAhB6B,CAuC7B;;AACAlB,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIa,WAAJ,EAAiB,OADH,CACW;;AACzB,QAAIM,UAAU,IAAI,CAACH,OAAf,IAA0BD,QAA9B,EAAwC;AACtC,UAAMY,WAAW,GAAGT,MAAM,CAACU,KAAP,CAAaC,QAAb,IAAyB,uBAA7C,CADsC,CAE1C;;AACIX,MAAAA,MAAM,CAACY,OAAP,CAAeH,WAAf;AACD;AACF,GAPQ,EAON,CAACd,WAAD,EAAcM,UAAd,EAA0BJ,QAA1B,EAAoCC,OAApC,EAA6CE,MAA7C,CAPM,CAAT;AASA,MAAI,CAACC,UAAL,EAAiB,OAAO,IAAP,CAjDY,CAiDC;AAE9B;;AACA,MAAMY,kBAAkB;AAAA,wEAAG;AAAA;AAAA;AAAA;AAAA;AACzBnB,cAAAA,QAAQ,CAAC,EAAD,CAAR;AADyB;AAAA;AAAA,qBAGjBK,gBAAgB,EAHC;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAOvBL,cAAAA,QAAQ,CAAC,8BAAD,CAAR;;AAPuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAlBmB,kBAAkB;AAAA;AAAA;AAAA,KAAxB;;AAWA,MAAMC,eAAe;AAAA,yEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AACtBpB,cAAAA,QAAQ,CAAC,EAAD,CAAR;AACAE,cAAAA,cAAc,CAAC,IAAD,CAAd;AACMmB,cAAAA,QAHgB,GAGLC,MAAM,CAAC,iBAAD,CAHD;;AAAA,kBAIjBD,QAJiB;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;AAAA;AAAA,qBAOdzB,QAAQ,CACXC,IADG,GAEH0B,0BAFG,CAEwB,eAFxB,EAEyCF,QAFzC,CAPc;;AAAA;AAUpB;AACAf,cAAAA,MAAM,CAACY,OAAP,CAAe,uBAAf;AAXoB;AAAA;;AAAA;AAAA;AAAA;AAapBlB,cAAAA,QAAQ,CAAC,wBAAwB,aAAIwB,OAA7B,CAAR;;AAboB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAfJ,eAAe;AAAA;AAAA;AAAA,KAArB;;AAiBA,SACE;AAAK,IAAA,SAAS,EAAE3B,MAAM,CAACgC,SAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,EAEE;AAAM,IAAA,GAAG,EAAC,MAAV;AAAiB,IAAA,IAAI,EAAC,cAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFF,EAGE;AAAM,IAAA,IAAI,EAAC,UAAX;AAAsB,IAAA,OAAO,EAAC,uCAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAHF,CADF,EAOE,MAAC,SAAD;AACE,IAAA,SAAS,EAAC,kDADZ;AAEE,IAAA,KAAK,EAAE;AAAEC,MAAAA,SAAS,EAAE;AAAb,KAFT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAIE;AAAK,IAAA,SAAS,EAAC,OAAf;AAAuB,IAAA,KAAK,EAAE;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE,MAAC,IAAD,CAAM,IAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACE;AAAI,IAAA,SAAS,EAAC,kBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,EAEG5B,KAAK,IAAI,MAAC,KAAD;AAAO,IAAA,OAAO,EAAC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAyBA,KAAzB,CAFZ,EAGE,MAAC,MAAD;AACE,IAAA,OAAO,EAAC,OADV;AAEE,IAAA,SAAS,EAAC,wDAFZ;AAGE,IAAA,OAAO,EAAEoB,kBAHX;AAIE,IAAA,KAAK,EAAE;AACLS,MAAAA,MAAM,EAAE,mBADH;AAELC,MAAAA,YAAY,EAAE,UAFT;AAGLC,MAAAA,KAAK,EAAE,SAHF;AAILC,MAAAA,OAAO,EAAE;AAJJ,KAJT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAWE;AACE,IAAA,GAAG,EAAC,gDADN;AAEE,IAAA,GAAG,EAAC,aAFN;AAGE,IAAA,KAAK,EAAC,IAHR;AAIE,IAAA,MAAM,EAAC,IAJT;AAKE,IAAA,SAAS,EAAC,MALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAXF,wBAHF,EAwBE,MAAC,MAAD;AACE,IAAA,OAAO,EAAC,WADV;AAEE,IAAA,SAAS,EAAC,YAFZ;AAGE,IAAA,OAAO,EAAEX,eAHX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAxBF,CADF,CADF,CAJF,CAPF,CADF;AAmDD;;GAnIuBtB,I;UAK0BJ,O,EACjCC,S;;;KANOG,I","sourcesContent":["import Head from \"next/head\";\nimport React, { useState, useEffect } from \"react\";\nimport { Button, Card, Container, Alert } from \"react-bootstrap\";\nimport styles from \"../styles/Home.module.css\";\n\nimport { useAuth } from \"../context/AuthUserContext\";\nimport { useRouter } from \"next/router\";\nimport firebase, { auth } from \"../context/Firebase\";\n\nexport default function Home() {\n  const [error, setError] = useState(\"\");\n  // Prevent our main-useEffect from hijacking the test-login flow:\n  const [isTestLogin, setIsTestLogin] = useState(false);\n\n  const { authUser, loading, signInWithGoogle } = useAuth();\n  const router = useRouter();\n  const [hasMounted, setHasMounted] = useState(false);\n\n  // Ensure we are on the client side\n  useEffect(() => {\n    setHasMounted(true);\n  }, []);\n\n  // Handle redirect result from Google Auth\n  // Handle redirect result from Google Auth (runs everywhere)\n  useEffect(() => {\n    if (hasMounted && !loading) {\n      auth\n        .getRedirectResult()\n        .then((result) => {\n          console.log(\"=== REDIRECT RESULT ===\");\n          console.log(\"Result:\", result);\n          if (result.credential) {\n            const destination = router.query.redirect || \"/NewSearch/mainSearch\";\n            console.log(\"User authenticated, redirecting to:\", destination);\n            router.replace(destination);\n          } else {\n            console.log(\"No credential found in redirect result\");\n          }\n        })\n        .catch((error) => {\n          console.error(\"Redirect result error:\", error);\n          setError(\"Authentication failed. Please try again.\");\n        });\n    }\n  }, [hasMounted, loading, router]);\n\n\n  // If auth status is known and the user is already logged in, redirect them.\n  useEffect(() => {\n    if (isTestLogin) return; // ← skip for test login\n    if (hasMounted && !loading && authUser) {\n      const destination = router.query.redirect || \"/NewSearch/mainSearch\";\n  // use replace to avoid stacking multiple entries\n      router.replace(destination);\n    }\n  }, [isTestLogin, hasMounted, authUser, loading, router]);\n\n  if (!hasMounted) return null; // Prevent rendering until mounted\n\n  // Handle Google Sign-In\n  const handleGoogleSignIn = async () => {\n    setError(\"\");\n    try {\n      await signInWithGoogle();\n      // Note: With redirect, the user will be redirected to Google and then back to this page\n      // The redirect result will be handled in the useEffect above\n    } catch (err) {\n      setError(\"Failed to log in with Google\");\n    }\n  };\n\n  const handleTestLogin = async () => {\n    setError(\"\");\n    setIsTestLogin(true);\n    const password = prompt(\"Enter password:\");\n    if (!password) return;\n\n    try {\n      await firebase\n        .auth()\n        .signInWithEmailAndPassword(\"test@test.com\", password);\n      // now go to your custom test-search page:\n      router.replace(\"/NewSearch/searchTest\");\n    } catch (err) {\n      setError(\"Test login failed: \" + err.message);\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      <Head>\n        <title>magmo</title>\n        <link rel=\"icon\" href=\"/favicon.ico\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n      </Head>\n\n      <Container\n        className=\"d-flex align-items-center justify-content-center\"\n        style={{ minHeight: \"100vh\" }}\n      >\n        <div className=\"w-100\" style={{ maxWidth: \"400px\" }}>\n          <Card>\n            <Card.Body>\n              <h2 className=\"text-center mb-4\">MAGMO</h2>\n              {error && <Alert variant=\"danger\">{error}</Alert>}\n              <Button\n                variant=\"light\"\n                className=\"w-100 d-flex align-items-center justify-content-center\"\n                onClick={handleGoogleSignIn}\n                style={{\n                  border: \"1px solid #dadce0\",\n                  borderRadius: \"0.375rem\",\n                  color: \"#757575\",\n                  padding: \"0.5rem 1rem\",\n                }}\n              >\n                <img\n                  src=\"https://www.svgrepo.com/show/355037/google.svg\"\n                  alt=\"Google logo\"\n                  width=\"20\"\n                  height=\"20\"\n                  className=\"me-2\"\n                />\n                Sign in with Google\n              </Button>\n\n              <Button\n                variant=\"secondary\"\n                className=\"w-100 mt-3\"\n                onClick={handleTestLogin}\n              >\n                Test Login\n              </Button>\n            </Card.Body>\n          </Card>\n        </div>\n      </Container>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}