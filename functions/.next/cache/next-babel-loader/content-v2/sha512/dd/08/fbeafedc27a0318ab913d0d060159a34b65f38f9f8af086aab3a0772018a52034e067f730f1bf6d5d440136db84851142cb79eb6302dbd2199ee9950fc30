{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _toConsumableArray from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"C:/Users/mack2/Desktop/code/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\NewSearch\\\\AddItem\\\\parentModal.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useEffect, useState, useCallback } from \"react\";\nimport { Modal, InputGroup, Dropdown, FormControl, Button, NavDropdown, Form, Table, Pagination } from \"react-bootstrap\";\nimport { fetchPartsWithMachineDataPage, fetchClients, fetchModels, formatDate } from \"../../../utils/fetchAssociations\";\nimport ClientTable from \"../../../utils/ClientTable\";\nimport ModelTable from \"../../../utils/ModelTable\";\nimport styles from \"./ParentModal.module.css\";\nvar CLIENT_WAREHOUSE = \"igor-house\";\nvar CLIENT_UNASSIGNED = \"unassigned\";\nvar PAGE_SIZE = 20;\n\nvar ParentModal = function ParentModal(_ref) {\n  _s();\n\n  var show = _ref.show,\n      handleClose = _ref.handleClose,\n      setSelectedParent = _ref.setSelectedParent;\n\n  var _useState = useState([]),\n      info = _useState[0],\n      setInfo = _useState[1];\n\n  var _useState2 = useState(false),\n      isLoading = _useState2[0],\n      setIsLoading = _useState2[1];\n\n  var _useState3 = useState(1),\n      page = _useState3[0],\n      setPage = _useState3[1];\n\n  var _useState4 = useState([]),\n      pageCursors = _useState4[0],\n      setPageCursors = _useState4[1];\n\n  var _useState5 = useState(false),\n      hasNextPage = _useState5[0],\n      setHasNextPage = _useState5[1];\n\n  var _useState6 = useState(0),\n      queryEpoch = _useState6[0],\n      setQueryEpoch = _useState6[1];\n\n  var _useState7 = useState(null),\n      loadError = _useState7[0],\n      setLoadError = _useState7[1];\n\n  var _useState8 = useState(\"\"),\n      search = _useState8[0],\n      setSearch = _useState8[1];\n\n  var _useState9 = useState(\"Name\"),\n      select = _useState9[0],\n      setSelect = _useState9[1];\n\n  var _useState10 = useState(false),\n      showList = _useState10[0],\n      setShowList = _useState10[1];\n\n  var _useState11 = useState(\"text\"),\n      showListSearch = _useState11[0],\n      setShowListSearch = _useState11[1];\n\n  var _useState12 = useState(null),\n      selectedOEM = _useState12[0],\n      setSelectedOEM = _useState12[1];\n\n  var _useState13 = useState(null),\n      selectedModality = _useState13[0],\n      setSelectedModality = _useState13[1];\n\n  var _useState14 = useState(null),\n      selectedClient = _useState14[0],\n      setSelectedClient = _useState14[1];\n\n  var _useState15 = useState([]),\n      clients = _useState15[0],\n      setClients = _useState15[1];\n\n  var _useState16 = useState(false),\n      showClientModal = _useState16[0],\n      setShowClientModal = _useState16[1];\n\n  var _useState17 = useState(\"Select Option\"),\n      clientButtonText = _useState17[0],\n      setClientButtonText = _useState17[1];\n\n  var _useState18 = useState(null),\n      selectedModel = _useState18[0],\n      setSelectedModel = _useState18[1];\n\n  var _useState19 = useState([]),\n      models = _useState19[0],\n      setModels = _useState19[1];\n\n  var _useState20 = useState(false),\n      showModelModal = _useState20[0],\n      setShowModelModal = _useState20[1];\n\n  var _useState21 = useState(\"Select Option\"),\n      modelButtonText = _useState21[0],\n      setModelButtonText = _useState21[1];\n\n  var _useState22 = useState(\"\"),\n      clientSearchTerm = _useState22[0],\n      setClientSearchTerm = _useState22[1];\n\n  var _useState23 = useState(\"\"),\n      modelSearchTerm = _useState23[0],\n      setModelSearchTerm = _useState23[1];\n\n  var normalizeText = function normalizeText(value) {\n    if (value == null) return \"\";\n    return String(value).toLowerCase().trim();\n  };\n\n  var fieldMatchesSelection = function fieldMatchesSelection(value, selected) {\n    if (!selected) return true;\n\n    if (Array.isArray(value)) {\n      return value.some(function (entry) {\n        return fieldMatchesSelection(entry, selected);\n      });\n    }\n\n    return normalizeText(value) === normalizeText(selected);\n  };\n\n  var getMachineField = function getMachineField(item, key) {\n    var _ref2, _ref3, _ref4, _ref5, _ref6, _item$machineData$key, _item$machineData, _item$machineData2, _key$toLowerCase, _item$currentMachineD, _item$currentMachineD2, _key$toLowerCase2, _item$TheMachine, _item$TheMachine2, _key$toLowerCase3;\n\n    if (!item) return null;\n    return (_ref2 = (_ref3 = (_ref4 = (_ref5 = (_ref6 = (_item$machineData$key = item === null || item === void 0 ? void 0 : (_item$machineData = item.machineData) === null || _item$machineData === void 0 ? void 0 : _item$machineData[key]) !== null && _item$machineData$key !== void 0 ? _item$machineData$key : item === null || item === void 0 ? void 0 : (_item$machineData2 = item.machineData) === null || _item$machineData2 === void 0 ? void 0 : _item$machineData2[key === null || key === void 0 ? void 0 : (_key$toLowerCase = key.toLowerCase) === null || _key$toLowerCase === void 0 ? void 0 : _key$toLowerCase.call(key)]) !== null && _ref6 !== void 0 ? _ref6 : item === null || item === void 0 ? void 0 : (_item$currentMachineD = item.currentMachineData) === null || _item$currentMachineD === void 0 ? void 0 : _item$currentMachineD[key]) !== null && _ref5 !== void 0 ? _ref5 : item === null || item === void 0 ? void 0 : (_item$currentMachineD2 = item.currentMachineData) === null || _item$currentMachineD2 === void 0 ? void 0 : _item$currentMachineD2[key === null || key === void 0 ? void 0 : (_key$toLowerCase2 = key.toLowerCase) === null || _key$toLowerCase2 === void 0 ? void 0 : _key$toLowerCase2.call(key)]) !== null && _ref4 !== void 0 ? _ref4 : item === null || item === void 0 ? void 0 : (_item$TheMachine = item.TheMachine) === null || _item$TheMachine === void 0 ? void 0 : _item$TheMachine[key]) !== null && _ref3 !== void 0 ? _ref3 : item === null || item === void 0 ? void 0 : (_item$TheMachine2 = item.TheMachine) === null || _item$TheMachine2 === void 0 ? void 0 : _item$TheMachine2[key === null || key === void 0 ? void 0 : (_key$toLowerCase3 = key.toLowerCase) === null || _key$toLowerCase3 === void 0 ? void 0 : _key$toLowerCase3.call(key)]) !== null && _ref2 !== void 0 ? _ref2 : null;\n  };\n\n  var resetPagination = function resetPagination() {\n    setPage(1);\n    setPageCursors([]);\n    setHasNextPage(false);\n  };\n\n  var searchChangeHandler = function searchChangeHandler(event) {\n    return setSearch(event.target.value);\n  };\n\n  var matchesFilters = useCallback(function (item) {\n    if (!item) return false;\n\n    if (selectedOEM) {\n      var OEM = getMachineField(item, \"OEM\");\n      if (!fieldMatchesSelection(OEM, selectedOEM)) return false;\n    }\n\n    if (selectedModality) {\n      var Modality = getMachineField(item, \"Modality\");\n      if (!fieldMatchesSelection(Modality, selectedModality)) return false;\n    }\n\n    if (selectedModel) {\n      var Model = getMachineField(item, \"Model\");\n      if (!fieldMatchesSelection(Model, selectedModel)) return false;\n    }\n\n    if (selectedClient) {\n      var clientRef = getMachineField(item, \"client\");\n      var clientId = typeof clientRef === \"string\" ? clientRef : (clientRef === null || clientRef === void 0 ? void 0 : clientRef.id) || null;\n      if (clientId !== selectedClient) return false;\n    }\n\n    return true;\n  }, [selectedOEM, selectedModality, selectedModel, selectedClient]);\n  var fetchData = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var requestedPage,\n        startAfterDoc,\n        searchLower,\n        _yield$fetchPartsWith,\n        data,\n        lastDoc,\n        nextPage,\n        _args = arguments;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            requestedPage = _args.length > 0 && _args[0] !== undefined ? _args[0] : 1;\n\n            if (show) {\n              _context.next = 3;\n              break;\n            }\n\n            return _context.abrupt(\"return\");\n\n          case 3:\n            startAfterDoc = requestedPage > 1 ? pageCursors[requestedPage - 2] : null;\n\n            if (!(requestedPage > 1 && !startAfterDoc)) {\n              _context.next = 7;\n              break;\n            }\n\n            setPage(1);\n            return _context.abrupt(\"return\");\n\n          case 7:\n            setIsLoading(true);\n            setLoadError(null);\n            searchLower = (search || \"\").toLowerCase().trim();\n            _context.prev = 10;\n            _context.next = 13;\n            return fetchPartsWithMachineDataPage({\n              pageSize: PAGE_SIZE,\n              startAfterDoc: startAfterDoc,\n              visibleOnly: true,\n              filterFn: selectedOEM || selectedModality || selectedModel || selectedClient ? matchesFilters : null,\n              search: searchLower ? {\n                type: select,\n                raw: search,\n                lower: searchLower\n              } : null,\n              needsMachineData: Boolean(selectedOEM) || Boolean(selectedModality) || Boolean(selectedModel) || Boolean(selectedClient)\n            });\n\n          case 13:\n            _yield$fetchPartsWith = _context.sent;\n            data = _yield$fetchPartsWith.parts;\n            lastDoc = _yield$fetchPartsWith.lastDoc;\n            nextPage = _yield$fetchPartsWith.hasNextPage;\n            setInfo(data);\n            setHasNextPage(nextPage);\n            setPageCursors(function (prev) {\n              var next = requestedPage === 1 ? [] : _toConsumableArray(prev);\n\n              if (lastDoc) {\n                next[requestedPage - 1] = lastDoc;\n              }\n\n              return next;\n            });\n            _context.next = 27;\n            break;\n\n          case 22:\n            _context.prev = 22;\n            _context.t0 = _context[\"catch\"](10);\n            console.error(\"Parent modal load failed:\", _context.t0);\n            setLoadError((_context.t0 === null || _context.t0 === void 0 ? void 0 : _context.t0.message) || \"Failed to load items.\");\n            setInfo([]);\n\n          case 27:\n            _context.prev = 27;\n            setIsLoading(false);\n            return _context.finish(27);\n\n          case 30:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[10, 22, 27, 30]]);\n  })), [show, pageCursors, search, select, selectedOEM, selectedModality, selectedModel, selectedClient, matchesFilters]);\n  useEffect(function () {\n    if (!show) return;\n    resetPagination();\n    setQueryEpoch(function (v) {\n      return v + 1;\n    });\n  }, [show, selectedOEM, selectedModality, selectedModel, selectedClient, search, select]);\n  useEffect(function () {\n    if (!show) return;\n    fetchData(page);\n  }, [show, page, queryEpoch, fetchData]);\n\n  var rowSelect = function rowSelect(item) {\n    setSelectedParent({\n      id: item.id,\n      name: item.name,\n      pn: item.pn\n    });\n    handleClose();\n  };\n\n  var _useState24 = useState(\"Select Option\"),\n      dropdown1Text = _useState24[0],\n      setDropdown1Text = _useState24[1];\n\n  var _useState25 = useState(\"Select Option\"),\n      dropdown2Text = _useState25[0],\n      setDropdown2Text = _useState25[1];\n\n  var handleSelect1 = function handleSelect1(eventKey, event) {\n    if (eventKey === \"unassigned\") {\n      setDropdown1Text(\"Select Option\");\n      setSelectedOEM(null);\n    } else {\n      setDropdown1Text(event.target.textContent);\n      setSelectedOEM(event.target.textContent);\n    }\n  };\n\n  var handleSelect2 = function handleSelect2(eventKey, event) {\n    if (eventKey === \"unassigned\") {\n      setDropdown2Text(\"Select Option\");\n      setSelectedModality(null);\n    } else {\n      setDropdown2Text(event.target.textContent);\n      setSelectedModality(event.target.textContent);\n    }\n  };\n\n  var handleClientClick = /*#__PURE__*/function () {\n    var _ref8 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var clientsData;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetchClients(selectedOEM, selectedModality);\n\n            case 2:\n              clientsData = _context2.sent;\n              setClients(clientsData);\n              setClientSearchTerm(\"\");\n              setShowClientModal(true);\n\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function handleClientClick() {\n      return _ref8.apply(this, arguments);\n    };\n  }();\n\n  var handleClientSelect = function handleClientSelect(clientId) {\n    if (!clientId) {\n      setClientButtonText(\"Select Option\");\n      setSelectedClient(null);\n      setShowClientModal(false);\n      return;\n    }\n\n    var client = clients.find(function (c) {\n      return c.id === clientId;\n    });\n    setClientButtonText((client === null || client === void 0 ? void 0 : client.name) || \"Select Option\");\n    setSelectedClient(clientId);\n    setShowClientModal(false);\n  };\n\n  var handleClientInfo = function handleClientInfo(clientId, clientName) {\n    console.log(\"Client ID: \".concat(clientId, \", Client Name: \").concat(clientName));\n  };\n\n  var handleClearClientSelection = function handleClearClientSelection() {\n    setClientButtonText(\"Select Option\");\n    setSelectedClient(null);\n    setShowClientModal(false);\n  };\n\n  var handleModelClick = /*#__PURE__*/function () {\n    var _ref9 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n      var modelsData;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return fetchModels(selectedOEM, selectedModality, selectedClient);\n\n            case 2:\n              modelsData = _context3.sent;\n              setModels(modelsData);\n              setModelSearchTerm(\"\");\n              setShowModelModal(true);\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleModelClick() {\n      return _ref9.apply(this, arguments);\n    };\n  }();\n\n  var handleModelSelect = function handleModelSelect(modelName) {\n    setModelButtonText(modelName || \"Select Option\");\n    setSelectedModel(modelName || null);\n    setShowModelModal(false);\n  };\n\n  var handleClearModelSelection = function handleClearModelSelection() {\n    setModelButtonText(\"Select Option\");\n    setSelectedModel(null);\n    setShowModelModal(false);\n  };\n\n  var handleWarehouseClick = function handleWarehouseClick() {\n    setClientButtonText(CLIENT_WAREHOUSE);\n    setSelectedClient(CLIENT_WAREHOUSE);\n  };\n\n  var handleUnassignedClick = function handleUnassignedClick() {\n    setClientButtonText(CLIENT_UNASSIGNED);\n    setSelectedClient(CLIENT_UNASSIGNED);\n  };\n\n  var totalKnownPages = Math.max(1, pageCursors.filter(Boolean).length + (hasNextPage ? 1 : 0));\n\n  var pageButtons = function () {\n    var buttons = [];\n    var maxVisible = 6;\n\n    var pushPage = function pushPage(p) {\n      return buttons.push(__jsx(Pagination.Item, {\n        key: \"page-\".concat(p),\n        active: p === page,\n        onClick: function onClick() {\n          return setPage(p);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 292,\n          columnNumber: 9\n        }\n      }, p));\n    };\n\n    var pushEllipsis = function pushEllipsis(key) {\n      return buttons.push(__jsx(Pagination.Ellipsis, {\n        key: key,\n        disabled: true,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 20\n        }\n      }));\n    };\n\n    if (totalKnownPages <= maxVisible) {\n      for (var i = 1; i <= totalKnownPages; i += 1) {\n        pushPage(i);\n      }\n\n      return buttons;\n    }\n\n    var start = Math.max(2, page - 1);\n    var end = Math.min(totalKnownPages - 1, page + 1);\n    var desiredWindow = maxVisible - 2;\n    var currentWindow = end - start + 1;\n    var remaining = desiredWindow - currentWindow;\n\n    while (remaining > 0) {\n      if (start > 2) {\n        start -= 1;\n        remaining -= 1;\n      }\n\n      if (remaining > 0 && end < totalKnownPages - 1) {\n        end += 1;\n        remaining -= 1;\n      }\n\n      if (start === 2 && end === totalKnownPages - 1) break;\n    }\n\n    pushPage(1);\n    if (start > 2) pushEllipsis(\"start-ellipsis\");\n\n    for (var _i = start; _i <= end; _i += 1) {\n      pushPage(_i);\n    }\n\n    if (end < totalKnownPages - 1) pushEllipsis(\"end-ellipsis\");\n    pushPage(totalKnownPages);\n    if (hasNextPage) pushEllipsis(\"more-ellipsis\");\n    return buttons;\n  }();\n\n  return __jsx(Modal, {\n    show: show,\n    onHide: handleClose,\n    size: \"xl\",\n    centered: true,\n    dialogClassName: styles.modalDialog,\n    contentClassName: styles.modalContent,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 5\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    className: styles.modalHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: styles.modalTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 348,\n      columnNumber: 11\n    }\n  }, \"Select Parent\"), __jsx(\"div\", {\n    className: styles.modalSubtitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 11\n    }\n  }, \"Search and choose a parent item for this part.\"))), __jsx(Modal.Body, {\n    className: styles.modalBody,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: styles.modalGrid,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 9\n    }\n  }, __jsx(\"aside\", {\n    className: styles.filtersPanel,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 356,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: styles.panelTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 13\n    }\n  }, \"Filters\"), __jsx(\"div\", {\n    className: styles.panelHint,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 13\n    }\n  }, \"Narrow results with machine and client filters.\"), __jsx(InputGroup, {\n    className: styles.inputGroup,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 361,\n      columnNumber: 13\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 362,\n      columnNumber: 15\n    }\n  }, \"OEM\"), __jsx(Dropdown, {\n    onSelect: handleSelect1,\n    className: \"w-100\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 363,\n      columnNumber: 15\n    }\n  }, __jsx(Dropdown.Toggle, {\n    variant: \"outline-secondary\",\n    id: \"dropdown-button-1\",\n    className: \"w-100\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 364,\n      columnNumber: 17\n    }\n  }, dropdown1Text), __jsx(Dropdown.Menu, {\n    className: \"w-100\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 371,\n      columnNumber: 17\n    }\n  }, __jsx(Dropdown.Item, {\n    eventKey: \"unassigned\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 19\n    }\n  }, \"Select Option\"), __jsx(Dropdown.Item, {\n    eventKey: \"GE\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 19\n    }\n  }, \"GE\"), __jsx(Dropdown.Item, {\n    eventKey: \"Toshiba\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 376,\n      columnNumber: 19\n    }\n  }, \"Toshiba\"), __jsx(Dropdown.Item, {\n    eventKey: \"Siemens\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 19\n    }\n  }, \"Siemens\"), __jsx(Dropdown.Item, {\n    eventKey: \"Philips\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 378,\n      columnNumber: 19\n    }\n  }, \"Philips\")))), __jsx(InputGroup, {\n    className: styles.inputGroup,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 383,\n      columnNumber: 13\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 384,\n      columnNumber: 15\n    }\n  }, \"Modality\"), __jsx(Dropdown, {\n    onSelect: handleSelect2,\n    className: \"w-100\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 385,\n      columnNumber: 15\n    }\n  }, __jsx(Dropdown.Toggle, {\n    variant: \"outline-secondary\",\n    id: \"dropdown-button-2\",\n    className: \"w-100\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 386,\n      columnNumber: 17\n    }\n  }, dropdown2Text), __jsx(Dropdown.Menu, {\n    className: \"w-100\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 17\n    }\n  }, __jsx(Dropdown.Item, {\n    eventKey: \"unassigned\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 19\n    }\n  }, \"Select Option\"), __jsx(Dropdown.Item, {\n    eventKey: \"CT\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 19\n    }\n  }, \"CT\"), __jsx(Dropdown.Item, {\n    eventKey: \"MRI\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 398,\n      columnNumber: 19\n    }\n  }, \"MRI\")))), __jsx(InputGroup, {\n    className: styles.inputGroup,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 13\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 15\n    }\n  }, \"Client\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: handleClientClick,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 405,\n      columnNumber: 15\n    }\n  }, clientButtonText)), __jsx(InputGroup, {\n    className: styles.inputGroup,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 13\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 415,\n      columnNumber: 15\n    }\n  }, \"Model\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: handleModelClick,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 416,\n      columnNumber: 15\n    }\n  }, modelButtonText)), __jsx(\"div\", {\n    className: styles.panelDivider,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 425,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: styles.panelTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 13\n    }\n  }, \"Quick\"), __jsx(\"div\", {\n    className: styles.quickButtons,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 427,\n      columnNumber: 13\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.quickButton,\n    onClick: handleWarehouseClick,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 428,\n      columnNumber: 15\n    }\n  }, \"Warehouse\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.quickButton,\n    onClick: handleUnassignedClick,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 435,\n      columnNumber: 15\n    }\n  }, \"Unassigned\"))), __jsx(\"section\", {\n    className: styles.resultsPanel,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 445,\n      columnNumber: 11\n    }\n  }, __jsx(\"div\", {\n    className: styles.resultsHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 446,\n      columnNumber: 13\n    }\n  }, __jsx(\"div\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 447,\n      columnNumber: 15\n    }\n  }, __jsx(\"div\", {\n    className: styles.resultsTitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 17\n    }\n  }, \"Results\"), __jsx(\"div\", {\n    className: styles.resultsSubtitle,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 449,\n      columnNumber: 17\n    }\n  }, isLoading ? \"Loading items\" : \"\".concat(info.length, \" items\"))), __jsx(Pagination, {\n    size: \"sm\",\n    className: styles.pagination,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 453,\n      columnNumber: 15\n    }\n  }, __jsx(Pagination.Prev, {\n    onClick: function onClick() {\n      return setPage(function (p) {\n        return Math.max(1, p - 1);\n      });\n    },\n    disabled: page <= 1,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 454,\n      columnNumber: 17\n    }\n  }), pageButtons, __jsx(Pagination.Next, {\n    onClick: function onClick() {\n      return setPage(function (p) {\n        return p + 1;\n      });\n    },\n    disabled: !hasNextPage,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 459,\n      columnNumber: 17\n    }\n  }))), __jsx(\"div\", {\n    className: styles.searchRow,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 13\n    }\n  }, __jsx(FormControl, {\n    type: showListSearch,\n    placeholder: \"Search\",\n    className: styles.searchInput,\n    \"aria-label\": \"Search\",\n    value: search,\n    onChange: searchChangeHandler,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 467,\n      columnNumber: 15\n    }\n  }), __jsx(NavDropdown, {\n    title: select,\n    id: \"parent-search-dropdown\",\n    show: showList,\n    onMouseEnter: function onMouseEnter() {\n      return setShowList(true);\n    },\n    onMouseLeave: function onMouseLeave() {\n      return setShowList(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 475,\n      columnNumber: 15\n    }\n  }, __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Name\");\n      setShowListSearch(\"text\");\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 482,\n      columnNumber: 17\n    }\n  }, \"Name\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Date\");\n      setShowListSearch(\"date\");\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 490,\n      columnNumber: 17\n    }\n  }, \"Date\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Work Order\");\n      setShowListSearch(\"text\");\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 498,\n      columnNumber: 17\n    }\n  }, \"Work Order\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Product Number\");\n      setShowListSearch(\"text\");\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 506,\n      columnNumber: 17\n    }\n  }, \"Product Number\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Serial Number\");\n      setShowListSearch(\"text\");\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 514,\n      columnNumber: 17\n    }\n  }, \"Serial Number\"), __jsx(NavDropdown.Item, {\n    onClick: function onClick() {\n      setSelect(\"Description\");\n      setShowListSearch(\"text\");\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 522,\n      columnNumber: 17\n    }\n  }, \"Description\"))), __jsx(\"div\", {\n    className: styles.tableWrap,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 533,\n      columnNumber: 13\n    }\n  }, isLoading ? __jsx(\"div\", {\n    className: styles.loadingState,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 535,\n      columnNumber: 17\n    }\n  }, __jsx(\"img\", {\n    src: \"/magmo-logo.png\",\n    alt: \"Loading\",\n    className: styles.loadingLogo,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 536,\n      columnNumber: 19\n    }\n  })) : loadError ? __jsx(\"div\", {\n    className: styles.errorState,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 543,\n      columnNumber: 17\n    }\n  }, loadError) : __jsx(Table, {\n    striped: true,\n    bordered: true,\n    hover: true,\n    size: \"sm\",\n    className: styles.table,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 545,\n      columnNumber: 17\n    }\n  }, __jsx(\"thead\", {\n    className: styles.stickyHeader,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 546,\n      columnNumber: 19\n    }\n  }, __jsx(\"tr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 547,\n      columnNumber: 21\n    }\n  }, __jsx(\"th\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 548,\n      columnNumber: 23\n    }\n  }, \"Name\"), __jsx(\"th\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 549,\n      columnNumber: 23\n    }\n  }, \"Date\"), __jsx(\"th\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 550,\n      columnNumber: 23\n    }\n  }, \"Work Order\"), __jsx(\"th\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 551,\n      columnNumber: 23\n    }\n  }, \"Product Number\"), __jsx(\"th\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 552,\n      columnNumber: 23\n    }\n  }, \"Serial Number\"), __jsx(\"th\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 23\n    }\n  }, \"Select\"))), __jsx(\"tbody\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 556,\n      columnNumber: 19\n    }\n  }, info.length === 0 && __jsx(\"tr\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 558,\n      columnNumber: 23\n    }\n  }, __jsx(\"td\", {\n    colSpan: 6,\n    className: styles.emptyState,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 559,\n      columnNumber: 25\n    }\n  }, \"No items found.\")), info.map(function (item) {\n    return __jsx(\"tr\", {\n      key: item.id,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 565,\n        columnNumber: 23\n      }\n    }, __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 566,\n        columnNumber: 25\n      }\n    }, item.name), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 567,\n        columnNumber: 25\n      }\n    }, formatDate(item.date)), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 568,\n        columnNumber: 25\n      }\n    }, item.workOrders && item.workOrders.length > 0 ? item.workOrders[item.workOrders.length - 1].workOrder : \"N/A\"), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 574,\n        columnNumber: 25\n      }\n    }, item.pn), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 575,\n        columnNumber: 25\n      }\n    }, item.sn), __jsx(\"td\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 576,\n        columnNumber: 25\n      }\n    }, __jsx(Button, {\n      variant: \"primary\",\n      size: \"sm\",\n      onClick: function onClick() {\n        return rowSelect(item);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 27\n      }\n    }, \"Select\")));\n  }))))))), __jsx(Modal.Footer, {\n    className: styles.modalFooter,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 594,\n      columnNumber: 7\n    }\n  }, __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleClose,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 595,\n      columnNumber: 9\n    }\n  }, \"Cancel\"), __jsx(Button, {\n    variant: \"warning\",\n    onClick: function onClick() {\n      setSelectedParent(null);\n      handleClose();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 598,\n      columnNumber: 9\n    }\n  }, \"Clear Selection\")), __jsx(Modal, {\n    show: showClientModal,\n    onHide: function onHide() {\n      return setShowClientModal(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 608,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 609,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 610,\n      columnNumber: 11\n    }\n  }, \"Select Client\")), __jsx(Modal.Body, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 612,\n      columnNumber: 9\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: clientSearchTerm,\n    onChange: function onChange(e) {\n      return setClientSearchTerm(e.target.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 613,\n      columnNumber: 11\n    }\n  }), __jsx(ClientTable, {\n    clients: clients.filter(function (client) {\n      return (client.name || \"\").toLowerCase().includes(clientSearchTerm.toLowerCase());\n    }),\n    disableInfo: true,\n    onSelectClient: handleClientSelect,\n    onInfoClick: handleClientInfo,\n    clearSelection: handleClearClientSelection,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 620,\n      columnNumber: 11\n    }\n  }))), __jsx(Modal, {\n    show: showModelModal,\n    onHide: function onHide() {\n      return setShowModelModal(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 634,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 635,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 636,\n      columnNumber: 11\n    }\n  }, \"Select Model\")), __jsx(Modal.Body, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 638,\n      columnNumber: 9\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: modelSearchTerm,\n    onChange: function onChange(e) {\n      return setModelSearchTerm(e.target.value);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 639,\n      columnNumber: 11\n    }\n  }), __jsx(ModelTable, {\n    models: models.filter(function (model) {\n      return typeof model === \"string\" ? model.toLowerCase().includes(modelSearchTerm.toLowerCase()) : false;\n    }),\n    onSelectModel: handleModelSelect,\n    clearSelection: handleClearModelSelection,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 646,\n      columnNumber: 11\n    }\n  }))));\n};\n\n_s(ParentModal, \"5ZKKJDQrTMtANa+CUvS5z3y+jHk=\");\n\n_c = ParentModal;\nexport default ParentModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"ParentModal\");","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/NewSearch/AddItem/parentModal.js"],"names":["React","useEffect","useState","useCallback","Modal","InputGroup","Dropdown","FormControl","Button","NavDropdown","Form","Table","Pagination","fetchPartsWithMachineDataPage","fetchClients","fetchModels","formatDate","ClientTable","ModelTable","styles","CLIENT_WAREHOUSE","CLIENT_UNASSIGNED","PAGE_SIZE","ParentModal","show","handleClose","setSelectedParent","info","setInfo","isLoading","setIsLoading","page","setPage","pageCursors","setPageCursors","hasNextPage","setHasNextPage","queryEpoch","setQueryEpoch","loadError","setLoadError","search","setSearch","select","setSelect","showList","setShowList","showListSearch","setShowListSearch","selectedOEM","setSelectedOEM","selectedModality","setSelectedModality","selectedClient","setSelectedClient","clients","setClients","showClientModal","setShowClientModal","clientButtonText","setClientButtonText","selectedModel","setSelectedModel","models","setModels","showModelModal","setShowModelModal","modelButtonText","setModelButtonText","clientSearchTerm","setClientSearchTerm","modelSearchTerm","setModelSearchTerm","normalizeText","value","String","toLowerCase","trim","fieldMatchesSelection","selected","Array","isArray","some","entry","getMachineField","item","key","machineData","currentMachineData","TheMachine","resetPagination","searchChangeHandler","event","target","matchesFilters","OEM","Modality","Model","clientRef","clientId","id","fetchData","requestedPage","startAfterDoc","searchLower","pageSize","visibleOnly","filterFn","type","raw","lower","needsMachineData","Boolean","data","parts","lastDoc","nextPage","prev","next","console","error","message","v","rowSelect","name","pn","dropdown1Text","setDropdown1Text","dropdown2Text","setDropdown2Text","handleSelect1","eventKey","textContent","handleSelect2","handleClientClick","clientsData","handleClientSelect","client","find","c","handleClientInfo","clientName","log","handleClearClientSelection","handleModelClick","modelsData","handleModelSelect","modelName","handleClearModelSelection","handleWarehouseClick","handleUnassignedClick","totalKnownPages","Math","max","filter","length","pageButtons","buttons","maxVisible","pushPage","p","push","pushEllipsis","i","start","end","min","desiredWindow","currentWindow","remaining","modalDialog","modalContent","modalHeader","modalTitle","modalSubtitle","modalBody","modalGrid","filtersPanel","panelTitle","panelHint","inputGroup","panelDivider","quickButtons","quickButton","resultsPanel","resultsHeader","resultsTitle","resultsSubtitle","pagination","searchRow","searchInput","tableWrap","loadingState","loadingLogo","errorState","table","stickyHeader","emptyState","map","date","workOrders","workOrder","sn","modalFooter","e","includes","model"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\nimport {\n  Modal,\n  InputGroup,\n  Dropdown,\n  FormControl,\n  Button,\n  NavDropdown,\n  Form,\n  Table,\n  Pagination,\n} from \"react-bootstrap\";\nimport {\n  fetchPartsWithMachineDataPage,\n  fetchClients,\n  fetchModels,\n  formatDate,\n} from \"../../../utils/fetchAssociations\";\nimport ClientTable from \"../../../utils/ClientTable\";\nimport ModelTable from \"../../../utils/ModelTable\";\nimport styles from \"./ParentModal.module.css\";\n\nconst CLIENT_WAREHOUSE = \"igor-house\";\nconst CLIENT_UNASSIGNED = \"unassigned\";\nconst PAGE_SIZE = 20;\n\nconst ParentModal = ({ show, handleClose, setSelectedParent }) => {\n  const [info, setInfo] = useState([]);\n  const [isLoading, setIsLoading] = useState(false);\n  const [page, setPage] = useState(1);\n  const [pageCursors, setPageCursors] = useState([]);\n  const [hasNextPage, setHasNextPage] = useState(false);\n  const [queryEpoch, setQueryEpoch] = useState(0);\n  const [loadError, setLoadError] = useState(null);\n\n  const [search, setSearch] = useState(\"\");\n  const [select, setSelect] = useState(\"Name\");\n  const [showList, setShowList] = useState(false);\n  const [showListSearch, setShowListSearch] = useState(\"text\");\n  const [selectedOEM, setSelectedOEM] = useState(null);\n  const [selectedModality, setSelectedModality] = useState(null);\n  const [selectedClient, setSelectedClient] = useState(null);\n  const [clients, setClients] = useState([]);\n  const [showClientModal, setShowClientModal] = useState(false);\n  const [clientButtonText, setClientButtonText] = useState(\"Select Option\");\n  const [selectedModel, setSelectedModel] = useState(null);\n  const [models, setModels] = useState([]);\n  const [showModelModal, setShowModelModal] = useState(false);\n  const [modelButtonText, setModelButtonText] = useState(\"Select Option\");\n  const [clientSearchTerm, setClientSearchTerm] = useState(\"\");\n  const [modelSearchTerm, setModelSearchTerm] = useState(\"\");\n\n  const normalizeText = (value) => {\n    if (value == null) return \"\";\n    return String(value).toLowerCase().trim();\n  };\n\n  const fieldMatchesSelection = (value, selected) => {\n    if (!selected) return true;\n    if (Array.isArray(value)) {\n      return value.some((entry) => fieldMatchesSelection(entry, selected));\n    }\n    return normalizeText(value) === normalizeText(selected);\n  };\n\n  const getMachineField = (item, key) => {\n    if (!item) return null;\n    return (\n      item?.machineData?.[key] ??\n      item?.machineData?.[key?.toLowerCase?.()] ??\n      item?.currentMachineData?.[key] ??\n      item?.currentMachineData?.[key?.toLowerCase?.()] ??\n      item?.TheMachine?.[key] ??\n      item?.TheMachine?.[key?.toLowerCase?.()] ??\n      null\n    );\n  };\n\n  const resetPagination = () => {\n    setPage(1);\n    setPageCursors([]);\n    setHasNextPage(false);\n  };\n\n  const searchChangeHandler = (event) => setSearch(event.target.value);\n\n  const matchesFilters = useCallback(\n    (item) => {\n      if (!item) return false;\n      if (selectedOEM) {\n        const OEM = getMachineField(item, \"OEM\");\n        if (!fieldMatchesSelection(OEM, selectedOEM)) return false;\n      }\n      if (selectedModality) {\n        const Modality = getMachineField(item, \"Modality\");\n        if (!fieldMatchesSelection(Modality, selectedModality)) return false;\n      }\n      if (selectedModel) {\n        const Model = getMachineField(item, \"Model\");\n        if (!fieldMatchesSelection(Model, selectedModel)) return false;\n      }\n      if (selectedClient) {\n        const clientRef = getMachineField(item, \"client\");\n        const clientId =\n          typeof clientRef === \"string\"\n            ? clientRef\n            : clientRef?.id || null;\n        if (clientId !== selectedClient) return false;\n      }\n      return true;\n    },\n    [selectedOEM, selectedModality, selectedModel, selectedClient]\n  );\n\n  const fetchData = useCallback(\n    async (requestedPage = 1) => {\n      if (!show) return;\n      const startAfterDoc =\n        requestedPage > 1 ? pageCursors[requestedPage - 2] : null;\n      if (requestedPage > 1 && !startAfterDoc) {\n        setPage(1);\n        return;\n      }\n      setIsLoading(true);\n      setLoadError(null);\n      const searchLower = (search || \"\").toLowerCase().trim();\n      try {\n        const { parts: data, lastDoc, hasNextPage: nextPage } =\n          await fetchPartsWithMachineDataPage({\n            pageSize: PAGE_SIZE,\n            startAfterDoc,\n            visibleOnly: true,\n            filterFn:\n              selectedOEM || selectedModality || selectedModel || selectedClient\n                ? matchesFilters\n                : null,\n            search: searchLower\n              ? {\n                  type: select,\n                  raw: search,\n                  lower: searchLower,\n                }\n              : null,\n            needsMachineData:\n              Boolean(selectedOEM) ||\n              Boolean(selectedModality) ||\n              Boolean(selectedModel) ||\n              Boolean(selectedClient),\n          });\n        setInfo(data);\n        setHasNextPage(nextPage);\n        setPageCursors((prev) => {\n          const next = requestedPage === 1 ? [] : [...prev];\n          if (lastDoc) {\n            next[requestedPage - 1] = lastDoc;\n          }\n          return next;\n        });\n      } catch (error) {\n        console.error(\"Parent modal load failed:\", error);\n        setLoadError(error?.message || \"Failed to load items.\");\n        setInfo([]);\n      } finally {\n        setIsLoading(false);\n      }\n    },\n    [\n      show,\n      pageCursors,\n      search,\n      select,\n      selectedOEM,\n      selectedModality,\n      selectedModel,\n      selectedClient,\n      matchesFilters,\n    ]\n  );\n\n  useEffect(() => {\n    if (!show) return;\n    resetPagination();\n    setQueryEpoch((v) => v + 1);\n  }, [show, selectedOEM, selectedModality, selectedModel, selectedClient, search, select]);\n\n  useEffect(() => {\n    if (!show) return;\n    fetchData(page);\n  }, [show, page, queryEpoch, fetchData]);\n\n  const rowSelect = (item) => {\n    setSelectedParent({ id: item.id, name: item.name, pn: item.pn });\n    handleClose();\n  };\n\n  const [dropdown1Text, setDropdown1Text] = useState(\"Select Option\");\n  const [dropdown2Text, setDropdown2Text] = useState(\"Select Option\");\n\n  const handleSelect1 = (eventKey, event) => {\n    if (eventKey === \"unassigned\") {\n      setDropdown1Text(\"Select Option\");\n      setSelectedOEM(null);\n    } else {\n      setDropdown1Text(event.target.textContent);\n      setSelectedOEM(event.target.textContent);\n    }\n  };\n\n  const handleSelect2 = (eventKey, event) => {\n    if (eventKey === \"unassigned\") {\n      setDropdown2Text(\"Select Option\");\n      setSelectedModality(null);\n    } else {\n      setDropdown2Text(event.target.textContent);\n      setSelectedModality(event.target.textContent);\n    }\n  };\n\n  const handleClientClick = async () => {\n    const clientsData = await fetchClients(selectedOEM, selectedModality);\n    setClients(clientsData);\n    setClientSearchTerm(\"\");\n    setShowClientModal(true);\n  };\n\n  const handleClientSelect = (clientId) => {\n    if (!clientId) {\n      setClientButtonText(\"Select Option\");\n      setSelectedClient(null);\n      setShowClientModal(false);\n      return;\n    }\n    const client = clients.find((c) => c.id === clientId);\n    setClientButtonText(client?.name || \"Select Option\");\n    setSelectedClient(clientId);\n    setShowClientModal(false);\n  };\n\n  const handleClientInfo = (clientId, clientName) => {\n    console.log(`Client ID: ${clientId}, Client Name: ${clientName}`);\n  };\n\n  const handleClearClientSelection = () => {\n    setClientButtonText(\"Select Option\");\n    setSelectedClient(null);\n    setShowClientModal(false);\n  };\n\n  const handleModelClick = async () => {\n    const modelsData = await fetchModels(\n      selectedOEM,\n      selectedModality,\n      selectedClient\n    );\n    setModels(modelsData);\n    setModelSearchTerm(\"\");\n    setShowModelModal(true);\n  };\n\n  const handleModelSelect = (modelName) => {\n    setModelButtonText(modelName || \"Select Option\");\n    setSelectedModel(modelName || null);\n    setShowModelModal(false);\n  };\n\n  const handleClearModelSelection = () => {\n    setModelButtonText(\"Select Option\");\n    setSelectedModel(null);\n    setShowModelModal(false);\n  };\n\n  const handleWarehouseClick = () => {\n    setClientButtonText(CLIENT_WAREHOUSE);\n    setSelectedClient(CLIENT_WAREHOUSE);\n  };\n\n  const handleUnassignedClick = () => {\n    setClientButtonText(CLIENT_UNASSIGNED);\n    setSelectedClient(CLIENT_UNASSIGNED);\n  };\n\n  const totalKnownPages = Math.max(\n    1,\n    pageCursors.filter(Boolean).length + (hasNextPage ? 1 : 0)\n  );\n  const pageButtons = (() => {\n    const buttons = [];\n    const maxVisible = 6;\n\n    const pushPage = (p) =>\n      buttons.push(\n        <Pagination.Item\n          key={`page-${p}`}\n          active={p === page}\n          onClick={() => setPage(p)}\n        >\n          {p}\n        </Pagination.Item>\n      );\n\n    const pushEllipsis = (key) =>\n      buttons.push(<Pagination.Ellipsis key={key} disabled />);\n\n    if (totalKnownPages <= maxVisible) {\n      for (let i = 1; i <= totalKnownPages; i += 1) pushPage(i);\n      return buttons;\n    }\n\n    let start = Math.max(2, page - 1);\n    let end = Math.min(totalKnownPages - 1, page + 1);\n    const desiredWindow = maxVisible - 2;\n    let currentWindow = end - start + 1;\n    let remaining = desiredWindow - currentWindow;\n\n    while (remaining > 0) {\n      if (start > 2) {\n        start -= 1;\n        remaining -= 1;\n      }\n      if (remaining > 0 && end < totalKnownPages - 1) {\n        end += 1;\n        remaining -= 1;\n      }\n      if (start === 2 && end === totalKnownPages - 1) break;\n    }\n\n    pushPage(1);\n    if (start > 2) pushEllipsis(\"start-ellipsis\");\n    for (let i = start; i <= end; i += 1) pushPage(i);\n    if (end < totalKnownPages - 1) pushEllipsis(\"end-ellipsis\");\n    pushPage(totalKnownPages);\n    if (hasNextPage) pushEllipsis(\"more-ellipsis\");\n\n    return buttons;\n  })();\n\n  return (\n    <Modal\n      show={show}\n      onHide={handleClose}\n      size=\"xl\"\n      centered\n      dialogClassName={styles.modalDialog}\n      contentClassName={styles.modalContent}\n    >\n      <Modal.Header closeButton className={styles.modalHeader}>\n        <div>\n          <div className={styles.modalTitle}>Select Parent</div>\n          <div className={styles.modalSubtitle}>\n            Search and choose a parent item for this part.\n          </div>\n        </div>\n      </Modal.Header>\n      <Modal.Body className={styles.modalBody}>\n        <div className={styles.modalGrid}>\n          <aside className={styles.filtersPanel}>\n            <div className={styles.panelTitle}>Filters</div>\n            <div className={styles.panelHint}>\n              Narrow results with machine and client filters.\n            </div>\n            <InputGroup className={styles.inputGroup}>\n              <InputGroup.Text>OEM</InputGroup.Text>\n              <Dropdown onSelect={handleSelect1} className=\"w-100\">\n                <Dropdown.Toggle\n                  variant=\"outline-secondary\"\n                  id=\"dropdown-button-1\"\n                  className=\"w-100\"\n                >\n                  {dropdown1Text}\n                </Dropdown.Toggle>\n                <Dropdown.Menu className=\"w-100\">\n                  <Dropdown.Item eventKey=\"unassigned\">\n                    Select Option\n                  </Dropdown.Item>\n                  <Dropdown.Item eventKey=\"GE\">GE</Dropdown.Item>\n                  <Dropdown.Item eventKey=\"Toshiba\">Toshiba</Dropdown.Item>\n                  <Dropdown.Item eventKey=\"Siemens\">Siemens</Dropdown.Item>\n                  <Dropdown.Item eventKey=\"Philips\">Philips</Dropdown.Item>\n                </Dropdown.Menu>\n              </Dropdown>\n            </InputGroup>\n\n            <InputGroup className={styles.inputGroup}>\n              <InputGroup.Text>Modality</InputGroup.Text>\n              <Dropdown onSelect={handleSelect2} className=\"w-100\">\n                <Dropdown.Toggle\n                  variant=\"outline-secondary\"\n                  id=\"dropdown-button-2\"\n                  className=\"w-100\"\n                >\n                  {dropdown2Text}\n                </Dropdown.Toggle>\n                <Dropdown.Menu className=\"w-100\">\n                  <Dropdown.Item eventKey=\"unassigned\">\n                    Select Option\n                  </Dropdown.Item>\n                  <Dropdown.Item eventKey=\"CT\">CT</Dropdown.Item>\n                  <Dropdown.Item eventKey=\"MRI\">MRI</Dropdown.Item>\n                </Dropdown.Menu>\n              </Dropdown>\n            </InputGroup>\n\n            <InputGroup className={styles.inputGroup}>\n              <InputGroup.Text>Client</InputGroup.Text>\n              <Button\n                variant=\"outline-secondary\"\n                className=\"w-100\"\n                onClick={handleClientClick}\n              >\n                {clientButtonText}\n              </Button>\n            </InputGroup>\n\n            <InputGroup className={styles.inputGroup}>\n              <InputGroup.Text>Model</InputGroup.Text>\n              <Button\n                variant=\"outline-secondary\"\n                className=\"w-100\"\n                onClick={handleModelClick}\n              >\n                {modelButtonText}\n              </Button>\n            </InputGroup>\n\n            <div className={styles.panelDivider}></div>\n            <div className={styles.panelTitle}>Quick</div>\n            <div className={styles.quickButtons}>\n              <Button\n                variant=\"outline-secondary\"\n                className={styles.quickButton}\n                onClick={handleWarehouseClick}\n              >\n                Warehouse\n              </Button>\n              <Button\n                variant=\"outline-secondary\"\n                className={styles.quickButton}\n                onClick={handleUnassignedClick}\n              >\n                Unassigned\n              </Button>\n            </div>\n          </aside>\n\n          <section className={styles.resultsPanel}>\n            <div className={styles.resultsHeader}>\n              <div>\n                <div className={styles.resultsTitle}>Results</div>\n                <div className={styles.resultsSubtitle}>\n                  {isLoading ? \"Loading items\" : `${info.length} items`}\n                </div>\n              </div>\n              <Pagination size=\"sm\" className={styles.pagination}>\n                <Pagination.Prev\n                  onClick={() => setPage((p) => Math.max(1, p - 1))}\n                  disabled={page <= 1}\n                />\n                {pageButtons}\n                <Pagination.Next\n                  onClick={() => setPage((p) => p + 1)}\n                  disabled={!hasNextPage}\n                />\n              </Pagination>\n            </div>\n\n            <div className={styles.searchRow}>\n              <FormControl\n                type={showListSearch}\n                placeholder=\"Search\"\n                className={styles.searchInput}\n                aria-label=\"Search\"\n                value={search}\n                onChange={searchChangeHandler}\n              />\n              <NavDropdown\n                title={select}\n                id=\"parent-search-dropdown\"\n                show={showList}\n                onMouseEnter={() => setShowList(true)}\n                onMouseLeave={() => setShowList(false)}\n              >\n                <NavDropdown.Item\n                  onClick={() => {\n                    setSelect(\"Name\");\n                    setShowListSearch(\"text\");\n                  }}\n                >\n                  Name\n                </NavDropdown.Item>\n                <NavDropdown.Item\n                  onClick={() => {\n                    setSelect(\"Date\");\n                    setShowListSearch(\"date\");\n                  }}\n                >\n                  Date\n                </NavDropdown.Item>\n                <NavDropdown.Item\n                  onClick={() => {\n                    setSelect(\"Work Order\");\n                    setShowListSearch(\"text\");\n                  }}\n                >\n                  Work Order\n                </NavDropdown.Item>\n                <NavDropdown.Item\n                  onClick={() => {\n                    setSelect(\"Product Number\");\n                    setShowListSearch(\"text\");\n                  }}\n                >\n                  Product Number\n                </NavDropdown.Item>\n                <NavDropdown.Item\n                  onClick={() => {\n                    setSelect(\"Serial Number\");\n                    setShowListSearch(\"text\");\n                  }}\n                >\n                  Serial Number\n                </NavDropdown.Item>\n                <NavDropdown.Item\n                  onClick={() => {\n                    setSelect(\"Description\");\n                    setShowListSearch(\"text\");\n                  }}\n                >\n                  Description\n                </NavDropdown.Item>\n              </NavDropdown>\n            </div>\n\n            <div className={styles.tableWrap}>\n              {isLoading ? (\n                <div className={styles.loadingState}>\n                  <img\n                    src=\"/magmo-logo.png\"\n                    alt=\"Loading\"\n                    className={styles.loadingLogo}\n                  />\n                </div>\n              ) : loadError ? (\n                <div className={styles.errorState}>{loadError}</div>\n              ) : (\n                <Table striped bordered hover size=\"sm\" className={styles.table}>\n                  <thead className={styles.stickyHeader}>\n                    <tr>\n                      <th>Name</th>\n                      <th>Date</th>\n                      <th>Work Order</th>\n                      <th>Product Number</th>\n                      <th>Serial Number</th>\n                      <th>Select</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {info.length === 0 && (\n                      <tr>\n                        <td colSpan={6} className={styles.emptyState}>\n                          No items found.\n                        </td>\n                      </tr>\n                    )}\n                    {info.map((item) => (\n                      <tr key={item.id}>\n                        <td>{item.name}</td>\n                        <td>{formatDate(item.date)}</td>\n                        <td>\n                          {item.workOrders && item.workOrders.length > 0\n                            ? item.workOrders[item.workOrders.length - 1]\n                                .workOrder\n                            : \"N/A\"}\n                        </td>\n                        <td>{item.pn}</td>\n                        <td>{item.sn}</td>\n                        <td>\n                          <Button\n                            variant=\"primary\"\n                            size=\"sm\"\n                            onClick={() => rowSelect(item)}\n                          >\n                            Select\n                          </Button>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </Table>\n              )}\n            </div>\n          </section>\n        </div>\n      </Modal.Body>\n      <Modal.Footer className={styles.modalFooter}>\n        <Button variant=\"secondary\" onClick={handleClose}>\n          Cancel\n        </Button>\n        <Button\n          variant=\"warning\"\n          onClick={() => {\n            setSelectedParent(null);\n            handleClose();\n          }}\n        >\n          Clear Selection\n        </Button>\n      </Modal.Footer>\n      <Modal show={showClientModal} onHide={() => setShowClientModal(false)}>\n        <Modal.Header closeButton>\n          <Modal.Title>Select Client</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <FormControl\n            type=\"text\"\n            placeholder=\"Search by name\"\n            className=\"mb-3\"\n            value={clientSearchTerm}\n            onChange={(e) => setClientSearchTerm(e.target.value)}\n          />\n          <ClientTable\n            clients={clients.filter((client) =>\n              (client.name || \"\")\n                .toLowerCase()\n                .includes(clientSearchTerm.toLowerCase())\n            )}\n            disableInfo={true}\n            onSelectClient={handleClientSelect}\n            onInfoClick={handleClientInfo}\n            clearSelection={handleClearClientSelection}\n          />\n        </Modal.Body>\n      </Modal>\n\n      <Modal show={showModelModal} onHide={() => setShowModelModal(false)}>\n        <Modal.Header closeButton>\n          <Modal.Title>Select Model</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <FormControl\n            type=\"text\"\n            placeholder=\"Search by name\"\n            className=\"mb-3\"\n            value={modelSearchTerm}\n            onChange={(e) => setModelSearchTerm(e.target.value)}\n          />\n          <ModelTable\n            models={models.filter((model) =>\n              typeof model === \"string\"\n                ? model.toLowerCase().includes(modelSearchTerm.toLowerCase())\n                : false\n            )}\n            onSelectModel={handleModelSelect}\n            clearSelection={handleClearModelSelection}\n          />\n        </Modal.Body>\n      </Modal>\n    </Modal>\n  );\n};\n\nexport default ParentModal;\r\n"]},"metadata":{},"sourceType":"module"}