{"ast":null,"code":"import { initializeApp, getApps, cert } from \"firebase-admin/app\";\nimport { getFirestore } from \"firebase-admin/firestore\"; // Import Firebase Functions for config access\n\nlet functions;\n\ntry {\n  functions = require(\"firebase-functions\");\n} catch (error) {\n  // Not running in Firebase Functions environment\n  functions = null;\n} // Initialize Firebase Admin if it hasn't been initialized\n\n\nif (!getApps().length) {\n  var _functions$config$adm, _functions$config$ssr, _functions$config$adm2, _functions$config$ssr2;\n\n  const clientEmail = process.env.FIREBASE_CLIENT_EMAIL || process.env.FIREBASE_FUNCTIONS_CLIENT_EMAIL || process.env.FIREBASE_ADMIN_CLIENT_EMAIL || (functions ? ((_functions$config$adm = functions.config().admin) === null || _functions$config$adm === void 0 ? void 0 : _functions$config$adm.client_email) || ((_functions$config$ssr = functions.config().ssr) === null || _functions$config$ssr === void 0 ? void 0 : _functions$config$ssr.firebase_client_email) : undefined);\n  const privateKey = process.env.FIREBASE_PRIVATE_KEY || process.env.FIREBASE_FUNCTIONS_PRIVATE_KEY || process.env.FIREBASE_ADMIN_PRIVATE_KEY || (functions ? ((_functions$config$adm2 = functions.config().admin) === null || _functions$config$adm2 === void 0 ? void 0 : _functions$config$adm2.private_key) || ((_functions$config$ssr2 = functions.config().ssr) === null || _functions$config$ssr2 === void 0 ? void 0 : _functions$config$ssr2.firebase_private_key) : undefined);\n  const hasExplicitAdminCreds = Boolean(clientEmail && privateKey);\n  const isGoogleRuntime = Boolean(process.env.K_SERVICE || process.env.FUNCTION_TARGET || process.env.GAE_ENV || process.env.GOOGLE_CLOUD_PROJECT);\n  const canUseAdc = isGoogleRuntime || Boolean(process.env.GOOGLE_APPLICATION_CREDENTIALS);\n\n  try {\n    if (hasExplicitAdminCreds) {\n      initializeApp({\n        credential: cert({\n          projectId: \"magmo-ac10c\",\n          clientEmail: clientEmail,\n          privateKey: privateKey.replace(/\\\\n/g, \"\\n\")\n        }),\n        databaseURL: \"https://magmo-ac10c.firebaseio.com\"\n      });\n    } else if (canUseAdc) {\n      // Fall back to Application Default Credentials (e.g. Cloud Functions/Run)\n      initializeApp({\n        projectId: \"magmo-ac10c\",\n        databaseURL: \"https://magmo-ac10c.firebaseio.com\"\n      });\n    } else {\n      console.warn(\"Firebase Admin not initialized: missing service account credentials in local environment.\");\n    }\n  } catch (error) {\n    console.warn(\"Firebase Admin initialization failed:\", error.message); // Don't throw error during build process\n  }\n} // Only export Firestore if Firebase Admin is properly initialized\n\n\nlet adminDb = null;\n\ntry {\n  if (getApps().length > 0) {\n    adminDb = getFirestore();\n  }\n} catch (error) {\n  console.warn(\"Firebase Admin not available:\", error.message);\n}\n\nexport { adminDb };\nexport default adminDb;","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/context/FirebaseAdmin.js"],"names":["initializeApp","getApps","cert","getFirestore","functions","require","error","length","clientEmail","process","env","FIREBASE_CLIENT_EMAIL","FIREBASE_FUNCTIONS_CLIENT_EMAIL","FIREBASE_ADMIN_CLIENT_EMAIL","config","admin","client_email","ssr","firebase_client_email","undefined","privateKey","FIREBASE_PRIVATE_KEY","FIREBASE_FUNCTIONS_PRIVATE_KEY","FIREBASE_ADMIN_PRIVATE_KEY","private_key","firebase_private_key","hasExplicitAdminCreds","Boolean","isGoogleRuntime","K_SERVICE","FUNCTION_TARGET","GAE_ENV","GOOGLE_CLOUD_PROJECT","canUseAdc","GOOGLE_APPLICATION_CREDENTIALS","credential","projectId","replace","databaseURL","console","warn","message","adminDb"],"mappings":"AAAA,SAASA,aAAT,EAAwBC,OAAxB,EAAiCC,IAAjC,QAA6C,oBAA7C;AACA,SAASC,YAAT,QAA6B,0BAA7B,C,CAEA;;AACA,IAAIC,SAAJ;;AACA,IAAI;AACFA,EAAAA,SAAS,GAAGC,OAAO,CAAC,oBAAD,CAAnB;AACD,CAFD,CAEE,OAAOC,KAAP,EAAc;AACd;AACAF,EAAAA,SAAS,GAAG,IAAZ;AACD,C,CAED;;;AACA,IAAI,CAACH,OAAO,GAAGM,MAAf,EAAuB;AAAA;;AACrB,QAAMC,WAAW,GACfC,OAAO,CAACC,GAAR,CAAYC,qBAAZ,IACAF,OAAO,CAACC,GAAR,CAAYE,+BADZ,IAEAH,OAAO,CAACC,GAAR,CAAYG,2BAFZ,KAGCT,SAAS,GACN,0BAAAA,SAAS,CAACU,MAAV,GAAmBC,KAAnB,gFAA0BC,YAA1B,+BACAZ,SAAS,CAACU,MAAV,GAAmBG,GADnB,0DACA,sBAAwBC,qBADxB,CADM,GAGNC,SANJ,CADF;AASA,QAAMC,UAAU,GACdX,OAAO,CAACC,GAAR,CAAYW,oBAAZ,IACAZ,OAAO,CAACC,GAAR,CAAYY,8BADZ,IAEAb,OAAO,CAACC,GAAR,CAAYa,0BAFZ,KAGCnB,SAAS,GACN,2BAAAA,SAAS,CAACU,MAAV,GAAmBC,KAAnB,kFAA0BS,WAA1B,gCACApB,SAAS,CAACU,MAAV,GAAmBG,GADnB,2DACA,uBAAwBQ,oBADxB,CADM,GAGNN,SANJ,CADF;AASA,QAAMO,qBAAqB,GAAGC,OAAO,CAACnB,WAAW,IAAIY,UAAhB,CAArC;AACA,QAAMQ,eAAe,GAAGD,OAAO,CAC7BlB,OAAO,CAACC,GAAR,CAAYmB,SAAZ,IACEpB,OAAO,CAACC,GAAR,CAAYoB,eADd,IAEErB,OAAO,CAACC,GAAR,CAAYqB,OAFd,IAGEtB,OAAO,CAACC,GAAR,CAAYsB,oBAJe,CAA/B;AAMA,QAAMC,SAAS,GACbL,eAAe,IAAID,OAAO,CAAClB,OAAO,CAACC,GAAR,CAAYwB,8BAAb,CAD5B;;AAGA,MAAI;AACF,QAAIR,qBAAJ,EAA2B;AACzB1B,MAAAA,aAAa,CAAC;AACZmC,QAAAA,UAAU,EAAEjC,IAAI,CAAC;AACfkC,UAAAA,SAAS,EAAE,aADI;AAEf5B,UAAAA,WAAW,EAAEA,WAFE;AAGfY,UAAAA,UAAU,EAAEA,UAAU,CAACiB,OAAX,CAAmB,MAAnB,EAA2B,IAA3B;AAHG,SAAD,CADJ;AAMZC,QAAAA,WAAW,EAAE;AAND,OAAD,CAAb;AAQD,KATD,MASO,IAAIL,SAAJ,EAAe;AACpB;AACAjC,MAAAA,aAAa,CAAC;AACZoC,QAAAA,SAAS,EAAE,aADC;AAEZE,QAAAA,WAAW,EAAE;AAFD,OAAD,CAAb;AAID,KANM,MAMA;AACLC,MAAAA,OAAO,CAACC,IAAR,CACE,2FADF;AAGD;AACF,GArBD,CAqBE,OAAOlC,KAAP,EAAc;AACdiC,IAAAA,OAAO,CAACC,IAAR,CAAa,uCAAb,EAAsDlC,KAAK,CAACmC,OAA5D,EADc,CAEd;AACD;AACF,C,CAED;;;AACA,IAAIC,OAAO,GAAG,IAAd;;AACA,IAAI;AACF,MAAIzC,OAAO,GAAGM,MAAV,GAAmB,CAAvB,EAA0B;AACxBmC,IAAAA,OAAO,GAAGvC,YAAY,EAAtB;AACD;AACF,CAJD,CAIE,OAAOG,KAAP,EAAc;AACdiC,EAAAA,OAAO,CAACC,IAAR,CAAa,+BAAb,EAA8ClC,KAAK,CAACmC,OAApD;AACD;;AAED,SAASC,OAAT;AACA,eAAeA,OAAf","sourcesContent":["import { initializeApp, getApps, cert } from \"firebase-admin/app\";\r\nimport { getFirestore } from \"firebase-admin/firestore\";\r\n\r\n// Import Firebase Functions for config access\r\nlet functions;\r\ntry {\r\n  functions = require(\"firebase-functions\");\r\n} catch (error) {\r\n  // Not running in Firebase Functions environment\r\n  functions = null;\r\n}\r\n\r\n// Initialize Firebase Admin if it hasn't been initialized\r\nif (!getApps().length) {\r\n  const clientEmail =\r\n    process.env.FIREBASE_CLIENT_EMAIL ||\r\n    process.env.FIREBASE_FUNCTIONS_CLIENT_EMAIL ||\r\n    process.env.FIREBASE_ADMIN_CLIENT_EMAIL ||\r\n    (functions\r\n      ? functions.config().admin?.client_email ||\r\n        functions.config().ssr?.firebase_client_email\r\n      : undefined);\r\n\r\n  const privateKey =\r\n    process.env.FIREBASE_PRIVATE_KEY ||\r\n    process.env.FIREBASE_FUNCTIONS_PRIVATE_KEY ||\r\n    process.env.FIREBASE_ADMIN_PRIVATE_KEY ||\r\n    (functions\r\n      ? functions.config().admin?.private_key ||\r\n        functions.config().ssr?.firebase_private_key\r\n      : undefined);\r\n\r\n  const hasExplicitAdminCreds = Boolean(clientEmail && privateKey);\r\n  const isGoogleRuntime = Boolean(\r\n    process.env.K_SERVICE ||\r\n      process.env.FUNCTION_TARGET ||\r\n      process.env.GAE_ENV ||\r\n      process.env.GOOGLE_CLOUD_PROJECT\r\n  );\r\n  const canUseAdc =\r\n    isGoogleRuntime || Boolean(process.env.GOOGLE_APPLICATION_CREDENTIALS);\r\n\r\n  try {\r\n    if (hasExplicitAdminCreds) {\r\n      initializeApp({\r\n        credential: cert({\r\n          projectId: \"magmo-ac10c\",\r\n          clientEmail: clientEmail,\r\n          privateKey: privateKey.replace(/\\\\n/g, \"\\n\"),\r\n        }),\r\n        databaseURL: \"https://magmo-ac10c.firebaseio.com\",\r\n      });\r\n    } else if (canUseAdc) {\r\n      // Fall back to Application Default Credentials (e.g. Cloud Functions/Run)\r\n      initializeApp({\r\n        projectId: \"magmo-ac10c\",\r\n        databaseURL: \"https://magmo-ac10c.firebaseio.com\",\r\n      });\r\n    } else {\r\n      console.warn(\r\n        \"Firebase Admin not initialized: missing service account credentials in local environment.\"\r\n      );\r\n    }\r\n  } catch (error) {\r\n    console.warn(\"Firebase Admin initialization failed:\", error.message);\r\n    // Don't throw error during build process\r\n  }\r\n}\r\n\r\n// Only export Firestore if Firebase Admin is properly initialized\r\nlet adminDb = null;\r\ntry {\r\n  if (getApps().length > 0) {\r\n    adminDb = getFirestore();\r\n  }\r\n} catch (error) {\r\n  console.warn(\"Firebase Admin not available:\", error.message);\r\n}\r\n\r\nexport { adminDb };\r\nexport default adminDb;\r\n"]},"metadata":{},"sourceType":"module"}