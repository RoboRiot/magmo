{"ast":null,"code":"import { getApps } from \"firebase-admin/app\";\nimport { getAuth } from \"firebase-admin/auth\";\nconst isProduction = true;\nexport async function requireFirebaseAuth(req, res) {\n  var _req$headers;\n\n  const header = ((_req$headers = req.headers) === null || _req$headers === void 0 ? void 0 : _req$headers.authorization) || \"\";\n  const match = header.match(/^Bearer\\s+(.+)$/i);\n  const token = match === null || match === void 0 ? void 0 : match[1];\n\n  if (!token) {\n    if (isProduction) {\n      res.status(401).json({\n        error: \"Missing auth token.\"\n      });\n      return null;\n    }\n\n    return null;\n  }\n\n  try {\n    if (!getApps().length) {\n      if (isProduction) {\n        res.status(503).json({\n          error: \"Firebase Admin not available.\"\n        });\n        return null;\n      }\n\n      return null;\n    }\n\n    const decoded = await getAuth().verifyIdToken(token);\n    return decoded;\n  } catch (error) {\n    if (isProduction) {\n      res.status(401).json({\n        error: \"Invalid auth token.\"\n      });\n      return null;\n    }\n\n    return null;\n  }\n}","map":null,"metadata":{},"sourceType":"module"}