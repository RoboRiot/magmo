{"ast":null,"code":"import { getApps } from \"firebase-admin/app\";\nimport { getAuth } from \"firebase-admin/auth\";\nconst isProduction = false;\nexport async function requireFirebaseAuth(req, res) {\n  var _req$headers;\n\n  const header = ((_req$headers = req.headers) === null || _req$headers === void 0 ? void 0 : _req$headers.authorization) || \"\";\n  const match = header.match(/^Bearer\\s+(.+)$/i);\n  const token = match === null || match === void 0 ? void 0 : match[1];\n\n  if (!token) {\n    if (isProduction) {\n      res.status(401).json({\n        error: \"Missing auth token.\"\n      });\n      return null;\n    }\n\n    return null;\n  }\n\n  try {\n    if (!getApps().length) {\n      if (isProduction) {\n        res.status(503).json({\n          error: \"Firebase Admin not available.\"\n        });\n        return null;\n      }\n\n      return null;\n    }\n\n    const decoded = await getAuth().verifyIdToken(token);\n    return decoded;\n  } catch (error) {\n    if (isProduction) {\n      res.status(401).json({\n        error: \"Invalid auth token.\"\n      });\n      return null;\n    }\n\n    return null;\n  }\n}","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/utils/apiAuth.js"],"names":["getApps","getAuth","isProduction","requireFirebaseAuth","req","res","header","headers","authorization","match","token","status","json","error","length","decoded","verifyIdToken"],"mappings":"AAAA,SAASA,OAAT,QAAwB,oBAAxB;AACA,SAASC,OAAT,QAAwB,qBAAxB;AAEA,MAAMC,YAAY,QAAlB;AAEA,OAAO,eAAeC,mBAAf,CAAmCC,GAAnC,EAAwCC,GAAxC,EAA6C;AAAA;;AAClD,QAAMC,MAAM,GAAG,iBAAAF,GAAG,CAACG,OAAJ,8DAAaC,aAAb,KAA8B,EAA7C;AACA,QAAMC,KAAK,GAAGH,MAAM,CAACG,KAAP,CAAa,kBAAb,CAAd;AACA,QAAMC,KAAK,GAAGD,KAAH,aAAGA,KAAH,uBAAGA,KAAK,CAAG,CAAH,CAAnB;;AAEA,MAAI,CAACC,KAAL,EAAY;AACV,QAAIR,YAAJ,EAAkB;AAChBG,MAAAA,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAArB;AACA,aAAO,IAAP;AACD;;AACD,WAAO,IAAP;AACD;;AAED,MAAI;AACF,QAAI,CAACb,OAAO,GAAGc,MAAf,EAAuB;AACrB,UAAIZ,YAAJ,EAAkB;AAChBG,QAAAA,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,UAAAA,KAAK,EAAE;AAAT,SAArB;AACA,eAAO,IAAP;AACD;;AACD,aAAO,IAAP;AACD;;AACD,UAAME,OAAO,GAAG,MAAMd,OAAO,GAAGe,aAAV,CAAwBN,KAAxB,CAAtB;AACA,WAAOK,OAAP;AACD,GAVD,CAUE,OAAOF,KAAP,EAAc;AACd,QAAIX,YAAJ,EAAkB;AAChBG,MAAAA,GAAG,CAACM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,QAAAA,KAAK,EAAE;AAAT,OAArB;AACA,aAAO,IAAP;AACD;;AACD,WAAO,IAAP;AACD;AACF","sourcesContent":["import { getApps } from \"firebase-admin/app\";\nimport { getAuth } from \"firebase-admin/auth\";\n\nconst isProduction = process.env.NODE_ENV === \"production\";\n\nexport async function requireFirebaseAuth(req, res) {\n  const header = req.headers?.authorization || \"\";\n  const match = header.match(/^Bearer\\s+(.+)$/i);\n  const token = match?.[1];\n\n  if (!token) {\n    if (isProduction) {\n      res.status(401).json({ error: \"Missing auth token.\" });\n      return null;\n    }\n    return null;\n  }\n\n  try {\n    if (!getApps().length) {\n      if (isProduction) {\n        res.status(503).json({ error: \"Firebase Admin not available.\" });\n        return null;\n      }\n      return null;\n    }\n    const decoded = await getAuth().verifyIdToken(token);\n    return decoded;\n  } catch (error) {\n    if (isProduction) {\n      res.status(401).json({ error: \"Invalid auth token.\" });\n      return null;\n    }\n    return null;\n  }\n}\n\n"]},"metadata":{},"sourceType":"module"}