{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mack2\\\\Desktop\\\\code\\\\pages\\\\NewSearch\\\\mainSearch.js\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState, useRef, useCallback } from \"react\";\nimport { Container, Card, Row, Col, InputGroup, Dropdown, FormControl, Button, NavDropdown, Form, Modal, Spinner, Pagination } from \"react-bootstrap\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport { fetchPartsWithMachineDataPage, fetchClients, fetchModels, formatDate } from \"../../utils/fetchAssociations\";\nimport { useAuth } from \"../../context/AuthUserContext\";\nimport LoggedIn from \"../LoggedIn\";\nimport ClientTable from \"../../utils/ClientTable\";\nimport ModelTable from \"../../utils/ModelTable\";\nimport PartTable from \"../../utils/PartTable\";\nimport styles from \"../../styles/MainSearch.module.css\";\nimport firebase from \"../../context/Firebase\"; // Predefined warehouse client IDs and display names\n\nconst SOCAL_CLIENT_ID = \"AIS17182\";\nconst NORCAL_CLIENT_ID = \"AIS25097\";\nconst UNASSIGNED_CLIENT_ID = \"AIS00404\";\nconst PAGE_SIZE = 25; // Simulates a network request delay\n\nfunction simulateNetworkRequest() {\n  return new Promise(resolve => setTimeout(resolve, 2000));\n} // Custom LoadingButton component\n\n\nfunction LoadingButton({\n  type,\n  name,\n  route\n}) {\n  const {\n    0: isLoading,\n    1: setLoading\n  } = useState(false);\n  useEffect(() => {\n    if (isLoading) {\n      let cancelled = false;\n      simulateNetworkRequest().then(() => {\n        if (!cancelled) setLoading(false);\n      });\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [isLoading]);\n  return __jsx(Link, {\n    href: `/${route}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, __jsx(\"a\", {\n    className: `btn btn-${type}`,\n    disabled: isLoading,\n    onClick: () => !isLoading && setLoading(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }\n  }, isLoading ? \"Loading…\" : name));\n} // ---- DATE HELPERS (top-level scope) ----\n// Convert anything date-ish into a timestamp (ms since epoch).\n\n\nfunction toTime(value) {\n  if (!value) return null; // Firestore Timestamp { seconds, nanoseconds }\n\n  if (typeof value === \"object\" && value !== null && value.seconds != null) {\n    try {\n      return value.seconds * 1000;\n    } catch {\n      /* ignore */\n    }\n  } // Native Date\n\n\n  if (value instanceof Date) {\n    const t = value.getTime();\n    return isNaN(t) ? null : t;\n  } // Strings\n\n\n  if (typeof value === \"string\") {\n    // ISO / yyyy-mm-dd\n    const iso = Date.parse(value);\n    if (!isNaN(iso)) return iso; // mm/dd/yyyy\n\n    const parts = value.split(\"/\");\n\n    if (parts.length === 3) {\n      const [mm, dd, yyyy] = parts;\n      const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\n      if (!isNaN(alt)) return alt;\n    }\n  } // Last resort\n\n\n  const t = Date.parse(value);\n  return isNaN(t) ? null : t;\n} // Canonicalize to 'yyyy-mm-dd' (matches <input type=\"date\">)\n\n\nfunction toYMD(value) {\n  const t = toTime(value);\n  if (t == null) return null;\n  const d = new Date(t);\n  const yyyy = d.getFullYear();\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  const dd = String(d.getDate()).padStart(2, \"0\");\n  return `${yyyy}-${mm}-${dd}`;\n}\n\nfunction normalizeText(value) {\n  if (value == null) return \"\";\n  return String(value).toLowerCase().trim();\n}\n\nfunction getMachineField(item, key) {\n  var _ref, _ref2, _ref3, _ref4, _ref5, _ref6, _ref7, _item$machineData$key, _item$machineData, _item$machineData2, _item$currentMachineD, _item$currentMachineD2, _item$theMachineData, _item$theMachineData2, _item$TheMachine, _item$TheMachine2;\n\n  if (!item) return null;\n  const lower = key.toLowerCase();\n  return (_ref = (_ref2 = (_ref3 = (_ref4 = (_ref5 = (_ref6 = (_ref7 = (_item$machineData$key = item === null || item === void 0 ? void 0 : (_item$machineData = item.machineData) === null || _item$machineData === void 0 ? void 0 : _item$machineData[key]) !== null && _item$machineData$key !== void 0 ? _item$machineData$key : item === null || item === void 0 ? void 0 : (_item$machineData2 = item.machineData) === null || _item$machineData2 === void 0 ? void 0 : _item$machineData2[lower]) !== null && _ref7 !== void 0 ? _ref7 : item === null || item === void 0 ? void 0 : (_item$currentMachineD = item.currentMachineData) === null || _item$currentMachineD === void 0 ? void 0 : _item$currentMachineD[key]) !== null && _ref6 !== void 0 ? _ref6 : item === null || item === void 0 ? void 0 : (_item$currentMachineD2 = item.currentMachineData) === null || _item$currentMachineD2 === void 0 ? void 0 : _item$currentMachineD2[lower]) !== null && _ref5 !== void 0 ? _ref5 : item === null || item === void 0 ? void 0 : (_item$theMachineData = item.theMachineData) === null || _item$theMachineData === void 0 ? void 0 : _item$theMachineData[key]) !== null && _ref4 !== void 0 ? _ref4 : item === null || item === void 0 ? void 0 : (_item$theMachineData2 = item.theMachineData) === null || _item$theMachineData2 === void 0 ? void 0 : _item$theMachineData2[lower]) !== null && _ref3 !== void 0 ? _ref3 : item === null || item === void 0 ? void 0 : (_item$TheMachine = item.TheMachine) === null || _item$TheMachine === void 0 ? void 0 : _item$TheMachine[key]) !== null && _ref2 !== void 0 ? _ref2 : item === null || item === void 0 ? void 0 : (_item$TheMachine2 = item.TheMachine) === null || _item$TheMachine2 === void 0 ? void 0 : _item$TheMachine2[lower]) !== null && _ref !== void 0 ? _ref : null;\n}\n\nexport default function MainSearch() {\n  const {\n    signOut\n  } = useAuth();\n  const {\n    0: info,\n    1: setInfo\n  } = useState([]);\n  const {\n    0: backupInfo,\n    1: setBackupInfo\n  } = useState([]);\n  const {\n    0: augmentedInfo,\n    1: setAugmentedInfo\n  } = useState([]); // items with clientFromId/currentId added\n\n  const {\n    0: isLoading,\n    1: setIsLoading\n  } = useState(true);\n  const {\n    0: ids,\n    1: setID\n  } = useState([]);\n  const {\n    0: show,\n    1: setShow\n  } = useState(false);\n  const {\n    0: dItem,\n    1: setDItem\n  } = useState();\n  const {\n    0: select,\n    1: setSelect\n  } = useState(\"Name\");\n  const {\n    0: showList,\n    1: setShowList\n  } = useState(false);\n  const {\n    0: showListSearch,\n    1: setShowListSearch\n  } = useState(\"text\");\n  const {\n    0: search,\n    1: setSearch\n  } = useState(\"\");\n  const {\n    0: selectedOEM,\n    1: setSelectedOEM\n  } = useState(null);\n  const {\n    0: selectedModality,\n    1: setSelectedModality\n  } = useState(null); // Replace the old single client state with two sets:\n\n  const {\n    0: selectedClientFrom,\n    1: setSelectedClientFrom\n  } = useState(null);\n  const {\n    0: clientFromButtonText,\n    1: setClientFromButtonText\n  } = useState(\"Select Option\");\n  const {\n    0: selectedClientCurrent,\n    1: setSelectedClientCurrent\n  } = useState(null);\n  const {\n    0: clientCurrentButtonText,\n    1: setClientCurrentButtonText\n  } = useState(\"Select Option\");\n  const {\n    0: clients,\n    1: setClients\n  } = useState([]);\n  const {\n    0: showClientModal,\n    1: setShowClientModal\n  } = useState(false); // This state tells the modal which client box is being updated: \"from\" or \"current\"\n\n  const {\n    0: clientSelectionType,\n    1: setClientSelectionType\n  } = useState(null);\n  const router = useRouter();\n  const labelBase = [\"name\", \"date\", \"w/o\", \"p/n\", \"s/n\"];\n  const labelBaseNames = [\"name\", \"date\", \"wo\", \"pn\", \"sn\"];\n  const sortCheckBase = [false, false, false, false, false, false];\n\n  function withSortIcon(baseLabels, activeIndex, isDesc) {\n    return baseLabels.map((text, i) => {\n      if (i !== activeIndex) return text; // untouched\n\n      const arrow = isDesc ? \" ▼\" : \" ▲\";\n      return `${text}${arrow}`;\n    });\n  }\n\n  const {\n    0: labels,\n    1: setLabels\n  } = useState(labelBase);\n  const {\n    0: sortCheck,\n    1: setSortCheck\n  } = useState(sortCheckBase);\n  const {\n    0: hoverIndex,\n    1: setHoverIndex\n  } = useState(null);\n  const {\n    0: selectedModel,\n    1: setSelectedModel\n  } = useState(null);\n  const {\n    0: gPos,\n    1: setGPos\n  } = useState(null);\n  const {\n    0: gIde,\n    1: setGIde\n  } = useState(null);\n  const {\n    0: isDeleting,\n    1: setIsDeleting\n  } = useState(false);\n  const {\n    0: page,\n    1: setPage\n  } = useState(1);\n  const {\n    0: pageCursors,\n    1: setPageCursors\n  } = useState([]);\n  const {\n    0: hasNextPage,\n    1: setHasNextPage\n  } = useState(false);\n  const fetchSeq = useRef(0);\n  const {\n    0: queryEpoch,\n    1: setQueryEpoch\n  } = useState(0);\n  const searchLower = (search || \"\").toLowerCase().trim();\n  const hasActiveFilters = Boolean(selectedOEM) || Boolean(selectedModality) || Boolean(selectedModel) || Boolean(selectedClientFrom) || Boolean(selectedClientCurrent) || Boolean(searchLower);\n\n  const valueMatches = (value, s) => {\n    if (!value) return false;\n\n    if (Array.isArray(value)) {\n      return value.some(v => valueMatches(v, s));\n    }\n\n    return String(value).toLowerCase().includes(s);\n  };\n\n  const matchesFilters = useCallback(item => {\n    // hide explicitly hidden items\n    if ((item === null || item === void 0 ? void 0 : item.visible) === false) return false; // OEM / Modality / Model filtering\n\n    const OEM = getMachineField(item, \"OEM\");\n    const Modality = getMachineField(item, \"Modality\");\n    const Model = getMachineField(item, \"Model\");\n\n    if (selectedOEM && normalizeText(OEM) !== normalizeText(selectedOEM)) {\n      return false;\n    }\n\n    if (selectedModality && normalizeText(Modality) !== normalizeText(selectedModality)) {\n      return false;\n    }\n\n    if (selectedModel && normalizeText(Model) !== normalizeText(selectedModel)) {\n      return false;\n    } // Client filters\n\n\n    if (selectedClientFrom && (item === null || item === void 0 ? void 0 : item.clientFromId) !== selectedClientFrom) {\n      return false;\n    }\n\n    if (selectedClientCurrent && (item === null || item === void 0 ? void 0 : item.clientCurrentId) !== selectedClientCurrent) {\n      return false;\n    } // Search\n\n\n    if (searchLower) {\n      if (select === \"Name\") {\n        return valueMatches(item === null || item === void 0 ? void 0 : item.name, searchLower);\n      }\n\n      if (select === \"Date\") {\n        const wantedDay = searchLower; // yyyy-mm-dd from input\n\n        const itemYMD = toYMD(item === null || item === void 0 ? void 0 : item.date);\n        if (itemYMD && itemYMD === wantedDay) return true;\n\n        if (Array.isArray(item === null || item === void 0 ? void 0 : item.descriptions)) {\n          if (item.descriptions.some(d => toYMD(d === null || d === void 0 ? void 0 : d.date) === wantedDay)) {\n            return true;\n          }\n        }\n\n        if (Array.isArray(item === null || item === void 0 ? void 0 : item.workOrders)) {\n          if (item.workOrders.some(w => toYMD(w === null || w === void 0 ? void 0 : w.date) === wantedDay)) {\n            return true;\n          }\n        }\n\n        return false;\n      }\n\n      if (select === \"Work Order\") {\n        return Array.isArray(item === null || item === void 0 ? void 0 : item.workOrders) && item.workOrders.some(wo => valueMatches(wo === null || wo === void 0 ? void 0 : wo.workOrder, searchLower));\n      }\n\n      if (select === \"Product Number\") {\n        return valueMatches(item === null || item === void 0 ? void 0 : item.pn, searchLower);\n      }\n\n      if (select === \"Serial Number\") {\n        return valueMatches(item === null || item === void 0 ? void 0 : item.sn, searchLower);\n      }\n\n      if (select === \"Description\") {\n        if (valueMatches(item === null || item === void 0 ? void 0 : item.desc, searchLower)) return true;\n        if (valueMatches(item === null || item === void 0 ? void 0 : item.description, searchLower)) return true;\n\n        if (Array.isArray(item === null || item === void 0 ? void 0 : item.descriptions)) {\n          return item.descriptions.some(d => valueMatches(d === null || d === void 0 ? void 0 : d.description, searchLower));\n        }\n\n        return false;\n      }\n\n      if (select === \"SKU\") {\n        return valueMatches(item === null || item === void 0 ? void 0 : item.id, searchLower) || valueMatches(item === null || item === void 0 ? void 0 : item.localSN, searchLower) || valueMatches(item === null || item === void 0 ? void 0 : item.local_sn, searchLower);\n      }\n    }\n\n    return true;\n  }, [selectedOEM, selectedModality, selectedModel, selectedClientFrom, selectedClientCurrent, searchLower, select]);\n\n  const resetPagination = () => {\n    setPage(1);\n    setPageCursors([]);\n    setHasNextPage(false);\n  }; // Reset pagination on route/query change (prevents stale pages like “starting at 6”)\n\n\n  useEffect(() => {\n    resetPagination();\n    setQueryEpoch(v => v + 1);\n  }, [router.asPath]); // Reset and refetch when filters/search change\n\n  useEffect(() => {\n    resetPagination();\n    setQueryEpoch(v => v + 1);\n  }, [selectedOEM, selectedModality, selectedModel, selectedClientFrom, selectedClientCurrent, search, select]); // Fetch data on component mount and route change\n\n  useEffect(() => {\n    fetchData(page);\n  }, [page, queryEpoch]);\n\n  async function fetchData(requestedPage = 1) {\n    const seq = ++fetchSeq.current;\n    setIsLoading(true);\n\n    try {\n      if (router.query.inputText && router.query.selectedType) {\n        setSelect(router.query.selectedType);\n        setSearch(router.query.inputText);\n      }\n\n      const startAfterDoc = requestedPage > 1 ? pageCursors[requestedPage - 2] : null;\n\n      if (requestedPage > 1 && !startAfterDoc) {\n        setPage(1);\n        if (seq === fetchSeq.current) setIsLoading(false);\n        return;\n      } // light retry for transient Firestore hiccups\n\n\n      const load = async (attempt = 1) => {\n        try {\n          return await fetchPartsWithMachineDataPage({\n            pageSize: PAGE_SIZE,\n            startAfterDoc,\n            visibleOnly: true,\n            filterFn: hasActiveFilters ? matchesFilters : null\n          });\n        } catch (e) {\n          if (attempt >= 3) throw e;\n          await new Promise(r => setTimeout(r, 250 * Math.pow(2, attempt - 1)));\n          return load(attempt + 1);\n        }\n      };\n\n      const {\n        parts: data,\n        lastDoc,\n        hasNextPage: nextPage\n      } = await load();\n      if (seq !== fetchSeq.current) return;\n\n      if (requestedPage === 1 && data.length === 0) {\n        setPageCursors([]);\n        setHasNextPage(false);\n      }\n\n      setBackupInfo(data);\n      setLabels(labelBase); // <-- add this line after setBackupInfo(data)\n\n      setID(data.map(item => item.id));\n\n      if (requestedPage > 1 && data.length === 0) {\n        setHasNextPage(false);\n        setPage(1);\n        return;\n      }\n\n      setHasNextPage(nextPage);\n      setPageCursors(prev => {\n        const next = requestedPage === 1 ? [] : [...prev];\n\n        if (lastDoc) {\n          next[requestedPage - 1] = lastDoc;\n        }\n\n        return next;\n      });\n      setSelectedItems([]); // Normalize client ids for filtering\n\n      const augmented = data.map(item => {\n        var _ref8, _ref9, _item$clientFromId, _item$ClientFrom, _ref10, _ref11, _item$clientCurrentId, _item$ClientCurrent;\n\n        return _objectSpread(_objectSpread({}, item), {}, {\n          clientFromId: (_ref8 = (_ref9 = (_item$clientFromId = item === null || item === void 0 ? void 0 : item.clientFromId) !== null && _item$clientFromId !== void 0 ? _item$clientFromId : typeof (item === null || item === void 0 ? void 0 : item.ClientFrom) === \"string\" ? item.ClientFrom : null) !== null && _ref9 !== void 0 ? _ref9 : item === null || item === void 0 ? void 0 : (_item$ClientFrom = item.ClientFrom) === null || _item$ClientFrom === void 0 ? void 0 : _item$ClientFrom.id) !== null && _ref8 !== void 0 ? _ref8 : null,\n          clientCurrentId: (_ref10 = (_ref11 = (_item$clientCurrentId = item === null || item === void 0 ? void 0 : item.clientCurrentId) !== null && _item$clientCurrentId !== void 0 ? _item$clientCurrentId : typeof (item === null || item === void 0 ? void 0 : item.ClientCurrent) === \"string\" ? item.ClientCurrent : null) !== null && _ref11 !== void 0 ? _ref11 : item === null || item === void 0 ? void 0 : (_item$ClientCurrent = item.ClientCurrent) === null || _item$ClientCurrent === void 0 ? void 0 : _item$ClientCurrent.id) !== null && _ref10 !== void 0 ? _ref10 : null\n        });\n      });\n      setAugmentedInfo(augmented); // default view = filtered (keeps pagination and filters consistent)\n\n      setInfo(augmented.filter(matchesFilters));\n    } catch (err) {\n      if (seq !== fetchSeq.current) return;\n      console.error(\"Error fetching data:\", err);\n      setInfo([]);\n      setAugmentedInfo([]);\n    } finally {\n      if (seq === fetchSeq.current) setIsLoading(false);\n    }\n  }\n\n  const searchChangeHandler = event => setSearch(event.target.value); // Filter the currently loaded items (now consistent with paged filtering)\n\n\n  useEffect(() => {\n    const base = augmentedInfo || [];\n    setInfo(base.filter(matchesFilters));\n  }, [augmentedInfo, matchesFilters]);\n\n  function sortCheckAll(pos) {\n    // Determine next direction: toggle the clicked column only\n    const nextSortCheck = sortCheck.map((v, i) => i === pos ? !v : v);\n    const isDesc = nextSortCheck[pos]; // true means descending\n\n    const sortedInfo = [...info].sort((a, b) => {\n      const key = labelBaseNames[pos];\n\n      if (pos === 1) {\n        // DATE column\n        const ta = toTime(a[key]);\n        const tb = toTime(b[key]); // Put missing dates at the end for ascending, at the start for descending\n\n        if (ta === null && tb === null) return 0;\n        if (ta === null) return isDesc ? -1 : 1;\n        if (tb === null) return isDesc ? 1 : -1;\n        return isDesc ? tb - ta : ta - tb;\n      } // NAME or SKU (string-y columns): indexes 0 or 5 in your original logic\n\n\n      if (pos === 0 || pos === 5) {\n        var _a$key, _b$key;\n\n        const av = ((_a$key = a[key]) !== null && _a$key !== void 0 ? _a$key : \"\").toString();\n        const bv = ((_b$key = b[key]) !== null && _b$key !== void 0 ? _b$key : \"\").toString();\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\n      } // Numeric-ish columns (wo, pn, sn) — fall back to string compare if NaN\n\n\n      const an = Number(a[key]);\n      const bn = Number(b[key]);\n\n      if (!isNaN(an) && !isNaN(bn)) {\n        return isDesc ? bn - an : an - bn;\n      } else {\n        var _a$key2, _b$key2;\n\n        const av = ((_a$key2 = a[key]) !== null && _a$key2 !== void 0 ? _a$key2 : \"\").toString();\n        const bv = ((_b$key2 = b[key]) !== null && _b$key2 !== void 0 ? _b$key2 : \"\").toString();\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\n      }\n    });\n    setInfo(sortedInfo);\n    setSortCheck(nextSortCheck); // Update header labels to show the little arrow on the active column\n\n    setLabels(withSortIcon(labelBase, pos, isDesc));\n  }\n\n  const rowSelect = item => {\n    if (item && item.id) {\n      console.log(\"Selected item:\", item);\n      router.push(\"./item/\" + item.id);\n    } else {\n      console.error(\"Unable to determine the selected item’s ID: \", item);\n    }\n  };\n\n  const {\n    0: selectedItems,\n    1: setSelectedItems\n  } = useState([]);\n  const {\n    0: showDeleteModal,\n    1: setShowDeleteModal\n  } = useState(false);\n\n  const handleSelectItem = id => {\n    setSelectedItems(prev => prev.includes(id) ? prev.filter(x => x !== id) : [...prev, id]);\n  }; // setSelectedItems((prev) => {\n  //   const newSelection = prev.includes(id)\n  //     ? prev.filter((itemId) => itemId !== id)\n  //     : [...prev, id];\n  //   console.log(\"Selected items:\", newSelection);\n  //   return newSelection; // <- important\n  // });\n\n\n  const handleShowDeleteModal = () => setShowDeleteModal(true);\n\n  const handleCloseDeleteModal = () => setShowDeleteModal(false);\n\n  const handleDeleteSelected = async () => {\n    setIsDeleting(true);\n    const db = firebase.firestore();\n\n    try {\n      // Loop over each selected item one at a time\n      for (const itemId of selectedItems) {\n        console.log(itemId);\n\n        try {\n          // Delete from \"Test\" collection\n          await db.collection(\"Test\").doc(itemId).delete();\n        } catch (err) {\n          console.error(`Error deleting document ${itemId} from Test:`, err);\n        }\n\n        try {\n          // Delete from \"Parts\" collection\n          await db.collection(\"Parts\").doc(itemId).delete();\n        } catch (err) {\n          console.error(`Error deleting document ${itemId} from Parts:`, err);\n        }\n\n        try {\n          // Delete associated photos from storage\n          await deleteFromStorage(itemId);\n        } catch (err) {\n          console.error(`Error deleting storage for ${itemId}:`, err);\n        }\n      } // Update local state by filtering out the deleted items\n\n\n      setInfo(info.filter(item => !selectedItems.includes(item.id)));\n      setSelectedItems([]);\n    } catch (error) {\n      console.error(\"Error deleting items:\", error);\n    } finally {\n      setIsDeleting(false);\n      handleCloseDeleteModal(); // Optionally, reload the page\n      // router.reload();\n    }\n  };\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true);\n\n  const checkDelete = (event, pos, idsToDelete, name) => {\n    if (event) {\n      event.preventDefault();\n      event.stopPropagation();\n    }\n\n    console.log(\"Selected IDs to delete:\", idsToDelete);\n    setSelectedItems(idsToDelete);\n    setDItem(name);\n    setShowDeleteModal(true);\n  }; // const handleDelete = async () => {\n  //   let itemId = gIde;\n  //   try {\n  //     setIsDeleting(true);\n  //     const db = firebase.firestore();\n  //     await db.collection(\"Test\").doc(itemId).delete();\n  //     await deleteFromPartsCollection(itemId);\n  //     await deleteFromStorage(itemId);\n  //     setInfo(info.filter((_, i) => gPos !== i));\n  //     console.log(`Deleted item: ${itemId}`);\n  //   } catch (error) {\n  //     console.error(\"Error deleting item:\", error);\n  //   } finally {\n  //     setIsDeleting(false);\n  //   }\n  //   handleClose();\n  // };\n\n\n  const hoverStyle = index => ({\n    backgroundColor: hoverIndex === index ? \"#ddd\" : \"transparent\",\n    textAlign: \"center\",\n    cursor: \"default\"\n  });\n\n  const {\n    0: dropdown1Text,\n    1: setDropdown1Text\n  } = useState(\"Select Option\");\n  const {\n    0: dropdown2Text,\n    1: setDropdown2Text\n  } = useState(\"Select Option\");\n\n  const handleSelect1 = (eventKey, event) => {\n    if (eventKey === \"unassigned\") {\n      setDropdown1Text(\"Select Option\");\n      setSelectedOEM(null);\n    } else {\n      setDropdown1Text(event.target.textContent);\n      setSelectedOEM(event.target.textContent);\n    }\n  };\n\n  const handleSelect2 = (eventKey, event) => {\n    if (eventKey === \"unassigned\") {\n      setDropdown2Text(\"Select Option\");\n      setSelectedModality(null);\n    } else {\n      setDropdown2Text(event.target.textContent);\n      setSelectedModality(event.target.textContent);\n    }\n  }; // Build a unique list of clients from the items currently loaded, filtered by OEM/Modality.\n  // `type` is \"from\" or \"current\" to decide which client ref to read.\n\n\n  async function buildClientsFromItems(type) {\n    const db = firebase.firestore();\n    const ids = new Set(); // Respect current OEM / Modality filters when deriving client options\n\n    const filtered = augmentedInfo.filter(item => {\n      const OEM = getMachineField(item, \"OEM\");\n      const Modality = getMachineField(item, \"Modality\");\n\n      if (selectedOEM && normalizeText(OEM) !== normalizeText(selectedOEM)) {\n        return false;\n      }\n\n      if (selectedModality && normalizeText(Modality) !== normalizeText(selectedModality)) {\n        return false;\n      }\n\n      return true;\n    });\n\n    for (const it of filtered) {\n      const id = type === \"from\" ? it.clientFromId : it.clientCurrentId;\n      if (id) ids.add(id);\n    }\n\n    const out = [];\n    const idArray = [...ids];\n\n    for (let i = 0; i < idArray.length; i += 10) {\n      const chunk = idArray.slice(i, i + 10);\n      const snap = await db.collection(\"Client\").where(firebase.firestore.FieldPath.documentId(), \"in\", chunk).get();\n      snap.forEach(doc => {\n        const d = doc.data() || {};\n        out.push({\n          id: doc.id,\n          name: d.name || doc.id\n        });\n      });\n    } // sort by name for nicer UX\n\n\n    out.sort((a, b) => (a.name || \"\").localeCompare(b.name || \"\"));\n    return out;\n  } // --------------------\n  // CLIENT SELECTION HANDLING\n  // --------------------\n  // This function fetches clients and opens the client modal.\n\n\n  const handleClientClick = async () => {\n    let safeClients = [];\n\n    try {\n      const clientsData = await fetchClients(selectedOEM, selectedModality);\n      safeClients = Array.isArray(clientsData) ? clientsData : [];\n    } catch (e) {\n      console.error(\"fetchClients failed:\", e);\n    } // Fallback to building from loaded items if API gave us nothing\n\n\n    if (safeClients.length === 0) {\n      try {\n        if (!clientSelectionType) {\n          // if somehow not set yet, default to \"from\"\n          setClientSelectionType(\"from\");\n        }\n\n        const derived = await buildClientsFromItems(clientSelectionType || \"from\");\n        safeClients = derived;\n      } catch (e) {\n        console.error(\"Fallback buildClientsFromItems failed:\", e);\n        safeClients = [];\n      }\n    }\n\n    setClients(safeClients);\n    setClientSearchTerm(\"\");\n    setShowClientModal(true);\n  }; // When a client is selected in the modal, we now assume the parameter is a client ID.\n  // If the passed value is null, we clear the selection.\n\n\n  const handleClientSelect = async clientId => {\n    console.log(\"User selected client id:\", clientId);\n\n    if (!clientId) {\n      if (clientSelectionType === \"from\") {\n        setClientFromButtonText(\"Select Option\");\n        setSelectedClientFrom(null);\n      } else if (clientSelectionType === \"current\") {\n        setClientCurrentButtonText(\"Select Option\");\n        setSelectedClientCurrent(null);\n      }\n\n      setShowClientModal(false);\n      return;\n    }\n\n    try {\n      const clientSnap = await firebase.firestore().collection(\"Client\").doc(clientId).get();\n\n      if (clientSnap.exists) {\n        const clientData = clientSnap.data();\n\n        if (clientSelectionType === \"from\") {\n          setClientFromButtonText(clientData.name);\n          setSelectedClientFrom(clientId);\n        } else if (clientSelectionType === \"current\") {\n          setClientCurrentButtonText(clientData.name);\n          setSelectedClientCurrent(clientId);\n        }\n      } else {\n        console.error(\"No client document found for id:\", clientId);\n      }\n    } catch (error) {\n      console.error(\"Error fetching client data:\", error);\n    }\n\n    setShowClientModal(false);\n  };\n\n  const handleClientInfo = (clientId, clientName) => {\n    console.log(`Client ID: ${clientId}, Client Name: ${clientName}`);\n    router.push(\"client/\" + clientId);\n  };\n\n  const handleClearClientSelection = () => {\n    if (clientSelectionType === \"from\") {\n      setClientFromButtonText(\"Select Option\");\n      setSelectedClientFrom(null);\n    } else if (clientSelectionType === \"current\") {\n      setClientCurrentButtonText(\"Select Option\");\n      setSelectedClientCurrent(null);\n    }\n\n    setShowClientModal(false);\n  }; // --------------------\n  // MODEL SELECTION HANDLING\n  // --------------------\n\n\n  const {\n    0: models,\n    1: setModels\n  } = useState([]);\n  const {\n    0: showModelModal,\n    1: setShowModelModal\n  } = useState(false);\n  const {\n    0: modelButtonText,\n    1: setModelButtonText\n  } = useState(\"Select Option\");\n\n  const handleModelClick = async () => {\n    const modelsData = await fetchModels(selectedOEM, selectedModality, selectedClientFrom);\n    setModels(modelsData);\n    setModelSearchTerm(\"\");\n    setShowModelModal(true);\n  };\n\n  const handleModelSelect = modelName => {\n    setModelButtonText(modelName || \"Select Option\");\n    setSelectedModel(modelName || null);\n    setShowModelModal(false);\n  };\n\n  const handleClearModelSelection = () => {\n    setModelButtonText(\"Select Option\");\n    setSelectedModel(null);\n    setShowModelModal(false);\n  }; // --------------------\n  // WAREHOUSE BUTTONS (for Client Current)\n  // --------------------\n\n\n  const handleSoCalWarehouseClick = () => {\n    setClientCurrentButtonText(\"SoCal Warehouse\");\n    setSelectedClientCurrent(SOCAL_CLIENT_ID);\n    console.log(\"Warehouse button clicked: setting Client Current to\", SOCAL_CLIENT_ID);\n  };\n\n  const handleNorCalWarehouseClick = () => {\n    setClientCurrentButtonText(\"NorCal Warehouse\");\n    setSelectedClientCurrent(NORCAL_CLIENT_ID);\n    console.log(\"Warehouse button clicked: setting Client Current to\", NORCAL_CLIENT_ID);\n  };\n\n  const handleWarehouseUnassignedClick = () => {\n    setClientCurrentButtonText(\"Unassigned\");\n    setSelectedClientCurrent(UNASSIGNED_CLIENT_ID);\n    console.log(\"Warehouse button clicked: setting Client Current to\", UNASSIGNED_CLIENT_ID);\n  };\n\n  const {\n    0: clientSearchTerm,\n    1: setClientSearchTerm\n  } = useState(\"\");\n  const {\n    0: modelSearchTerm,\n    1: setModelSearchTerm\n  } = useState(\"\");\n\n  const deleteFromStorage = async itemId => {\n    const storageRef = firebase.storage().ref();\n    const folderRef = storageRef.child(`Parts/${itemId}/`);\n\n    try {\n      const listResult = await folderRef.listAll();\n      const deletePromises = listResult.items.map(item => item.delete());\n      await Promise.all(deletePromises);\n    } catch (error) {\n      console.error(\"Error deleting from storage:\", error);\n    }\n  };\n\n  const deleteFromPartsCollection = async itemId => {\n    const db = firebase.firestore();\n\n    try {\n      await db.collection(\"Parts\").doc(itemId).delete();\n      console.log(`Deleted item from Parts collection: ${itemId}`);\n    } catch (error) {\n      console.error(\"Error deleting from Parts collection:\", error);\n    }\n  }; //   // Safely convert any date-ish value into a comparable timestamp (ms since epoch).\n  // function toTime(value) {\n  //   if (!value) return null;\n  //   // Firestore Timestamp: { seconds, nanoseconds }\n  //   if (typeof value === \"object\" && value.seconds) {\n  //     try {\n  //       return value.seconds * 1000;\n  //     } catch { /* fallthrough */ }\n  //   }\n  //   // If already a Date\n  //   if (value instanceof Date) return isNaN(value.getTime()) ? null : value.getTime();\n  //   // If string: try ISO first\n  //   if (typeof value === \"string\") {\n  //     // yyyy-mm-dd (from your form inputs)\n  //     const iso = Date.parse(value);\n  //     if (!isNaN(iso)) return iso;\n  //     // mm/dd/yyyy fallback (older items)\n  //     const parts = value.split(\"/\");\n  //     if (parts.length === 3) {\n  //       const [mm, dd, yyyy] = parts;\n  //       const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\n  //       if (!isNaN(alt)) return alt;\n  //     }\n  //   }\n  //   // Canonicalize any date-ish value to 'yyyy-mm-dd' so it matches <input type=\"date\"> values\n  //   function toYMD(value) {\n  //     const t = toTime(value);\n  //     if (t == null) return null;\n  //     const d = new Date(t);\n  //     const yyyy = d.getFullYear();\n  //     const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  //     const dd = String(d.getDate()).padStart(2, \"0\");\n  //     return `${yyyy}-${mm}-${dd}`;\n  //   }\n  //   // Last resort\n  //   const t = Date.parse(value);\n  //   return isNaN(t) ? null : t;\n  // }\n\n\n  const totalKnownPages = Math.max(1, pageCursors.filter(Boolean).length + (hasNextPage ? 1 : 0));\n  const pageButtons = [];\n\n  for (let i = 1; i <= totalKnownPages; i++) {\n    pageButtons.push(__jsx(Pagination.Item, {\n      key: i,\n      active: i === page,\n      onClick: () => setPage(i),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 878,\n        columnNumber: 7\n      }\n    }, i));\n  }\n\n  return __jsx(LoggedIn, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 890,\n      columnNumber: 5\n    }\n  }, isDeleting && __jsx(\"div\", {\n    className: \"loading-overlay\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 892,\n      columnNumber: 9\n    }\n  }, __jsx(Spinner, {\n    animation: \"border\",\n    role: \"status\",\n    className: \"spinner-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 893,\n      columnNumber: 11\n    }\n  }, __jsx(\"span\", {\n    className: \"sr-only\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 894,\n      columnNumber: 13\n    }\n  }, \"Loading...\"))), __jsx(Modal, {\n    show: showDeleteModal,\n    onHide: handleCloseDeleteModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 898,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 899,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 900,\n      columnNumber: 11\n    }\n  }, \"Confirm Deletion\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 902,\n      columnNumber: 9\n    }\n  }, \"Are you sure you want to delete \", selectedItems.length, \" item\", selectedItems.length > 1 ? \"s\" : \"\", \"?\"), __jsx(Modal.Footer, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 906,\n      columnNumber: 9\n    }\n  }, __jsx(Button, {\n    variant: \"danger\",\n    onClick: handleDeleteSelected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 907,\n      columnNumber: 11\n    }\n  }, \"Yes, delete\"), __jsx(Button, {\n    variant: \"secondary\",\n    onClick: handleCloseDeleteModal,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 910,\n      columnNumber: 11\n    }\n  }, \"Cancel\"))), __jsx(Modal, {\n    show: showClientModal,\n    onHide: () => setShowClientModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 916,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 917,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 918,\n      columnNumber: 11\n    }\n  }, \"Select \", clientSelectionType === \"from\" ? \"Client From\" : \"Client Current\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 922,\n      columnNumber: 9\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: clientSearchTerm,\n    onChange: e => setClientSearchTerm(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 923,\n      columnNumber: 11\n    }\n  }), __jsx(ClientTable, {\n    clients: (Array.isArray(clients) ? clients : []).filter(client => {\n      var _client$name;\n\n      return ((_client$name = client === null || client === void 0 ? void 0 : client.name) !== null && _client$name !== void 0 ? _client$name : \"\").toLowerCase().includes(clientSearchTerm.toLowerCase());\n    }),\n    onSelectClient: handleClientSelect,\n    onInfoClick: handleClientInfo,\n    isClientSearch: false,\n    clearSelection: () => handleClientSelect(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 930,\n      columnNumber: 11\n    }\n  }))), __jsx(Modal, {\n    show: showModelModal,\n    onHide: () => setShowModelModal(false),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 942,\n      columnNumber: 7\n    }\n  }, __jsx(Modal.Header, {\n    closeButton: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 943,\n      columnNumber: 9\n    }\n  }, __jsx(Modal.Title, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 944,\n      columnNumber: 11\n    }\n  }, \"Select Model\")), __jsx(Modal.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 946,\n      columnNumber: 9\n    }\n  }, __jsx(FormControl, {\n    type: \"text\",\n    placeholder: \"Search by name\",\n    className: \"mb-3\",\n    value: modelSearchTerm,\n    onChange: e => setModelSearchTerm(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 947,\n      columnNumber: 11\n    }\n  }), __jsx(ModelTable, {\n    models: models.filter(model => typeof model === \"string\" ? model.toLowerCase().includes(modelSearchTerm.toLowerCase()) : false),\n    onSelectModel: handleModelSelect,\n    clearSelection: () => handleModelSelect(null),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 954,\n      columnNumber: 11\n    }\n  }))), __jsx(Container, {\n    className: \"d-flex align-items-center justify-content-center\",\n    style: {\n      minHeight: \"100vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 966,\n      columnNumber: 7\n    }\n  }, __jsx(\"div\", {\n    className: \"w-100\",\n    style: {\n      maxWidth: \"1200px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 970,\n      columnNumber: 9\n    }\n  }, __jsx(Card, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 971,\n      columnNumber: 11\n    }\n  }, __jsx(Card.Body, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 972,\n      columnNumber: 13\n    }\n  }, __jsx(\"h2\", {\n    className: \"text-center mb-4\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 973,\n      columnNumber: 15\n    }\n  }, \"Magmo\"), __jsx(Row, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 974,\n      columnNumber: 15\n    }\n  }, __jsx(Col, {\n    md: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 975,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 977,\n      columnNumber: 19\n    }\n  }, __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 978,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 979,\n      columnNumber: 23\n    }\n  }, \"OEM\"), __jsx(Dropdown, {\n    onSelect: handleSelect1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 980,\n      columnNumber: 23\n    }\n  }, __jsx(Dropdown.Toggle, {\n    variant: \"outline-secondary\",\n    id: \"dropdown-button-1\",\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 981,\n      columnNumber: 25\n    }\n  }, dropdown1Text), __jsx(Dropdown.Menu, {\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 988,\n      columnNumber: 25\n    }\n  }, __jsx(Dropdown.Item, {\n    eventKey: \"unassigned\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 989,\n      columnNumber: 27\n    }\n  }, \"Select Option\"), __jsx(Dropdown.Item, {\n    eventKey: \"GE\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 992,\n      columnNumber: 27\n    }\n  }, \"GE\"), __jsx(Dropdown.Item, {\n    eventKey: \"Toshiba\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 993,\n      columnNumber: 27\n    }\n  }, \"Toshiba\"), __jsx(Dropdown.Item, {\n    eventKey: \"Siemens\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 996,\n      columnNumber: 27\n    }\n  }, \"Siemens\"), __jsx(Dropdown.Item, {\n    eventKey: \"Philips\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 999,\n      columnNumber: 27\n    }\n  }, \"Philips\")))), __jsx(InputGroup, {\n    className: \"mb-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1006,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1007,\n      columnNumber: 23\n    }\n  }, \"Modality\"), __jsx(Dropdown, {\n    onSelect: handleSelect2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1008,\n      columnNumber: 23\n    }\n  }, __jsx(Dropdown.Toggle, {\n    variant: \"outline-secondary\",\n    id: \"dropdown-button-2\",\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1009,\n      columnNumber: 25\n    }\n  }, dropdown2Text), __jsx(Dropdown.Menu, {\n    className: \"w-100\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1016,\n      columnNumber: 25\n    }\n  }, __jsx(Dropdown.Item, {\n    eventKey: \"unassigned\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1017,\n      columnNumber: 27\n    }\n  }, \"Select Option\"), __jsx(Dropdown.Item, {\n    eventKey: \"CT\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1020,\n      columnNumber: 27\n    }\n  }, \"CT\"), __jsx(Dropdown.Item, {\n    eventKey: \"MRI\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1021,\n      columnNumber: 27\n    }\n  }, \"MRI\"))))), __jsx(\"div\", {\n    className: styles.divider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1027,\n      columnNumber: 19\n    }\n  }), __jsx(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1030,\n      columnNumber: 19\n    }\n  }, __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1031,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1032,\n      columnNumber: 23\n    }\n  }, \"Client From\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: () => handleClientClick(\"from\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1033,\n      columnNumber: 23\n    }\n  }, clientFromButtonText)), __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1042,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1043,\n      columnNumber: 23\n    }\n  }, \"Client Current\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: () => handleClientClick(\"current\"),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1044,\n      columnNumber: 23\n    }\n  }, clientCurrentButtonText)), __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1054,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1055,\n      columnNumber: 23\n    }\n  }, \"Model\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: \"w-100\",\n    onClick: handleModelClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1056,\n      columnNumber: 23\n    }\n  }, modelButtonText)), __jsx(\"div\", {\n    className: styles.divider,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1065,\n      columnNumber: 21\n    }\n  }), __jsx(InputGroup, {\n    className: \"mb-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1068,\n      columnNumber: 21\n    }\n  }, __jsx(InputGroup.Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1069,\n      columnNumber: 23\n    }\n  }, \"Warehouse\"), __jsx(\"div\", {\n    className: styles.buttonGroup,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1070,\n      columnNumber: 23\n    }\n  }, __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.flexButton,\n    onClick: handleSoCalWarehouseClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1071,\n      columnNumber: 25\n    }\n  }, \"SoCal Warehouse\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.flexButton,\n    onClick: handleNorCalWarehouseClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1078,\n      columnNumber: 25\n    }\n  }, \"NorCal Warehouse\"), __jsx(Button, {\n    variant: \"outline-secondary\",\n    className: styles.flexButton,\n    onClick: handleWarehouseUnassignedClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1085,\n      columnNumber: 25\n    }\n  }, \"Unassigned\"))))), __jsx(Col, {\n    md: 8,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1097,\n      columnNumber: 17\n    }\n  }, __jsx(\"div\", {\n    className: styles.tableContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1098,\n      columnNumber: 19\n    }\n  }, isLoading ? __jsx(\"div\", {\n    className: \"jsx-1682384643\" + \" \" + \"d-flex justify-content-center align-items-center p-5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1100,\n      columnNumber: 23\n    }\n  }, __jsx(\"img\", {\n    src: \"/magmo-logo.png\" // make sure it's in /public\n    ,\n    alt: \"Loading Magmo\",\n    style: {\n      width: 64,\n      height: 64,\n      animation: \"magmo-spin 1s linear infinite\",\n      transformOrigin: \"50% 50%\",\n      display: \"block\"\n    },\n    className: \"jsx-1682384643\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1101,\n      columnNumber: 25\n    }\n  }), __jsx(_JSXStyle, {\n    id: \"1682384643\",\n    __self: this,\n    __source: void 0\n  }, \"@-webkit-keyframes magmo-spin{from{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}to{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}@keyframes magmo-spin{from{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg);}to{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcbWFjazJcXERlc2t0b3BcXGNvZGVcXHBhZ2VzXFxOZXdTZWFyY2hcXG1haW5TZWFyY2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBeWxDMkMsQUFJa0MsQUFHRSxpRkFGM0IsTUFHQSIsImZpbGUiOiJDOlxcVXNlcnNcXG1hY2syXFxEZXNrdG9wXFxjb2RlXFxwYWdlc1xcTmV3U2VhcmNoXFxtYWluU2VhcmNoLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlU3RhdGUsIHVzZVJlZiwgdXNlQ2FsbGJhY2sgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7XHJcbiAgQ29udGFpbmVyLFxuICBDYXJkLFxuICBSb3csXG4gIENvbCxcbiAgSW5wdXRHcm91cCxcbiAgRHJvcGRvd24sXG4gIEZvcm1Db250cm9sLFxuICBCdXR0b24sXG4gIE5hdkRyb3Bkb3duLFxuICBGb3JtLFxuICBNb2RhbCxcbiAgU3Bpbm5lcixcbiAgUGFnaW5hdGlvbixcbn0gZnJvbSBcInJlYWN0LWJvb3RzdHJhcFwiO1xuaW1wb3J0IExpbmsgZnJvbSBcIm5leHQvbGlua1wiO1xuaW1wb3J0IHsgdXNlUm91dGVyIH0gZnJvbSBcIm5leHQvcm91dGVyXCI7XG5pbXBvcnQge1xuICBmZXRjaFBhcnRzV2l0aE1hY2hpbmVEYXRhUGFnZSxcbiAgZmV0Y2hDbGllbnRzLFxuICBmZXRjaE1vZGVscyxcbiAgZm9ybWF0RGF0ZSxcbn0gZnJvbSBcIi4uLy4uL3V0aWxzL2ZldGNoQXNzb2NpYXRpb25zXCI7XG5pbXBvcnQgeyB1c2VBdXRoIH0gZnJvbSBcIi4uLy4uL2NvbnRleHQvQXV0aFVzZXJDb250ZXh0XCI7XHJcbmltcG9ydCBMb2dnZWRJbiBmcm9tIFwiLi4vTG9nZ2VkSW5cIjtcclxuaW1wb3J0IENsaWVudFRhYmxlIGZyb20gXCIuLi8uLi91dGlscy9DbGllbnRUYWJsZVwiO1xyXG5pbXBvcnQgTW9kZWxUYWJsZSBmcm9tIFwiLi4vLi4vdXRpbHMvTW9kZWxUYWJsZVwiO1xyXG5pbXBvcnQgUGFydFRhYmxlIGZyb20gXCIuLi8uLi91dGlscy9QYXJ0VGFibGVcIjtcclxuaW1wb3J0IHN0eWxlcyBmcm9tIFwiLi4vLi4vc3R5bGVzL01haW5TZWFyY2gubW9kdWxlLmNzc1wiO1xyXG5pbXBvcnQgZmlyZWJhc2UgZnJvbSBcIi4uLy4uL2NvbnRleHQvRmlyZWJhc2VcIjtcclxuXHJcbi8vIFByZWRlZmluZWQgd2FyZWhvdXNlIGNsaWVudCBJRHMgYW5kIGRpc3BsYXkgbmFtZXNcclxuY29uc3QgU09DQUxfQ0xJRU5UX0lEID0gXCJBSVMxNzE4MlwiO1xyXG5jb25zdCBOT1JDQUxfQ0xJRU5UX0lEID0gXCJBSVMyNTA5N1wiO1xuY29uc3QgVU5BU1NJR05FRF9DTElFTlRfSUQgPSBcIkFJUzAwNDA0XCI7XG5jb25zdCBQQUdFX1NJWkUgPSAyNTtcblxyXG5cclxuLy8gU2ltdWxhdGVzIGEgbmV0d29yayByZXF1ZXN0IGRlbGF5XHJcbmZ1bmN0aW9uIHNpbXVsYXRlTmV0d29ya1JlcXVlc3QoKSB7XHJcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDIwMDApKTtcclxufVxyXG5cclxuLy8gQ3VzdG9tIExvYWRpbmdCdXR0b24gY29tcG9uZW50XHJcbmZ1bmN0aW9uIExvYWRpbmdCdXR0b24oeyB0eXBlLCBuYW1lLCByb3V0ZSB9KSB7XG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldExvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgbGV0IGNhbmNlbGxlZCA9IGZhbHNlO1xuICAgICAgc2ltdWxhdGVOZXR3b3JrUmVxdWVzdCgpLnRoZW4oKCkgPT4ge1xuICAgICAgICBpZiAoIWNhbmNlbGxlZCkgc2V0TG9hZGluZyhmYWxzZSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgIGNhbmNlbGxlZCA9IHRydWU7XG4gICAgICB9O1xuICAgIH1cbiAgfSwgW2lzTG9hZGluZ10pO1xuXHJcbiAgcmV0dXJuIChcclxuICAgIDxMaW5rIGhyZWY9e2AvJHtyb3V0ZX1gfT5cclxuICAgICAgPGFcclxuICAgICAgICBjbGFzc05hbWU9e2BidG4gYnRuLSR7dHlwZX1gfVxyXG4gICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmd9XHJcbiAgICAgICAgb25DbGljaz17KCkgPT4gIWlzTG9hZGluZyAmJiBzZXRMb2FkaW5nKHRydWUpfVxyXG4gICAgICA+XHJcbiAgICAgICAge2lzTG9hZGluZyA/IFwiTG9hZGluZ+KAplwiIDogbmFtZX1cclxuICAgICAgPC9hPlxyXG4gICAgPC9MaW5rPlxyXG4gICk7XHJcbn1cclxuXHJcbi8vIC0tLS0gREFURSBIRUxQRVJTICh0b3AtbGV2ZWwgc2NvcGUpIC0tLS1cclxuXHJcbi8vIENvbnZlcnQgYW55dGhpbmcgZGF0ZS1pc2ggaW50byBhIHRpbWVzdGFtcCAobXMgc2luY2UgZXBvY2gpLlxyXG5mdW5jdGlvbiB0b1RpbWUodmFsdWUpIHtcclxuICBpZiAoIXZhbHVlKSByZXR1cm4gbnVsbDtcclxuXHJcbiAgLy8gRmlyZXN0b3JlIFRpbWVzdGFtcCB7IHNlY29uZHMsIG5hbm9zZWNvbmRzIH1cclxuICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlICE9PSBudWxsICYmIHZhbHVlLnNlY29uZHMgIT0gbnVsbCkge1xyXG4gICAgdHJ5IHsgcmV0dXJuIHZhbHVlLnNlY29uZHMgKiAxMDAwOyB9IGNhdGNoIHsgLyogaWdub3JlICovIH1cclxuICB9XHJcblxyXG4gIC8vIE5hdGl2ZSBEYXRlXHJcbiAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xyXG4gICAgY29uc3QgdCA9IHZhbHVlLmdldFRpbWUoKTtcclxuICAgIHJldHVybiBpc05hTih0KSA/IG51bGwgOiB0O1xyXG4gIH1cclxuXHJcbiAgLy8gU3RyaW5nc1xyXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcclxuICAgIC8vIElTTyAvIHl5eXktbW0tZGRcclxuICAgIGNvbnN0IGlzbyA9IERhdGUucGFyc2UodmFsdWUpO1xyXG4gICAgaWYgKCFpc05hTihpc28pKSByZXR1cm4gaXNvO1xyXG5cclxuICAgIC8vIG1tL2RkL3l5eXlcclxuICAgIGNvbnN0IHBhcnRzID0gdmFsdWUuc3BsaXQoXCIvXCIpO1xyXG4gICAgaWYgKHBhcnRzLmxlbmd0aCA9PT0gMykge1xyXG4gICAgICBjb25zdCBbbW0sIGRkLCB5eXl5XSA9IHBhcnRzO1xyXG4gICAgICBjb25zdCBhbHQgPSBEYXRlLnBhcnNlKGAke3l5eXl9LSR7bW19LSR7ZGR9YCk7XHJcbiAgICAgIGlmICghaXNOYU4oYWx0KSkgcmV0dXJuIGFsdDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIExhc3QgcmVzb3J0XHJcbiAgY29uc3QgdCA9IERhdGUucGFyc2UodmFsdWUpO1xyXG4gIHJldHVybiBpc05hTih0KSA/IG51bGwgOiB0O1xyXG59XHJcblxyXG4vLyBDYW5vbmljYWxpemUgdG8gJ3l5eXktbW0tZGQnIChtYXRjaGVzIDxpbnB1dCB0eXBlPVwiZGF0ZVwiPilcclxuZnVuY3Rpb24gdG9ZTUQodmFsdWUpIHtcbiAgY29uc3QgdCA9IHRvVGltZSh2YWx1ZSk7XG4gIGlmICh0ID09IG51bGwpIHJldHVybiBudWxsO1xuICBjb25zdCBkID0gbmV3IERhdGUodCk7XG4gIGNvbnN0IHl5eXkgPSBkLmdldEZ1bGxZZWFyKCk7XG4gIGNvbnN0IG1tID0gU3RyaW5nKGQuZ2V0TW9udGgoKSArIDEpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcbiAgY29uc3QgZGQgPSBTdHJpbmcoZC5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsIFwiMFwiKTtcbiAgcmV0dXJuIGAke3l5eXl9LSR7bW19LSR7ZGR9YDtcbn1cblxuZnVuY3Rpb24gbm9ybWFsaXplVGV4dCh2YWx1ZSkge1xuICBpZiAodmFsdWUgPT0gbnVsbCkgcmV0dXJuIFwiXCI7XG4gIHJldHVybiBTdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xufVxuXG5mdW5jdGlvbiBnZXRNYWNoaW5lRmllbGQoaXRlbSwga2V5KSB7XG4gIGlmICghaXRlbSkgcmV0dXJuIG51bGw7XG4gIGNvbnN0IGxvd2VyID0ga2V5LnRvTG93ZXJDYXNlKCk7XG4gIHJldHVybiAoXG4gICAgaXRlbT8ubWFjaGluZURhdGE/LltrZXldID8/XG4gICAgaXRlbT8ubWFjaGluZURhdGE/Lltsb3dlcl0gPz9cbiAgICBpdGVtPy5jdXJyZW50TWFjaGluZURhdGE/LltrZXldID8/XG4gICAgaXRlbT8uY3VycmVudE1hY2hpbmVEYXRhPy5bbG93ZXJdID8/XG4gICAgaXRlbT8udGhlTWFjaGluZURhdGE/LltrZXldID8/XG4gICAgaXRlbT8udGhlTWFjaGluZURhdGE/Lltsb3dlcl0gPz9cbiAgICBpdGVtPy5UaGVNYWNoaW5lPy5ba2V5XSA/P1xuICAgIGl0ZW0/LlRoZU1hY2hpbmU/Lltsb3dlcl0gPz9cbiAgICBudWxsXG4gICk7XG59XG5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gTWFpblNlYXJjaCgpIHtcbiAgY29uc3QgeyBzaWduT3V0IH0gPSB1c2VBdXRoKCk7XHJcbiAgY29uc3QgW2luZm8sIHNldEluZm9dID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFtiYWNrdXBJbmZvLCBzZXRCYWNrdXBJbmZvXSA9IHVzZVN0YXRlKFtdKTtcclxuICBjb25zdCBbYXVnbWVudGVkSW5mbywgc2V0QXVnbWVudGVkSW5mb10gPSB1c2VTdGF0ZShbXSk7IC8vIGl0ZW1zIHdpdGggY2xpZW50RnJvbUlkL2N1cnJlbnRJZCBhZGRlZFxyXG4gIGNvbnN0IFtpc0xvYWRpbmcsIHNldElzTG9hZGluZ10gPSB1c2VTdGF0ZSh0cnVlKTtcclxuICBjb25zdCBbaWRzLCBzZXRJRF0gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW3Nob3csIHNldFNob3ddID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtkSXRlbSwgc2V0REl0ZW1dID0gdXNlU3RhdGUoKTtcclxuICBjb25zdCBbc2VsZWN0LCBzZXRTZWxlY3RdID0gdXNlU3RhdGUoXCJOYW1lXCIpO1xyXG4gIGNvbnN0IFtzaG93TGlzdCwgc2V0U2hvd0xpc3RdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFtzaG93TGlzdFNlYXJjaCwgc2V0U2hvd0xpc3RTZWFyY2hdID0gdXNlU3RhdGUoXCJ0ZXh0XCIpO1xyXG4gIGNvbnN0IFtzZWFyY2gsIHNldFNlYXJjaF0gPSB1c2VTdGF0ZShcIlwiKTtcclxuICBjb25zdCBbc2VsZWN0ZWRPRU0sIHNldFNlbGVjdGVkT0VNXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtzZWxlY3RlZE1vZGFsaXR5LCBzZXRTZWxlY3RlZE1vZGFsaXR5XSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIC8vIFJlcGxhY2UgdGhlIG9sZCBzaW5nbGUgY2xpZW50IHN0YXRlIHdpdGggdHdvIHNldHM6XHJcbiAgY29uc3QgW3NlbGVjdGVkQ2xpZW50RnJvbSwgc2V0U2VsZWN0ZWRDbGllbnRGcm9tXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtjbGllbnRGcm9tQnV0dG9uVGV4dCwgc2V0Q2xpZW50RnJvbUJ1dHRvblRleHRdID0gdXNlU3RhdGUoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gIGNvbnN0IFtzZWxlY3RlZENsaWVudEN1cnJlbnQsIHNldFNlbGVjdGVkQ2xpZW50Q3VycmVudF0gPSB1c2VTdGF0ZShudWxsKTtcclxuICBjb25zdCBbY2xpZW50Q3VycmVudEJ1dHRvblRleHQsIHNldENsaWVudEN1cnJlbnRCdXR0b25UZXh0XSA9IHVzZVN0YXRlKFwiU2VsZWN0IE9wdGlvblwiKTtcclxuXHJcbiAgY29uc3QgW2NsaWVudHMsIHNldENsaWVudHNdID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFtzaG93Q2xpZW50TW9kYWwsIHNldFNob3dDbGllbnRNb2RhbF0gPSB1c2VTdGF0ZShmYWxzZSk7XHJcbiAgLy8gVGhpcyBzdGF0ZSB0ZWxscyB0aGUgbW9kYWwgd2hpY2ggY2xpZW50IGJveCBpcyBiZWluZyB1cGRhdGVkOiBcImZyb21cIiBvciBcImN1cnJlbnRcIlxyXG4gIGNvbnN0IFtjbGllbnRTZWxlY3Rpb25UeXBlLCBzZXRDbGllbnRTZWxlY3Rpb25UeXBlXSA9IHVzZVN0YXRlKG51bGwpO1xyXG5cclxuICBjb25zdCByb3V0ZXIgPSB1c2VSb3V0ZXIoKTtcclxuICBjb25zdCBsYWJlbEJhc2UgPSBbXCJuYW1lXCIsIFwiZGF0ZVwiLCBcIncvb1wiLCBcInAvblwiLCBcInMvblwiXTtcclxuICBjb25zdCBsYWJlbEJhc2VOYW1lcyA9IFtcIm5hbWVcIiwgXCJkYXRlXCIsIFwid29cIiwgXCJwblwiLCBcInNuXCJdO1xyXG4gIGNvbnN0IHNvcnRDaGVja0Jhc2UgPSBbZmFsc2UsIGZhbHNlLCBmYWxzZSwgZmFsc2UsIGZhbHNlLCBmYWxzZV07XHJcblxyXG4gIGZ1bmN0aW9uIHdpdGhTb3J0SWNvbihiYXNlTGFiZWxzLCBhY3RpdmVJbmRleCwgaXNEZXNjKSB7XHJcbiAgICByZXR1cm4gYmFzZUxhYmVscy5tYXAoKHRleHQsIGkpID0+IHtcclxuICAgICAgaWYgKGkgIT09IGFjdGl2ZUluZGV4KSByZXR1cm4gdGV4dDsgLy8gdW50b3VjaGVkXHJcbiAgICAgIGNvbnN0IGFycm93ID0gaXNEZXNjID8gXCIg4pa8XCIgOiBcIiDilrJcIjtcclxuICAgICAgcmV0dXJuIGAke3RleHR9JHthcnJvd31gO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgY29uc3QgW2xhYmVscywgc2V0TGFiZWxzXSA9IHVzZVN0YXRlKGxhYmVsQmFzZSk7XHJcbiAgY29uc3QgW3NvcnRDaGVjaywgc2V0U29ydENoZWNrXSA9IHVzZVN0YXRlKHNvcnRDaGVja0Jhc2UpO1xyXG4gIGNvbnN0IFtob3ZlckluZGV4LCBzZXRIb3ZlckluZGV4XSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtzZWxlY3RlZE1vZGVsLCBzZXRTZWxlY3RlZE1vZGVsXSA9IHVzZVN0YXRlKG51bGwpO1xyXG4gIGNvbnN0IFtnUG9zLCBzZXRHUG9zXSA9IHVzZVN0YXRlKG51bGwpO1xuICBjb25zdCBbZ0lkZSwgc2V0R0lkZV0gPSB1c2VTdGF0ZShudWxsKTtcbiAgY29uc3QgW2lzRGVsZXRpbmcsIHNldElzRGVsZXRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbcGFnZSwgc2V0UGFnZV0gPSB1c2VTdGF0ZSgxKTtcbiAgY29uc3QgW3BhZ2VDdXJzb3JzLCBzZXRQYWdlQ3Vyc29yc10gPSB1c2VTdGF0ZShbXSk7XG4gIGNvbnN0IFtoYXNOZXh0UGFnZSwgc2V0SGFzTmV4dFBhZ2VdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBmZXRjaFNlcSA9IHVzZVJlZigwKTtcbiAgY29uc3QgW3F1ZXJ5RXBvY2gsIHNldFF1ZXJ5RXBvY2hdID0gdXNlU3RhdGUoMCk7XG5cbiAgY29uc3Qgc2VhcmNoTG93ZXIgPSAoc2VhcmNoIHx8IFwiXCIpLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICBjb25zdCBoYXNBY3RpdmVGaWx0ZXJzID1cbiAgICBCb29sZWFuKHNlbGVjdGVkT0VNKSB8fFxuICAgIEJvb2xlYW4oc2VsZWN0ZWRNb2RhbGl0eSkgfHxcbiAgICBCb29sZWFuKHNlbGVjdGVkTW9kZWwpIHx8XG4gICAgQm9vbGVhbihzZWxlY3RlZENsaWVudEZyb20pIHx8XG4gICAgQm9vbGVhbihzZWxlY3RlZENsaWVudEN1cnJlbnQpIHx8XG4gICAgQm9vbGVhbihzZWFyY2hMb3dlcik7XG5cbiAgY29uc3QgdmFsdWVNYXRjaGVzID0gKHZhbHVlLCBzKSA9PiB7XG4gICAgaWYgKCF2YWx1ZSkgcmV0dXJuIGZhbHNlO1xuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgcmV0dXJuIHZhbHVlLnNvbWUoKHYpID0+IHZhbHVlTWF0Y2hlcyh2LCBzKSk7XG4gICAgfVxuICAgIHJldHVybiBTdHJpbmcodmFsdWUpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocyk7XG4gIH07XG5cbiAgY29uc3QgbWF0Y2hlc0ZpbHRlcnMgPSB1c2VDYWxsYmFjayhcbiAgICAoaXRlbSkgPT4ge1xuICAgICAgLy8gaGlkZSBleHBsaWNpdGx5IGhpZGRlbiBpdGVtc1xuICAgICAgaWYgKGl0ZW0/LnZpc2libGUgPT09IGZhbHNlKSByZXR1cm4gZmFsc2U7XG5cbiAgICAgIC8vIE9FTSAvIE1vZGFsaXR5IC8gTW9kZWwgZmlsdGVyaW5nXG4gICAgICBjb25zdCBPRU0gPSBnZXRNYWNoaW5lRmllbGQoaXRlbSwgXCJPRU1cIik7XG4gICAgICBjb25zdCBNb2RhbGl0eSA9IGdldE1hY2hpbmVGaWVsZChpdGVtLCBcIk1vZGFsaXR5XCIpO1xuICAgICAgY29uc3QgTW9kZWwgPSBnZXRNYWNoaW5lRmllbGQoaXRlbSwgXCJNb2RlbFwiKTtcblxuICAgICAgaWYgKHNlbGVjdGVkT0VNICYmIG5vcm1hbGl6ZVRleHQoT0VNKSAhPT0gbm9ybWFsaXplVGV4dChzZWxlY3RlZE9FTSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKFxuICAgICAgICBzZWxlY3RlZE1vZGFsaXR5ICYmXG4gICAgICAgIG5vcm1hbGl6ZVRleHQoTW9kYWxpdHkpICE9PSBub3JtYWxpemVUZXh0KHNlbGVjdGVkTW9kYWxpdHkpXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKHNlbGVjdGVkTW9kZWwgJiYgbm9ybWFsaXplVGV4dChNb2RlbCkgIT09IG5vcm1hbGl6ZVRleHQoc2VsZWN0ZWRNb2RlbCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgICAvLyBDbGllbnQgZmlsdGVyc1xuICAgICAgaWYgKHNlbGVjdGVkQ2xpZW50RnJvbSAmJiBpdGVtPy5jbGllbnRGcm9tSWQgIT09IHNlbGVjdGVkQ2xpZW50RnJvbSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAoXG4gICAgICAgIHNlbGVjdGVkQ2xpZW50Q3VycmVudCAmJlxuICAgICAgICBpdGVtPy5jbGllbnRDdXJyZW50SWQgIT09IHNlbGVjdGVkQ2xpZW50Q3VycmVudFxuICAgICAgKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgICAgLy8gU2VhcmNoXG4gICAgICBpZiAoc2VhcmNoTG93ZXIpIHtcbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJOYW1lXCIpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWVNYXRjaGVzKGl0ZW0/Lm5hbWUsIHNlYXJjaExvd2VyKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0ID09PSBcIkRhdGVcIikge1xuICAgICAgICAgIGNvbnN0IHdhbnRlZERheSA9IHNlYXJjaExvd2VyOyAvLyB5eXl5LW1tLWRkIGZyb20gaW5wdXRcbiAgICAgICAgICBjb25zdCBpdGVtWU1EID0gdG9ZTUQoaXRlbT8uZGF0ZSk7XG4gICAgICAgICAgaWYgKGl0ZW1ZTUQgJiYgaXRlbVlNRCA9PT0gd2FudGVkRGF5KSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVtPy5kZXNjcmlwdGlvbnMpKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS5kZXNjcmlwdGlvbnMuc29tZSgoZCkgPT4gdG9ZTUQoZD8uZGF0ZSkgPT09IHdhbnRlZERheSkpIHtcbiAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KGl0ZW0/LndvcmtPcmRlcnMpKSB7XG4gICAgICAgICAgICBpZiAoaXRlbS53b3JrT3JkZXJzLnNvbWUoKHcpID0+IHRvWU1EKHc/LmRhdGUpID09PSB3YW50ZWREYXkpKSB7XG4gICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJXb3JrIE9yZGVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgQXJyYXkuaXNBcnJheShpdGVtPy53b3JrT3JkZXJzKSAmJlxuICAgICAgICAgICAgaXRlbS53b3JrT3JkZXJzLnNvbWUoKHdvKSA9PlxuICAgICAgICAgICAgICB2YWx1ZU1hdGNoZXMod28/LndvcmtPcmRlciwgc2VhcmNoTG93ZXIpXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2VsZWN0ID09PSBcIlByb2R1Y3QgTnVtYmVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWVNYXRjaGVzKGl0ZW0/LnBuLCBzZWFyY2hMb3dlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJTZXJpYWwgTnVtYmVyXCIpIHtcbiAgICAgICAgICByZXR1cm4gdmFsdWVNYXRjaGVzKGl0ZW0/LnNuLCBzZWFyY2hMb3dlcik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJEZXNjcmlwdGlvblwiKSB7XG4gICAgICAgICAgaWYgKHZhbHVlTWF0Y2hlcyhpdGVtPy5kZXNjLCBzZWFyY2hMb3dlcikpIHJldHVybiB0cnVlO1xuICAgICAgICAgIGlmICh2YWx1ZU1hdGNoZXMoaXRlbT8uZGVzY3JpcHRpb24sIHNlYXJjaExvd2VyKSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoaXRlbT8uZGVzY3JpcHRpb25zKSkge1xuICAgICAgICAgICAgcmV0dXJuIGl0ZW0uZGVzY3JpcHRpb25zLnNvbWUoKGQpID0+XG4gICAgICAgICAgICAgIHZhbHVlTWF0Y2hlcyhkPy5kZXNjcmlwdGlvbiwgc2VhcmNoTG93ZXIpXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlbGVjdCA9PT0gXCJTS1VcIikge1xuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICB2YWx1ZU1hdGNoZXMoaXRlbT8uaWQsIHNlYXJjaExvd2VyKSB8fFxuICAgICAgICAgICAgdmFsdWVNYXRjaGVzKGl0ZW0/LmxvY2FsU04sIHNlYXJjaExvd2VyKSB8fFxuICAgICAgICAgICAgdmFsdWVNYXRjaGVzKGl0ZW0/LmxvY2FsX3NuLCBzZWFyY2hMb3dlcilcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgW1xuICAgICAgc2VsZWN0ZWRPRU0sXG4gICAgICBzZWxlY3RlZE1vZGFsaXR5LFxuICAgICAgc2VsZWN0ZWRNb2RlbCxcbiAgICAgIHNlbGVjdGVkQ2xpZW50RnJvbSxcbiAgICAgIHNlbGVjdGVkQ2xpZW50Q3VycmVudCxcbiAgICAgIHNlYXJjaExvd2VyLFxuICAgICAgc2VsZWN0LFxuICAgIF1cbiAgKTtcblxuICBjb25zdCByZXNldFBhZ2luYXRpb24gPSAoKSA9PiB7XG4gICAgc2V0UGFnZSgxKTtcbiAgICBzZXRQYWdlQ3Vyc29ycyhbXSk7XG4gICAgc2V0SGFzTmV4dFBhZ2UoZmFsc2UpO1xuICB9O1xuXG4gIC8vIFJlc2V0IHBhZ2luYXRpb24gb24gcm91dGUvcXVlcnkgY2hhbmdlIChwcmV2ZW50cyBzdGFsZSBwYWdlcyBsaWtlIOKAnHN0YXJ0aW5nIGF0IDbigJ0pXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgcmVzZXRQYWdpbmF0aW9uKCk7XG4gICAgc2V0UXVlcnlFcG9jaCgodikgPT4gdiArIDEpO1xuICB9LCBbcm91dGVyLmFzUGF0aF0pO1xuXG4gIC8vIFJlc2V0IGFuZCByZWZldGNoIHdoZW4gZmlsdGVycy9zZWFyY2ggY2hhbmdlXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgcmVzZXRQYWdpbmF0aW9uKCk7XG4gICAgc2V0UXVlcnlFcG9jaCgodikgPT4gdiArIDEpO1xuICB9LCBbXG4gICAgc2VsZWN0ZWRPRU0sXG4gICAgc2VsZWN0ZWRNb2RhbGl0eSxcbiAgICBzZWxlY3RlZE1vZGVsLFxuICAgIHNlbGVjdGVkQ2xpZW50RnJvbSxcbiAgICBzZWxlY3RlZENsaWVudEN1cnJlbnQsXG4gICAgc2VhcmNoLFxuICAgIHNlbGVjdCxcbiAgXSk7XG5cbiAgLy8gRmV0Y2ggZGF0YSBvbiBjb21wb25lbnQgbW91bnQgYW5kIHJvdXRlIGNoYW5nZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGZldGNoRGF0YShwYWdlKTtcbiAgfSwgW3BhZ2UsIHF1ZXJ5RXBvY2hdKTtcblxuICBhc3luYyBmdW5jdGlvbiBmZXRjaERhdGEocmVxdWVzdGVkUGFnZSA9IDEpIHtcbiAgICBjb25zdCBzZXEgPSArK2ZldGNoU2VxLmN1cnJlbnQ7XG4gICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuICAgIHRyeSB7XG4gICAgICBpZiAocm91dGVyLnF1ZXJ5LmlucHV0VGV4dCAmJiByb3V0ZXIucXVlcnkuc2VsZWN0ZWRUeXBlKSB7XG4gICAgICAgIHNldFNlbGVjdChyb3V0ZXIucXVlcnkuc2VsZWN0ZWRUeXBlKTtcbiAgICAgICAgc2V0U2VhcmNoKHJvdXRlci5xdWVyeS5pbnB1dFRleHQpO1xuICAgICAgfVxuICAgICAgY29uc3Qgc3RhcnRBZnRlckRvYyA9XG4gICAgICAgIHJlcXVlc3RlZFBhZ2UgPiAxID8gcGFnZUN1cnNvcnNbcmVxdWVzdGVkUGFnZSAtIDJdIDogbnVsbDtcbiAgICAgIGlmIChyZXF1ZXN0ZWRQYWdlID4gMSAmJiAhc3RhcnRBZnRlckRvYykge1xuICAgICAgICBzZXRQYWdlKDEpO1xuICAgICAgICBpZiAoc2VxID09PSBmZXRjaFNlcS5jdXJyZW50KSBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyBsaWdodCByZXRyeSBmb3IgdHJhbnNpZW50IEZpcmVzdG9yZSBoaWNjdXBzXG4gICAgICBjb25zdCBsb2FkID0gYXN5bmMgKGF0dGVtcHQgPSAxKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmV0dXJuIGF3YWl0IGZldGNoUGFydHNXaXRoTWFjaGluZURhdGFQYWdlKHtcbiAgICAgICAgICAgIHBhZ2VTaXplOiBQQUdFX1NJWkUsXG4gICAgICAgICAgICBzdGFydEFmdGVyRG9jLFxuICAgICAgICAgICAgdmlzaWJsZU9ubHk6IHRydWUsXG4gICAgICAgICAgICBmaWx0ZXJGbjogaGFzQWN0aXZlRmlsdGVycyA/IG1hdGNoZXNGaWx0ZXJzIDogbnVsbCxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIGlmIChhdHRlbXB0ID49IDMpIHRocm93IGU7XG4gICAgICAgICAgYXdhaXQgbmV3IFByb21pc2UociA9PiBzZXRUaW1lb3V0KHIsIDI1MCAqIE1hdGgucG93KDIsIGF0dGVtcHQgLSAxKSkpO1xuICAgICAgICAgIHJldHVybiBsb2FkKGF0dGVtcHQgKyAxKTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICAgIGNvbnN0IHsgcGFydHM6IGRhdGEsIGxhc3REb2MsIGhhc05leHRQYWdlOiBuZXh0UGFnZSB9ID0gYXdhaXQgbG9hZCgpO1xuICAgICAgaWYgKHNlcSAhPT0gZmV0Y2hTZXEuY3VycmVudCkgcmV0dXJuO1xuICAgICAgaWYgKHJlcXVlc3RlZFBhZ2UgPT09IDEgJiYgZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2V0UGFnZUN1cnNvcnMoW10pO1xuICAgICAgICBzZXRIYXNOZXh0UGFnZShmYWxzZSk7XG4gICAgICB9XG4gICAgICBzZXRCYWNrdXBJbmZvKGRhdGEpO1xuICAgICAgc2V0TGFiZWxzKGxhYmVsQmFzZSk7IC8vIDwtLSBhZGQgdGhpcyBsaW5lIGFmdGVyIHNldEJhY2t1cEluZm8oZGF0YSlcbiAgICAgIHNldElEKGRhdGEubWFwKChpdGVtKSA9PiBpdGVtLmlkKSk7XG4gICAgICBpZiAocmVxdWVzdGVkUGFnZSA+IDEgJiYgZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgc2V0SGFzTmV4dFBhZ2UoZmFsc2UpO1xuICAgICAgICBzZXRQYWdlKDEpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBzZXRIYXNOZXh0UGFnZShuZXh0UGFnZSk7XG4gICAgICBzZXRQYWdlQ3Vyc29ycygocHJldikgPT4ge1xuICAgICAgICBjb25zdCBuZXh0ID0gcmVxdWVzdGVkUGFnZSA9PT0gMSA/IFtdIDogWy4uLnByZXZdO1xuICAgICAgICBpZiAobGFzdERvYykge1xuICAgICAgICAgIG5leHRbcmVxdWVzdGVkUGFnZSAtIDFdID0gbGFzdERvYztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmV4dDtcbiAgICAgIH0pO1xuICAgICAgc2V0U2VsZWN0ZWRJdGVtcyhbXSk7XG5cbiAgICAgIC8vIE5vcm1hbGl6ZSBjbGllbnQgaWRzIGZvciBmaWx0ZXJpbmdcbiAgICAgIGNvbnN0IGF1Z21lbnRlZCA9IGRhdGEubWFwKChpdGVtKSA9PiAoe1xuICAgICAgICAuLi5pdGVtLFxuICAgICAgICBjbGllbnRGcm9tSWQ6XG4gICAgICAgICAgaXRlbT8uY2xpZW50RnJvbUlkID8/XG4gICAgICAgICAgKHR5cGVvZiBpdGVtPy5DbGllbnRGcm9tID09PSBcInN0cmluZ1wiID8gaXRlbS5DbGllbnRGcm9tIDogbnVsbCkgPz9cbiAgICAgICAgICBpdGVtPy5DbGllbnRGcm9tPy5pZCA/P1xuICAgICAgICAgIG51bGwsXG4gICAgICAgIGNsaWVudEN1cnJlbnRJZDpcbiAgICAgICAgICBpdGVtPy5jbGllbnRDdXJyZW50SWQgPz9cbiAgICAgICAgICAodHlwZW9mIGl0ZW0/LkNsaWVudEN1cnJlbnQgPT09IFwic3RyaW5nXCIgPyBpdGVtLkNsaWVudEN1cnJlbnQgOiBudWxsKSA/P1xuICAgICAgICAgIGl0ZW0/LkNsaWVudEN1cnJlbnQ/LmlkID8/XG4gICAgICAgICAgbnVsbCxcbiAgICAgIH0pKTtcblxyXG4gICAgICBzZXRBdWdtZW50ZWRJbmZvKGF1Z21lbnRlZCk7XG4gICAgICAvLyBkZWZhdWx0IHZpZXcgPSBmaWx0ZXJlZCAoa2VlcHMgcGFnaW5hdGlvbiBhbmQgZmlsdGVycyBjb25zaXN0ZW50KVxuICAgICAgc2V0SW5mbyhhdWdtZW50ZWQuZmlsdGVyKG1hdGNoZXNGaWx0ZXJzKSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoc2VxICE9PSBmZXRjaFNlcS5jdXJyZW50KSByZXR1cm47XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgZGF0YTpcIiwgZXJyKTtcbiAgICAgIHNldEluZm8oW10pO1xuICAgICAgc2V0QXVnbWVudGVkSW5mbyhbXSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGlmIChzZXEgPT09IGZldGNoU2VxLmN1cnJlbnQpIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9XG5cclxuICBjb25zdCBzZWFyY2hDaGFuZ2VIYW5kbGVyID0gKGV2ZW50KSA9PiBzZXRTZWFyY2goZXZlbnQudGFyZ2V0LnZhbHVlKTtcclxuXHJcbiAgLy8gRmlsdGVyIHRoZSBjdXJyZW50bHkgbG9hZGVkIGl0ZW1zIChub3cgY29uc2lzdGVudCB3aXRoIHBhZ2VkIGZpbHRlcmluZylcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBiYXNlID0gYXVnbWVudGVkSW5mbyB8fCBbXTtcbiAgICBzZXRJbmZvKGJhc2UuZmlsdGVyKG1hdGNoZXNGaWx0ZXJzKSk7XG4gIH0sIFthdWdtZW50ZWRJbmZvLCBtYXRjaGVzRmlsdGVyc10pO1xuXHJcbiAgZnVuY3Rpb24gc29ydENoZWNrQWxsKHBvcykge1xyXG4gICAgLy8gRGV0ZXJtaW5lIG5leHQgZGlyZWN0aW9uOiB0b2dnbGUgdGhlIGNsaWNrZWQgY29sdW1uIG9ubHlcclxuICAgIGNvbnN0IG5leHRTb3J0Q2hlY2sgPSBzb3J0Q2hlY2subWFwKCh2LCBpKSA9PiAoaSA9PT0gcG9zID8gIXYgOiB2KSk7XHJcbiAgICBjb25zdCBpc0Rlc2MgPSBuZXh0U29ydENoZWNrW3Bvc107IC8vIHRydWUgbWVhbnMgZGVzY2VuZGluZ1xyXG5cclxuICAgIGNvbnN0IHNvcnRlZEluZm8gPSBbLi4uaW5mb10uc29ydCgoYSwgYikgPT4ge1xyXG4gICAgICBjb25zdCBrZXkgPSBsYWJlbEJhc2VOYW1lc1twb3NdO1xyXG5cclxuICAgICAgaWYgKHBvcyA9PT0gMSkge1xyXG4gICAgICAgIC8vIERBVEUgY29sdW1uXHJcbiAgICAgICAgY29uc3QgdGEgPSB0b1RpbWUoYVtrZXldKTtcclxuICAgICAgICBjb25zdCB0YiA9IHRvVGltZShiW2tleV0pO1xyXG5cclxuICAgICAgICAvLyBQdXQgbWlzc2luZyBkYXRlcyBhdCB0aGUgZW5kIGZvciBhc2NlbmRpbmcsIGF0IHRoZSBzdGFydCBmb3IgZGVzY2VuZGluZ1xyXG4gICAgICAgIGlmICh0YSA9PT0gbnVsbCAmJiB0YiA9PT0gbnVsbCkgcmV0dXJuIDA7XHJcbiAgICAgICAgaWYgKHRhID09PSBudWxsKSByZXR1cm4gaXNEZXNjID8gLTEgOiAxO1xyXG4gICAgICAgIGlmICh0YiA9PT0gbnVsbCkgcmV0dXJuIGlzRGVzYyA/IDEgOiAtMTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGlzRGVzYyA/ICh0YiAtIHRhKSA6ICh0YSAtIHRiKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gTkFNRSBvciBTS1UgKHN0cmluZy15IGNvbHVtbnMpOiBpbmRleGVzIDAgb3IgNSBpbiB5b3VyIG9yaWdpbmFsIGxvZ2ljXHJcbiAgICAgIGlmIChwb3MgPT09IDAgfHwgcG9zID09PSA1KSB7XHJcbiAgICAgICAgY29uc3QgYXYgPSAoYVtrZXldID8/IFwiXCIpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgY29uc3QgYnYgPSAoYltrZXldID8/IFwiXCIpLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgcmV0dXJuIGlzRGVzYyA/IGJ2LmxvY2FsZUNvbXBhcmUoYXYpIDogYXYubG9jYWxlQ29tcGFyZShidik7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIE51bWVyaWMtaXNoIGNvbHVtbnMgKHdvLCBwbiwgc24pIOKAlCBmYWxsIGJhY2sgdG8gc3RyaW5nIGNvbXBhcmUgaWYgTmFOXHJcbiAgICAgIGNvbnN0IGFuID0gTnVtYmVyKGFba2V5XSk7XHJcbiAgICAgIGNvbnN0IGJuID0gTnVtYmVyKGJba2V5XSk7XHJcblxyXG4gICAgICBpZiAoIWlzTmFOKGFuKSAmJiAhaXNOYU4oYm4pKSB7XHJcbiAgICAgICAgcmV0dXJuIGlzRGVzYyA/IChibiAtIGFuKSA6IChhbiAtIGJuKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zdCBhdiA9IChhW2tleV0gPz8gXCJcIikudG9TdHJpbmcoKTtcclxuICAgICAgICBjb25zdCBidiA9IChiW2tleV0gPz8gXCJcIikudG9TdHJpbmcoKTtcclxuICAgICAgICByZXR1cm4gaXNEZXNjID8gYnYubG9jYWxlQ29tcGFyZShhdikgOiBhdi5sb2NhbGVDb21wYXJlKGJ2KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgc2V0SW5mbyhzb3J0ZWRJbmZvKTtcclxuICAgIHNldFNvcnRDaGVjayhuZXh0U29ydENoZWNrKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgaGVhZGVyIGxhYmVscyB0byBzaG93IHRoZSBsaXR0bGUgYXJyb3cgb24gdGhlIGFjdGl2ZSBjb2x1bW5cclxuICAgIHNldExhYmVscyh3aXRoU29ydEljb24obGFiZWxCYXNlLCBwb3MsIGlzRGVzYykpO1xyXG4gIH1cclxuXHJcblxyXG4gIGNvbnN0IHJvd1NlbGVjdCA9IChpdGVtKSA9PiB7XHJcbiAgICBpZiAoaXRlbSAmJiBpdGVtLmlkKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKFwiU2VsZWN0ZWQgaXRlbTpcIiwgaXRlbSk7XHJcbiAgICAgIHJvdXRlci5wdXNoKFwiLi9pdGVtL1wiICsgaXRlbS5pZCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiVW5hYmxlIHRvIGRldGVybWluZSB0aGUgc2VsZWN0ZWQgaXRlbeKAmXMgSUQ6IFwiLCBpdGVtKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCBbc2VsZWN0ZWRJdGVtcywgc2V0U2VsZWN0ZWRJdGVtc10gPSB1c2VTdGF0ZShbXSk7XHJcbiAgY29uc3QgW3Nob3dEZWxldGVNb2RhbCwgc2V0U2hvd0RlbGV0ZU1vZGFsXSA9IHVzZVN0YXRlKGZhbHNlKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlU2VsZWN0SXRlbSA9IChpZCkgPT4ge1xyXG4gICAgc2V0U2VsZWN0ZWRJdGVtcyhwcmV2ID0+XHJcbiAgICAgIHByZXYuaW5jbHVkZXMoaWQpID8gcHJldi5maWx0ZXIoeCA9PiB4ICE9PSBpZCkgOiBbLi4ucHJldiwgaWRdXHJcbiAgICApO1xyXG4gIH07XHJcblxyXG5cclxuICAvLyBzZXRTZWxlY3RlZEl0ZW1zKChwcmV2KSA9PiB7XHJcbiAgLy8gICBjb25zdCBuZXdTZWxlY3Rpb24gPSBwcmV2LmluY2x1ZGVzKGlkKVxyXG4gIC8vICAgICA/IHByZXYuZmlsdGVyKChpdGVtSWQpID0+IGl0ZW1JZCAhPT0gaWQpXHJcbiAgLy8gICAgIDogWy4uLnByZXYsIGlkXTtcclxuICAvLyAgIGNvbnNvbGUubG9nKFwiU2VsZWN0ZWQgaXRlbXM6XCIsIG5ld1NlbGVjdGlvbik7XHJcbiAgLy8gICByZXR1cm4gbmV3U2VsZWN0aW9uOyAvLyA8LSBpbXBvcnRhbnRcclxuICAvLyB9KTtcclxuXHJcbiAgY29uc3QgaGFuZGxlU2hvd0RlbGV0ZU1vZGFsID0gKCkgPT4gc2V0U2hvd0RlbGV0ZU1vZGFsKHRydWUpO1xyXG4gIGNvbnN0IGhhbmRsZUNsb3NlRGVsZXRlTW9kYWwgPSAoKSA9PiBzZXRTaG93RGVsZXRlTW9kYWwoZmFsc2UpO1xyXG5cclxuICBjb25zdCBoYW5kbGVEZWxldGVTZWxlY3RlZCA9IGFzeW5jICgpID0+IHtcclxuICAgIHNldElzRGVsZXRpbmcodHJ1ZSk7XHJcbiAgICBjb25zdCBkYiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpO1xyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gTG9vcCBvdmVyIGVhY2ggc2VsZWN0ZWQgaXRlbSBvbmUgYXQgYSB0aW1lXHJcbiAgICAgIGZvciAoY29uc3QgaXRlbUlkIG9mIHNlbGVjdGVkSXRlbXMpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhpdGVtSWQpXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIC8vIERlbGV0ZSBmcm9tIFwiVGVzdFwiIGNvbGxlY3Rpb25cclxuICAgICAgICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oXCJUZXN0XCIpLmRvYyhpdGVtSWQpLmRlbGV0ZSgpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZGVsZXRpbmcgZG9jdW1lbnQgJHtpdGVtSWR9IGZyb20gVGVzdDpgLCBlcnIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgLy8gRGVsZXRlIGZyb20gXCJQYXJ0c1wiIGNvbGxlY3Rpb25cclxuICAgICAgICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oXCJQYXJ0c1wiKS5kb2MoaXRlbUlkKS5kZWxldGUoKTtcclxuICAgICAgICB9IGNhdGNoIChlcnIpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGRlbGV0aW5nIGRvY3VtZW50ICR7aXRlbUlkfSBmcm9tIFBhcnRzOmAsIGVycik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAvLyBEZWxldGUgYXNzb2NpYXRlZCBwaG90b3MgZnJvbSBzdG9yYWdlXHJcbiAgICAgICAgICBhd2FpdCBkZWxldGVGcm9tU3RvcmFnZShpdGVtSWQpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZGVsZXRpbmcgc3RvcmFnZSBmb3IgJHtpdGVtSWR9OmAsIGVycik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIC8vIFVwZGF0ZSBsb2NhbCBzdGF0ZSBieSBmaWx0ZXJpbmcgb3V0IHRoZSBkZWxldGVkIGl0ZW1zXHJcbiAgICAgIHNldEluZm8oaW5mby5maWx0ZXIoKGl0ZW0pID0+ICFzZWxlY3RlZEl0ZW1zLmluY2x1ZGVzKGl0ZW0uaWQpKSk7XHJcbiAgICAgIHNldFNlbGVjdGVkSXRlbXMoW10pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGl0ZW1zOlwiLCBlcnJvcik7XHJcbiAgICB9IGZpbmFsbHkge1xyXG4gICAgICBzZXRJc0RlbGV0aW5nKGZhbHNlKTtcclxuICAgICAgaGFuZGxlQ2xvc2VEZWxldGVNb2RhbCgpO1xyXG4gICAgICAvLyBPcHRpb25hbGx5LCByZWxvYWQgdGhlIHBhZ2VcclxuICAgICAgLy8gcm91dGVyLnJlbG9hZCgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG5cclxuICBjb25zdCBoYW5kbGVDbG9zZSA9ICgpID0+IHNldFNob3coZmFsc2UpO1xyXG4gIGNvbnN0IGhhbmRsZVNob3cgPSAoKSA9PiBzZXRTaG93KHRydWUpO1xyXG5cclxuICBjb25zdCBjaGVja0RlbGV0ZSA9IChldmVudCwgcG9zLCBpZHNUb0RlbGV0ZSwgbmFtZSkgPT4ge1xyXG4gICAgaWYgKGV2ZW50KSB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2coXCJTZWxlY3RlZCBJRHMgdG8gZGVsZXRlOlwiLCBpZHNUb0RlbGV0ZSk7XHJcbiAgICBzZXRTZWxlY3RlZEl0ZW1zKGlkc1RvRGVsZXRlKTtcclxuICAgIHNldERJdGVtKG5hbWUpO1xyXG4gICAgc2V0U2hvd0RlbGV0ZU1vZGFsKHRydWUpO1xyXG4gIH07XHJcblxyXG4gIC8vIGNvbnN0IGhhbmRsZURlbGV0ZSA9IGFzeW5jICgpID0+IHtcclxuICAvLyAgIGxldCBpdGVtSWQgPSBnSWRlO1xyXG4gIC8vICAgdHJ5IHtcclxuICAvLyAgICAgc2V0SXNEZWxldGluZyh0cnVlKTtcclxuICAvLyAgICAgY29uc3QgZGIgPSBmaXJlYmFzZS5maXJlc3RvcmUoKTtcclxuICAvLyAgICAgYXdhaXQgZGIuY29sbGVjdGlvbihcIlRlc3RcIikuZG9jKGl0ZW1JZCkuZGVsZXRlKCk7XHJcbiAgLy8gICAgIGF3YWl0IGRlbGV0ZUZyb21QYXJ0c0NvbGxlY3Rpb24oaXRlbUlkKTtcclxuICAvLyAgICAgYXdhaXQgZGVsZXRlRnJvbVN0b3JhZ2UoaXRlbUlkKTtcclxuICAvLyAgICAgc2V0SW5mbyhpbmZvLmZpbHRlcigoXywgaSkgPT4gZ1BvcyAhPT0gaSkpO1xyXG4gIC8vICAgICBjb25zb2xlLmxvZyhgRGVsZXRlZCBpdGVtOiAke2l0ZW1JZH1gKTtcclxuICAvLyAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgLy8gICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBpdGVtOlwiLCBlcnJvcik7XHJcbiAgLy8gICB9IGZpbmFsbHkge1xyXG4gIC8vICAgICBzZXRJc0RlbGV0aW5nKGZhbHNlKTtcclxuICAvLyAgIH1cclxuICAvLyAgIGhhbmRsZUNsb3NlKCk7XHJcbiAgLy8gfTtcclxuXHJcbiAgY29uc3QgaG92ZXJTdHlsZSA9IChpbmRleCkgPT4gKHtcclxuICAgIGJhY2tncm91bmRDb2xvcjogaG92ZXJJbmRleCA9PT0gaW5kZXggPyBcIiNkZGRcIiA6IFwidHJhbnNwYXJlbnRcIixcclxuICAgIHRleHRBbGlnbjogXCJjZW50ZXJcIixcclxuICAgIGN1cnNvcjogXCJkZWZhdWx0XCIsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IFtkcm9wZG93bjFUZXh0LCBzZXREcm9wZG93bjFUZXh0XSA9IHVzZVN0YXRlKFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICBjb25zdCBbZHJvcGRvd24yVGV4dCwgc2V0RHJvcGRvd24yVGV4dF0gPSB1c2VTdGF0ZShcIlNlbGVjdCBPcHRpb25cIik7XHJcblxyXG4gIGNvbnN0IGhhbmRsZVNlbGVjdDEgPSAoZXZlbnRLZXksIGV2ZW50KSA9PiB7XHJcbiAgICBpZiAoZXZlbnRLZXkgPT09IFwidW5hc3NpZ25lZFwiKSB7XHJcbiAgICAgIHNldERyb3Bkb3duMVRleHQoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gICAgICBzZXRTZWxlY3RlZE9FTShudWxsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNldERyb3Bkb3duMVRleHQoZXZlbnQudGFyZ2V0LnRleHRDb250ZW50KTtcclxuICAgICAgc2V0U2VsZWN0ZWRPRU0oZXZlbnQudGFyZ2V0LnRleHRDb250ZW50KTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVTZWxlY3QyID0gKGV2ZW50S2V5LCBldmVudCkgPT4ge1xyXG4gICAgaWYgKGV2ZW50S2V5ID09PSBcInVuYXNzaWduZWRcIikge1xyXG4gICAgICBzZXREcm9wZG93bjJUZXh0KFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICAgICAgc2V0U2VsZWN0ZWRNb2RhbGl0eShudWxsKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNldERyb3Bkb3duMlRleHQoZXZlbnQudGFyZ2V0LnRleHRDb250ZW50KTtcclxuICAgICAgc2V0U2VsZWN0ZWRNb2RhbGl0eShldmVudC50YXJnZXQudGV4dENvbnRlbnQpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vIEJ1aWxkIGEgdW5pcXVlIGxpc3Qgb2YgY2xpZW50cyBmcm9tIHRoZSBpdGVtcyBjdXJyZW50bHkgbG9hZGVkLCBmaWx0ZXJlZCBieSBPRU0vTW9kYWxpdHkuXHJcbiAgLy8gYHR5cGVgIGlzIFwiZnJvbVwiIG9yIFwiY3VycmVudFwiIHRvIGRlY2lkZSB3aGljaCBjbGllbnQgcmVmIHRvIHJlYWQuXHJcbiAgYXN5bmMgZnVuY3Rpb24gYnVpbGRDbGllbnRzRnJvbUl0ZW1zKHR5cGUpIHtcbiAgICBjb25zdCBkYiA9IGZpcmViYXNlLmZpcmVzdG9yZSgpO1xuICAgIGNvbnN0IGlkcyA9IG5ldyBTZXQoKTtcblxuICAgIC8vIFJlc3BlY3QgY3VycmVudCBPRU0gLyBNb2RhbGl0eSBmaWx0ZXJzIHdoZW4gZGVyaXZpbmcgY2xpZW50IG9wdGlvbnNcbiAgICBjb25zdCBmaWx0ZXJlZCA9IGF1Z21lbnRlZEluZm8uZmlsdGVyKChpdGVtKSA9PiB7XG4gICAgICBjb25zdCBPRU0gPSBnZXRNYWNoaW5lRmllbGQoaXRlbSwgXCJPRU1cIik7XG4gICAgICBjb25zdCBNb2RhbGl0eSA9IGdldE1hY2hpbmVGaWVsZChpdGVtLCBcIk1vZGFsaXR5XCIpO1xuICAgICAgaWYgKHNlbGVjdGVkT0VNICYmIG5vcm1hbGl6ZVRleHQoT0VNKSAhPT0gbm9ybWFsaXplVGV4dChzZWxlY3RlZE9FTSkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKFxuICAgICAgICBzZWxlY3RlZE1vZGFsaXR5ICYmXG4gICAgICAgIG5vcm1hbGl6ZVRleHQoTW9kYWxpdHkpICE9PSBub3JtYWxpemVUZXh0KHNlbGVjdGVkTW9kYWxpdHkpXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7XG5cclxuICAgIGZvciAoY29uc3QgaXQgb2YgZmlsdGVyZWQpIHtcclxuICAgICAgY29uc3QgaWQgPSB0eXBlID09PSBcImZyb21cIiA/IGl0LmNsaWVudEZyb21JZCA6IGl0LmNsaWVudEN1cnJlbnRJZDtcclxuICAgICAgaWYgKGlkKSBpZHMuYWRkKGlkKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBvdXQgPSBbXTtcclxuICAgIGNvbnN0IGlkQXJyYXkgPSBbLi4uaWRzXTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWRBcnJheS5sZW5ndGg7IGkgKz0gMTApIHtcclxuICAgICAgY29uc3QgY2h1bmsgPSBpZEFycmF5LnNsaWNlKGksIGkgKyAxMCk7XHJcbiAgICAgIGNvbnN0IHNuYXAgPSBhd2FpdCBkYlxyXG4gICAgICAgIC5jb2xsZWN0aW9uKFwiQ2xpZW50XCIpXHJcbiAgICAgICAgLndoZXJlKGZpcmViYXNlLmZpcmVzdG9yZS5GaWVsZFBhdGguZG9jdW1lbnRJZCgpLCBcImluXCIsIGNodW5rKVxyXG4gICAgICAgIC5nZXQoKTtcclxuICAgICAgc25hcC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgICBjb25zdCBkID0gZG9jLmRhdGEoKSB8fCB7fTtcclxuICAgICAgICBvdXQucHVzaCh7IGlkOiBkb2MuaWQsIG5hbWU6IGQubmFtZSB8fCBkb2MuaWQgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIHNvcnQgYnkgbmFtZSBmb3IgbmljZXIgVVhcclxuICAgIG91dC5zb3J0KChhLCBiKSA9PiAoYS5uYW1lIHx8IFwiXCIpLmxvY2FsZUNvbXBhcmUoYi5uYW1lIHx8IFwiXCIpKTtcclxuICAgIHJldHVybiBvdXQ7XHJcbiAgfVxyXG5cclxuXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyBDTElFTlQgU0VMRUNUSU9OIEhBTkRMSU5HXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvLyBUaGlzIGZ1bmN0aW9uIGZldGNoZXMgY2xpZW50cyBhbmQgb3BlbnMgdGhlIGNsaWVudCBtb2RhbC5cclxuICBjb25zdCBoYW5kbGVDbGllbnRDbGljayA9IGFzeW5jICgpID0+IHtcclxuICAgIGxldCBzYWZlQ2xpZW50cyA9IFtdO1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgY2xpZW50c0RhdGEgPSBhd2FpdCBmZXRjaENsaWVudHMoc2VsZWN0ZWRPRU0sIHNlbGVjdGVkTW9kYWxpdHkpO1xyXG4gICAgICBzYWZlQ2xpZW50cyA9IEFycmF5LmlzQXJyYXkoY2xpZW50c0RhdGEpID8gY2xpZW50c0RhdGEgOiBbXTtcclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcImZldGNoQ2xpZW50cyBmYWlsZWQ6XCIsIGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIEZhbGxiYWNrIHRvIGJ1aWxkaW5nIGZyb20gbG9hZGVkIGl0ZW1zIGlmIEFQSSBnYXZlIHVzIG5vdGhpbmdcclxuICAgIGlmIChzYWZlQ2xpZW50cy5sZW5ndGggPT09IDApIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBpZiAoIWNsaWVudFNlbGVjdGlvblR5cGUpIHtcclxuICAgICAgICAgIC8vIGlmIHNvbWVob3cgbm90IHNldCB5ZXQsIGRlZmF1bHQgdG8gXCJmcm9tXCJcclxuICAgICAgICAgIHNldENsaWVudFNlbGVjdGlvblR5cGUoXCJmcm9tXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkZXJpdmVkID0gYXdhaXQgYnVpbGRDbGllbnRzRnJvbUl0ZW1zKGNsaWVudFNlbGVjdGlvblR5cGUgfHwgXCJmcm9tXCIpO1xyXG4gICAgICAgIHNhZmVDbGllbnRzID0gZGVyaXZlZDtcclxuICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJGYWxsYmFjayBidWlsZENsaWVudHNGcm9tSXRlbXMgZmFpbGVkOlwiLCBlKTtcclxuICAgICAgICBzYWZlQ2xpZW50cyA9IFtdO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgc2V0Q2xpZW50cyhzYWZlQ2xpZW50cyk7XHJcbiAgICBzZXRDbGllbnRTZWFyY2hUZXJtKFwiXCIpO1xyXG4gICAgc2V0U2hvd0NsaWVudE1vZGFsKHRydWUpO1xyXG4gIH07XHJcblxyXG5cclxuXHJcbiAgLy8gV2hlbiBhIGNsaWVudCBpcyBzZWxlY3RlZCBpbiB0aGUgbW9kYWwsIHdlIG5vdyBhc3N1bWUgdGhlIHBhcmFtZXRlciBpcyBhIGNsaWVudCBJRC5cclxuICAvLyBJZiB0aGUgcGFzc2VkIHZhbHVlIGlzIG51bGwsIHdlIGNsZWFyIHRoZSBzZWxlY3Rpb24uXHJcbiAgY29uc3QgaGFuZGxlQ2xpZW50U2VsZWN0ID0gYXN5bmMgKGNsaWVudElkKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcIlVzZXIgc2VsZWN0ZWQgY2xpZW50IGlkOlwiLCBjbGllbnRJZCk7XHJcbiAgICBpZiAoIWNsaWVudElkKSB7XHJcbiAgICAgIGlmIChjbGllbnRTZWxlY3Rpb25UeXBlID09PSBcImZyb21cIikge1xyXG4gICAgICAgIHNldENsaWVudEZyb21CdXR0b25UZXh0KFwiU2VsZWN0IE9wdGlvblwiKTtcclxuICAgICAgICBzZXRTZWxlY3RlZENsaWVudEZyb20obnVsbCk7XHJcbiAgICAgIH0gZWxzZSBpZiAoY2xpZW50U2VsZWN0aW9uVHlwZSA9PT0gXCJjdXJyZW50XCIpIHtcclxuICAgICAgICBzZXRDbGllbnRDdXJyZW50QnV0dG9uVGV4dChcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgICAgICAgc2V0U2VsZWN0ZWRDbGllbnRDdXJyZW50KG51bGwpO1xyXG4gICAgICB9XHJcbiAgICAgIHNldFNob3dDbGllbnRNb2RhbChmYWxzZSk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGNsaWVudFNuYXAgPSBhd2FpdCBmaXJlYmFzZS5maXJlc3RvcmUoKS5jb2xsZWN0aW9uKFwiQ2xpZW50XCIpLmRvYyhjbGllbnRJZCkuZ2V0KCk7XHJcbiAgICAgIGlmIChjbGllbnRTbmFwLmV4aXN0cykge1xyXG4gICAgICAgIGNvbnN0IGNsaWVudERhdGEgPSBjbGllbnRTbmFwLmRhdGEoKTtcclxuICAgICAgICBpZiAoY2xpZW50U2VsZWN0aW9uVHlwZSA9PT0gXCJmcm9tXCIpIHtcclxuICAgICAgICAgIHNldENsaWVudEZyb21CdXR0b25UZXh0KGNsaWVudERhdGEubmFtZSk7XHJcbiAgICAgICAgICBzZXRTZWxlY3RlZENsaWVudEZyb20oY2xpZW50SWQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoY2xpZW50U2VsZWN0aW9uVHlwZSA9PT0gXCJjdXJyZW50XCIpIHtcclxuICAgICAgICAgIHNldENsaWVudEN1cnJlbnRCdXR0b25UZXh0KGNsaWVudERhdGEubmFtZSk7XHJcbiAgICAgICAgICBzZXRTZWxlY3RlZENsaWVudEN1cnJlbnQoY2xpZW50SWQpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiTm8gY2xpZW50IGRvY3VtZW50IGZvdW5kIGZvciBpZDpcIiwgY2xpZW50SWQpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgY2xpZW50IGRhdGE6XCIsIGVycm9yKTtcclxuICAgIH1cclxuICAgIHNldFNob3dDbGllbnRNb2RhbChmYWxzZSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlQ2xpZW50SW5mbyA9IChjbGllbnRJZCwgY2xpZW50TmFtZSkgPT4ge1xyXG4gICAgY29uc29sZS5sb2coYENsaWVudCBJRDogJHtjbGllbnRJZH0sIENsaWVudCBOYW1lOiAke2NsaWVudE5hbWV9YCk7XHJcbiAgICByb3V0ZXIucHVzaChcImNsaWVudC9cIiArIGNsaWVudElkKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVDbGVhckNsaWVudFNlbGVjdGlvbiA9ICgpID0+IHtcclxuICAgIGlmIChjbGllbnRTZWxlY3Rpb25UeXBlID09PSBcImZyb21cIikge1xyXG4gICAgICBzZXRDbGllbnRGcm9tQnV0dG9uVGV4dChcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgICAgIHNldFNlbGVjdGVkQ2xpZW50RnJvbShudWxsKTtcclxuICAgIH0gZWxzZSBpZiAoY2xpZW50U2VsZWN0aW9uVHlwZSA9PT0gXCJjdXJyZW50XCIpIHtcclxuICAgICAgc2V0Q2xpZW50Q3VycmVudEJ1dHRvblRleHQoXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gICAgICBzZXRTZWxlY3RlZENsaWVudEN1cnJlbnQobnVsbCk7XHJcbiAgICB9XHJcbiAgICBzZXRTaG93Q2xpZW50TW9kYWwoZmFsc2UpO1xyXG4gIH07XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gTU9ERUwgU0VMRUNUSU9OIEhBTkRMSU5HXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICBjb25zdCBbbW9kZWxzLCBzZXRNb2RlbHNdID0gdXNlU3RhdGUoW10pO1xyXG4gIGNvbnN0IFtzaG93TW9kZWxNb2RhbCwgc2V0U2hvd01vZGVsTW9kYWxdID0gdXNlU3RhdGUoZmFsc2UpO1xyXG4gIGNvbnN0IFttb2RlbEJ1dHRvblRleHQsIHNldE1vZGVsQnV0dG9uVGV4dF0gPSB1c2VTdGF0ZShcIlNlbGVjdCBPcHRpb25cIik7XHJcblxyXG4gIGNvbnN0IGhhbmRsZU1vZGVsQ2xpY2sgPSBhc3luYyAoKSA9PiB7XHJcbiAgICBjb25zdCBtb2RlbHNEYXRhID0gYXdhaXQgZmV0Y2hNb2RlbHMoXHJcbiAgICAgIHNlbGVjdGVkT0VNLFxyXG4gICAgICBzZWxlY3RlZE1vZGFsaXR5LFxyXG4gICAgICBzZWxlY3RlZENsaWVudEZyb21cclxuICAgICk7XHJcbiAgICBzZXRNb2RlbHMobW9kZWxzRGF0YSk7XHJcbiAgICBzZXRNb2RlbFNlYXJjaFRlcm0oXCJcIik7XHJcbiAgICBzZXRTaG93TW9kZWxNb2RhbCh0cnVlKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVNb2RlbFNlbGVjdCA9IChtb2RlbE5hbWUpID0+IHtcclxuICAgIHNldE1vZGVsQnV0dG9uVGV4dChtb2RlbE5hbWUgfHwgXCJTZWxlY3QgT3B0aW9uXCIpO1xyXG4gICAgc2V0U2VsZWN0ZWRNb2RlbChtb2RlbE5hbWUgfHwgbnVsbCk7XHJcbiAgICBzZXRTaG93TW9kZWxNb2RhbChmYWxzZSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlQ2xlYXJNb2RlbFNlbGVjdGlvbiA9ICgpID0+IHtcclxuICAgIHNldE1vZGVsQnV0dG9uVGV4dChcIlNlbGVjdCBPcHRpb25cIik7XHJcbiAgICBzZXRTZWxlY3RlZE1vZGVsKG51bGwpO1xyXG4gICAgc2V0U2hvd01vZGVsTW9kYWwoZmFsc2UpO1xyXG4gIH07XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy8gV0FSRUhPVVNFIEJVVFRPTlMgKGZvciBDbGllbnQgQ3VycmVudClcclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIGNvbnN0IGhhbmRsZVNvQ2FsV2FyZWhvdXNlQ2xpY2sgPSAoKSA9PiB7XHJcbiAgICBzZXRDbGllbnRDdXJyZW50QnV0dG9uVGV4dChcIlNvQ2FsIFdhcmVob3VzZVwiKTtcclxuICAgIHNldFNlbGVjdGVkQ2xpZW50Q3VycmVudChTT0NBTF9DTElFTlRfSUQpO1xyXG4gICAgY29uc29sZS5sb2coXCJXYXJlaG91c2UgYnV0dG9uIGNsaWNrZWQ6IHNldHRpbmcgQ2xpZW50IEN1cnJlbnQgdG9cIiwgU09DQUxfQ0xJRU5UX0lEKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBoYW5kbGVOb3JDYWxXYXJlaG91c2VDbGljayA9ICgpID0+IHtcclxuICAgIHNldENsaWVudEN1cnJlbnRCdXR0b25UZXh0KFwiTm9yQ2FsIFdhcmVob3VzZVwiKTtcclxuICAgIHNldFNlbGVjdGVkQ2xpZW50Q3VycmVudChOT1JDQUxfQ0xJRU5UX0lEKTtcclxuICAgIGNvbnNvbGUubG9nKFwiV2FyZWhvdXNlIGJ1dHRvbiBjbGlja2VkOiBzZXR0aW5nIENsaWVudCBDdXJyZW50IHRvXCIsIE5PUkNBTF9DTElFTlRfSUQpO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGhhbmRsZVdhcmVob3VzZVVuYXNzaWduZWRDbGljayA9ICgpID0+IHtcclxuICAgIHNldENsaWVudEN1cnJlbnRCdXR0b25UZXh0KFwiVW5hc3NpZ25lZFwiKTtcclxuICAgIHNldFNlbGVjdGVkQ2xpZW50Q3VycmVudChVTkFTU0lHTkVEX0NMSUVOVF9JRCk7XHJcbiAgICBjb25zb2xlLmxvZyhcIldhcmVob3VzZSBidXR0b24gY2xpY2tlZDogc2V0dGluZyBDbGllbnQgQ3VycmVudCB0b1wiLCBVTkFTU0lHTkVEX0NMSUVOVF9JRCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgW2NsaWVudFNlYXJjaFRlcm0sIHNldENsaWVudFNlYXJjaFRlcm1dID0gdXNlU3RhdGUoXCJcIik7XHJcbiAgY29uc3QgW21vZGVsU2VhcmNoVGVybSwgc2V0TW9kZWxTZWFyY2hUZXJtXSA9IHVzZVN0YXRlKFwiXCIpO1xyXG5cclxuICBjb25zdCBkZWxldGVGcm9tU3RvcmFnZSA9IGFzeW5jIChpdGVtSWQpID0+IHtcclxuICAgIGNvbnN0IHN0b3JhZ2VSZWYgPSBmaXJlYmFzZS5zdG9yYWdlKCkucmVmKCk7XHJcbiAgICBjb25zdCBmb2xkZXJSZWYgPSBzdG9yYWdlUmVmLmNoaWxkKGBQYXJ0cy8ke2l0ZW1JZH0vYCk7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBsaXN0UmVzdWx0ID0gYXdhaXQgZm9sZGVyUmVmLmxpc3RBbGwoKTtcclxuICAgICAgY29uc3QgZGVsZXRlUHJvbWlzZXMgPSBsaXN0UmVzdWx0Lml0ZW1zLm1hcCgoaXRlbSkgPT4gaXRlbS5kZWxldGUoKSk7XHJcbiAgICAgIGF3YWl0IFByb21pc2UuYWxsKGRlbGV0ZVByb21pc2VzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBkZWxldGluZyBmcm9tIHN0b3JhZ2U6XCIsIGVycm9yKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBjb25zdCBkZWxldGVGcm9tUGFydHNDb2xsZWN0aW9uID0gYXN5bmMgKGl0ZW1JZCkgPT4ge1xyXG4gICAgY29uc3QgZGIgPSBmaXJlYmFzZS5maXJlc3RvcmUoKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGF3YWl0IGRiLmNvbGxlY3Rpb24oXCJQYXJ0c1wiKS5kb2MoaXRlbUlkKS5kZWxldGUoKTtcclxuICAgICAgY29uc29sZS5sb2coYERlbGV0ZWQgaXRlbSBmcm9tIFBhcnRzIGNvbGxlY3Rpb246ICR7aXRlbUlkfWApO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGRlbGV0aW5nIGZyb20gUGFydHMgY29sbGVjdGlvbjpcIiwgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIC8vICAgLy8gU2FmZWx5IGNvbnZlcnQgYW55IGRhdGUtaXNoIHZhbHVlIGludG8gYSBjb21wYXJhYmxlIHRpbWVzdGFtcCAobXMgc2luY2UgZXBvY2gpLlxyXG4gIC8vIGZ1bmN0aW9uIHRvVGltZSh2YWx1ZSkge1xyXG4gIC8vICAgaWYgKCF2YWx1ZSkgcmV0dXJuIG51bGw7XHJcblxyXG4gIC8vICAgLy8gRmlyZXN0b3JlIFRpbWVzdGFtcDogeyBzZWNvbmRzLCBuYW5vc2Vjb25kcyB9XHJcbiAgLy8gICBpZiAodHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiICYmIHZhbHVlLnNlY29uZHMpIHtcclxuICAvLyAgICAgdHJ5IHtcclxuICAvLyAgICAgICByZXR1cm4gdmFsdWUuc2Vjb25kcyAqIDEwMDA7XHJcbiAgLy8gICAgIH0gY2F0Y2ggeyAvKiBmYWxsdGhyb3VnaCAqLyB9XHJcbiAgLy8gICB9XHJcblxyXG4gIC8vICAgLy8gSWYgYWxyZWFkeSBhIERhdGVcclxuICAvLyAgIGlmICh2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHJldHVybiBpc05hTih2YWx1ZS5nZXRUaW1lKCkpID8gbnVsbCA6IHZhbHVlLmdldFRpbWUoKTtcclxuXHJcbiAgLy8gICAvLyBJZiBzdHJpbmc6IHRyeSBJU08gZmlyc3RcclxuICAvLyAgIGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHtcclxuICAvLyAgICAgLy8geXl5eS1tbS1kZCAoZnJvbSB5b3VyIGZvcm0gaW5wdXRzKVxyXG4gIC8vICAgICBjb25zdCBpc28gPSBEYXRlLnBhcnNlKHZhbHVlKTtcclxuICAvLyAgICAgaWYgKCFpc05hTihpc28pKSByZXR1cm4gaXNvO1xyXG5cclxuICAvLyAgICAgLy8gbW0vZGQveXl5eSBmYWxsYmFjayAob2xkZXIgaXRlbXMpXHJcbiAgLy8gICAgIGNvbnN0IHBhcnRzID0gdmFsdWUuc3BsaXQoXCIvXCIpO1xyXG4gIC8vICAgICBpZiAocGFydHMubGVuZ3RoID09PSAzKSB7XHJcbiAgLy8gICAgICAgY29uc3QgW21tLCBkZCwgeXl5eV0gPSBwYXJ0cztcclxuICAvLyAgICAgICBjb25zdCBhbHQgPSBEYXRlLnBhcnNlKGAke3l5eXl9LSR7bW19LSR7ZGR9YCk7XHJcbiAgLy8gICAgICAgaWYgKCFpc05hTihhbHQpKSByZXR1cm4gYWx0O1xyXG4gIC8vICAgICB9XHJcbiAgLy8gICB9XHJcblxyXG4gIC8vICAgLy8gQ2Fub25pY2FsaXplIGFueSBkYXRlLWlzaCB2YWx1ZSB0byAneXl5eS1tbS1kZCcgc28gaXQgbWF0Y2hlcyA8aW5wdXQgdHlwZT1cImRhdGVcIj4gdmFsdWVzXHJcbiAgLy8gICBmdW5jdGlvbiB0b1lNRCh2YWx1ZSkge1xyXG4gIC8vICAgICBjb25zdCB0ID0gdG9UaW1lKHZhbHVlKTtcclxuICAvLyAgICAgaWYgKHQgPT0gbnVsbCkgcmV0dXJuIG51bGw7XHJcbiAgLy8gICAgIGNvbnN0IGQgPSBuZXcgRGF0ZSh0KTtcclxuICAvLyAgICAgY29uc3QgeXl5eSA9IGQuZ2V0RnVsbFllYXIoKTtcclxuICAvLyAgICAgY29uc3QgbW0gPSBTdHJpbmcoZC5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgXCIwXCIpO1xyXG4gIC8vICAgICBjb25zdCBkZCA9IFN0cmluZyhkLmdldERhdGUoKSkucGFkU3RhcnQoMiwgXCIwXCIpO1xyXG4gIC8vICAgICByZXR1cm4gYCR7eXl5eX0tJHttbX0tJHtkZH1gO1xyXG4gIC8vICAgfVxyXG5cclxuXHJcbiAgLy8gICAvLyBMYXN0IHJlc29ydFxuICAvLyAgIGNvbnN0IHQgPSBEYXRlLnBhcnNlKHZhbHVlKTtcbiAgLy8gICByZXR1cm4gaXNOYU4odCkgPyBudWxsIDogdDtcbiAgLy8gfVxuXG4gIGNvbnN0IHRvdGFsS25vd25QYWdlcyA9IE1hdGgubWF4KFxuICAgIDEsXG4gICAgcGFnZUN1cnNvcnMuZmlsdGVyKEJvb2xlYW4pLmxlbmd0aCArIChoYXNOZXh0UGFnZSA/IDEgOiAwKVxuICApO1xuICBjb25zdCBwYWdlQnV0dG9ucyA9IFtdO1xuICBmb3IgKGxldCBpID0gMTsgaSA8PSB0b3RhbEtub3duUGFnZXM7IGkrKykge1xuICAgIHBhZ2VCdXR0b25zLnB1c2goXG4gICAgICA8UGFnaW5hdGlvbi5JdGVtXG4gICAgICAgIGtleT17aX1cbiAgICAgICAgYWN0aXZlPXtpID09PSBwYWdlfVxuICAgICAgICBvbkNsaWNrPXsoKSA9PiBzZXRQYWdlKGkpfVxuICAgICAgPlxuICAgICAgICB7aX1cbiAgICAgIDwvUGFnaW5hdGlvbi5JdGVtPlxuICAgICk7XG4gIH1cblxuXG4gIHJldHVybiAoXG4gICAgPExvZ2dlZEluPlxuICAgICAge2lzRGVsZXRpbmcgJiYgKFxyXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibG9hZGluZy1vdmVybGF5XCI+XHJcbiAgICAgICAgICA8U3Bpbm5lciBhbmltYXRpb249XCJib3JkZXJcIiByb2xlPVwic3RhdHVzXCIgY2xhc3NOYW1lPVwic3Bpbm5lci1jZW50ZXJcIj5cclxuICAgICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwic3Itb25seVwiPkxvYWRpbmcuLi48L3NwYW4+XHJcbiAgICAgICAgICA8L1NwaW5uZXI+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgICl9XHJcbiAgICAgIDxNb2RhbCBzaG93PXtzaG93RGVsZXRlTW9kYWx9IG9uSGlkZT17aGFuZGxlQ2xvc2VEZWxldGVNb2RhbH0+XHJcbiAgICAgICAgPE1vZGFsLkhlYWRlciBjbG9zZUJ1dHRvbj5cclxuICAgICAgICAgIDxNb2RhbC5UaXRsZT5Db25maXJtIERlbGV0aW9uPC9Nb2RhbC5UaXRsZT5cclxuICAgICAgICA8L01vZGFsLkhlYWRlcj5cclxuICAgICAgICA8TW9kYWwuQm9keT5cclxuICAgICAgICAgIEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBkZWxldGUge3NlbGVjdGVkSXRlbXMubGVuZ3RofSBpdGVtXHJcbiAgICAgICAgICB7c2VsZWN0ZWRJdGVtcy5sZW5ndGggPiAxID8gXCJzXCIgOiBcIlwifT9cclxuICAgICAgICA8L01vZGFsLkJvZHk+XHJcbiAgICAgICAgPE1vZGFsLkZvb3Rlcj5cclxuICAgICAgICAgIDxCdXR0b24gdmFyaWFudD1cImRhbmdlclwiIG9uQ2xpY2s9e2hhbmRsZURlbGV0ZVNlbGVjdGVkfT5cclxuICAgICAgICAgICAgWWVzLCBkZWxldGVcclxuICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgICAgPEJ1dHRvbiB2YXJpYW50PVwic2Vjb25kYXJ5XCIgb25DbGljaz17aGFuZGxlQ2xvc2VEZWxldGVNb2RhbH0+XHJcbiAgICAgICAgICAgIENhbmNlbFxyXG4gICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgPC9Nb2RhbC5Gb290ZXI+XHJcbiAgICAgIDwvTW9kYWw+XHJcblxyXG4gICAgICA8TW9kYWwgc2hvdz17c2hvd0NsaWVudE1vZGFsfSBvbkhpZGU9eygpID0+IHNldFNob3dDbGllbnRNb2RhbChmYWxzZSl9PlxyXG4gICAgICAgIDxNb2RhbC5IZWFkZXIgY2xvc2VCdXR0b24+XHJcbiAgICAgICAgICA8TW9kYWwuVGl0bGU+XHJcbiAgICAgICAgICAgIFNlbGVjdCB7Y2xpZW50U2VsZWN0aW9uVHlwZSA9PT0gXCJmcm9tXCIgPyBcIkNsaWVudCBGcm9tXCIgOiBcIkNsaWVudCBDdXJyZW50XCJ9XHJcbiAgICAgICAgICA8L01vZGFsLlRpdGxlPlxyXG4gICAgICAgIDwvTW9kYWwuSGVhZGVyPlxyXG4gICAgICAgIDxNb2RhbC5Cb2R5PlxyXG4gICAgICAgICAgPEZvcm1Db250cm9sXHJcbiAgICAgICAgICAgIHR5cGU9XCJ0ZXh0XCJcclxuICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJTZWFyY2ggYnkgbmFtZVwiXHJcbiAgICAgICAgICAgIGNsYXNzTmFtZT1cIm1iLTNcIlxyXG4gICAgICAgICAgICB2YWx1ZT17Y2xpZW50U2VhcmNoVGVybX1cclxuICAgICAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBzZXRDbGllbnRTZWFyY2hUZXJtKGUudGFyZ2V0LnZhbHVlKX1cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgICA8Q2xpZW50VGFibGVcclxuICAgICAgICAgICAgY2xpZW50cz17KEFycmF5LmlzQXJyYXkoY2xpZW50cykgPyBjbGllbnRzIDogW10pLmZpbHRlcihcclxuICAgICAgICAgICAgICAoY2xpZW50KSA9PiAoY2xpZW50Py5uYW1lID8/IFwiXCIpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoY2xpZW50U2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICAgICAgICApfVxyXG4gICAgICAgICAgICBvblNlbGVjdENsaWVudD17aGFuZGxlQ2xpZW50U2VsZWN0fVxyXG4gICAgICAgICAgICBvbkluZm9DbGljaz17aGFuZGxlQ2xpZW50SW5mb31cclxuICAgICAgICAgICAgaXNDbGllbnRTZWFyY2g9e2ZhbHNlfVxyXG4gICAgICAgICAgICBjbGVhclNlbGVjdGlvbj17KCkgPT4gaGFuZGxlQ2xpZW50U2VsZWN0KG51bGwpfVxyXG4gICAgICAgICAgLz5cclxuICAgICAgICA8L01vZGFsLkJvZHk+XHJcbiAgICAgIDwvTW9kYWw+XHJcblxyXG4gICAgICA8TW9kYWwgc2hvdz17c2hvd01vZGVsTW9kYWx9IG9uSGlkZT17KCkgPT4gc2V0U2hvd01vZGVsTW9kYWwoZmFsc2UpfT5cclxuICAgICAgICA8TW9kYWwuSGVhZGVyIGNsb3NlQnV0dG9uPlxyXG4gICAgICAgICAgPE1vZGFsLlRpdGxlPlNlbGVjdCBNb2RlbDwvTW9kYWwuVGl0bGU+XHJcbiAgICAgICAgPC9Nb2RhbC5IZWFkZXI+XHJcbiAgICAgICAgPE1vZGFsLkJvZHk+XHJcbiAgICAgICAgICA8Rm9ybUNvbnRyb2xcclxuICAgICAgICAgICAgdHlwZT1cInRleHRcIlxyXG4gICAgICAgICAgICBwbGFjZWhvbGRlcj1cIlNlYXJjaCBieSBuYW1lXCJcclxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibWItM1wiXHJcbiAgICAgICAgICAgIHZhbHVlPXttb2RlbFNlYXJjaFRlcm19XHJcbiAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0TW9kZWxTZWFyY2hUZXJtKGUudGFyZ2V0LnZhbHVlKX1cclxuICAgICAgICAgIC8+XHJcbiAgICAgICAgICA8TW9kZWxUYWJsZVxyXG4gICAgICAgICAgICBtb2RlbHM9e21vZGVscy5maWx0ZXIoKG1vZGVsKSA9PlxyXG4gICAgICAgICAgICAgIHR5cGVvZiBtb2RlbCA9PT0gXCJzdHJpbmdcIlxyXG4gICAgICAgICAgICAgICAgPyBtb2RlbC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG1vZGVsU2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKVxyXG4gICAgICAgICAgICAgICAgOiBmYWxzZVxyXG4gICAgICAgICAgICApfVxyXG4gICAgICAgICAgICBvblNlbGVjdE1vZGVsPXtoYW5kbGVNb2RlbFNlbGVjdH1cclxuICAgICAgICAgICAgY2xlYXJTZWxlY3Rpb249eygpID0+IGhhbmRsZU1vZGVsU2VsZWN0KG51bGwpfVxyXG4gICAgICAgICAgLz5cclxuICAgICAgICA8L01vZGFsLkJvZHk+XHJcbiAgICAgIDwvTW9kYWw+XHJcblxyXG4gICAgICA8Q29udGFpbmVyXHJcbiAgICAgICAgY2xhc3NOYW1lPVwiZC1mbGV4IGFsaWduLWl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNvbnRlbnQtY2VudGVyXCJcclxuICAgICAgICBzdHlsZT17eyBtaW5IZWlnaHQ6IFwiMTAwdmhcIiB9fVxyXG4gICAgICA+XHJcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3LTEwMFwiIHN0eWxlPXt7IG1heFdpZHRoOiBcIjEyMDBweFwiIH19PlxyXG4gICAgICAgICAgPENhcmQ+XHJcbiAgICAgICAgICAgIDxDYXJkLkJvZHk+XHJcbiAgICAgICAgICAgICAgPGgyIGNsYXNzTmFtZT1cInRleHQtY2VudGVyIG1iLTRcIj5NYWdtbzwvaDI+XHJcbiAgICAgICAgICAgICAgPFJvdz5cclxuICAgICAgICAgICAgICAgIDxDb2wgbWQ9ezR9PlxyXG4gICAgICAgICAgICAgICAgICB7LyogRHJvcGRvd25zICovfVxyXG4gICAgICAgICAgICAgICAgICA8ZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDxJbnB1dEdyb3VwIGNsYXNzTmFtZT1cIm1iLTNcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxJbnB1dEdyb3VwLlRleHQ+T0VNPC9JbnB1dEdyb3VwLlRleHQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24gb25TZWxlY3Q9e2hhbmRsZVNlbGVjdDF9PlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uVG9nZ2xlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyaWFudD1cIm91dGxpbmUtc2Vjb25kYXJ5XCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBpZD1cImRyb3Bkb3duLWJ1dHRvbi0xXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEwMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB7ZHJvcGRvd24xVGV4dH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5Ub2dnbGU+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5NZW51IGNsYXNzTmFtZT1cInctMTAwXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLkl0ZW0gZXZlbnRLZXk9XCJ1bmFzc2lnbmVkXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZWxlY3QgT3B0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5JdGVtIGV2ZW50S2V5PVwiR0VcIj5HRTwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uSXRlbSBldmVudEtleT1cIlRvc2hpYmFcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRvc2hpYmFcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLkl0ZW0gZXZlbnRLZXk9XCJTaWVtZW5zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaWVtZW5zXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5JdGVtIGV2ZW50S2V5PVwiUGhpbGlwc1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUGhpbGlwc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvRHJvcGRvd24uSXRlbT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bi5NZW51PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9Ecm9wZG93bj5cclxuICAgICAgICAgICAgICAgICAgICA8L0lucHV0R3JvdXA+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIDxJbnB1dEdyb3VwIGNsYXNzTmFtZT1cIm1iLTVcIj5cclxuICAgICAgICAgICAgICAgICAgICAgIDxJbnB1dEdyb3VwLlRleHQ+TW9kYWxpdHk8L0lucHV0R3JvdXAuVGV4dD5cclxuICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93biBvblNlbGVjdD17aGFuZGxlU2VsZWN0Mn0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5Ub2dnbGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkPVwiZHJvcGRvd24tYnV0dG9uLTJcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctMTAwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHtkcm9wZG93bjJUZXh0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duLlRvZ2dsZT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLk1lbnUgY2xhc3NOYW1lPVwidy0xMDBcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8RHJvcGRvd24uSXRlbSBldmVudEtleT1cInVuYXNzaWduZWRcIj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNlbGVjdCBPcHRpb25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPERyb3Bkb3duLkl0ZW0gZXZlbnRLZXk9XCJDVFwiPkNUPC9Ecm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxEcm9wZG93bi5JdGVtIGV2ZW50S2V5PVwiTVJJXCI+TVJJPC9Ecm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duLk1lbnU+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L0Ryb3Bkb3duPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvSW5wdXRHcm91cD5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcblxyXG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT17c3R5bGVzLmRpdmlkZXJ9PjwvZGl2PlxyXG5cclxuICAgICAgICAgICAgICAgICAgey8qIENsaWVudCBzZWxlY3Rpb24gYm94ZXMgKi99XHJcbiAgICAgICAgICAgICAgICAgIDxkaXY+XHJcbiAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAgY2xhc3NOYW1lPVwibWItM1wiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgPElucHV0R3JvdXAuVGV4dD5DbGllbnQgRnJvbTwvSW5wdXRHcm91cC5UZXh0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3LTEwMFwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IGhhbmRsZUNsaWVudENsaWNrKFwiZnJvbVwiKX1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtjbGllbnRGcm9tQnV0dG9uVGV4dH1cclxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvSW5wdXRHcm91cD5cclxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cCBjbGFzc05hbWU9XCJtYi0zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cC5UZXh0PkNsaWVudCBDdXJyZW50PC9JbnB1dEdyb3VwLlRleHQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lLXNlY29uZGFyeVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctMTAwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlQ2xpZW50Q2xpY2soXCJjdXJyZW50XCIpfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAge2NsaWVudEN1cnJlbnRCdXR0b25UZXh0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgPC9JbnB1dEdyb3VwPlxyXG5cclxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cCBjbGFzc05hbWU9XCJtYi0zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cC5UZXh0Pk1vZGVsPC9JbnB1dEdyb3VwLlRleHQ+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8QnV0dG9uXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lLXNlY29uZGFyeVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cInctMTAwXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlTW9kZWxDbGlja31cclxuICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAge21vZGVsQnV0dG9uVGV4dH1cclxuICAgICAgICAgICAgICAgICAgICAgIDwvQnV0dG9uPlxyXG4gICAgICAgICAgICAgICAgICAgIDwvSW5wdXRHcm91cD5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e3N0eWxlcy5kaXZpZGVyfT48L2Rpdj5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgey8qIFdhcmVob3VzZSBidXR0b25zIGZvciBDbGllbnQgQ3VycmVudCAqL31cclxuICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cCBjbGFzc05hbWU9XCJtYi0zXCI+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8SW5wdXRHcm91cC5UZXh0PldhcmVob3VzZTwvSW5wdXRHcm91cC5UZXh0PlxyXG4gICAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e3N0eWxlcy5idXR0b25Hcm91cH0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17c3R5bGVzLmZsZXhCdXR0b259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlU29DYWxXYXJlaG91c2VDbGlja31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFNvQ2FsIFdhcmVob3VzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgICAgPEJ1dHRvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHZhcmlhbnQ9XCJvdXRsaW5lLXNlY29uZGFyeVwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPXtzdHlsZXMuZmxleEJ1dHRvbn1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVOb3JDYWxXYXJlaG91c2VDbGlja31cclxuICAgICAgICAgICAgICAgICAgICAgICAgPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIE5vckNhbCBXYXJlaG91c2VcclxuICAgICAgICAgICAgICAgICAgICAgICAgPC9CdXR0b24+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxCdXR0b25cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB2YXJpYW50PVwib3V0bGluZS1zZWNvbmRhcnlcIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17c3R5bGVzLmZsZXhCdXR0b259XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlV2FyZWhvdXNlVW5hc3NpZ25lZENsaWNrfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgVW5hc3NpZ25lZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8L0J1dHRvbj5cclxuICAgICAgICAgICAgICAgICAgICAgIDwvZGl2PlxyXG4gICAgICAgICAgICAgICAgICAgIDwvSW5wdXRHcm91cD5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L0NvbD5cclxuXHJcbiAgICAgICAgICAgICAgICA8Q29sIG1kPXs4fT5cclxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e3N0eWxlcy50YWJsZUNvbnRhaW5lcn0+XHJcbiAgICAgICAgICAgICAgICAgICAge2lzTG9hZGluZyA/IChcclxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZC1mbGV4IGp1c3RpZnktY29udGVudC1jZW50ZXIgYWxpZ24taXRlbXMtY2VudGVyIHAtNVwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8aW1nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc3JjPVwiL21hZ21vLWxvZ28ucG5nXCIgLy8gbWFrZSBzdXJlIGl0J3MgaW4gL3B1YmxpY1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGFsdD1cIkxvYWRpbmcgTWFnbW9cIlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogNjQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDY0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uOiBcIm1hZ21vLXNwaW4gMXMgbGluZWFyIGluZmluaXRlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zvcm1PcmlnaW46IFwiNTAlIDUwJVwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheTogXCJibG9ja1wiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7LyogZ2xvYmFsIHNvIHN0eWxlZC1qc3ggZG9lc24ndCBoYXNoIHRoZSBuYW1lICovfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8c3R5bGUganN4IGdsb2JhbD57YFxyXG4gICAgICBAa2V5ZnJhbWVzIG1hZ21vLXNwaW4ge1xyXG4gICAgICAgIGZyb20ge1xyXG4gICAgICAgICAgdHJhbnNmb3JtOiByb3RhdGUoMGRlZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRvIHtcclxuICAgICAgICAgIHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICBgfTwvc3R5bGU+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICApIDogKFxyXG4gICAgICAgICAgICAgICAgICAgICAgPFBhcnRUYWJsZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmZvPXtpbmZvfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHM9e2xhYmVsc31cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWRzPXtpZHN9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvdmVyU3R5bGU9e2hvdmVyU3R5bGV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRDaGVja0FsbD17c29ydENoZWNrQWxsfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjaGVja0RlbGV0ZT17Y2hlY2tEZWxldGV9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzRGVsZXRpbmc9e2lzRGVsZXRpbmd9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvd1NlbGVjdD17cm93U2VsZWN0fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRIb3ZlckluZGV4PXtzZXRIb3ZlckluZGV4fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBob3ZlckluZGV4PXtob3ZlckluZGV4fVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZEl0ZW1zPXtzZWxlY3RlZEl0ZW1zfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZXRTZWxlY3RlZEl0ZW1zPXtzZXRTZWxlY3RlZEl0ZW1zfVxyXG4gICAgICAgICAgICAgICAgICAgICAgLz5cclxuICAgICAgICAgICAgICAgICAgICApfVxuXG5cbiAgICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e3N0eWxlcy5zZWFyY2hDb250YWluZXJ9PlxuICAgICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtzdHlsZXMucGFnaW5hdGlvblJvd30+XG4gICAgICAgICAgICAgICAgICAgICAgICA8UGFnaW5hdGlvbiBzaXplPVwic21cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPFBhZ2luYXRpb24uUHJldlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHNldFBhZ2UoKHApID0+IE1hdGgubWF4KDEsIHAgLSAxKSl9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ9e3BhZ2UgPD0gMX1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgLz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAge3BhZ2VCdXR0b25zfVxuICAgICAgICAgICAgICAgICAgICAgICAgICA8UGFnaW5hdGlvbi5OZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DbGljaz17KCkgPT4gc2V0UGFnZSgocCkgPT4gcCArIDEpfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc2FibGVkPXshaGFzTmV4dFBhZ2V9XG4gICAgICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgICAgICA8L1BhZ2luYXRpb24+XG4gICAgICAgICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgICAgICAgPEZvcm0gY2xhc3NOYW1lPVwiZC1mbGV4IHBiLTJcIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxGb3JtQ29udHJvbFxuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlPXtzaG93TGlzdFNlYXJjaH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI9XCJTZWFyY2hcIlxuICAgICAgICAgICAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJtZS0yIGZsZXgtZ3Jvdy0xXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBhcmlhLWxhYmVsPVwiU2VhcmNoXCJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZT17c2VhcmNofVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlPXtzZWFyY2hDaGFuZ2VIYW5kbGVyfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlPXt7IGZsZXg6IFwiMVwiIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxOYXZEcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlPXtzZWxlY3R9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ9XCJjb2xsYXNpYmxlLW5hdi1kcm9wZG93blwiXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdz17c2hvd0xpc3R9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgb25Nb3VzZUVudGVyPXsoKSA9PiBzZXRTaG93TGlzdCh0cnVlKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBvbk1vdXNlTGVhdmU9eygpID0+IHNldFNob3dMaXN0KGZhbHNlKX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICBzdHlsZT17eyBtYXJnaW5Ub3A6IFwiLTVweFwiIH19XHJcbiAgICAgICAgICAgICAgICAgICAgICAgID5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8TmF2RHJvcGRvd24uSXRlbSBvbkNsaWNrPXsoKSA9PiB7IHNldFNlbGVjdChcIk5hbWVcIik7IHNldFNob3dMaXN0U2VhcmNoKFwidGV4dFwiKTsgfX0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBOYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPC9OYXZEcm9wZG93bi5JdGVtPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxOYXZEcm9wZG93bi5JdGVtIG9uQ2xpY2s9eygpID0+IHsgc2V0U2VsZWN0KFwiRGF0ZVwiKTsgc2V0U2hvd0xpc3RTZWFyY2goXCJkYXRlXCIpOyB9fT5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L05hdkRyb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgPE5hdkRyb3Bkb3duLkl0ZW0gb25DbGljaz17KCkgPT4geyBzZXRTZWxlY3QoXCJXb3JrIE9yZGVyXCIpOyBzZXRTaG93TGlzdFNlYXJjaChcIm51bWJlclwiKTsgfX0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgV29yayBPcmRlclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L05hdkRyb3Bkb3duLkl0ZW0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxOYXZEcm9wZG93bi5JdGVtIG9uQ2xpY2s9eygpID0+IHsgc2V0U2VsZWN0KFwiV29yayBPcmRlclwiKTsgc2V0U2hvd0xpc3RTZWFyY2goXCJ0ZXh0XCIpOyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBXb3JrIE9yZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPE5hdkRyb3Bkb3duLkl0ZW0gb25DbGljaz17KCkgPT4geyBzZXRTZWxlY3QoXCJQcm9kdWN0IE51bWJlclwiKTsgc2V0U2hvd0xpc3RTZWFyY2goXCJ0ZXh0XCIpOyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQcm9kdWN0IE51bWJlclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L05hdkRyb3Bkb3duLkl0ZW0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxOYXZEcm9wZG93bi5JdGVtIG9uQ2xpY2s9eygpID0+IHsgc2V0U2VsZWN0KFwiU2VyaWFsIE51bWJlclwiKTsgc2V0U2hvd0xpc3RTZWFyY2goXCJ0ZXh0XCIpOyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTZXJpYWwgTnVtYmVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24uSXRlbT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgPE5hdkRyb3Bkb3duLkl0ZW0gb25DbGljaz17KCkgPT4geyBzZXRTZWxlY3QoXCJEZXNjcmlwdGlvblwiKTsgc2V0U2hvd0xpc3RTZWFyY2goXCJ0ZXh0XCIpOyB9fT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEZXNjcmlwdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L05hdkRyb3Bkb3duLkl0ZW0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgIDxOYXZEcm9wZG93bi5JdGVtXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNldFNlbGVjdChcIlNLVVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0U2hvd0xpc3RTZWFyY2goXCJ0ZXh0XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfX1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICA+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTS1VcclxuICAgICAgICAgICAgICAgICAgICAgICAgICA8L05hdkRyb3Bkb3duLkl0ZW0+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDwvTmF2RHJvcGRvd24+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L0Zvcm0+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImQtZmxleCBqdXN0aWZ5LWNvbnRlbnQtYmV0d2VlblwiPlxyXG4gICAgICAgICAgICAgICAgICAgICAgICA8TG9hZGluZ0J1dHRvbiB0eXBlPVwic2Vjb25kYXJ5XCIgbmFtZT1cIkFkZCBOZXcgSXRlbVwiIHJvdXRlPVwiTmV3U2VhcmNoL0FkZEl0ZW0vTmV3SXRlbVwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIDxMb2FkaW5nQnV0dG9uIHR5cGU9XCJwcmltYXJ5XCIgbmFtZT1cIkJhY2tcIiByb3V0ZT1cIldhcmVob3VzZWRiL1dhcmVob3VzZVNlbGVjdFwiIC8+XHJcbiAgICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgICA8L2Rpdj5cclxuICAgICAgICAgICAgICAgICAgPC9kaXY+XHJcbiAgICAgICAgICAgICAgICA8L0NvbD5cclxuICAgICAgICAgICAgICA8L1Jvdz5cclxuICAgICAgICAgICAgPC9DYXJkLkJvZHk+XHJcbiAgICAgICAgICA8L0NhcmQ+XHJcbiAgICAgICAgPC9kaXY+XHJcbiAgICAgIDwvQ29udGFpbmVyPlxyXG4gICAgPC9Mb2dnZWRJbj5cclxuICApO1xyXG5cclxuXHJcbn1cclxuXHJcbiJdfQ== */\\n/*@ sourceURL=C:\\\\\\\\Users\\\\\\\\mack2\\\\\\\\Desktop\\\\\\\\code\\\\\\\\pages\\\\\\\\NewSearch\\\\\\\\mainSearch.js */\")) : __jsx(PartTable, {\n    info: info,\n    labels: labels,\n    ids: ids,\n    hoverStyle: hoverStyle,\n    sortCheckAll: sortCheckAll,\n    checkDelete: checkDelete,\n    isDeleting: isDeleting,\n    rowSelect: rowSelect,\n    setHoverIndex: setHoverIndex,\n    hoverIndex: hoverIndex,\n    selectedItems: selectedItems,\n    setSelectedItems: setSelectedItems,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1126,\n      columnNumber: 23\n    }\n  }), __jsx(\"div\", {\n    className: styles.searchContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1143,\n      columnNumber: 21\n    }\n  }, __jsx(\"div\", {\n    className: styles.paginationRow,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1144,\n      columnNumber: 23\n    }\n  }, __jsx(Pagination, {\n    size: \"sm\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1145,\n      columnNumber: 25\n    }\n  }, __jsx(Pagination.Prev, {\n    onClick: () => setPage(p => Math.max(1, p - 1)),\n    disabled: page <= 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1146,\n      columnNumber: 27\n    }\n  }), pageButtons, __jsx(Pagination.Next, {\n    onClick: () => setPage(p => p + 1),\n    disabled: !hasNextPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1151,\n      columnNumber: 27\n    }\n  }))), __jsx(Form, {\n    className: \"d-flex pb-2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1157,\n      columnNumber: 23\n    }\n  }, __jsx(FormControl, {\n    type: showListSearch,\n    placeholder: \"Search\",\n    className: \"me-2 flex-grow-1\",\n    \"aria-label\": \"Search\",\n    value: search,\n    onChange: searchChangeHandler,\n    style: {\n      flex: \"1\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1158,\n      columnNumber: 25\n    }\n  }), __jsx(NavDropdown, {\n    title: select,\n    id: \"collasible-nav-dropdown\",\n    show: showList,\n    onMouseEnter: () => setShowList(true),\n    onMouseLeave: () => setShowList(false),\n    style: {\n      marginTop: \"-5px\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1167,\n      columnNumber: 25\n    }\n  }, __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Name\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1175,\n      columnNumber: 27\n    }\n  }, \"Name\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Date\");\n      setShowListSearch(\"date\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1178,\n      columnNumber: 27\n    }\n  }, \"Date\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Work Order\");\n      setShowListSearch(\"number\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1181,\n      columnNumber: 27\n    }\n  }, \"Work Order\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Work Order\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1184,\n      columnNumber: 27\n    }\n  }, \"Work Order\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Product Number\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1187,\n      columnNumber: 27\n    }\n  }, \"Product Number\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Serial Number\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1190,\n      columnNumber: 27\n    }\n  }, \"Serial Number\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"Description\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1193,\n      columnNumber: 27\n    }\n  }, \"Description\"), __jsx(NavDropdown.Item, {\n    onClick: () => {\n      setSelect(\"SKU\");\n      setShowListSearch(\"text\");\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1196,\n      columnNumber: 27\n    }\n  }, \"SKU\"))), __jsx(\"div\", {\n    className: \"d-flex justify-content-between\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1206,\n      columnNumber: 23\n    }\n  }, __jsx(LoadingButton, {\n    type: \"secondary\",\n    name: \"Add New Item\",\n    route: \"NewSearch/AddItem/NewItem\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1207,\n      columnNumber: 25\n    }\n  }), __jsx(LoadingButton, {\n    type: \"primary\",\n    name: \"Back\",\n    route: \"Warehousedb/WarehouseSelect\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 1208,\n      columnNumber: 25\n    }\n  })))))))))));\n}","map":{"version":3,"sources":["C:/Users/mack2/Desktop/code/pages/NewSearch/mainSearch.js"],"names":["React","useEffect","useState","useRef","useCallback","Container","Card","Row","Col","InputGroup","Dropdown","FormControl","Button","NavDropdown","Form","Modal","Spinner","Pagination","Link","useRouter","fetchPartsWithMachineDataPage","fetchClients","fetchModels","formatDate","useAuth","LoggedIn","ClientTable","ModelTable","PartTable","styles","firebase","SOCAL_CLIENT_ID","NORCAL_CLIENT_ID","UNASSIGNED_CLIENT_ID","PAGE_SIZE","simulateNetworkRequest","Promise","resolve","setTimeout","LoadingButton","type","name","route","isLoading","setLoading","cancelled","then","toTime","value","seconds","Date","t","getTime","isNaN","iso","parse","parts","split","length","mm","dd","yyyy","alt","toYMD","d","getFullYear","String","getMonth","padStart","getDate","normalizeText","toLowerCase","trim","getMachineField","item","key","lower","machineData","currentMachineData","theMachineData","TheMachine","MainSearch","signOut","info","setInfo","backupInfo","setBackupInfo","augmentedInfo","setAugmentedInfo","setIsLoading","ids","setID","show","setShow","dItem","setDItem","select","setSelect","showList","setShowList","showListSearch","setShowListSearch","search","setSearch","selectedOEM","setSelectedOEM","selectedModality","setSelectedModality","selectedClientFrom","setSelectedClientFrom","clientFromButtonText","setClientFromButtonText","selectedClientCurrent","setSelectedClientCurrent","clientCurrentButtonText","setClientCurrentButtonText","clients","setClients","showClientModal","setShowClientModal","clientSelectionType","setClientSelectionType","router","labelBase","labelBaseNames","sortCheckBase","withSortIcon","baseLabels","activeIndex","isDesc","map","text","i","arrow","labels","setLabels","sortCheck","setSortCheck","hoverIndex","setHoverIndex","selectedModel","setSelectedModel","gPos","setGPos","gIde","setGIde","isDeleting","setIsDeleting","page","setPage","pageCursors","setPageCursors","hasNextPage","setHasNextPage","fetchSeq","queryEpoch","setQueryEpoch","searchLower","hasActiveFilters","Boolean","valueMatches","s","Array","isArray","some","v","includes","matchesFilters","visible","OEM","Modality","Model","clientFromId","clientCurrentId","wantedDay","itemYMD","date","descriptions","workOrders","w","wo","workOrder","pn","sn","desc","description","id","localSN","local_sn","resetPagination","asPath","fetchData","requestedPage","seq","current","query","inputText","selectedType","startAfterDoc","load","attempt","pageSize","visibleOnly","filterFn","e","r","Math","pow","data","lastDoc","nextPage","prev","next","setSelectedItems","augmented","ClientFrom","ClientCurrent","filter","err","console","error","searchChangeHandler","event","target","base","sortCheckAll","pos","nextSortCheck","sortedInfo","sort","a","b","ta","tb","av","toString","bv","localeCompare","an","Number","bn","rowSelect","log","push","selectedItems","showDeleteModal","setShowDeleteModal","handleSelectItem","x","handleShowDeleteModal","handleCloseDeleteModal","handleDeleteSelected","db","firestore","itemId","collection","doc","delete","deleteFromStorage","handleClose","handleShow","checkDelete","idsToDelete","preventDefault","stopPropagation","hoverStyle","index","backgroundColor","textAlign","cursor","dropdown1Text","setDropdown1Text","dropdown2Text","setDropdown2Text","handleSelect1","eventKey","textContent","handleSelect2","buildClientsFromItems","Set","filtered","it","add","out","idArray","chunk","slice","snap","where","FieldPath","documentId","get","forEach","handleClientClick","safeClients","clientsData","derived","setClientSearchTerm","handleClientSelect","clientId","clientSnap","exists","clientData","handleClientInfo","clientName","handleClearClientSelection","models","setModels","showModelModal","setShowModelModal","modelButtonText","setModelButtonText","handleModelClick","modelsData","setModelSearchTerm","handleModelSelect","modelName","handleClearModelSelection","handleSoCalWarehouseClick","handleNorCalWarehouseClick","handleWarehouseUnassignedClick","clientSearchTerm","modelSearchTerm","storageRef","storage","ref","folderRef","child","listResult","listAll","deletePromises","items","all","deleteFromPartsCollection","totalKnownPages","max","pageButtons","client","model","minHeight","maxWidth","divider","buttonGroup","flexButton","tableContainer","width","height","animation","transformOrigin","display","searchContainer","paginationRow","p","flex","marginTop"],"mappings":"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","sourcesContent":["import React, { useEffect, useState, useRef, useCallback } from \"react\";\nimport {\r\n  Container,\n  Card,\n  Row,\n  Col,\n  InputGroup,\n  Dropdown,\n  FormControl,\n  Button,\n  NavDropdown,\n  Form,\n  Modal,\n  Spinner,\n  Pagination,\n} from \"react-bootstrap\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/router\";\nimport {\n  fetchPartsWithMachineDataPage,\n  fetchClients,\n  fetchModels,\n  formatDate,\n} from \"../../utils/fetchAssociations\";\nimport { useAuth } from \"../../context/AuthUserContext\";\r\nimport LoggedIn from \"../LoggedIn\";\r\nimport ClientTable from \"../../utils/ClientTable\";\r\nimport ModelTable from \"../../utils/ModelTable\";\r\nimport PartTable from \"../../utils/PartTable\";\r\nimport styles from \"../../styles/MainSearch.module.css\";\r\nimport firebase from \"../../context/Firebase\";\r\n\r\n// Predefined warehouse client IDs and display names\r\nconst SOCAL_CLIENT_ID = \"AIS17182\";\r\nconst NORCAL_CLIENT_ID = \"AIS25097\";\nconst UNASSIGNED_CLIENT_ID = \"AIS00404\";\nconst PAGE_SIZE = 25;\n\r\n\r\n// Simulates a network request delay\r\nfunction simulateNetworkRequest() {\r\n  return new Promise((resolve) => setTimeout(resolve, 2000));\r\n}\r\n\r\n// Custom LoadingButton component\r\nfunction LoadingButton({ type, name, route }) {\n  const [isLoading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (isLoading) {\n      let cancelled = false;\n      simulateNetworkRequest().then(() => {\n        if (!cancelled) setLoading(false);\n      });\n      return () => {\n        cancelled = true;\n      };\n    }\n  }, [isLoading]);\n\r\n  return (\r\n    <Link href={`/${route}`}>\r\n      <a\r\n        className={`btn btn-${type}`}\r\n        disabled={isLoading}\r\n        onClick={() => !isLoading && setLoading(true)}\r\n      >\r\n        {isLoading ? \"Loading…\" : name}\r\n      </a>\r\n    </Link>\r\n  );\r\n}\r\n\r\n// ---- DATE HELPERS (top-level scope) ----\r\n\r\n// Convert anything date-ish into a timestamp (ms since epoch).\r\nfunction toTime(value) {\r\n  if (!value) return null;\r\n\r\n  // Firestore Timestamp { seconds, nanoseconds }\r\n  if (typeof value === \"object\" && value !== null && value.seconds != null) {\r\n    try { return value.seconds * 1000; } catch { /* ignore */ }\r\n  }\r\n\r\n  // Native Date\r\n  if (value instanceof Date) {\r\n    const t = value.getTime();\r\n    return isNaN(t) ? null : t;\r\n  }\r\n\r\n  // Strings\r\n  if (typeof value === \"string\") {\r\n    // ISO / yyyy-mm-dd\r\n    const iso = Date.parse(value);\r\n    if (!isNaN(iso)) return iso;\r\n\r\n    // mm/dd/yyyy\r\n    const parts = value.split(\"/\");\r\n    if (parts.length === 3) {\r\n      const [mm, dd, yyyy] = parts;\r\n      const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\r\n      if (!isNaN(alt)) return alt;\r\n    }\r\n  }\r\n\r\n  // Last resort\r\n  const t = Date.parse(value);\r\n  return isNaN(t) ? null : t;\r\n}\r\n\r\n// Canonicalize to 'yyyy-mm-dd' (matches <input type=\"date\">)\r\nfunction toYMD(value) {\n  const t = toTime(value);\n  if (t == null) return null;\n  const d = new Date(t);\n  const yyyy = d.getFullYear();\n  const mm = String(d.getMonth() + 1).padStart(2, \"0\");\n  const dd = String(d.getDate()).padStart(2, \"0\");\n  return `${yyyy}-${mm}-${dd}`;\n}\n\nfunction normalizeText(value) {\n  if (value == null) return \"\";\n  return String(value).toLowerCase().trim();\n}\n\nfunction getMachineField(item, key) {\n  if (!item) return null;\n  const lower = key.toLowerCase();\n  return (\n    item?.machineData?.[key] ??\n    item?.machineData?.[lower] ??\n    item?.currentMachineData?.[key] ??\n    item?.currentMachineData?.[lower] ??\n    item?.theMachineData?.[key] ??\n    item?.theMachineData?.[lower] ??\n    item?.TheMachine?.[key] ??\n    item?.TheMachine?.[lower] ??\n    null\n  );\n}\n\n\nexport default function MainSearch() {\n  const { signOut } = useAuth();\r\n  const [info, setInfo] = useState([]);\r\n  const [backupInfo, setBackupInfo] = useState([]);\r\n  const [augmentedInfo, setAugmentedInfo] = useState([]); // items with clientFromId/currentId added\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [ids, setID] = useState([]);\r\n  const [show, setShow] = useState(false);\r\n  const [dItem, setDItem] = useState();\r\n  const [select, setSelect] = useState(\"Name\");\r\n  const [showList, setShowList] = useState(false);\r\n  const [showListSearch, setShowListSearch] = useState(\"text\");\r\n  const [search, setSearch] = useState(\"\");\r\n  const [selectedOEM, setSelectedOEM] = useState(null);\r\n  const [selectedModality, setSelectedModality] = useState(null);\r\n  // Replace the old single client state with two sets:\r\n  const [selectedClientFrom, setSelectedClientFrom] = useState(null);\r\n  const [clientFromButtonText, setClientFromButtonText] = useState(\"Select Option\");\r\n  const [selectedClientCurrent, setSelectedClientCurrent] = useState(null);\r\n  const [clientCurrentButtonText, setClientCurrentButtonText] = useState(\"Select Option\");\r\n\r\n  const [clients, setClients] = useState([]);\r\n  const [showClientModal, setShowClientModal] = useState(false);\r\n  // This state tells the modal which client box is being updated: \"from\" or \"current\"\r\n  const [clientSelectionType, setClientSelectionType] = useState(null);\r\n\r\n  const router = useRouter();\r\n  const labelBase = [\"name\", \"date\", \"w/o\", \"p/n\", \"s/n\"];\r\n  const labelBaseNames = [\"name\", \"date\", \"wo\", \"pn\", \"sn\"];\r\n  const sortCheckBase = [false, false, false, false, false, false];\r\n\r\n  function withSortIcon(baseLabels, activeIndex, isDesc) {\r\n    return baseLabels.map((text, i) => {\r\n      if (i !== activeIndex) return text; // untouched\r\n      const arrow = isDesc ? \" ▼\" : \" ▲\";\r\n      return `${text}${arrow}`;\r\n    });\r\n  }\r\n\r\n\r\n  const [labels, setLabels] = useState(labelBase);\r\n  const [sortCheck, setSortCheck] = useState(sortCheckBase);\r\n  const [hoverIndex, setHoverIndex] = useState(null);\r\n  const [selectedModel, setSelectedModel] = useState(null);\r\n  const [gPos, setGPos] = useState(null);\n  const [gIde, setGIde] = useState(null);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [page, setPage] = useState(1);\n  const [pageCursors, setPageCursors] = useState([]);\n  const [hasNextPage, setHasNextPage] = useState(false);\n  const fetchSeq = useRef(0);\n  const [queryEpoch, setQueryEpoch] = useState(0);\n\n  const searchLower = (search || \"\").toLowerCase().trim();\n  const hasActiveFilters =\n    Boolean(selectedOEM) ||\n    Boolean(selectedModality) ||\n    Boolean(selectedModel) ||\n    Boolean(selectedClientFrom) ||\n    Boolean(selectedClientCurrent) ||\n    Boolean(searchLower);\n\n  const valueMatches = (value, s) => {\n    if (!value) return false;\n    if (Array.isArray(value)) {\n      return value.some((v) => valueMatches(v, s));\n    }\n    return String(value).toLowerCase().includes(s);\n  };\n\n  const matchesFilters = useCallback(\n    (item) => {\n      // hide explicitly hidden items\n      if (item?.visible === false) return false;\n\n      // OEM / Modality / Model filtering\n      const OEM = getMachineField(item, \"OEM\");\n      const Modality = getMachineField(item, \"Modality\");\n      const Model = getMachineField(item, \"Model\");\n\n      if (selectedOEM && normalizeText(OEM) !== normalizeText(selectedOEM)) {\n        return false;\n      }\n      if (\n        selectedModality &&\n        normalizeText(Modality) !== normalizeText(selectedModality)\n      ) {\n        return false;\n      }\n      if (selectedModel && normalizeText(Model) !== normalizeText(selectedModel)) {\n        return false;\n      }\n\n      // Client filters\n      if (selectedClientFrom && item?.clientFromId !== selectedClientFrom) {\n        return false;\n      }\n      if (\n        selectedClientCurrent &&\n        item?.clientCurrentId !== selectedClientCurrent\n      ) {\n        return false;\n      }\n\n      // Search\n      if (searchLower) {\n        if (select === \"Name\") {\n          return valueMatches(item?.name, searchLower);\n        }\n        if (select === \"Date\") {\n          const wantedDay = searchLower; // yyyy-mm-dd from input\n          const itemYMD = toYMD(item?.date);\n          if (itemYMD && itemYMD === wantedDay) return true;\n          if (Array.isArray(item?.descriptions)) {\n            if (item.descriptions.some((d) => toYMD(d?.date) === wantedDay)) {\n              return true;\n            }\n          }\n          if (Array.isArray(item?.workOrders)) {\n            if (item.workOrders.some((w) => toYMD(w?.date) === wantedDay)) {\n              return true;\n            }\n          }\n          return false;\n        }\n        if (select === \"Work Order\") {\n          return (\n            Array.isArray(item?.workOrders) &&\n            item.workOrders.some((wo) =>\n              valueMatches(wo?.workOrder, searchLower)\n            )\n          );\n        }\n        if (select === \"Product Number\") {\n          return valueMatches(item?.pn, searchLower);\n        }\n        if (select === \"Serial Number\") {\n          return valueMatches(item?.sn, searchLower);\n        }\n        if (select === \"Description\") {\n          if (valueMatches(item?.desc, searchLower)) return true;\n          if (valueMatches(item?.description, searchLower)) return true;\n          if (Array.isArray(item?.descriptions)) {\n            return item.descriptions.some((d) =>\n              valueMatches(d?.description, searchLower)\n            );\n          }\n          return false;\n        }\n        if (select === \"SKU\") {\n          return (\n            valueMatches(item?.id, searchLower) ||\n            valueMatches(item?.localSN, searchLower) ||\n            valueMatches(item?.local_sn, searchLower)\n          );\n        }\n      }\n\n      return true;\n    },\n    [\n      selectedOEM,\n      selectedModality,\n      selectedModel,\n      selectedClientFrom,\n      selectedClientCurrent,\n      searchLower,\n      select,\n    ]\n  );\n\n  const resetPagination = () => {\n    setPage(1);\n    setPageCursors([]);\n    setHasNextPage(false);\n  };\n\n  // Reset pagination on route/query change (prevents stale pages like “starting at 6”)\n  useEffect(() => {\n    resetPagination();\n    setQueryEpoch((v) => v + 1);\n  }, [router.asPath]);\n\n  // Reset and refetch when filters/search change\n  useEffect(() => {\n    resetPagination();\n    setQueryEpoch((v) => v + 1);\n  }, [\n    selectedOEM,\n    selectedModality,\n    selectedModel,\n    selectedClientFrom,\n    selectedClientCurrent,\n    search,\n    select,\n  ]);\n\n  // Fetch data on component mount and route change\n  useEffect(() => {\n    fetchData(page);\n  }, [page, queryEpoch]);\n\n  async function fetchData(requestedPage = 1) {\n    const seq = ++fetchSeq.current;\n    setIsLoading(true);\n    try {\n      if (router.query.inputText && router.query.selectedType) {\n        setSelect(router.query.selectedType);\n        setSearch(router.query.inputText);\n      }\n      const startAfterDoc =\n        requestedPage > 1 ? pageCursors[requestedPage - 2] : null;\n      if (requestedPage > 1 && !startAfterDoc) {\n        setPage(1);\n        if (seq === fetchSeq.current) setIsLoading(false);\n        return;\n      }\n      // light retry for transient Firestore hiccups\n      const load = async (attempt = 1) => {\n        try {\n          return await fetchPartsWithMachineDataPage({\n            pageSize: PAGE_SIZE,\n            startAfterDoc,\n            visibleOnly: true,\n            filterFn: hasActiveFilters ? matchesFilters : null,\n          });\n        } catch (e) {\n          if (attempt >= 3) throw e;\n          await new Promise(r => setTimeout(r, 250 * Math.pow(2, attempt - 1)));\n          return load(attempt + 1);\n        }\n      };\n      const { parts: data, lastDoc, hasNextPage: nextPage } = await load();\n      if (seq !== fetchSeq.current) return;\n      if (requestedPage === 1 && data.length === 0) {\n        setPageCursors([]);\n        setHasNextPage(false);\n      }\n      setBackupInfo(data);\n      setLabels(labelBase); // <-- add this line after setBackupInfo(data)\n      setID(data.map((item) => item.id));\n      if (requestedPage > 1 && data.length === 0) {\n        setHasNextPage(false);\n        setPage(1);\n        return;\n      }\n      setHasNextPage(nextPage);\n      setPageCursors((prev) => {\n        const next = requestedPage === 1 ? [] : [...prev];\n        if (lastDoc) {\n          next[requestedPage - 1] = lastDoc;\n        }\n        return next;\n      });\n      setSelectedItems([]);\n\n      // Normalize client ids for filtering\n      const augmented = data.map((item) => ({\n        ...item,\n        clientFromId:\n          item?.clientFromId ??\n          (typeof item?.ClientFrom === \"string\" ? item.ClientFrom : null) ??\n          item?.ClientFrom?.id ??\n          null,\n        clientCurrentId:\n          item?.clientCurrentId ??\n          (typeof item?.ClientCurrent === \"string\" ? item.ClientCurrent : null) ??\n          item?.ClientCurrent?.id ??\n          null,\n      }));\n\r\n      setAugmentedInfo(augmented);\n      // default view = filtered (keeps pagination and filters consistent)\n      setInfo(augmented.filter(matchesFilters));\n    } catch (err) {\n      if (seq !== fetchSeq.current) return;\n      console.error(\"Error fetching data:\", err);\n      setInfo([]);\n      setAugmentedInfo([]);\n    } finally {\n      if (seq === fetchSeq.current) setIsLoading(false);\n    }\n  }\n\r\n  const searchChangeHandler = (event) => setSearch(event.target.value);\r\n\r\n  // Filter the currently loaded items (now consistent with paged filtering)\n  useEffect(() => {\n    const base = augmentedInfo || [];\n    setInfo(base.filter(matchesFilters));\n  }, [augmentedInfo, matchesFilters]);\n\r\n  function sortCheckAll(pos) {\r\n    // Determine next direction: toggle the clicked column only\r\n    const nextSortCheck = sortCheck.map((v, i) => (i === pos ? !v : v));\r\n    const isDesc = nextSortCheck[pos]; // true means descending\r\n\r\n    const sortedInfo = [...info].sort((a, b) => {\r\n      const key = labelBaseNames[pos];\r\n\r\n      if (pos === 1) {\r\n        // DATE column\r\n        const ta = toTime(a[key]);\r\n        const tb = toTime(b[key]);\r\n\r\n        // Put missing dates at the end for ascending, at the start for descending\r\n        if (ta === null && tb === null) return 0;\r\n        if (ta === null) return isDesc ? -1 : 1;\r\n        if (tb === null) return isDesc ? 1 : -1;\r\n\r\n        return isDesc ? (tb - ta) : (ta - tb);\r\n      }\r\n\r\n      // NAME or SKU (string-y columns): indexes 0 or 5 in your original logic\r\n      if (pos === 0 || pos === 5) {\r\n        const av = (a[key] ?? \"\").toString();\r\n        const bv = (b[key] ?? \"\").toString();\r\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\r\n      }\r\n\r\n      // Numeric-ish columns (wo, pn, sn) — fall back to string compare if NaN\r\n      const an = Number(a[key]);\r\n      const bn = Number(b[key]);\r\n\r\n      if (!isNaN(an) && !isNaN(bn)) {\r\n        return isDesc ? (bn - an) : (an - bn);\r\n      } else {\r\n        const av = (a[key] ?? \"\").toString();\r\n        const bv = (b[key] ?? \"\").toString();\r\n        return isDesc ? bv.localeCompare(av) : av.localeCompare(bv);\r\n      }\r\n    });\r\n\r\n    setInfo(sortedInfo);\r\n    setSortCheck(nextSortCheck);\r\n\r\n    // Update header labels to show the little arrow on the active column\r\n    setLabels(withSortIcon(labelBase, pos, isDesc));\r\n  }\r\n\r\n\r\n  const rowSelect = (item) => {\r\n    if (item && item.id) {\r\n      console.log(\"Selected item:\", item);\r\n      router.push(\"./item/\" + item.id);\r\n    } else {\r\n      console.error(\"Unable to determine the selected item’s ID: \", item);\r\n    }\r\n  };\r\n\r\n  const [selectedItems, setSelectedItems] = useState([]);\r\n  const [showDeleteModal, setShowDeleteModal] = useState(false);\r\n\r\n  const handleSelectItem = (id) => {\r\n    setSelectedItems(prev =>\r\n      prev.includes(id) ? prev.filter(x => x !== id) : [...prev, id]\r\n    );\r\n  };\r\n\r\n\r\n  // setSelectedItems((prev) => {\r\n  //   const newSelection = prev.includes(id)\r\n  //     ? prev.filter((itemId) => itemId !== id)\r\n  //     : [...prev, id];\r\n  //   console.log(\"Selected items:\", newSelection);\r\n  //   return newSelection; // <- important\r\n  // });\r\n\r\n  const handleShowDeleteModal = () => setShowDeleteModal(true);\r\n  const handleCloseDeleteModal = () => setShowDeleteModal(false);\r\n\r\n  const handleDeleteSelected = async () => {\r\n    setIsDeleting(true);\r\n    const db = firebase.firestore();\r\n    try {\r\n      // Loop over each selected item one at a time\r\n      for (const itemId of selectedItems) {\r\n        console.log(itemId)\r\n        try {\r\n          // Delete from \"Test\" collection\r\n          await db.collection(\"Test\").doc(itemId).delete();\r\n        } catch (err) {\r\n          console.error(`Error deleting document ${itemId} from Test:`, err);\r\n        }\r\n        try {\r\n          // Delete from \"Parts\" collection\r\n          await db.collection(\"Parts\").doc(itemId).delete();\r\n        } catch (err) {\r\n          console.error(`Error deleting document ${itemId} from Parts:`, err);\r\n        }\r\n        try {\r\n          // Delete associated photos from storage\r\n          await deleteFromStorage(itemId);\r\n        } catch (err) {\r\n          console.error(`Error deleting storage for ${itemId}:`, err);\r\n        }\r\n      }\r\n      // Update local state by filtering out the deleted items\r\n      setInfo(info.filter((item) => !selectedItems.includes(item.id)));\r\n      setSelectedItems([]);\r\n    } catch (error) {\r\n      console.error(\"Error deleting items:\", error);\r\n    } finally {\r\n      setIsDeleting(false);\r\n      handleCloseDeleteModal();\r\n      // Optionally, reload the page\r\n      // router.reload();\r\n    }\r\n  };\r\n\r\n\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n\r\n  const checkDelete = (event, pos, idsToDelete, name) => {\r\n    if (event) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }\r\n    console.log(\"Selected IDs to delete:\", idsToDelete);\r\n    setSelectedItems(idsToDelete);\r\n    setDItem(name);\r\n    setShowDeleteModal(true);\r\n  };\r\n\r\n  // const handleDelete = async () => {\r\n  //   let itemId = gIde;\r\n  //   try {\r\n  //     setIsDeleting(true);\r\n  //     const db = firebase.firestore();\r\n  //     await db.collection(\"Test\").doc(itemId).delete();\r\n  //     await deleteFromPartsCollection(itemId);\r\n  //     await deleteFromStorage(itemId);\r\n  //     setInfo(info.filter((_, i) => gPos !== i));\r\n  //     console.log(`Deleted item: ${itemId}`);\r\n  //   } catch (error) {\r\n  //     console.error(\"Error deleting item:\", error);\r\n  //   } finally {\r\n  //     setIsDeleting(false);\r\n  //   }\r\n  //   handleClose();\r\n  // };\r\n\r\n  const hoverStyle = (index) => ({\r\n    backgroundColor: hoverIndex === index ? \"#ddd\" : \"transparent\",\r\n    textAlign: \"center\",\r\n    cursor: \"default\",\r\n  });\r\n\r\n  const [dropdown1Text, setDropdown1Text] = useState(\"Select Option\");\r\n  const [dropdown2Text, setDropdown2Text] = useState(\"Select Option\");\r\n\r\n  const handleSelect1 = (eventKey, event) => {\r\n    if (eventKey === \"unassigned\") {\r\n      setDropdown1Text(\"Select Option\");\r\n      setSelectedOEM(null);\r\n    } else {\r\n      setDropdown1Text(event.target.textContent);\r\n      setSelectedOEM(event.target.textContent);\r\n    }\r\n  };\r\n\r\n  const handleSelect2 = (eventKey, event) => {\r\n    if (eventKey === \"unassigned\") {\r\n      setDropdown2Text(\"Select Option\");\r\n      setSelectedModality(null);\r\n    } else {\r\n      setDropdown2Text(event.target.textContent);\r\n      setSelectedModality(event.target.textContent);\r\n    }\r\n  };\r\n\r\n  // Build a unique list of clients from the items currently loaded, filtered by OEM/Modality.\r\n  // `type` is \"from\" or \"current\" to decide which client ref to read.\r\n  async function buildClientsFromItems(type) {\n    const db = firebase.firestore();\n    const ids = new Set();\n\n    // Respect current OEM / Modality filters when deriving client options\n    const filtered = augmentedInfo.filter((item) => {\n      const OEM = getMachineField(item, \"OEM\");\n      const Modality = getMachineField(item, \"Modality\");\n      if (selectedOEM && normalizeText(OEM) !== normalizeText(selectedOEM)) {\n        return false;\n      }\n      if (\n        selectedModality &&\n        normalizeText(Modality) !== normalizeText(selectedModality)\n      ) {\n        return false;\n      }\n      return true;\n    });\n\r\n    for (const it of filtered) {\r\n      const id = type === \"from\" ? it.clientFromId : it.clientCurrentId;\r\n      if (id) ids.add(id);\r\n    }\r\n\r\n    const out = [];\r\n    const idArray = [...ids];\r\n    for (let i = 0; i < idArray.length; i += 10) {\r\n      const chunk = idArray.slice(i, i + 10);\r\n      const snap = await db\r\n        .collection(\"Client\")\r\n        .where(firebase.firestore.FieldPath.documentId(), \"in\", chunk)\r\n        .get();\r\n      snap.forEach((doc) => {\r\n        const d = doc.data() || {};\r\n        out.push({ id: doc.id, name: d.name || doc.id });\r\n      });\r\n    }\r\n\r\n    // sort by name for nicer UX\r\n    out.sort((a, b) => (a.name || \"\").localeCompare(b.name || \"\"));\r\n    return out;\r\n  }\r\n\r\n\r\n  // --------------------\r\n  // CLIENT SELECTION HANDLING\r\n  // --------------------\r\n  // This function fetches clients and opens the client modal.\r\n  const handleClientClick = async () => {\r\n    let safeClients = [];\r\n    try {\r\n      const clientsData = await fetchClients(selectedOEM, selectedModality);\r\n      safeClients = Array.isArray(clientsData) ? clientsData : [];\r\n    } catch (e) {\r\n      console.error(\"fetchClients failed:\", e);\r\n    }\r\n\r\n    // Fallback to building from loaded items if API gave us nothing\r\n    if (safeClients.length === 0) {\r\n      try {\r\n        if (!clientSelectionType) {\r\n          // if somehow not set yet, default to \"from\"\r\n          setClientSelectionType(\"from\");\r\n        }\r\n        const derived = await buildClientsFromItems(clientSelectionType || \"from\");\r\n        safeClients = derived;\r\n      } catch (e) {\r\n        console.error(\"Fallback buildClientsFromItems failed:\", e);\r\n        safeClients = [];\r\n      }\r\n    }\r\n\r\n    setClients(safeClients);\r\n    setClientSearchTerm(\"\");\r\n    setShowClientModal(true);\r\n  };\r\n\r\n\r\n\r\n  // When a client is selected in the modal, we now assume the parameter is a client ID.\r\n  // If the passed value is null, we clear the selection.\r\n  const handleClientSelect = async (clientId) => {\r\n    console.log(\"User selected client id:\", clientId);\r\n    if (!clientId) {\r\n      if (clientSelectionType === \"from\") {\r\n        setClientFromButtonText(\"Select Option\");\r\n        setSelectedClientFrom(null);\r\n      } else if (clientSelectionType === \"current\") {\r\n        setClientCurrentButtonText(\"Select Option\");\r\n        setSelectedClientCurrent(null);\r\n      }\r\n      setShowClientModal(false);\r\n      return;\r\n    }\r\n    try {\r\n      const clientSnap = await firebase.firestore().collection(\"Client\").doc(clientId).get();\r\n      if (clientSnap.exists) {\r\n        const clientData = clientSnap.data();\r\n        if (clientSelectionType === \"from\") {\r\n          setClientFromButtonText(clientData.name);\r\n          setSelectedClientFrom(clientId);\r\n        } else if (clientSelectionType === \"current\") {\r\n          setClientCurrentButtonText(clientData.name);\r\n          setSelectedClientCurrent(clientId);\r\n        }\r\n      } else {\r\n        console.error(\"No client document found for id:\", clientId);\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error fetching client data:\", error);\r\n    }\r\n    setShowClientModal(false);\r\n  };\r\n\r\n  const handleClientInfo = (clientId, clientName) => {\r\n    console.log(`Client ID: ${clientId}, Client Name: ${clientName}`);\r\n    router.push(\"client/\" + clientId);\r\n  };\r\n\r\n  const handleClearClientSelection = () => {\r\n    if (clientSelectionType === \"from\") {\r\n      setClientFromButtonText(\"Select Option\");\r\n      setSelectedClientFrom(null);\r\n    } else if (clientSelectionType === \"current\") {\r\n      setClientCurrentButtonText(\"Select Option\");\r\n      setSelectedClientCurrent(null);\r\n    }\r\n    setShowClientModal(false);\r\n  };\r\n\r\n  // --------------------\r\n  // MODEL SELECTION HANDLING\r\n  // --------------------\r\n  const [models, setModels] = useState([]);\r\n  const [showModelModal, setShowModelModal] = useState(false);\r\n  const [modelButtonText, setModelButtonText] = useState(\"Select Option\");\r\n\r\n  const handleModelClick = async () => {\r\n    const modelsData = await fetchModels(\r\n      selectedOEM,\r\n      selectedModality,\r\n      selectedClientFrom\r\n    );\r\n    setModels(modelsData);\r\n    setModelSearchTerm(\"\");\r\n    setShowModelModal(true);\r\n  };\r\n\r\n  const handleModelSelect = (modelName) => {\r\n    setModelButtonText(modelName || \"Select Option\");\r\n    setSelectedModel(modelName || null);\r\n    setShowModelModal(false);\r\n  };\r\n\r\n  const handleClearModelSelection = () => {\r\n    setModelButtonText(\"Select Option\");\r\n    setSelectedModel(null);\r\n    setShowModelModal(false);\r\n  };\r\n\r\n  // --------------------\r\n  // WAREHOUSE BUTTONS (for Client Current)\r\n  // --------------------\r\n  const handleSoCalWarehouseClick = () => {\r\n    setClientCurrentButtonText(\"SoCal Warehouse\");\r\n    setSelectedClientCurrent(SOCAL_CLIENT_ID);\r\n    console.log(\"Warehouse button clicked: setting Client Current to\", SOCAL_CLIENT_ID);\r\n  };\r\n\r\n  const handleNorCalWarehouseClick = () => {\r\n    setClientCurrentButtonText(\"NorCal Warehouse\");\r\n    setSelectedClientCurrent(NORCAL_CLIENT_ID);\r\n    console.log(\"Warehouse button clicked: setting Client Current to\", NORCAL_CLIENT_ID);\r\n  };\r\n\r\n  const handleWarehouseUnassignedClick = () => {\r\n    setClientCurrentButtonText(\"Unassigned\");\r\n    setSelectedClientCurrent(UNASSIGNED_CLIENT_ID);\r\n    console.log(\"Warehouse button clicked: setting Client Current to\", UNASSIGNED_CLIENT_ID);\r\n  };\r\n\r\n  const [clientSearchTerm, setClientSearchTerm] = useState(\"\");\r\n  const [modelSearchTerm, setModelSearchTerm] = useState(\"\");\r\n\r\n  const deleteFromStorage = async (itemId) => {\r\n    const storageRef = firebase.storage().ref();\r\n    const folderRef = storageRef.child(`Parts/${itemId}/`);\r\n    try {\r\n      const listResult = await folderRef.listAll();\r\n      const deletePromises = listResult.items.map((item) => item.delete());\r\n      await Promise.all(deletePromises);\r\n    } catch (error) {\r\n      console.error(\"Error deleting from storage:\", error);\r\n    }\r\n  };\r\n\r\n  const deleteFromPartsCollection = async (itemId) => {\r\n    const db = firebase.firestore();\r\n    try {\r\n      await db.collection(\"Parts\").doc(itemId).delete();\r\n      console.log(`Deleted item from Parts collection: ${itemId}`);\r\n    } catch (error) {\r\n      console.error(\"Error deleting from Parts collection:\", error);\r\n    }\r\n  };\r\n\r\n  //   // Safely convert any date-ish value into a comparable timestamp (ms since epoch).\r\n  // function toTime(value) {\r\n  //   if (!value) return null;\r\n\r\n  //   // Firestore Timestamp: { seconds, nanoseconds }\r\n  //   if (typeof value === \"object\" && value.seconds) {\r\n  //     try {\r\n  //       return value.seconds * 1000;\r\n  //     } catch { /* fallthrough */ }\r\n  //   }\r\n\r\n  //   // If already a Date\r\n  //   if (value instanceof Date) return isNaN(value.getTime()) ? null : value.getTime();\r\n\r\n  //   // If string: try ISO first\r\n  //   if (typeof value === \"string\") {\r\n  //     // yyyy-mm-dd (from your form inputs)\r\n  //     const iso = Date.parse(value);\r\n  //     if (!isNaN(iso)) return iso;\r\n\r\n  //     // mm/dd/yyyy fallback (older items)\r\n  //     const parts = value.split(\"/\");\r\n  //     if (parts.length === 3) {\r\n  //       const [mm, dd, yyyy] = parts;\r\n  //       const alt = Date.parse(`${yyyy}-${mm}-${dd}`);\r\n  //       if (!isNaN(alt)) return alt;\r\n  //     }\r\n  //   }\r\n\r\n  //   // Canonicalize any date-ish value to 'yyyy-mm-dd' so it matches <input type=\"date\"> values\r\n  //   function toYMD(value) {\r\n  //     const t = toTime(value);\r\n  //     if (t == null) return null;\r\n  //     const d = new Date(t);\r\n  //     const yyyy = d.getFullYear();\r\n  //     const mm = String(d.getMonth() + 1).padStart(2, \"0\");\r\n  //     const dd = String(d.getDate()).padStart(2, \"0\");\r\n  //     return `${yyyy}-${mm}-${dd}`;\r\n  //   }\r\n\r\n\r\n  //   // Last resort\n  //   const t = Date.parse(value);\n  //   return isNaN(t) ? null : t;\n  // }\n\n  const totalKnownPages = Math.max(\n    1,\n    pageCursors.filter(Boolean).length + (hasNextPage ? 1 : 0)\n  );\n  const pageButtons = [];\n  for (let i = 1; i <= totalKnownPages; i++) {\n    pageButtons.push(\n      <Pagination.Item\n        key={i}\n        active={i === page}\n        onClick={() => setPage(i)}\n      >\n        {i}\n      </Pagination.Item>\n    );\n  }\n\n\n  return (\n    <LoggedIn>\n      {isDeleting && (\r\n        <div className=\"loading-overlay\">\r\n          <Spinner animation=\"border\" role=\"status\" className=\"spinner-center\">\r\n            <span className=\"sr-only\">Loading...</span>\r\n          </Spinner>\r\n        </div>\r\n      )}\r\n      <Modal show={showDeleteModal} onHide={handleCloseDeleteModal}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Confirm Deletion</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          Are you sure you want to delete {selectedItems.length} item\r\n          {selectedItems.length > 1 ? \"s\" : \"\"}?\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"danger\" onClick={handleDeleteSelected}>\r\n            Yes, delete\r\n          </Button>\r\n          <Button variant=\"secondary\" onClick={handleCloseDeleteModal}>\r\n            Cancel\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n\r\n      <Modal show={showClientModal} onHide={() => setShowClientModal(false)}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>\r\n            Select {clientSelectionType === \"from\" ? \"Client From\" : \"Client Current\"}\r\n          </Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <FormControl\r\n            type=\"text\"\r\n            placeholder=\"Search by name\"\r\n            className=\"mb-3\"\r\n            value={clientSearchTerm}\r\n            onChange={(e) => setClientSearchTerm(e.target.value)}\r\n          />\r\n          <ClientTable\r\n            clients={(Array.isArray(clients) ? clients : []).filter(\r\n              (client) => (client?.name ?? \"\").toLowerCase().includes(clientSearchTerm.toLowerCase())\r\n            )}\r\n            onSelectClient={handleClientSelect}\r\n            onInfoClick={handleClientInfo}\r\n            isClientSearch={false}\r\n            clearSelection={() => handleClientSelect(null)}\r\n          />\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      <Modal show={showModelModal} onHide={() => setShowModelModal(false)}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Select Model</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n          <FormControl\r\n            type=\"text\"\r\n            placeholder=\"Search by name\"\r\n            className=\"mb-3\"\r\n            value={modelSearchTerm}\r\n            onChange={(e) => setModelSearchTerm(e.target.value)}\r\n          />\r\n          <ModelTable\r\n            models={models.filter((model) =>\r\n              typeof model === \"string\"\r\n                ? model.toLowerCase().includes(modelSearchTerm.toLowerCase())\r\n                : false\r\n            )}\r\n            onSelectModel={handleModelSelect}\r\n            clearSelection={() => handleModelSelect(null)}\r\n          />\r\n        </Modal.Body>\r\n      </Modal>\r\n\r\n      <Container\r\n        className=\"d-flex align-items-center justify-content-center\"\r\n        style={{ minHeight: \"100vh\" }}\r\n      >\r\n        <div className=\"w-100\" style={{ maxWidth: \"1200px\" }}>\r\n          <Card>\r\n            <Card.Body>\r\n              <h2 className=\"text-center mb-4\">Magmo</h2>\r\n              <Row>\r\n                <Col md={4}>\r\n                  {/* Dropdowns */}\r\n                  <div>\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>OEM</InputGroup.Text>\r\n                      <Dropdown onSelect={handleSelect1}>\r\n                        <Dropdown.Toggle\r\n                          variant=\"outline-secondary\"\r\n                          id=\"dropdown-button-1\"\r\n                          className=\"w-100\"\r\n                        >\r\n                          {dropdown1Text}\r\n                        </Dropdown.Toggle>\r\n                        <Dropdown.Menu className=\"w-100\">\r\n                          <Dropdown.Item eventKey=\"unassigned\">\r\n                            Select Option\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"GE\">GE</Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"Toshiba\">\r\n                            Toshiba\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"Siemens\">\r\n                            Siemens\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"Philips\">\r\n                            Philips\r\n                          </Dropdown.Item>\r\n                        </Dropdown.Menu>\r\n                      </Dropdown>\r\n                    </InputGroup>\r\n\r\n                    <InputGroup className=\"mb-5\">\r\n                      <InputGroup.Text>Modality</InputGroup.Text>\r\n                      <Dropdown onSelect={handleSelect2}>\r\n                        <Dropdown.Toggle\r\n                          variant=\"outline-secondary\"\r\n                          id=\"dropdown-button-2\"\r\n                          className=\"w-100\"\r\n                        >\r\n                          {dropdown2Text}\r\n                        </Dropdown.Toggle>\r\n                        <Dropdown.Menu className=\"w-100\">\r\n                          <Dropdown.Item eventKey=\"unassigned\">\r\n                            Select Option\r\n                          </Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"CT\">CT</Dropdown.Item>\r\n                          <Dropdown.Item eventKey=\"MRI\">MRI</Dropdown.Item>\r\n                        </Dropdown.Menu>\r\n                      </Dropdown>\r\n                    </InputGroup>\r\n                  </div>\r\n\r\n                  <div className={styles.divider}></div>\r\n\r\n                  {/* Client selection boxes */}\r\n                  <div>\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Client From</InputGroup.Text>\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        className=\"w-100\"\r\n                        onClick={() => handleClientClick(\"from\")}\r\n\r\n                      >\r\n                        {clientFromButtonText}\r\n                      </Button>\r\n                    </InputGroup>\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Client Current</InputGroup.Text>\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        className=\"w-100\"\r\n                        onClick={() => handleClientClick(\"current\")}\r\n\r\n                      >\r\n                        {clientCurrentButtonText}\r\n                      </Button>\r\n                    </InputGroup>\r\n\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Model</InputGroup.Text>\r\n                      <Button\r\n                        variant=\"outline-secondary\"\r\n                        className=\"w-100\"\r\n                        onClick={handleModelClick}\r\n                      >\r\n                        {modelButtonText}\r\n                      </Button>\r\n                    </InputGroup>\r\n\r\n                    <div className={styles.divider}></div>\r\n\r\n                    {/* Warehouse buttons for Client Current */}\r\n                    <InputGroup className=\"mb-3\">\r\n                      <InputGroup.Text>Warehouse</InputGroup.Text>\r\n                      <div className={styles.buttonGroup}>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          className={styles.flexButton}\r\n                          onClick={handleSoCalWarehouseClick}\r\n                        >\r\n                          SoCal Warehouse\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          className={styles.flexButton}\r\n                          onClick={handleNorCalWarehouseClick}\r\n                        >\r\n                          NorCal Warehouse\r\n                        </Button>\r\n                        <Button\r\n                          variant=\"outline-secondary\"\r\n                          className={styles.flexButton}\r\n                          onClick={handleWarehouseUnassignedClick}\r\n                        >\r\n                          Unassigned\r\n                        </Button>\r\n                      </div>\r\n                    </InputGroup>\r\n                  </div>\r\n                </Col>\r\n\r\n                <Col md={8}>\r\n                  <div className={styles.tableContainer}>\r\n                    {isLoading ? (\r\n                      <div className=\"d-flex justify-content-center align-items-center p-5\">\r\n                        <img\r\n                          src=\"/magmo-logo.png\" // make sure it's in /public\r\n                          alt=\"Loading Magmo\"\r\n                          style={{\r\n                            width: 64,\r\n                            height: 64,\r\n                            animation: \"magmo-spin 1s linear infinite\",\r\n                            transformOrigin: \"50% 50%\",\r\n                            display: \"block\",\r\n                          }}\r\n                        />\r\n\r\n                        {/* global so styled-jsx doesn't hash the name */}\r\n                        <style jsx global>{`\r\n      @keyframes magmo-spin {\r\n        from {\r\n          transform: rotate(0deg);\r\n        }\r\n        to {\r\n          transform: rotate(360deg);\r\n        }\r\n      }\r\n    `}</style>\r\n                      </div>\r\n                    ) : (\r\n                      <PartTable\r\n                        info={info}\r\n                        labels={labels}\r\n                        ids={ids}\r\n                        hoverStyle={hoverStyle}\r\n                        sortCheckAll={sortCheckAll}\r\n                        checkDelete={checkDelete}\r\n                        isDeleting={isDeleting}\r\n                        rowSelect={rowSelect}\r\n                        setHoverIndex={setHoverIndex}\r\n                        hoverIndex={hoverIndex}\r\n                        selectedItems={selectedItems}\r\n                        setSelectedItems={setSelectedItems}\r\n                      />\r\n                    )}\n\n\n                    <div className={styles.searchContainer}>\n                      <div className={styles.paginationRow}>\n                        <Pagination size=\"sm\">\n                          <Pagination.Prev\n                            onClick={() => setPage((p) => Math.max(1, p - 1))}\n                            disabled={page <= 1}\n                          />\n                          {pageButtons}\n                          <Pagination.Next\n                            onClick={() => setPage((p) => p + 1)}\n                            disabled={!hasNextPage}\n                          />\n                        </Pagination>\n                      </div>\n                      <Form className=\"d-flex pb-2\">\n                        <FormControl\n                          type={showListSearch}\n                          placeholder=\"Search\"\n                          className=\"me-2 flex-grow-1\"\r\n                          aria-label=\"Search\"\r\n                          value={search}\r\n                          onChange={searchChangeHandler}\r\n                          style={{ flex: \"1\" }}\r\n                        />\r\n                        <NavDropdown\r\n                          title={select}\r\n                          id=\"collasible-nav-dropdown\"\r\n                          show={showList}\r\n                          onMouseEnter={() => setShowList(true)}\r\n                          onMouseLeave={() => setShowList(false)}\r\n                          style={{ marginTop: \"-5px\" }}\r\n                        >\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Name\"); setShowListSearch(\"text\"); }}>\r\n                            Name\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Date\"); setShowListSearch(\"date\"); }}>\r\n                            Date\r\n                          </NavDropdown.Item>\r\n                          <NavDropdown.Item onClick={() => { setSelect(\"Work Order\"); setShowListSearch(\"number\"); }}>\n                            Work Order\n                          </NavDropdown.Item>\n                          <NavDropdown.Item onClick={() => { setSelect(\"Work Order\"); setShowListSearch(\"text\"); }}>\n                            Work Order\n                          </NavDropdown.Item>\n                          <NavDropdown.Item onClick={() => { setSelect(\"Product Number\"); setShowListSearch(\"text\"); }}>\n                            Product Number\n                          </NavDropdown.Item>\n                          <NavDropdown.Item onClick={() => { setSelect(\"Serial Number\"); setShowListSearch(\"text\"); }}>\n                            Serial Number\n                          </NavDropdown.Item>\n                          <NavDropdown.Item onClick={() => { setSelect(\"Description\"); setShowListSearch(\"text\"); }}>\n                            Description\n                          </NavDropdown.Item>\n                          <NavDropdown.Item\r\n                            onClick={() => {\r\n                              setSelect(\"SKU\");\r\n                              setShowListSearch(\"text\");\r\n                            }}\r\n                          >\r\n                            SKU\r\n                          </NavDropdown.Item>\r\n                        </NavDropdown>\r\n                      </Form>\r\n                      <div className=\"d-flex justify-content-between\">\r\n                        <LoadingButton type=\"secondary\" name=\"Add New Item\" route=\"NewSearch/AddItem/NewItem\" />\r\n                        <LoadingButton type=\"primary\" name=\"Back\" route=\"Warehousedb/WarehouseSelect\" />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </Col>\r\n              </Row>\r\n            </Card.Body>\r\n          </Card>\r\n        </div>\r\n      </Container>\r\n    </LoggedIn>\r\n  );\r\n\r\n\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}